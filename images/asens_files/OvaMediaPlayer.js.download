!function a(b,c,d){function e(f,h){var i,j,k;if(!c[f]){if(!b[f]){if(i="function"==typeof require&&require,!h&&i)return i(f,!0);if(g)return g(f,!0);throw j=new Error("Cannot find module '"+f+"'"),j.code="MODULE_NOT_FOUND",j}k=c[f]={exports:{}},b[f][0].call(k.exports,function(a){var c=b[f][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[f].exports}var f,g="function"==typeof require&&require;for(f=0;f<d.length;f++)e(d[f]);return e}({1:[function(require,module,exports){(function(process,global){!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Promise=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(f,h){var i,j,k;if(!c[f]){if(!b[f]){if(i="function"==typeof _dereq_&&_dereq_,!h&&i)return i(f,!0);if(g)return g(f,!0);throw j=new Error("Cannot find module '"+f+"'"),j.code="MODULE_NOT_FOUND",j}k=c[f]={exports:{}},b[f][0].call(k.exports,function(a){var c=b[f][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[f].exports}var f,g="function"==typeof _dereq_&&_dereq_;for(f=0;f<d.length;f++)e(d[f]);return e}({1:[function(a,b,c){"use strict";b.exports=function(a){function b(a){var b=new c(a),d=b.promise();return b.setHowMany(1),b.setUnwrap(),b.init(),d}var c=a._SomePromiseArray;a.any=function(a){return b(a)},a.prototype.any=function(){return b(this)}}},{}],2:[function(a,b,c){"use strict";function d(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new j(16),this._normalQueue=new j(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var a=this;this.drainQueues=function(){a._drainQueues()},this._schedule=i}function e(a,b,c){this._lateQueue.push(a,b,c),this._queueTick()}function f(a,b,c){this._normalQueue.push(a,b,c),this._queueTick()}function g(a){this._normalQueue._pushOne(a),this._queueTick()}var h,i,j,k;try{throw new Error}catch(l){h=l}i=a("./schedule"),j=a("./queue"),k=a("./util"),d.prototype.setScheduler=function(a){var b=this._schedule;return this._schedule=a,this._customScheduler=!0,b},d.prototype.hasCustomScheduler=function(){return this._customScheduler},d.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},d.prototype.disableTrampolineIfNecessary=function(){k.hasDevTools&&(this._trampolineEnabled=!1)},d.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},d.prototype.fatalError=function(a,b){b?(process.stderr.write("Fatal "+(a instanceof Error?a.stack:a)+"\n"),process.exit(2)):this.throwLater(a)},d.prototype.throwLater=function(a,b){if(1===arguments.length&&(b=a,a=function(){throw b}),"undefined"!=typeof setTimeout)setTimeout(function(){a(b)},0);else try{this._schedule(function(){a(b)})}catch(c){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},k.hasDevTools?(d.prototype.invokeLater=function(a,b,c){this._trampolineEnabled?e.call(this,a,b,c):this._schedule(function(){setTimeout(function(){a.call(b,c)},100)})},d.prototype.invoke=function(a,b,c){this._trampolineEnabled?f.call(this,a,b,c):this._schedule(function(){a.call(b,c)})},d.prototype.settlePromises=function(a){this._trampolineEnabled?g.call(this,a):this._schedule(function(){a._settlePromises()})}):(d.prototype.invokeLater=e,d.prototype.invoke=f,d.prototype.settlePromises=g),d.prototype._drainQueue=function(a){for(var b,c,d;a.length()>0;)b=a.shift(),"function"==typeof b?(c=a.shift(),d=a.shift(),b.call(c,d)):b._settlePromises()},d.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},d.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},d.prototype._reset=function(){this._isTickUsed=!1},b.exports=d,b.exports.firstLineError=h},{"./queue":26,"./schedule":29,"./util":36}],3:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){var e=!1,f=function(a,b){this._reject(b)},g=function(a,b){b.promiseRejectionQueued=!0,b.bindingPromise._then(f,f,null,this,a)},h=function(a,b){0===(50397184&this._bitField)&&this._resolveCallback(b.target)},i=function(a,b){b.promiseRejectionQueued||this._reject(a)};a.prototype.bind=function(f){var j,k,l,m;return e||(e=!0,a.prototype._propagateFrom=d.propagateFromFunction(),a.prototype._boundValue=d.boundValueFunction()),j=c(f),k=new a(b),k._propagateFrom(this,1),l=this._target(),k._setBoundTo(j),j instanceof a?(m={promiseRejectionQueued:!1,promise:k,target:l,bindingPromise:j},l._then(b,g,void 0,k,m),j._then(h,i,void 0,k,m),k._setOnCancel(j)):k._resolveCallback(l),k},a.prototype._setBoundTo=function(a){void 0!==a?(this._bitField=2097152|this._bitField,this._boundTo=a):this._bitField=this._bitField&-2097153},a.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},a.bind=function(b,c){return a.resolve(c).bind(b)}}},{}],4:[function(a,b,c){"use strict";function d(){try{Promise===f&&(Promise=e)}catch(a){}return f}var e,f;"undefined"!=typeof Promise&&(e=Promise),f=a("./promise")(),f.noConflict=d,b.exports=f},{"./promise":22}],5:[function(a,b,c){"use strict";var d,e,f=Object.create;f&&(d=f(null),e=f(null),d[" size"]=e[" size"]=0),b.exports=function(b){function c(a,c){var d,e;if(null!=a&&(d=a[c]),"function"!=typeof d)throw e="Object "+l.classString(a)+" has no method '"+l.toString(c)+"'",new b.TypeError(e);return d}function d(a){var b=this.pop(),d=c(a,b);return d.apply(a,this)}function e(a){return a[this]}function f(a){var b=+this;return b<0&&(b=Math.max(0,b+a.length)),a[b]}var g,h,i,j,k,l=a("./util"),m=l.canEvaluate,n=l.isIdentifier;b.prototype.call=function(a){var b,c=[].slice.call(arguments,1);return c.push(a),this._then(d,void 0,void 0,c,void 0)},b.prototype.get=function(a){var b,c,d="number"==typeof a;return d?b=f:m?(c=h(a),b=null!==c?c:e):b=e,this._then(b,void 0,void 0,a,void 0)}}},{"./util":36}],6:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){var f=a("./util"),g=f.tryCatch,h=f.errorObj,i=b._async;b.prototype["break"]=b.prototype.cancel=function(){var a,b,c;if(!e.cancellation())return this._warn("cancellation is disabled");for(a=this,b=a;a._isCancellable();){if(!a._cancelBy(b)){b._isFollowing()?b._followee().cancel():b._cancelBranched();break}if(c=a._cancellationParent,null==c||!c._isCancellable()){a._isFollowing()?a._followee().cancel():a._cancelBranched();break}a._isFollowing()&&a._followee().cancel(),a._setWillBeCancelled(),b=a,a=c}},b.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},b.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},b.prototype._cancelBy=function(a){return a===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},b.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},b.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),i.invoke(this._cancelPromises,this,void 0))},b.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},b.prototype._unsetOnCancel=function(){this._onCancelField=void 0},b.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},b.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},b.prototype._doInvokeOnCancel=function(a,b){var c,d;if(f.isArray(a))for(c=0;c<a.length;++c)this._doInvokeOnCancel(a[c],b);else void 0!==a&&("function"==typeof a?b||(d=g(a).call(this._boundValue()),d===h&&(this._attachExtraTrace(d.e),i.throwLater(d.e))):a._resultCancelled(this))},b.prototype._invokeOnCancel=function(){var a=this._onCancel();this._unsetOnCancel(),i.invoke(this._doInvokeOnCancel,this,a)},b.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},b.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(a,b,c){"use strict";b.exports=function(b){function c(a,c,h){return function(i){var j,k,l,m,n,o,p=h._boundValue();a:for(j=0;j<a.length;++j)if(k=a[j],k===Error||null!=k&&k.prototype instanceof Error){if(i instanceof k)return f(c).call(p,i)}else if("function"==typeof k){if(l=f(k).call(p,i),l===g)return l;if(l)return f(c).call(p,i)}else if(d.isObject(i)){for(m=e(k),n=0;n<m.length;++n)if(o=m[n],k[o]!=i[o])continue a;return f(c).call(p,i)}return b}}var d=a("./util"),e=a("./es5").keys,f=d.tryCatch,g=d.errorObj;return c}},{"./es5":13,"./util":36}],8:[function(a,b,c){"use strict";b.exports=function(a){function b(){this._trace=new b.CapturedTrace(d())}function c(){if(e)return new b}function d(){var a=f.length-1;if(a>=0)return f[a]}var e=!1,f=[];return a.prototype._promiseCreated=function(){},a.prototype._pushContext=function(){},a.prototype._popContext=function(){return null},a._peekContext=a.prototype._peekContext=function(){},b.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,f.push(this._trace))},b.prototype._popContext=function(){var a,b;return void 0!==this._trace?(a=f.pop(),b=a._promiseCreated,a._promiseCreated=null,b):null},b.CapturedTrace=null,b.create=c,b.deactivateLongStackTraces=function(){},b.activateLongStackTraces=function(){var c=a.prototype._pushContext,f=a.prototype._popContext,g=a._peekContext,h=a.prototype._peekContext,i=a.prototype._promiseCreated;b.deactivateLongStackTraces=function(){a.prototype._pushContext=c,a.prototype._popContext=f,a._peekContext=g,a.prototype._peekContext=h,a.prototype._promiseCreated=i,e=!1},e=!0,a.prototype._pushContext=b.prototype._pushContext,a.prototype._popContext=b.prototype._popContext,a._peekContext=a.prototype._peekContext=d,a.prototype._promiseCreated=function(){var a=this._peekContext();a&&null==a._promiseCreated&&(a._promiseCreated=this)}},b}},{}],9:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a,b){return{promise:b}}function e(){return!1}function f(a,b,c){var d=this;try{a(b,c,function(a){if("function"!=typeof a)throw new TypeError("onCancel must be a function, got: "+W.toString(a));d._attachCancellationCallback(a)})}catch(e){return e}}function g(a){if(!this._isCancellable())return this;var b=this._onCancel();void 0!==b?W.isArray(b)?b.push(a):this._setOnCancel([b,a]):this._setOnCancel(a)}function h(){return this._onCancelField}function i(a){this._onCancelField=a}function j(){this._cancellationParent=void 0,this._onCancelField=void 0}function k(a,b){if(0!==(1&b)){this._cancellationParent=a;var c=a._branchesRemainingToCancel;void 0===c&&(c=0),a._branchesRemainingToCancel=c+1}0!==(2&b)&&a._isBound()&&this._setBoundTo(a._boundTo)}function l(a,b){0!==(2&b)&&a._isBound()&&this._setBoundTo(a._boundTo)}function m(){var a=this._boundTo;return void 0!==a&&a instanceof b?a.isFulfilled()?a.value():void 0:a}function n(){this._trace=new F(this._peekContext())}function o(a,b){var c,d;X(a)&&(c=this._trace,void 0!==c&&b&&(c=c._parent),void 0!==c?c.attachExtraTrace(a):a.__stackCleaned__||(d=x(a),W.notEnumerableProp(a,"stack",d.message+"\n"+d.stack.join("\n")),W.notEnumerableProp(a,"__stackCleaned__",!0)))}function p(a,b,c,d,e){var f,g,h,i,j,k,l,m,n;if(void 0===a&&null!==b&&fa){if(void 0!==e&&e._returnedNonUndefined())return;if(0===(65535&d._bitField))return;if(c&&(c+=" "),f="",g="",b._trace){for(h=b._trace.stack.split("\n"),i=v(h),j=i.length-1;j>=0;--j)if(k=i[j],!Z.test(k)){l=k.match($),l&&(f="at "+l[1]+":"+l[2]+":"+l[3]+" ");break}if(i.length>0)for(m=i[0],j=0;j<h.length;++j)if(h[j]===m){j>0&&(g="\n"+h[j-1]);break}}n="a promise was created in a "+c+"handler "+f+"but was not returned from it, see http://goo.gl/rRqMUw"+g,d._warn(n,!0,b)}}function q(a,b){var c=a+" is deprecated and will be removed in a future version.";return b&&(c+=" Use "+b+" instead."),r(c)}function r(a,c,d){var e,f,g;S.warnings&&(e=new V(a),c?d._attachExtraTrace(e):S.longStackTraces&&(f=b._peekContext())?f.attachExtraTrace(e):(g=x(e),e.stack=g.message+"\n"+g.stack.join("\n")),N("warning",e)||y(e,"",!0))}function s(a,b){for(var c=0;c<b.length-1;++c)b[c].push("From previous event:"),b[c]=b[c].join("\n");return c<b.length&&(b[c]=b[c].join("\n")),a+"\n"+b.join("\n")}function t(a){for(var b=0;b<a.length;++b)(0===a[b].length||b+1<a.length&&a[b][0]===a[b+1][0])&&(a.splice(b,1),b--)}function u(a){var b,c,d,e,f,g,h,i=a[0];for(b=1;b<a.length;++b){for(c=a[b],d=i.length-1,e=i[d],f=-1,g=c.length-1;g>=0;--g)if(c[g]===e){f=g;break}for(g=f;g>=0&&(h=c[g],i[d]===h);--g)i.pop(),d--;i=c}}function v(a){var b,c,d,e,f=[];for(b=0;b<a.length;++b)c=a[b],d="    (No stack trace)"===c||_.test(c),e=d&&P(c),d&&!e&&(ba&&" "!==c.charAt(0)&&(c="    "+c),f.push(c));return f}function w(a){var b,c,d=a.stack.replace(/\s+$/g,"").split("\n");for(b=0;b<d.length&&(c=d[b],"    (No stack trace)"!==c&&!_.test(c));++b);return b>0&&"SyntaxError"!=a.name&&(d=d.slice(b)),d}function x(a){var b=a.stack,c=a.toString();return b="string"==typeof b&&b.length>0?w(a):["    (No stack trace)"],{message:c,stack:"SyntaxError"==a.name?b:v(b)}}function y(a,b,c){var d,e;"undefined"!=typeof console&&(W.isObject(a)?(e=a.stack,d=b+aa(e,a)):d=b+String(a),"function"==typeof I?I(d,c):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(d))}function z(a,b,c,d){var e=!1;try{"function"==typeof b&&(e=!0,"rejectionHandled"===a?b(d):b(c,d))}catch(f){U.throwLater(f)}"unhandledRejection"===a?N(a,c,d)||e||y(c,"Unhandled rejection "):N(a,d)}function A(a){var b,c,d;if("function"==typeof a)b="[function "+(a.name||"anonymous")+"]";else{if(b=a&&"function"==typeof a.toString?a.toString():W.toString(a),c=/\[object [a-zA-Z0-9$_]+\]/,c.test(b))try{d=JSON.stringify(a),b=d}catch(e){}0===b.length&&(b="(empty array)")}return"(<"+B(b)+">, no stack trace)"}function B(a){var b=41;return a.length<b?a:a.substr(0,b-3)+"..."}function C(){return"function"==typeof R}function D(a){var b=a.match(Q);if(b)return{fileName:b[1],line:parseInt(b[2],10)}}function E(a,b){var c,d,e,f,g,h,i,j;if(C()){for(c=a.stack.split("\n"),d=b.stack.split("\n"),e=-1,f=-1,i=0;i<c.length;++i)if(j=D(c[i])){g=j.fileName,e=j.line;break}for(i=0;i<d.length;++i)if(j=D(d[i])){h=j.fileName,f=j.line;break}e<0||f<0||!g||!h||g!==h||e>=f||(P=function(a){if(Y.test(a))return!0;var b=D(a);return!!(b&&b.fileName===g&&e<=b.line&&b.line<=f)})}}function F(a){this._parent=a,this._promisesCreated=0;var b=this._length=1+(void 0===a?0:a._length);R(this,F),b>32&&this.uncycle()}var G,H,I,J,K,L,M,N,O,P,Q,R,S,T=b._getDomain,U=b._async,V=a("./errors").Warning,W=a("./util"),X=W.canAttachTrace,Y=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,Z=/\((?:timers\.js):\d+:\d+\)/,$=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,_=null,aa=null,ba=!1,ca=!(0==W.env("BLUEBIRD_DEBUG")),da=!(0==W.env("BLUEBIRD_WARNINGS")||!ca&&!W.env("BLUEBIRD_WARNINGS")),ea=!(0==W.env("BLUEBIRD_LONG_STACK_TRACES")||!ca&&!W.env("BLUEBIRD_LONG_STACK_TRACES")),fa=0!=W.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(da||!!W.env("BLUEBIRD_W_FORGOTTEN_RETURN"));return b.prototype.suppressUnhandledRejections=function(){var a=this._target();a._bitField=a._bitField&-1048577|524288},b.prototype._ensurePossibleRejectionHandled=function(){if(0===(524288&this._bitField)){this._setRejectionIsUnhandled();var a=this;setTimeout(function(){a._notifyUnhandledRejection()},1)}},b.prototype._notifyUnhandledRejectionIsHandled=function(){z("rejectionHandled",G,void 0,this)},b.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},b.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},b.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var a=this._settledValue();this._setUnhandledRejectionIsNotified(),z("unhandledRejection",H,a,this)}},b.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},b.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},b.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},b.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},b.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},b.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},b.prototype._warn=function(a,b,c){return r(a,b,c||this)},b.onPossiblyUnhandledRejection=function(a){var b=T();H="function"==typeof a?null===b?a:W.domainBind(b,a):void 0},b.onUnhandledRejectionHandled=function(a){var b=T();G="function"==typeof a?null===b?a:W.domainBind(b,a):void 0},J=function(){},b.longStackTraces=function(){var a,d;if(U.haveItemsQueued()&&!S.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");!S.longStackTraces&&C()&&(a=b.prototype._captureStackTrace,d=b.prototype._attachExtraTrace,S.longStackTraces=!0,J=function(){if(U.haveItemsQueued()&&!S.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");b.prototype._captureStackTrace=a,b.prototype._attachExtraTrace=d,c.deactivateLongStackTraces(),U.enableTrampoline(),S.longStackTraces=!1},b.prototype._captureStackTrace=n,b.prototype._attachExtraTrace=o,c.activateLongStackTraces(),U.disableTrampolineIfNecessary())},b.hasLongStackTraces=function(){return S.longStackTraces&&C()},K=function(){var a;try{return"function"==typeof CustomEvent?(a=new CustomEvent("CustomEvent"),W.global.dispatchEvent(a),function(a,b){var c=new CustomEvent(a.toLowerCase(),{detail:b,cancelable:!0});return!W.global.dispatchEvent(c)}):"function"==typeof Event?(a=new Event("CustomEvent"),W.global.dispatchEvent(a),function(a,b){var c=new Event(a.toLowerCase(),{cancelable:!0});return c.detail=b,!W.global.dispatchEvent(c)}):(a=document.createEvent("CustomEvent"),a.initCustomEvent("testingtheevent",!1,!0,{}),W.global.dispatchEvent(a),function(a,b){var c=document.createEvent("CustomEvent");return c.initCustomEvent(a.toLowerCase(),!1,!0,b),!W.global.dispatchEvent(c)})}catch(b){}return function(){return!1}}(),L=function(){return W.isNode?function(){return process.emit.apply(process,arguments)}:W.global?function(a){var b="on"+a.toLowerCase(),c=W.global[b];return!!c&&(c.apply(W.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),M={promiseCreated:d,promiseFulfilled:d,promiseRejected:d,promiseResolved:d,promiseCancelled:d,promiseChained:function(a,b,c){return{promise:b,child:c}},warning:function(a,b){return{warning:b}},unhandledRejection:function(a,b,c){return{reason:b,promise:c}},rejectionHandled:d},N=function(a){var b,c=!1;try{c=L.apply(null,arguments)}catch(d){U.throwLater(d),c=!0}b=!1;try{b=K(a,M[a].apply(null,arguments))}catch(d){U.throwLater(d),b=!0}return b||c},b.config=function(a){if(a=Object(a),"longStackTraces"in a&&(a.longStackTraces?b.longStackTraces():!a.longStackTraces&&b.hasLongStackTraces()&&J()),"warnings"in a){var c=a.warnings;S.warnings=!!c,fa=S.warnings,W.isObject(c)&&"wForgottenReturn"in c&&(fa=!!c.wForgottenReturn)}if("cancellation"in a&&a.cancellation&&!S.cancellation){if(U.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");b.prototype._clearCancellationData=j,b.prototype._propagateFrom=k,b.prototype._onCancel=h,b.prototype._setOnCancel=i,b.prototype._attachCancellationCallback=g,b.prototype._execute=f,O=k,S.cancellation=!0}return"monitoring"in a&&(a.monitoring&&!S.monitoring?(S.monitoring=!0,b.prototype._fireEvent=N):!a.monitoring&&S.monitoring&&(S.monitoring=!1,b.prototype._fireEvent=e)),b},b.prototype._fireEvent=e,b.prototype._execute=function(a,b,c){try{a(b,c)}catch(d){return d}},b.prototype._onCancel=function(){},b.prototype._setOnCancel=function(a){},b.prototype._attachCancellationCallback=function(a){},b.prototype._captureStackTrace=function(){},b.prototype._attachExtraTrace=function(){},b.prototype._clearCancellationData=function(){},b.prototype._propagateFrom=function(a,b){},O=l,P=function(){return!1},Q=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/,W.inherits(F,Error),c.CapturedTrace=F,F.prototype.uncycle=function(){var a,b,c,d,e,f,g,h,i,j,k=this._length;if(!(k<2)){for(a=[],b={},c=0,d=this;void 0!==d;++c)a.push(d),d=d._parent;for(k=this._length=c,c=k-1;c>=0;--c)e=a[c].stack,void 0===b[e]&&(b[e]=c);for(c=0;c<k;++c)if(f=a[c].stack,g=b[f],void 0!==g&&g!==c){for(g>0&&(a[g-1]._parent=void 0,a[g-1]._length=1),a[c]._parent=void 0,a[c]._length=1,h=c>0?a[c-1]:this,g<k-1?(h._parent=a[g+1],h._parent.uncycle(),h._length=h._parent._length+1):(h._parent=void 0,h._length=1),i=h._length+1,j=c-2;j>=0;--j)a[j]._length=i,i++;return}}},F.prototype.attachExtraTrace=function(a){var b,c,d,e;if(!a.__stackCleaned__){for(this.uncycle(),b=x(a),c=b.message,d=[b.stack],e=this;void 0!==e;)d.push(v(e.stack.split("\n"))),e=e._parent;u(d),t(d),W.notEnumerableProp(a,"stack",s(c,d)),W.notEnumerableProp(a,"__stackCleaned__",!0)}},R=function ga(){var a,b,c,d=/^\s*at\s*/,e=function(a,b){return"string"==typeof a?a:void 0!==b.name&&void 0!==b.message?b.toString():A(b)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace)return Error.stackTraceLimit+=6,_=d,aa=e,a=Error.captureStackTrace,P=function(a){return Y.test(a)},function(b,c){Error.stackTraceLimit+=6,a(b,c),Error.stackTraceLimit-=6};if(b=new Error,"string"==typeof b.stack&&b.stack.split("\n")[0].indexOf("stackDetection@")>=0)return _=/@/,aa=e,ba=!0,function g(a){a.stack=(new Error).stack};try{throw new Error}catch(f){c="stack"in f}return"stack"in b||!c||"number"!=typeof Error.stackTraceLimit?(aa=function(a,b){return"string"==typeof a?a:"object"!=typeof b&&"function"!=typeof b||void 0===b.name||void 0===b.message?A(b):b.toString()},null):(_=d,aa=e,function h(a){Error.stackTraceLimit+=6;try{throw new Error}catch(b){a.stack=b.stack}Error.stackTraceLimit-=6})}([]),"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(I=function(a){console.warn(a)},W.isNode&&process.stderr.isTTY?I=function(a,b){var c=b?"[33m":"[31m";console.warn(c+a+"[0m\n")}:W.isNode||"string"!=typeof(new Error).stack||(I=function(a,b){console.warn("%c"+a,b?"color: darkorange":"color: red")})),S={warnings:da,longStackTraces:!1,cancellation:!1,monitoring:!1},ea&&b.longStackTraces(),{longStackTraces:function(){return S.longStackTraces},warnings:function(){return S.warnings},cancellation:function(){return S.cancellation},monitoring:function(){return S.monitoring},propagateFromFunction:function(){return O},boundValueFunction:function(){return m},checkForgottenReturns:p,setBounds:E,warn:r,deprecated:q,CapturedTrace:F,fireDomEvent:K,fireGlobalEvent:L}}},{"./errors":12,"./util":36}],10:[function(a,b,c){"use strict";b.exports=function(a){function b(){return this.value}function c(){throw this.reason}a.prototype["return"]=a.prototype.thenReturn=function(c){return c instanceof a&&c.suppressUnhandledRejections(),this._then(b,void 0,void 0,{value:c},void 0)},a.prototype["throw"]=a.prototype.thenThrow=function(a){return this._then(c,void 0,void 0,{reason:a},void 0)},a.prototype.catchThrow=function(a){var b,d;return arguments.length<=1?this._then(void 0,c,void 0,{reason:a},void 0):(b=arguments[1],d=function(){throw b},this.caught(a,d))},a.prototype.catchReturn=function(c){var d,e;return arguments.length<=1?(c instanceof a&&c.suppressUnhandledRejections(),this._then(void 0,b,void 0,{value:c},void 0)):(d=arguments[1],d instanceof a&&d.suppressUnhandledRejections(),e=function(){return d},this.caught(c,e))}}},{}],11:[function(a,b,c){"use strict";b.exports=function(a,b){function c(){return f(this)}function d(a,c){return e(a,c,b,b)}var e=a.reduce,f=a.all;a.prototype.each=function(a){return e(this,a,b,0)._then(c,void 0,void 0,this,void 0)},a.prototype.mapSeries=function(a){return e(this,a,b,b)},a.each=function(a,d){return e(a,d,b,0)._then(c,void 0,void 0,a,void 0)},a.mapSeries=d}},{}],12:[function(a,b,c){"use strict";function d(a,b){function c(d){return this instanceof c?(p(this,"message","string"==typeof d?d:b),p(this,"name",a),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new c(d)}return o(c,Error),c}function e(a){return this instanceof e?(p(this,"name","OperationalError"),p(this,"message",a),this.cause=a,this.isOperational=!0,void(a instanceof Error?(p(this,"message",a.message),p(this,"stack",a.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new e(a)}var f,g,h,i,j,k,l=a("./es5"),m=l.freeze,n=a("./util"),o=n.inherits,p=n.notEnumerableProp,q=d("Warning","warning"),r=d("CancellationError","cancellation error"),s=d("TimeoutError","timeout error"),t=d("AggregateError","aggregate error");try{f=TypeError,g=RangeError}catch(u){f=d("TypeError","type error"),g=d("RangeError","range error")}for(h="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),i=0;i<h.length;++i)"function"==typeof Array.prototype[h[i]]&&(t.prototype[h[i]]=Array.prototype[h[i]]);l.defineProperty(t.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),t.prototype.isOperational=!0,j=0,t.prototype.toString=function(){var a,b,c,d,e=Array(4*j+1).join(" "),f="\n"+e+"AggregateError of:\n";for(j++,e=Array(4*j+1).join(" "),a=0;a<this.length;++a){for(b=this[a]===this?"[Circular AggregateError]":this[a]+"",c=b.split("\n"),d=0;d<c.length;++d)c[d]=e+c[d];b=c.join("\n"),f+=b+"\n"}return j--,f},o(e,Error),k=Error.__BluebirdErrorTypes__,k||(k=m({CancellationError:r,TimeoutError:s,OperationalError:e,RejectionError:e,AggregateError:t}),l.defineProperty(Error,"__BluebirdErrorTypes__",{value:k,writable:!1,enumerable:!1,configurable:!1})),b.exports={Error:Error,TypeError:f,RangeError:g,CancellationError:k.CancellationError,OperationalError:k.OperationalError,TimeoutError:k.TimeoutError,AggregateError:k.AggregateError,Warning:q}},{"./es5":13,"./util":36}],13:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m=function(){"use strict";return void 0===this}();m?b.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:m,propertyIsWritable:function(a,b){var c=Object.getOwnPropertyDescriptor(a,b);return!(c&&!c.writable&&!c.set)}}:(d={}.hasOwnProperty,e={}.toString,f={}.constructor.prototype,g=function(a){var b,c=[];for(b in a)d.call(a,b)&&c.push(b);return c},h=function(a,b){return{value:a[b]}},i=function(a,b,c){return a[b]=c.value,a},j=function(a){return a},k=function(a){try{return Object(a).constructor.prototype}catch(b){return f}},l=function(a){try{return"[object Array]"===e.call(a)}catch(b){return!1}},b.exports={isArray:l,keys:g,names:g,defineProperty:i,getDescriptor:h,freeze:j,getPrototypeOf:k,isES5:m,propertyIsWritable:function(){return!0}})},{}],14:[function(a,b,c){"use strict";b.exports=function(a,b){var c=a.map;a.prototype.filter=function(a,d){return c(this,a,d,b)},a.filter=function(a,d,e){return c(a,d,e,b)}}},{}],15:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a,b,c){this.promise=a,this.type=b,this.handler=c,this.called=!1,this.cancelPromise=null}function f(a){this.finallyHandler=a}function g(a,b){return null!=a.cancelPromise&&(arguments.length>1?a.cancelPromise._reject(b):a.cancelPromise._cancel(),a.cancelPromise=null,!0)}function h(){return j.call(this,this.promise._target()._settledValue())}function i(a){if(!g(this,a))return m.e=a,m}function j(a){var e,j,k,n=this.promise,o=this.handler;if(!this.called){if(this.called=!0,e=this.isFinallyHandler()?o.call(n._boundValue()):o.call(n._boundValue(),a),e===d)return e;if(void 0!==e&&(n._setReturnedNonUndefined(),j=c(e,n),j instanceof b)){if(null!=this.cancelPromise){if(j._isCancelled())return k=new l("late cancellation observer"),n._attachExtraTrace(k),m.e=k,m;j.isPending()&&j._attachCancellationCallback(new f(this))}return j._then(h,i,void 0,this,void 0)}}return n.isRejected()?(g(this),m.e=a,m):(g(this),a)}var k=a("./util"),l=b.CancellationError,m=k.errorObj,n=a("./catch_filter")(d);return e.prototype.isFinallyHandler=function(){return 0===this.type},f.prototype._resultCancelled=function(){g(this.finallyHandler)},b.prototype._passThrough=function(a,b,c,d){return"function"!=typeof a?this.then():this._then(c,d,void 0,new e(this,b,a),void 0)},b.prototype.lastly=b.prototype["finally"]=function(a){return this._passThrough(a,0,j,j)},b.prototype.tap=function(a){return this._passThrough(a,1,j)},b.prototype.tapCatch=function(a){var c,d,e,f,g,h=arguments.length;if(1===h)return this._passThrough(a,1,void 0,j);for(c=new Array(h-1),d=0,e=0;e<h-1;++e){if(f=arguments[e],!k.isObject(f))return b.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+k.classString(f)));c[d++]=f}return c.length=d,g=arguments[e],this._passThrough(n(c,g,this),1,void 0,j)},e}},{"./catch_filter":7,"./util":36}],16:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a,c,d){var f,g,h,i;for(f=0;f<c.length;++f){if(d._pushContext(),g=n(c[f])(a),d._popContext(),g===m)return d._pushContext(),h=b.reject(m.e),d._popContext(),h;if(i=e(g,d),i instanceof b)return i}return null}function i(a,c,e,f){var h,i,j;g.cancellation()?(h=new b(d),i=this._finallyPromise=new b(d),this._promise=h.lastly(function(){return i}),h._captureStackTrace(),h._setOnCancel(this)):(j=this._promise=new b(d),j._captureStackTrace()),this._stack=f,this._generatorFunction=a,this._receiver=c,this._generator=void 0,this._yieldHandlers="function"==typeof e?[e].concat(o):o,this._yieldedPromise=null,this._cancellationPhase=!1}var j=a("./errors"),k=j.TypeError,l=a("./util"),m=l.errorObj,n=l.tryCatch,o=[];l.inherits(i,f),i.prototype._isResolved=function(){return null===this._promise},i.prototype._cleanup=function(){this._promise=this._generator=null,g.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},i.prototype._promiseCancelled=function(){var a,c,d;this._isResolved()||(a="undefined"!=typeof this._generator["return"],a?(this._promise._pushContext(),c=n(this._generator["return"]).call(this._generator,void 0),this._promise._popContext()):(d=new b.CancellationError("generator .return() sentinel"),b.coroutine.returnSentinel=d,this._promise._attachExtraTrace(d),this._promise._pushContext(),c=n(this._generator["throw"]).call(this._generator,d),this._promise._popContext()),this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(c))},i.prototype._promiseFulfilled=function(a){this._yieldedPromise=null,this._promise._pushContext();var b=n(this._generator.next).call(this._generator,a);this._promise._popContext(),this._continue(b)},i.prototype._promiseRejected=function(a){this._yieldedPromise=null,this._promise._attachExtraTrace(a),this._promise._pushContext();var b=n(this._generator["throw"]).call(this._generator,a);this._promise._popContext(),this._continue(b)},i.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof b){var a=this._yieldedPromise;this._yieldedPromise=null,a.cancel()}},i.prototype.promise=function(){return this._promise},i.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},i.prototype._continue=function(a){var c,d,f,g=this._promise;return a===m?(this._cleanup(),this._cancellationPhase?g.cancel():g._rejectCallback(a.e,!1)):(c=a.value,a.done===!0?(this._cleanup(),this._cancellationPhase?g.cancel():g._resolveCallback(c)):(d=e(c,this._promise),d instanceof b||(d=h(d,this._yieldHandlers,this._promise),null!==d)?(d=d._target(),f=d._bitField,void(0===(50397184&f)?(this._yieldedPromise=d,d._proxy(this,null)):0!==(33554432&f)?b._async.invoke(this._promiseFulfilled,this,d._value()):0!==(16777216&f)?b._async.invoke(this._promiseRejected,this,d._reason()):this._promiseCancelled())):void this._promiseRejected(new k("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(c))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))));
},b.coroutine=function(a,b){var c,d,e;if("function"!=typeof a)throw new k("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");return c=Object(b).yieldHandler,d=i,e=(new Error).stack,function(){var b=a.apply(this,arguments),f=new d((void 0),(void 0),c,e),g=f.promise();return f._generator=b,f._promiseFulfilled(void 0),g}},b.coroutine.addYieldHandler=function(a){if("function"!=typeof a)throw new k("expecting a function but got "+l.classString(a));o.push(a)},b.spawn=function(a){var d,e;return g.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof a?c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n"):(d=new i(a,this),e=d.promise(),d._run(b.spawn),e)}}},{"./errors":12,"./util":36}],17:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p=a("./util"),q=p.canEvaluate,r=p.tryCatch,s=p.errorObj;if(0){for(i=function(a){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,a))},j=function(a){return new Function("promise","holder","                           \n            'use strict';                                                    \n            holder.pIndex = promise;                                         \n            ".replace(/Index/g,a))},k=function(a){var c,d,e,g,h,i,j=new Array(a);for(c=0;c<j.length;++c)j[c]="this.p"+(c+1);return d=j.join(" = ")+" = null;",e="var promise;\n"+j.map(function(a){return"                                                         \n                promise = "+a+";                                      \n                if (promise instanceof Promise) {                            \n                    promise.cancel();                                        \n                }                                                            \n            "}).join("\n"),g=j.join(", "),h="Holder$"+a,i="return function(tryCatch, errorObj, Promise, async) {    \n            'use strict';                                                    \n            function [TheName](fn) {                                         \n                [TheProperties]                                              \n                this.fn = fn;                                                \n                this.asyncNeeded = true;                                     \n                this.now = 0;                                                \n            }                                                                \n                                                                             \n            [TheName].prototype._callFunction = function(promise) {          \n                promise._pushContext();                                      \n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n                promise._popContext();                                       \n                if (ret === errorObj) {                                      \n                    promise._rejectCallback(ret.e, false);                   \n                } else {                                                     \n                    promise._resolveCallback(ret);                           \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype.checkFulfillment = function(promise) {       \n                var now = ++this.now;                                        \n                if (now === [TheTotal]) {                                    \n                    if (this.asyncNeeded) {                                  \n                        async.invoke(this._callFunction, this, promise);     \n                    } else {                                                 \n                        this._callFunction(promise);                         \n                    }                                                        \n                                                                             \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype._resultCancelled = function() {              \n                [CancellationCode]                                           \n            };                                                               \n                                                                             \n            return [TheName];                                                \n        }(tryCatch, errorObj, Promise, async);                               \n        ",i=i.replace(/\[TheName\]/g,h).replace(/\[TheTotal\]/g,a).replace(/\[ThePassedArguments\]/g,g).replace(/\[TheProperties\]/g,d).replace(/\[CancellationCode\]/g,e),new Function("tryCatch","errorObj","Promise","async",i)(r,s,b,f)},l=[],m=[],n=[],o=0;o<8;++o)l.push(k(o+1)),m.push(i(o+1)),n.push(j(o+1));h=function(a){this._reject(a)}}b.join=function(){var a,f,i,j,k,o,q,r,s,t,u=arguments.length-1;if(u>0&&"function"==typeof arguments[u]&&(a=arguments[u],0)){for(f=new b(e),f._captureStackTrace(),i=l[u-1],j=new i(a),k=m,o=0;o<u;++o)q=d(arguments[o],f),q instanceof b?(q=q._target(),r=q._bitField,0===(50397184&r)?(q._then(k[o],h,void 0,f,j),n[o](q,j),j.asyncNeeded=!1):0!==(33554432&r)?k[o].call(f,q._value(),j):0!==(16777216&r)?f._reject(q._reason()):f._cancel()):k[o].call(f,q,j);return f._isFateSealed()||(j.asyncNeeded&&(s=g(),null!==s&&(j.fn=p.domainBind(s,j.fn))),f._setAsyncGuaranteed(),f._setOnCancel(j)),f}return t=[].slice.call(arguments),a&&t.pop(),f=new c(t).promise(),void 0!==a?f.spread(a):f}}},{"./util":36}],18:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a,b,c,d){this.constructor$(a),this._promise._captureStackTrace();var e=j();this._callback=null===e?b:k.domainBind(e,b),this._preservedValues=d===f?new Array(this.length()):null,this._limit=c,this._inFlight=0,this._queue=[],n.invoke(this._asyncInit,this,void 0)}function i(a,c,e,f){if("function"!=typeof c)return d("expecting a function but got "+k.classString(c));var g=0;if(void 0!==e){if("object"!=typeof e||null===e)return b.reject(new TypeError("options argument must be an object but it is "+k.classString(e)));if("number"!=typeof e.concurrency)return b.reject(new TypeError("'concurrency' must be a number but it is "+k.classString(e.concurrency)));g=e.concurrency}return g="number"==typeof g&&isFinite(g)&&g>=1?g:0,new h(a,c,g,f).promise()}var j=b._getDomain,k=a("./util"),l=k.tryCatch,m=k.errorObj,n=b._async;k.inherits(h,c),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(a,c){var d,f,h,i,j,k,n,o,p=this._values,q=this.length(),r=this._preservedValues,s=this._limit;if(c<0){if(c=c*-1-1,p[c]=a,s>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(s>=1&&this._inFlight>=s)return p[c]=a,this._queue.push(c),!1;if(null!==r&&(r[c]=a),d=this._promise,f=this._callback,h=d._boundValue(),d._pushContext(),i=l(f).call(h,a,c,q),j=d._popContext(),g.checkForgottenReturns(i,j,null!==r?"Promise.filter":"Promise.map",d),i===m)return this._reject(i.e),!0;if(k=e(i,this._promise),k instanceof b){if(k=k._target(),n=k._bitField,0===(50397184&n))return s>=1&&this._inFlight++,p[c]=k,k._proxy(this,(c+1)*-1),!1;if(0===(33554432&n))return 0!==(16777216&n)?(this._reject(k._reason()),!0):(this._cancel(),!0);i=k._value()}p[c]=i}return o=++this._totalResolved,o>=q&&(null!==r?this._filter(p,r):this._resolve(p),!0)},h.prototype._drainQueue=function(){for(var a,b=this._queue,c=this._limit,d=this._values;b.length>0&&this._inFlight<c;){if(this._isResolved())return;a=b.pop(),this._promiseFulfilled(d[a],a)}},h.prototype._filter=function(a,b){var c,d=b.length,e=new Array(d),f=0;for(c=0;c<d;++c)a[c]&&(e[f++]=b[c]);e.length=f,this._resolve(e)},h.prototype.preservedValues=function(){return this._preservedValues},b.prototype.map=function(a,b){return i(this,a,b,null)},b.map=function(a,b,c,d){return i(a,b,c,d)}}},{"./util":36}],19:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f){var g=a("./util"),h=g.tryCatch;b.method=function(a){if("function"!=typeof a)throw new b.TypeError("expecting a function but got "+g.classString(a));return function(){var d,e,g=new b(c);return g._captureStackTrace(),g._pushContext(),d=h(a).apply(this,arguments),e=g._popContext(),f.checkForgottenReturns(d,e,"Promise.method",g),g._resolveFromSyncValue(d),g}},b.attempt=b["try"]=function(a){var d,i,j,k,l;return"function"!=typeof a?e("expecting a function but got "+g.classString(a)):(d=new b(c),d._captureStackTrace(),d._pushContext(),arguments.length>1?(f.deprecated("calling Promise.try with more than 1 argument"),j=arguments[1],k=arguments[2],i=g.isArray(j)?h(a).apply(k,j):h(a).call(k,j)):i=h(a)(),l=d._popContext(),f.checkForgottenReturns(i,l,"Promise.try",d),d._resolveFromSyncValue(i),d)},b.prototype._resolveFromSyncValue=function(a){a===g.errorObj?this._rejectCallback(a.e,!1):this._resolveCallback(a,!0)}}},{"./util":36}],20:[function(a,b,c){"use strict";function d(a){return a instanceof Error&&k.getPrototypeOf(a)===Error.prototype}function e(a){var b,c,e,f;if(d(a)){for(b=new j(a),b.name=a.name,b.message=a.message,b.stack=a.stack,c=k.keys(a),e=0;e<c.length;++e)f=c[e],l.test(f)||(b[f]=a[f]);return b}return g.markAsOriginatingFromRejection(a),a}function f(a,b){return function(c,d){var f,g;null!==a&&(c?(f=e(h(c)),a._attachExtraTrace(f),a._reject(f)):b?(g=[].slice.call(arguments,1),a._fulfill(g)):a._fulfill(d),a=null)}}var g=a("./util"),h=g.maybeWrapAsError,i=a("./errors"),j=i.OperationalError,k=a("./es5"),l=/^(?:name|message|stack|cause)$/;b.exports=f},{"./errors":12,"./es5":13,"./util":36}],21:[function(a,b,c){"use strict";b.exports=function(b){function c(a,b){var c,e=this;return f.isArray(a)?(c=h(b).apply(e._boundValue(),[null].concat(a)),void(c===i&&g.throwLater(c.e))):d.call(e,a,b)}function d(a,b){var c=this,d=c._boundValue(),e=void 0===a?h(b).call(d,null):h(b).call(d,null,a);e===i&&g.throwLater(e.e)}function e(a,b){var c,d,e=this;a||(c=new Error(a+""),c.cause=a,a=c),d=h(b).call(e._boundValue(),a),d===i&&g.throwLater(d.e)}var f=a("./util"),g=b._async,h=f.tryCatch,i=f.errorObj;b.prototype.asCallback=b.prototype.nodeify=function(a,b){if("function"==typeof a){var f=d;void 0!==b&&Object(b).spread&&(f=c),this._then(f,e,void 0,this,a)}return this}}},{"./util":36}],22:[function(a,b,c){"use strict";b.exports=function(){function c(){}function d(a,b){if(null==a||a.constructor!==e)throw new n("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof b)throw new n("expecting a function but got "+H.classString(b))}function e(a){a!==p&&d(this,a),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(a),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function f(a){this.promise._resolveCallback(a)}function g(a){this.promise._rejectCallback(a,!1)}function h(a){var b=new e(p);b._fulfillmentHandler0=a,b._rejectionHandler0=a,b._promise0=a,b._receiver0=a}var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=function(){return new n("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},E=function(){return new e.PromiseInspection(this._target())},F=function(a){return e.reject(new n(a))},G={},H=a("./util");return i=H.isNode?function(){var a=process.domain;return void 0===a&&(a=null),a}:function(){return null},H.notEnumerableProp(e,"_getDomain",i),j=a("./es5"),k=a("./async"),l=new k,j.defineProperty(e,"_async",{value:l}),m=a("./errors"),n=e.TypeError=m.TypeError,e.RangeError=m.RangeError,o=e.CancellationError=m.CancellationError,e.TimeoutError=m.TimeoutError,e.OperationalError=m.OperationalError,e.RejectionError=m.OperationalError,e.AggregateError=m.AggregateError,p=function(){},q={},r={},s=a("./thenables")(e,p),t=a("./promise_array")(e,p,s,F,c),u=a("./context")(e),v=u.create,w=a("./debuggability")(e,u),x=w.CapturedTrace,y=a("./finally")(e,s,r),z=a("./catch_filter")(r),A=a("./nodeback"),B=H.errorObj,C=H.tryCatch,e.prototype.toString=function(){return"[object Promise]"},e.prototype.caught=e.prototype["catch"]=function(a){var b,c,d,e,f=arguments.length;if(f>1){for(b=new Array(f-1),c=0,d=0;d<f-1;++d){if(e=arguments[d],!H.isObject(e))return F("Catch statement predicate: expecting an object but got "+H.classString(e));b[c++]=e}return b.length=c,a=arguments[d],this.then(void 0,z(b,a,this))}return this.then(void 0,a)},e.prototype.reflect=function(){return this._then(E,E,void 0,this,void 0)},e.prototype.then=function(a,b){if(w.warnings()&&arguments.length>0&&"function"!=typeof a&&"function"!=typeof b){var c=".then() only accepts functions but was passed: "+H.classString(a);arguments.length>1&&(c+=", "+H.classString(b)),this._warn(c)}return this._then(a,b,void 0,void 0,void 0)},e.prototype.done=function(a,b){var c=this._then(a,b,void 0,void 0,void 0);c._setIsFinal()},e.prototype.spread=function(a){return"function"!=typeof a?F("expecting a function but got "+H.classString(a)):this.all()._then(a,void 0,void 0,q,void 0)},e.prototype.toJSON=function(){var a={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(a.fulfillmentValue=this.value(),a.isFulfilled=!0):this.isRejected()&&(a.rejectionReason=this.reason(),a.isRejected=!0),a},e.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new t(this).promise()},e.prototype.error=function(a){return this.caught(H.originatesFromRejection,a)},e.getNewLibraryCopy=b.exports,e.is=function(a){return a instanceof e},e.fromNode=e.fromCallback=function(a){var b,c,d=new e(p);return d._captureStackTrace(),b=arguments.length>1&&!!Object(arguments[1]).multiArgs,c=C(a)(A(d,b)),c===B&&d._rejectCallback(c.e,!0),d._isFateSealed()||d._setAsyncGuaranteed(),d},e.all=function(a){return new t(a).promise()},e.cast=function(a){var b=s(a);return b instanceof e||(b=new e(p),b._captureStackTrace(),b._setFulfilled(),b._rejectionHandler0=a),b},e.resolve=e.fulfilled=e.cast,e.reject=e.rejected=function(a){var b=new e(p);return b._captureStackTrace(),b._rejectCallback(a,!0),b},e.setScheduler=function(a){if("function"!=typeof a)throw new n("expecting a function but got "+H.classString(a));return l.setScheduler(a)},e.prototype._then=function(a,b,c,d,f){var g,h,j,k,m=void 0!==f,n=m?f:new e(p),q=this._target(),r=q._bitField;return m||(n._propagateFrom(this,3),n._captureStackTrace(),void 0===d&&0!==(2097152&this._bitField)&&(d=0!==(50397184&r)?this._boundValue():q===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,n)),g=i(),0!==(50397184&r)?(k=q._settlePromiseCtx,0!==(33554432&r)?(j=q._rejectionHandler0,h=a):0!==(16777216&r)?(j=q._fulfillmentHandler0,h=b,q._unsetRejectionIsUnhandled()):(k=q._settlePromiseLateCancellationObserver,j=new o("late cancellation observer"),q._attachExtraTrace(j),h=b),l.invoke(k,q,{handler:null===g?h:"function"==typeof h&&H.domainBind(g,h),promise:n,receiver:d,value:j})):q._addCallbacks(a,b,n,d,g),n},e.prototype._length=function(){return 65535&this._bitField},e.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},e.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},e.prototype._setLength=function(a){this._bitField=this._bitField&-65536|65535&a},e.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},e.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},e.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},e.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},e.prototype._isFinal=function(){return(4194304&this._bitField)>0},e.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},e.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},e.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},e.prototype._setAsyncGuaranteed=function(){l.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},e.prototype._receiverAt=function(a){var b=0===a?this._receiver0:this[4*a-4+3];if(b!==G)return void 0===b&&this._isBound()?this._boundValue():b},e.prototype._promiseAt=function(a){return this[4*a-4+2]},e.prototype._fulfillmentHandlerAt=function(a){return this[4*a-4+0]},e.prototype._rejectionHandlerAt=function(a){return this[4*a-4+1]},e.prototype._boundValue=function(){},e.prototype._migrateCallback0=function(a){var b=a._bitField,c=a._fulfillmentHandler0,d=a._rejectionHandler0,e=a._promise0,f=a._receiverAt(0);void 0===f&&(f=G),this._addCallbacks(c,d,e,f,null)},e.prototype._migrateCallbackAt=function(a,b){var c=a._fulfillmentHandlerAt(b),d=a._rejectionHandlerAt(b),e=a._promiseAt(b),f=a._receiverAt(b);void 0===f&&(f=G),this._addCallbacks(c,d,e,f,null)},e.prototype._addCallbacks=function(a,b,c,d,e){var f,g=this._length();return g>=65531&&(g=0,this._setLength(0)),0===g?(this._promise0=c,this._receiver0=d,"function"==typeof a&&(this._fulfillmentHandler0=null===e?a:H.domainBind(e,a)),"function"==typeof b&&(this._rejectionHandler0=null===e?b:H.domainBind(e,b))):(f=4*g-4,this[f+2]=c,this[f+3]=d,"function"==typeof a&&(this[f+0]=null===e?a:H.domainBind(e,a)),"function"==typeof b&&(this[f+1]=null===e?b:H.domainBind(e,b))),this._setLength(g+1),g},e.prototype._proxy=function(a,b){this._addCallbacks(void 0,void 0,b,a,null)},e.prototype._resolveCallback=function(a,b){var c,d,f,g,h,i;if(0===(117506048&this._bitField)){if(a===this)return this._rejectCallback(D(),!1);if(c=s(a,this),!(c instanceof e))return this._fulfill(a);if(b&&this._propagateFrom(c,2),d=c._target(),d===this)return void this._reject(D());if(f=d._bitField,0===(50397184&f)){for(g=this._length(),g>0&&d._migrateCallback0(this),h=1;h<g;++h)d._migrateCallbackAt(this,h);this._setFollowing(),this._setLength(0),this._setFollowee(d)}else 0!==(33554432&f)?this._fulfill(d._value()):0!==(16777216&f)?this._reject(d._reason()):(i=new o("late cancellation observer"),d._attachExtraTrace(i),this._reject(i))}},e.prototype._rejectCallback=function(a,b,c){var d,e=H.ensureErrorObject(a),f=e===a;f||c||!w.warnings()||(d="a promise was rejected with a non-error: "+H.classString(a),this._warn(d,!0)),this._attachExtraTrace(e,!!b&&f),this._reject(a)},e.prototype._resolveFromExecutor=function(a){var b,c,d;a!==p&&(b=this,this._captureStackTrace(),this._pushContext(),c=!0,d=this._execute(a,function(a){b._resolveCallback(a)},function(a){b._rejectCallback(a,c)}),c=!1,this._popContext(),void 0!==d&&b._rejectCallback(d,!0))},e.prototype._settlePromiseFromHandler=function(a,b,c,d){var e,f,g=d._bitField;0===(65536&g)&&(d._pushContext(),b===q?c&&"number"==typeof c.length?e=C(a).apply(this._boundValue(),c):(e=B,e.e=new n("cannot .spread() a non-array: "+H.classString(c))):e=C(a).call(b,c),f=d._popContext(),g=d._bitField,0===(65536&g)&&(e===r?d._reject(c):e===B?d._rejectCallback(e.e,!1):(w.checkForgottenReturns(e,f,"",d,this),d._resolveCallback(e))))},e.prototype._target=function(){for(var a=this;a._isFollowing();)a=a._followee();return a},e.prototype._followee=function(){return this._rejectionHandler0},e.prototype._setFollowee=function(a){this._rejectionHandler0=a},e.prototype._settlePromise=function(a,b,d,f){var g=a instanceof e,h=this._bitField,i=0!==(134217728&h);0!==(65536&h)?(g&&a._invokeInternalOnCancel(),d instanceof y&&d.isFinallyHandler()?(d.cancelPromise=a,C(b).call(d,f)===B&&a._reject(B.e)):b===E?a._fulfill(E.call(d)):d instanceof c?d._promiseCancelled(a):g||a instanceof t?a._cancel():d.cancel()):"function"==typeof b?g?(i&&a._setAsyncGuaranteed(),this._settlePromiseFromHandler(b,d,f,a)):b.call(d,f,a):d instanceof c?d._isResolved()||(0!==(33554432&h)?d._promiseFulfilled(f,a):d._promiseRejected(f,a)):g&&(i&&a._setAsyncGuaranteed(),0!==(33554432&h)?a._fulfill(f):a._reject(f))},e.prototype._settlePromiseLateCancellationObserver=function(a){var b=a.handler,c=a.promise,d=a.receiver,f=a.value;"function"==typeof b?c instanceof e?this._settlePromiseFromHandler(b,d,f,c):b.call(d,f,c):c instanceof e&&c._reject(f)},e.prototype._settlePromiseCtx=function(a){this._settlePromise(a.promise,a.handler,a.receiver,a.value)},e.prototype._settlePromise0=function(a,b,c){var d=this._promise0,e=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(d,a,e,b)},e.prototype._clearCallbackDataAtIndex=function(a){var b=4*a-4;this[b+2]=this[b+3]=this[b+0]=this[b+1]=void 0},e.prototype._fulfill=function(a){var b,c=this._bitField;if(!((117506048&c)>>>16)){if(a===this)return b=D(),this._attachExtraTrace(b),this._reject(b);this._setFulfilled(),this._rejectionHandler0=a,(65535&c)>0&&(0!==(134217728&c)?this._settlePromises():l.settlePromises(this))}},e.prototype._reject=function(a){var b=this._bitField;if(!((117506048&b)>>>16))return this._setRejected(),this._fulfillmentHandler0=a,this._isFinal()?l.fatalError(a,H.isNode):void((65535&b)>0?l.settlePromises(this):this._ensurePossibleRejectionHandled())},e.prototype._fulfillPromises=function(a,b){var c,d,e,f;for(c=1;c<a;c++)d=this._fulfillmentHandlerAt(c),e=this._promiseAt(c),f=this._receiverAt(c),this._clearCallbackDataAtIndex(c),this._settlePromise(e,d,f,b)},e.prototype._rejectPromises=function(a,b){var c,d,e,f;for(c=1;c<a;c++)d=this._rejectionHandlerAt(c),e=this._promiseAt(c),f=this._receiverAt(c),this._clearCallbackDataAtIndex(c),this._settlePromise(e,d,f,b)},e.prototype._settlePromises=function(){var a,b,c=this._bitField,d=65535&c;d>0&&(0!==(16842752&c)?(a=this._fulfillmentHandler0,this._settlePromise0(this._rejectionHandler0,a,c),this._rejectPromises(d,a)):(b=this._rejectionHandler0,this._settlePromise0(this._fulfillmentHandler0,b,c),this._fulfillPromises(d,b)),this._setLength(0)),this._clearCancellationData()},e.prototype._settledValue=function(){var a=this._bitField;return 0!==(33554432&a)?this._rejectionHandler0:0!==(16777216&a)?this._fulfillmentHandler0:void 0},e.defer=e.pending=function(){w.deprecated("Promise.defer","new Promise");var a=new e(p);return{promise:a,resolve:f,reject:g}},H.notEnumerableProp(e,"_makeSelfResolutionError",D),a("./method")(e,p,s,F,w),a("./bind")(e,p,s,w),a("./cancel")(e,t,F,w),a("./direct_resolve")(e),a("./synchronous_inspection")(e),a("./join")(e,t,s,p,l,i),e.Promise=e,e.version="3.5.1",a("./map.js")(e,t,F,s,p,w),a("./call_get.js")(e),a("./using.js")(e,F,s,v,p,w),a("./timers.js")(e,p,w),a("./generators.js")(e,F,p,s,c,w),a("./nodeify.js")(e),a("./promisify.js")(e,p),a("./props.js")(e,t,s,F),a("./race.js")(e,p,s,F),a("./reduce.js")(e,t,F,s,p,w),a("./settle.js")(e,t,w),a("./some.js")(e,t,F),a("./filter.js")(e,p),a("./each.js")(e,p),a("./any.js")(e),H.toFastProperties(e),H.toFastProperties(e.prototype),h({a:1}),h({b:2}),h({c:3}),h(1),h(function(){}),h(void 0),h(!1),h(new e(p)),w.setBounds(k.firstLineError,H.lastLineError),e}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f){function g(a){switch(a){case-2:return[];case-3:return{};case-6:return new Map}}function h(a){var d=this._promise=new b(c);a instanceof b&&d._propagateFrom(a,3),d._setOnCancel(this),this._values=a,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var i=a("./util"),j=i.isArray;return i.inherits(h,f),h.prototype.length=function(){return this._length},h.prototype.promise=function(){return this._promise},h.prototype._init=function k(a,c){var f,h,j=d(this._values,this._promise);if(j instanceof b){if(j=j._target(),f=j._bitField,this._values=j,0===(50397184&f))return this._promise._setAsyncGuaranteed(),j._then(k,this._reject,void 0,this,c);if(0===(33554432&f))return 0!==(16777216&f)?this._reject(j._reason()):this._cancel();j=j._value()}return j=i.asArray(j),null===j?(h=e("expecting an array or an iterable object but got "+i.classString(j)).reason(),void this._promise._rejectCallback(h,!1)):0===j.length?void(c===-5?this._resolveEmptyArray():this._resolve(g(c))):void this._iterate(j)},h.prototype._iterate=function(a){var c,e,f,g,h,i=this.getActualLength(a.length);for(this._length=i,this._values=this.shouldCopyValues()?new Array(i):this._values,c=this._promise,e=!1,f=null,g=0;g<i;++g)h=d(a[g],c),h instanceof b?(h=h._target(),f=h._bitField):f=null,e?null!==f&&h.suppressUnhandledRejections():null!==f?0===(50397184&f)?(h._proxy(this,g),this._values[g]=h):e=0!==(33554432&f)?this._promiseFulfilled(h._value(),g):0!==(16777216&f)?this._promiseRejected(h._reason(),g):this._promiseCancelled(g):e=this._promiseFulfilled(h,g);e||c._setAsyncGuaranteed()},h.prototype._isResolved=function(){return null===this._values},h.prototype._resolve=function(a){this._values=null,this._promise._fulfill(a)},h.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},h.prototype._reject=function(a){this._values=null,this._promise._rejectCallback(a,!1)},h.prototype._promiseFulfilled=function(a,b){this._values[b]=a;var c=++this._totalResolved;return c>=this._length&&(this._resolve(this._values),!0)},h.prototype._promiseCancelled=function(){return this._cancel(),!0},h.prototype._promiseRejected=function(a){return this._totalResolved++,this._reject(a),!0},h.prototype._resultCancelled=function(){var a,c;if(!this._isResolved())if(a=this._values,this._cancel(),a instanceof b)a.cancel();else for(c=0;c<a.length;++c)a[c]instanceof b&&a[c].cancel()},h.prototype.shouldCopyValues=function(){return!0},h.prototype.getActualLength=function(a){return a},h}},{"./util":36}],24:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a){return!B.test(a)}function e(a){try{return a.__isPromisified__===!0}catch(b){return!1}}function f(a,b,c){var d=s.getDataPropertyOrDefault(a,b+c,z);return!!d&&e(d)}function g(a,b,c){var d,e,f,g;for(d=0;d<a.length;d+=2)if(e=a[d],c.test(e))for(f=e.replace(c,""),g=0;g<a.length;g+=2)if(a[g]===f)throw new x("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",b))}function h(a,b,c,d){var h,i,j,k,l=s.inheritedDataKeys(a),m=[];for(h=0;h<l.length;++h)i=l[h],j=a[i],k=d===C||C(i,j,a),"function"!=typeof j||e(j)||f(a,i,b)||!d(i,j,a,k)||m.push(i,j);return g(m,b,c),m}function i(a,d,e,f,g,h){function i(){var e,f,g,i=d;d===r&&(i=this),e=new b(c),e._captureStackTrace(),f="string"==typeof k&&this!==j?this[k]:a,g=t(e,h);try{f.apply(i,u(arguments,g))}catch(l){e._rejectCallback(v(l),!0,!0)}return e._isFateSealed()||e._setAsyncGuaranteed(),e}var j=function(){return this}(),k=a;return"string"==typeof k&&(a=f),s.notEnumerableProp(i,"__isPromisified__",!0),i}function j(a,b,c,d,e){var f,g,i,j,k,l,m=new RegExp(D(b)+"$"),n=h(a,b,m,c);for(f=0,g=n.length;f<g;f+=2)i=n[f],j=n[f+1],k=i+b,d===q?a[k]=q(i,r,i,j,b,e):(l=d(j,function(){return q(i,r,i,j,b,e)}),s.notEnumerableProp(l,"__isPromisified__",!0),a[k]=l);return s.toFastProperties(a),a}function k(a,b,c){return q(a,b,void 0,a,null,c)}var l,m,n,o,p,q,r={},s=a("./util"),t=a("./nodeback"),u=s.withAppended,v=s.maybeWrapAsError,w=s.canEvaluate,x=a("./errors").TypeError,y="Async",z={__isPromisified__:!0},A=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],B=new RegExp("^(?:"+A.join("|")+")$"),C=function(a){return s.isIdentifier(a)&&"_"!==a.charAt(0)&&"constructor"!==a},D=function(a){return a.replace(/([$])/,"\\$")};q=w?l:i,b.promisify=function(a,b){var c,f,g;if("function"!=typeof a)throw new x("expecting a function but got "+s.classString(a));return e(a)?a:(b=Object(b),c=void 0===b.context?r:b.context,f=!!b.multiArgs,g=k(a,c,f),s.copyDescriptors(a,g,d),g)},b.promisifyAll=function(a,b){var c,d,e,f,g,h,i;if("function"!=typeof a&&"object"!=typeof a)throw new x("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");if(b=Object(b),c=!!b.multiArgs,d=b.suffix,"string"!=typeof d&&(d=y),e=b.filter,"function"!=typeof e&&(e=C),f=b.promisifier,"function"!=typeof f&&(f=q),!s.isIdentifier(d))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(g=s.inheritedDataKeys(a),h=0;h<g.length;++h)i=a[g[h]],"constructor"!==g[h]&&s.isClass(i)&&(j(i.prototype,d,e,f,c),j(i,d,e,f,c));return j(a,d,e,f,c)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){function f(a){var b,c,d,e,f,g=!1;if(void 0!==h&&a instanceof h)b=i(a),g=!0;else for(c=m.keys(a),d=c.length,b=new Array(2*d),e=0;e<d;++e)f=c[e],b[e]=a[f],b[e+d]=f;this.constructor$(b),this._isMap=g,this._init$(void 0,g?-6:-3)}function g(a){var c,g=d(a);return l(g)?(c=g instanceof b?g._then(b.props,void 0,void 0,void 0,void 0):new f(g).promise(),g instanceof b&&c._propagateFrom(g,2),c):e("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var h,i,j,k=a("./util"),l=k.isObject,m=a("./es5");"function"==typeof Map&&(h=Map),i=function(){function a(a,d){this[b]=a,this[b+c]=d,b++}var b=0,c=0;return function d(e){c=e.size,b=0;var f=new Array(2*e.size);return e.forEach(a,f),f}}(),j=function(a){var b,c,d,e=new h,f=a.length/2|0;for(b=0;b<f;++b)c=a[f+b],d=a[b],e.set(c,d);return e},k.inherits(f,c),f.prototype._init=function(){},f.prototype._promiseFulfilled=function(a,b){var c,d,e,f,g;if(this._values[b]=a,c=++this._totalResolved,c>=this._length){if(this._isMap)d=j(this._values);else for(d={},e=this.length(),f=0,g=this.length();f<g;++f)d[this._values[f+e]]=this._values[f];return this._resolve(d),!0}return!1},f.prototype.shouldCopyValues=function(){return!1},f.prototype.getActualLength=function(a){return a>>1},b.prototype.props=function(){return g(this)},b.props=function(a){return g(a)}}},{"./es5":13,"./util":36}],26:[function(a,b,c){"use strict";function d(a,b,c,d,e){for(var f=0;f<e;++f)c[f+d]=a[f+b],a[f+b]=void 0}function e(a){this._capacity=a,this._length=0,this._front=0}e.prototype._willBeOverCapacity=function(a){return this._capacity<a},e.prototype._pushOne=function(a){var b,c=this.length();this._checkCapacity(c+1),b=this._front+c&this._capacity-1,this[b]=a,this._length=c+1},e.prototype.push=function(a,b,c){var d,e,f=this.length()+3;return this._willBeOverCapacity(f)?(this._pushOne(a),this._pushOne(b),void this._pushOne(c)):(d=this._front+f-3,this._checkCapacity(f),e=this._capacity-1,this[d+0&e]=a,this[d+1&e]=b,this[d+2&e]=c,void(this._length=f))},e.prototype.shift=function(){var a=this._front,b=this[a];return this[a]=void 0,this._front=a+1&this._capacity-1,this._length--,b},e.prototype.length=function(){return this._length},e.prototype._checkCapacity=function(a){this._capacity<a&&this._resizeTo(this._capacity<<1)},e.prototype._resizeTo=function(a){var b,c,e,f=this._capacity;this._capacity=a,b=this._front,c=this._length,e=b+c&f-1,d(this,0,this,f,e)},b.exports=e},{}],27:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){function f(a,f){var i,j,k,l,m,n,o=d(a);if(o instanceof b)return h(o);
if(a=g.asArray(a),null===a)return e("expecting an array or an iterable object but got "+g.classString(a));for(i=new b(c),void 0!==f&&i._propagateFrom(f,3),j=i._fulfill,k=i._reject,l=0,m=a.length;l<m;++l)n=a[l],(void 0!==n||l in a)&&b.cast(n)._then(j,k,void 0,i,null);return i}var g=a("./util"),h=function(a){return a.then(function(b){return f(b,a)})};b.race=function(a){return f(a,void 0)},b.prototype.race=function(){return f(this,void 0)}}},{"./util":36}],28:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a,c,d,e){this.constructor$(a);var g=m();this._fn=null===g?c:n.domainBind(g,c),void 0!==d&&(d=b.resolve(d),d._attachCancellationCallback(this)),this._initialValue=d,this._currentCancellable=null,e===f?this._eachValues=Array(this._length):0===e?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function i(a,b){this.isFulfilled()?b._resolve(a):b._reject(a)}function j(a,b,c,e){if("function"!=typeof b)return d("expecting a function but got "+n.classString(b));var f=new h(a,b,c,e);return f.promise()}function k(a){this.accum=a,this.array._gotAccum(a);var c=e(this.value,this.array._promise);return c instanceof b?(this.array._currentCancellable=c,c._then(l,void 0,void 0,this,void 0)):l.call(this,c)}function l(a){var c,d,e=this.array,f=e._promise,h=o(e._fn);return f._pushContext(),c=void 0!==e._eachValues?h.call(f._boundValue(),a,this.index,this.length):h.call(f._boundValue(),this.accum,a,this.index,this.length),c instanceof b&&(e._currentCancellable=c),d=f._popContext(),g.checkForgottenReturns(c,d,void 0!==e._eachValues?"Promise.each":"Promise.reduce",f),c}var m=b._getDomain,n=a("./util"),o=n.tryCatch;n.inherits(h,c),h.prototype._gotAccum=function(a){void 0!==this._eachValues&&null!==this._eachValues&&a!==f&&this._eachValues.push(a)},h.prototype._eachComplete=function(a){return null!==this._eachValues&&this._eachValues.push(a),this._eachValues},h.prototype._init=function(){},h.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},h.prototype.shouldCopyValues=function(){return!1},h.prototype._resolve=function(a){this._promise._resolveCallback(a),this._values=null},h.prototype._resultCancelled=function(a){return a===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof b&&this._currentCancellable.cancel(),this._initialValue instanceof b&&this._initialValue.cancel()))},h.prototype._iterate=function(a){var c,d,e,f;if(this._values=a,e=a.length,void 0!==this._initialValue?(c=this._initialValue,d=0):(c=b.resolve(a[0]),d=1),this._currentCancellable=c,!c.isRejected())for(;d<e;++d)f={accum:null,value:a[d],index:d,length:e,array:this},c=c._then(k,void 0,void 0,f,void 0);void 0!==this._eachValues&&(c=c._then(this._eachComplete,void 0,void 0,this,void 0)),c._then(i,i,void 0,c,this)},b.prototype.reduce=function(a,b){return j(this,a,b,null)},b.reduce=function(a,b,c,d){return j(a,b,c,d)}}},{"./util":36}],29:[function(a,b,c){"use strict";var d,e,f,g,h=a("./util"),i=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},j=h.getNativePromise();h.isNode&&"undefined"==typeof MutationObserver?(e=global.setImmediate,f=process.nextTick,d=h.isRecentNode?function(a){e.call(global,a)}:function(a){f.call(process,a)}):"function"==typeof j&&"function"==typeof j.resolve?(g=j.resolve(),d=function(a){g.then(a)}):d="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(a){setImmediate(a)}:"undefined"!=typeof setTimeout?function(a){setTimeout(a,0)}:i:function(){var a,b=document.createElement("div"),c={attributes:!0},d=!1,e=document.createElement("div"),f=new MutationObserver(function(){b.classList.toggle("foo"),d=!1});return f.observe(e,c),a=function(){d||(d=!0,e.classList.toggle("foo"))},function g(d){var e=new MutationObserver(function(){e.disconnect(),d()});e.observe(b,c),a()}}(),b.exports=d},{"./util":36}],30:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a){this.constructor$(a)}var f=b.PromiseInspection,g=a("./util");g.inherits(e,c),e.prototype._promiseResolved=function(a,b){this._values[a]=b;var c=++this._totalResolved;return c>=this._length&&(this._resolve(this._values),!0)},e.prototype._promiseFulfilled=function(a,b){var c=new f;return c._bitField=33554432,c._settledValueField=a,this._promiseResolved(b,c)},e.prototype._promiseRejected=function(a,b){var c=new f;return c._bitField=16777216,c._settledValueField=a,this._promiseResolved(b,c)},b.settle=function(a){return d.deprecated(".settle()",".reflect()"),new e(a).promise()},b.prototype.settle=function(){return b.settle(this)}}},{"./util":36}],31:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a){this.constructor$(a),this._howMany=0,this._unwrap=!1,this._initialized=!1}function f(a,b){var c,f;return(0|b)!==b||b<0?d("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n"):(c=new e(a),f=c.promise(),c.setHowMany(b),c.init(),f)}var g=a("./util"),h=a("./errors").RangeError,i=a("./errors").AggregateError,j=g.isArray,k={};g.inherits(e,c),e.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var a=j(this._values);!this._isResolved()&&a&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},e.prototype.init=function(){this._initialized=!0,this._init()},e.prototype.setUnwrap=function(){this._unwrap=!0},e.prototype.howMany=function(){return this._howMany},e.prototype.setHowMany=function(a){this._howMany=a},e.prototype._promiseFulfilled=function(a){return this._addFulfilled(a),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},e.prototype._promiseRejected=function(a){return this._addRejected(a),this._checkOutcome()},e.prototype._promiseCancelled=function(){return this._values instanceof b||null==this._values?this._cancel():(this._addRejected(k),this._checkOutcome())},e.prototype._checkOutcome=function(){var a,b;if(this.howMany()>this._canPossiblyFulfill()){for(a=new i,b=this.length();b<this._values.length;++b)this._values[b]!==k&&a.push(this._values[b]);return a.length>0?this._reject(a):this._cancel(),!0}return!1},e.prototype._fulfilled=function(){return this._totalResolved},e.prototype._rejected=function(){return this._values.length-this.length()},e.prototype._addRejected=function(a){this._values.push(a)},e.prototype._addFulfilled=function(a){this._values[this._totalResolved++]=a},e.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},e.prototype._getRangeError=function(a){var b="Input array must contain at least "+this._howMany+" items but contains only "+a+" items";return new h(b)},e.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},b.some=function(a,b){return f(a,b)},b.prototype.some=function(a){return f(this,a)},b._SomePromiseArray=e}},{"./errors":12,"./util":36}],32:[function(a,b,c){"use strict";b.exports=function(a){function b(a){void 0!==a?(a=a._target(),this._bitField=a._bitField,this._settledValueField=a._isFateSealed()?a._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}var c,d,e,f,g,h;b.prototype._settledValue=function(){return this._settledValueField},c=b.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},d=b.prototype.error=b.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},e=b.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},f=b.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},g=b.prototype.isPending=function(){return 0===(50397184&this._bitField)},h=b.prototype.isResolved=function(){return 0!==(50331648&this._bitField)},b.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},a.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},a.prototype._isCancelled=function(){return this._target().__isCancelled()},a.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},a.prototype.isPending=function(){return g.call(this._target())},a.prototype.isRejected=function(){return f.call(this._target())},a.prototype.isFulfilled=function(){return e.call(this._target())},a.prototype.isResolved=function(){return h.call(this._target())},a.prototype.value=function(){return c.call(this._target())},a.prototype.reason=function(){var a=this._target();return a._unsetRejectionIsUnhandled(),d.call(a)},a.prototype._value=function(){return this._settledValue()},a.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},a.PromiseInspection=b}},{}],33:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a,d){var e,i;if(k(a)){if(a instanceof b)return a;if(e=f(a),e===j)return d&&d._pushContext(),i=b.reject(e.e),d&&d._popContext(),i;if("function"==typeof e)return g(a)?(i=new b(c),a._then(i._fulfill,i._reject,void 0,i,null),i):h(a,e,d)}return a}function e(a){return a.then}function f(a){try{return e(a)}catch(b){return j.e=b,j}}function g(a){try{return l.call(a,"_promise0")}catch(b){return!1}}function h(a,d,e){function f(a){l&&(l._resolveCallback(a),l=null)}function g(a){l&&(l._rejectCallback(a,h,!0),l=null)}var h,k,l=new b(c),m=l;return e&&e._pushContext(),l._captureStackTrace(),e&&e._popContext(),h=!0,k=i.tryCatch(d).call(a,f,g),h=!1,l&&k===j&&(l._rejectCallback(k.e,!0,!0),l=null),m}var i=a("./util"),j=i.errorObj,k=i.isObject,l={}.hasOwnProperty;return d}},{"./util":36}],34:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a){this.handle=a}function f(a){return clearTimeout(this.handle),a}function g(a){throw clearTimeout(this.handle),a}var h,i,j,k=a("./util"),l=b.TimeoutError;e.prototype._resultCancelled=function(){clearTimeout(this.handle)},h=function(a){return i(+this).thenReturn(a)},i=b.delay=function(a,f){var g,i;return void 0!==f?(g=b.resolve(f)._then(h,null,null,a,void 0),d.cancellation()&&f instanceof b&&g._setOnCancel(f)):(g=new b(c),i=setTimeout(function(){g._fulfill()},+a),d.cancellation()&&g._setOnCancel(new e(i)),g._captureStackTrace()),g._setAsyncGuaranteed(),g},b.prototype.delay=function(a){return i(a,this)},j=function(a,b,c){var d;d="string"!=typeof b?b instanceof Error?b:new l("operation timed out"):new l(b),k.markAsOriginatingFromRejection(d),a._attachExtraTrace(d),a._reject(d),null!=c&&c.cancel()},b.prototype.timeout=function(a,b){var c,h,i;return a=+a,i=new e(setTimeout(function k(){c.isPending()&&j(c,b,h)},a)),d.cancellation()?(h=this.then(),c=h._then(f,g,void 0,i,void 0),c._setOnCancel(i)):c=this._then(f,g,void 0,i,void 0),c}}},{"./util":36}],35:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a){setTimeout(function(){throw a},0)}function i(a){var b=d(a);return b!==a&&"function"==typeof a._isDisposable&&"function"==typeof a._getDisposer&&a._isDisposable()&&b._setDisposable(a._getDisposer()),b}function j(a,c){function e(){if(g>=j)return k._fulfill();var f=i(a[g++]);if(f instanceof b&&f._isDisposable()){try{f=d(f._getDisposer().tryDispose(c),a.promise)}catch(l){return h(l)}if(f instanceof b)return f._then(e,h,null,null,null)}e()}var g=0,j=a.length,k=new b(f);return e(),k}function k(a,b,c){this._data=a,this._promise=b,this._context=c}function l(a,b,c){this.constructor$(a,b,c)}function m(a){return k.isDisposer(a)?(this.resources[this.index]._setDisposable(a),a.promise()):a}function n(a){this.length=a,this.promise=null,this[a-1]=null}var o=a("./util"),p=a("./errors").TypeError,q=a("./util").inherits,r=o.errorObj,s=o.tryCatch,t={};k.prototype.data=function(){return this._data},k.prototype.promise=function(){return this._promise},k.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():t},k.prototype.tryDispose=function(a){var b,c=this.resource(),d=this._context;return void 0!==d&&d._pushContext(),b=c!==t?this.doDispose(c,a):null,void 0!==d&&d._popContext(),this._promise._unsetDisposable(),this._data=null,b},k.isDisposer=function(a){return null!=a&&"function"==typeof a.resource&&"function"==typeof a.tryDispose},q(l,k),l.prototype.doDispose=function(a,b){var c=this.data();return c.call(a,a,b)},n.prototype._resultCancelled=function(){var a,c,d=this.length;for(a=0;a<d;++a)c=this[a],c instanceof b&&c.cancel()},b.using=function(){var a,e,f,h,i,l,p,q,t,u,v,w=arguments.length;if(w<2)return c("you must pass at least 2 arguments to Promise.using");if(a=arguments[w-1],"function"!=typeof a)return c("expecting a function but got "+o.classString(a));for(f=!0,2===w&&Array.isArray(arguments[0])?(e=arguments[0],w=e.length,f=!1):(e=arguments,w--),h=new n(w),i=0;i<w;++i)l=e[i],k.isDisposer(l)?(p=l,l=l.promise(),l._setDisposable(p)):(q=d(l),q instanceof b&&(l=q._then(m,null,null,{resources:h,index:i},void 0))),h[i]=l;for(t=new Array(h.length),i=0;i<t.length;++i)t[i]=b.resolve(h[i]).reflect();return u=b.all(t).then(function(b){var c,d,e,h;for(c=0;c<b.length;++c){if(d=b[c],d.isRejected())return r.e=d.error(),r;if(!d.isFulfilled())return void u.cancel();b[c]=d.value()}return v._pushContext(),a=s(a),e=f?a.apply(void 0,b):a(b),h=v._popContext(),g.checkForgottenReturns(e,h,"Promise.using",v),e}),v=u.lastly(function(){var a=new b.PromiseInspection(u);return j(h,a)}),h.promise=v,v._setOnCancel(h),v},b.prototype._setDisposable=function(a){this._bitField=131072|this._bitField,this._disposer=a},b.prototype._isDisposable=function(){return(131072&this._bitField)>0},b.prototype._getDisposer=function(){return this._disposer},b.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},b.prototype.disposer=function(a){if("function"==typeof a)return new l(a,this,e());throw new p}}},{"./errors":12,"./util":36}],36:[function(_dereq_,module,exports){"use strict";function tryCatcher(){try{var a=tryCatchTarget;return tryCatchTarget=null,a.apply(this,arguments)}catch(b){return errorObj.e=b,errorObj}}function tryCatch(a){return tryCatchTarget=a,tryCatcher}function isPrimitive(a){return null==a||a===!0||a===!1||"string"==typeof a||"number"==typeof a}function isObject(a){return"function"==typeof a||"object"==typeof a&&null!==a}function maybeWrapAsError(a){return isPrimitive(a)?new Error(safeToString(a)):a}function withAppended(a,b){var c,d=a.length,e=new Array(d+1);for(c=0;c<d;++c)e[c]=a[c];return e[c]=b,e}function getDataPropertyOrDefault(a,b,c){if(!es5.isES5)return{}.hasOwnProperty.call(a,b)?a[b]:void 0;var d=Object.getOwnPropertyDescriptor(a,b);return null!=d?null==d.get&&null==d.set?d.value:c:void 0}function notEnumerableProp(a,b,c){if(isPrimitive(a))return a;var d={value:c,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(a,b,d),a}function thrower(a){throw a}function isClass(a){var b,c,d,e;try{return!!("function"==typeof a&&(b=es5.names(a.prototype),c=es5.isES5&&b.length>1,d=b.length>0&&!(1===b.length&&"constructor"===b[0]),e=thisAssignmentPattern.test(a+"")&&es5.names(a).length>0,c||d||e))}catch(f){return!1}}function toFastProperties(obj){function FakeConstructor(){}FakeConstructor.prototype=obj;for(var l=8;l--;)new FakeConstructor;return obj;eval(obj)}function isIdentifier(a){return rident.test(a)}function filledRange(a,b,c){var d,e=new Array(a);for(d=0;d<a;++d)e[d]=b+d+c;return e}function safeToString(a){try{return a+""}catch(b){return"[no string representation]"}}function isError(a){return a instanceof Error||null!==a&&"object"==typeof a&&"string"==typeof a.message&&"string"==typeof a.name}function markAsOriginatingFromRejection(a){try{notEnumerableProp(a,"isOperational",!0)}catch(b){}}function originatesFromRejection(a){return null!=a&&(a instanceof Error.__BluebirdErrorTypes__.OperationalError||a.isOperational===!0)}function canAttachTrace(a){return isError(a)&&es5.propertyIsWritable(a,"stack")}function classString(a){return{}.toString.call(a)}function copyDescriptors(a,b,c){var d,e,f=es5.names(a);for(d=0;d<f.length;++d)if(e=f[d],c(e))try{es5.defineProperty(b,e,es5.getDescriptor(a,e))}catch(g){}}function env(a){return hasEnvVariables?process.env[a]:void 0}function getNativePromise(){if("function"==typeof Promise)try{var a=new Promise(function(){});if("[object Promise]"==={}.toString.call(a))return Promise}catch(b){}}function domainBind(a,b){return a.bind(b)}var tryCatchTarget,ArrayFrom,isNode,hasEnvVariables,ret,es5=_dereq_("./es5"),canEvaluate="undefined"==typeof navigator,errorObj={e:{}},globalObject="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,inherits=function(a,b){function c(){this.constructor=a,this.constructor$=b;for(var c in b.prototype)d.call(b.prototype,c)&&"$"!==c.charAt(c.length-1)&&(this[c+"$"]=b.prototype[c])}var d={}.hasOwnProperty;return c.prototype=b.prototype,a.prototype=new c,a.prototype},inheritedDataKeys=function(){var a,b,c=[Array.prototype,Object.prototype,Function.prototype],d=function(a){for(var b=0;b<c.length;++b)if(c[b]===a)return!0;return!1};return es5.isES5?(a=Object.getOwnPropertyNames,function(b){for(var c,e,f,g,h=[],i=Object.create(null);null!=b&&!d(b);){try{c=a(b)}catch(j){return h}for(e=0;e<c.length;++e)f=c[e],i[f]||(i[f]=!0,g=Object.getOwnPropertyDescriptor(b,f),null!=g&&null==g.get&&null==g.set&&h.push(f));b=es5.getPrototypeOf(b)}return h}):(b={}.hasOwnProperty,function(a){var e,f,g;if(d(a))return[];e=[];a:for(f in a)if(b.call(a,f))e.push(f);else{for(g=0;g<c.length;++g)if(b.call(c[g],f))continue a;e.push(f)}return e})}(),thisAssignmentPattern=/this\s*\.\s*\S+\s*=/,rident=/^[a-z$_][a-z$_0-9]*$/i,ensureErrorObject=function(){return"stack"in new Error?function(a){return canAttachTrace(a)?a:new Error(safeToString(a))}:function(a){if(canAttachTrace(a))return a;try{throw new Error(safeToString(a))}catch(b){return b}}}(),asArray=function(a){return es5.isArray(a)?a:null};"undefined"!=typeof Symbol&&Symbol.iterator&&(ArrayFrom="function"==typeof Array.from?function(a){return Array.from(a)}:function(a){for(var b,c=[],d=a[Symbol.iterator]();!(b=d.next()).done;)c.push(b.value);return c},asArray=function(a){return es5.isArray(a)?a:null!=a&&"function"==typeof a[Symbol.iterator]?ArrayFrom(a):null}),isNode="undefined"!=typeof process&&"[object process]"===classString(process).toLowerCase(),hasEnvVariables="undefined"!=typeof process&&"undefined"!=typeof process.env,ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,asArray:asArray,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,isError:isError,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,toFastProperties:toFastProperties,filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:isNode,hasEnvVariables:hasEnvVariables,env:env,global:globalObject,getNativePromise:getNativePromise,domainBind:domainBind},ret.isRecentNode=ret.isNode&&function(){var a=process.versions.node.split(".").map(Number);return 0===a[0]&&a[1]>10||a[0]>0}(),ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(e){ret.lastLineError=e}module.exports=ret},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:6}],2:[function(a,b,c){"use strict";function d(a){var b=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return a.replace(/#{\s*key\s*}/g,b)}function e(a,b){var c,e,h,i,j,k,l,m=!1;b||(b={}),c=b.debug||!1;try{if(h=f(),i=document.createRange(),j=document.getSelection(),k=document.createElement("span"),k.textContent=a,k.style.all="unset",k.style.position="fixed",k.style.top=0,k.style.clip="rect(0, 0, 0, 0)",k.style.whiteSpace="pre",k.style.webkitUserSelect="text",k.style.MozUserSelect="text",k.style.msUserSelect="text",k.style.userSelect="text",document.body.appendChild(k),i.selectNode(k),j.addRange(i),l=document.execCommand("copy"),!l)throw new Error("copy command was unsuccessful");m=!0}catch(n){c&&console.error("unable to copy using execCommand: ",n),c&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",a),m=!0}catch(n){c&&console.error("unable to copy using clipboardData: ",n),c&&console.error("falling back to prompt"),e=d("message"in b?b.message:g),window.prompt(e,a)}}finally{j&&("function"==typeof j.removeRange?j.removeRange(i):j.removeAllRanges()),k&&document.body.removeChild(k),h()}return m}var f=a("toggle-selection"),g="Copy to clipboard: #{key}, Enter";b.exports=e},{"toggle-selection":8}],3:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;i<d;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],4:[function(a,b,c){(function(a){function c(a,b,c){function e(b){var c=p,d=q;return p=q=void 0,y=b,s=a.apply(d,c)}function f(a){return y=a,t=setTimeout(k,b),z?e(a):s}function i(a){var c=a-x,d=a-y,e=b-c;return A?v(e,r-d):e}function j(a){var c=a-x,d=a-y;return void 0===x||c>=b||c<0||A&&d>=r}function k(){var a=w();return j(a)?l(a):void(t=setTimeout(k,i(a)))}function l(a){return t=void 0,B&&p?e(a):(p=q=void 0,s)}function m(){void 0!==t&&clearTimeout(t),y=0,p=x=q=t=void 0}function n(){return void 0===t?s:l(w())}function o(){var a=w(),c=j(a);if(p=arguments,q=this,x=a,c){if(void 0===t)return f(x);if(A)return t=setTimeout(k,b),e(x)}return void 0===t&&(t=setTimeout(k,b)),s}var p,q,r,s,t,x,y=0,z=!1,A=!1,B=!0;if("function"!=typeof a)throw new TypeError(h);return b=g(b)||0,d(c)&&(z=!!c.leading,A="maxWait"in c,r=A?u(g(c.maxWait)||0,b):r,B="trailing"in c?!!c.trailing:B),o.cancel=m,o.flush=n,o}function d(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function e(a){return!!a&&"object"==typeof a}function f(a){return"symbol"==typeof a||e(a)&&t.call(a)==j}function g(a){var b,c;return"number"==typeof a?a:f(a)?i:(d(a)&&(b="function"==typeof a.valueOf?a.valueOf():a,a=d(b)?b+"":b),"string"!=typeof a?0===a?a:+a:(a=a.replace(k,""),c=m.test(a),c||n.test(a)?o(a.slice(2),c?2:8):l.test(a)?i:+a))}var h="Expected a function",i=NaN,j="[object Symbol]",k=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,n=/^0o[0-7]+$/i,o=parseInt,p="object"==typeof a&&a&&a.Object===Object&&a,q="object"==typeof self&&self&&self.Object===Object&&self,r=p||q||Function("return this")(),s=Object.prototype,t=s.toString,u=Math.max,v=Math.min,w=function(){return r.Date.now()};b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(a,b,c){!function(a,d){var e,f;if("object"==typeof c&&"object"==typeof b)b.exports=d();else if("function"==typeof define&&define.amd)define([],d);else{e=d();for(f in e)("object"==typeof c?c:a)[f]=e[f]}}(this,function(){return function(a){function b(a){delete installedChunks[a]}function c(a){var b=document.getElementsByTagName("head")[0],c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.src=n.p+"hot_updater/hot-update.js",b.appendChild(c)}function d(){return new Promise(function(a,b){if("undefined"==typeof XMLHttpRequest)return b(new Error("No browser support"));try{var c=new XMLHttpRequest,d=n.p+"hot_updater/hot-update.json";c.open("GET",d,!0),c.timeout=1e4,c.send(null)}catch(a){return b(a)}c.onreadystatechange=function(){if(4===c.readyState)if(0===c.status)b(new Error("Manifest request to "+d+" timed out."));else if(404===c.status)e();else if(200!==c.status&&304!==c.status)b(new Error("Manifest request to "+d+" failed."));else{try{var a=JSON.parse(c.responseText)}catch(e){return void b(e)}e(a)}}})}function e(a){var b,c,d=E[a];if(!d)return n;b=function(b){return d.hot.active?(E[b]?E[b].parents.indexOf(a)<0&&E[b].parents.push(a):(v=[a],o=b),d.children.indexOf(b)<0&&d.children.push(b)):(console.warn("[HMR] unexpected require("+b+") from disposed module "+a),v=[]),n(b)};for(c in n)Object.prototype.hasOwnProperty.call(n,c)&&"e"!==c&&Object.defineProperty(b,c,function(a){return{configurable:!0,enumerable:!0,get:function(){return n[a]},set:function(b){n[a]=b}}}(c));return b.e=function(a){function b(){A--,"prepare"===y&&(B[a]||k(a),0===A&&0===z&&l())}return"ready"===y&&g("prepare"),A++,n.e(a).then(b,function(a){throw b(),a})},b}function f(a){var b={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:o!==a,active:!0,accept:function(a,c){if(void 0===a)b._selfAccepted=!0;else if("function"==typeof a)b._selfAccepted=a;else if("object"==typeof a)for(var d=0;d<a.length;d++)b._acceptedDependencies[a[d]]=c||function(){};else b._acceptedDependencies[a]=c||function(){}},decline:function(a){if(void 0===a)b._selfDeclined=!0;else if("object"==typeof a)for(var c=0;c<a.length;c++)b._declinedDependencies[a[c]]=!0;else b._declinedDependencies[a]=!0},dispose:function(a){b._disposeHandlers.push(a)},addDisposeHandler:function(a){b._disposeHandlers.push(a)},removeDisposeHandler:function(a){var c=b._disposeHandlers.indexOf(a);c>=0&&b._disposeHandlers.splice(c,1)},check:i,apply:m,status:function(a){return a?void x.push(a):y},addStatusHandler:function(a){x.push(a)},removeStatusHandler:function(a){var b=x.indexOf(a);b>=0&&x.splice(b,1)},data:u[a]};return o=void 0,b}function g(a){y=a;for(var b=0;b<x.length;b++)x[b].call(null,a)}function h(a){return+a+""===a?+a:a}function i(a){if("idle"!==y)throw new Error("check() is only allowed in idle status");return s=a,g("check"),d().then(function(a){if(!a)return g("idle"),null;C={},B={},D=a.c,r=a.h,g("prepare");var b=new Promise(function(a,b){p={resolve:a,reject:b}});return q={},k(0),"prepare"===y&&0===A&&0===z&&l(),b})}function j(a,b){if(D[a]&&C[a]){C[a]=!1;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(q[c]=b[c]);0==--z&&0===A&&l()}}function k(a){D[a]?(C[a]=!0,z++,c(a)):B[a]=!0}function l(){var a,b,c;if(g("ready"),a=p,p=null,a)if(s)m(s).then(function(b){a.resolve(b)},function(b){a.reject(b)});else{b=[];for(c in q)Object.prototype.hasOwnProperty.call(q,c)&&b.push(h(c));a.resolve(b)}}function m(a){function b(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],a.indexOf(d)<0&&a.push(d)}var c,d,e,f,i,j,k,l,m,o,p,s,w,x,z,A,B,C,F,G,H,I,J,K,L,M;if("ready"!==y)throw new Error("apply() is only allowed in ready status");a=a||{},j={},k=[],l={},m=function(){console.warn("[HMR] unexpected require("+p.moduleId+") to disposed module")};for(o in q)if(Object.prototype.hasOwnProperty.call(q,o)){switch(i=h(o),p=q[o]?function(a){var c,d,e,g,h,i,j,k,l;for(c=[a],d={},e=c.slice().map(function(a){return{chain:[a],id:a}});e.length>0;)if(g=e.pop(),h=g.id,i=g.chain,(f=E[h])&&!f.hot._selfAccepted){if(f.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:h};if(f.hot._main)return{type:"unaccepted",chain:i,moduleId:h};for(j=0;j<f.parents.length;j++)if(k=f.parents[j],l=E[k]){if(l.hot._declinedDependencies[h])return{type:"declined",chain:i.concat([k]),moduleId:h,parentId:k};c.indexOf(k)>=0||(l.hot._acceptedDependencies[h]?(d[k]||(d[k]=[]),b(d[k],[h])):(delete d[k],c.push(k),e.push({chain:i.concat([k]),id:k})))}}return{type:"accepted",moduleId:a,outdatedModules:c,outdatedDependencies:d}}(i):{type:"disposed",moduleId:o},s=!1,w=!1,x=!1,z="",p.chain&&(z="\nUpdate propagation: "+p.chain.join(" -> ")),p.type){case"self-declined":a.onDeclined&&a.onDeclined(p),a.ignoreDeclined||(s=new Error("Aborted because of self decline: "+p.moduleId+z));break;case"declined":a.onDeclined&&a.onDeclined(p),a.ignoreDeclined||(s=new Error("Aborted because of declined dependency: "+p.moduleId+" in "+p.parentId+z));break;case"unaccepted":a.onUnaccepted&&a.onUnaccepted(p),a.ignoreUnaccepted||(s=new Error("Aborted because "+i+" is not accepted"+z));break;case"accepted":a.onAccepted&&a.onAccepted(p),w=!0;break;case"disposed":a.onDisposed&&a.onDisposed(p),
x=!0;break;default:throw new Error("Unexception type "+p.type)}if(s)return g("abort"),Promise.reject(s);if(w){l[i]=q[i],b(k,p.outdatedModules);for(i in p.outdatedDependencies)Object.prototype.hasOwnProperty.call(p.outdatedDependencies,i)&&(j[i]||(j[i]=[]),b(j[i],p.outdatedDependencies[i]))}x&&(b(k,[p.moduleId]),l[i]=m)}for(A=[],d=0;d<k.length;d++)i=k[d],E[i]&&E[i].hot._selfAccepted&&A.push({module:i,errorHandler:E[i].hot._selfAccepted});for(g("dispose"),Object.keys(D).forEach(function(a){!1===D[a]&&O(a)}),C=k.slice();C.length>0;)if(i=C.pop(),f=E[i]){for(F={},G=f.hot._disposeHandlers,e=0;e<G.length;e++)(c=G[e])(F);for(u[i]=F,f.hot.active=!1,delete E[i],e=0;e<f.children.length;e++)H=E[f.children[e]],H&&(B=H.parents.indexOf(i))>=0&&H.parents.splice(B,1)}for(i in j)if(Object.prototype.hasOwnProperty.call(j,i)&&(f=E[i]))for(J=j[i],e=0;e<J.length;e++)I=J[e],(B=f.children.indexOf(I))>=0&&f.children.splice(B,1);g("apply"),t=r;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(N[i]=l[i]);K=null;for(i in j)if(Object.prototype.hasOwnProperty.call(j,i)){for(f=E[i],J=j[i],L=[],d=0;d<J.length;d++)I=J[d],c=f.hot._acceptedDependencies[I],L.indexOf(c)>=0||L.push(c);for(d=0;d<L.length;d++){c=L[d];try{c(J)}catch(N){a.onErrored&&a.onErrored({type:"accept-errored",moduleId:i,dependencyId:J[d],error:N}),a.ignoreErrored||K||(K=N)}}}for(d=0;d<A.length;d++){M=A[d],i=M.module,v=[i];try{n(i)}catch(N){if("function"==typeof M.errorHandler)try{M.errorHandler(N)}catch(O){a.onErrored&&a.onErrored({type:"self-accept-error-handler-errored",moduleId:i,error:O,orginalError:N}),a.ignoreErrored||K||(K=O),K||(K=N)}else a.onErrored&&a.onErrored({type:"self-accept-errored",moduleId:i,error:N}),a.ignoreErrored||K||(K=N)}}return K?(g("fail"),Promise.reject(K)):(g("idle"),new Promise(function(a){a(k)}))}function n(b){if(E[b])return E[b].exports;var c=E[b]={i:b,l:!1,exports:{},hot:f(b),parents:(w=v,v=[],w),children:[]};return a[b].call(c.exports,c,c.exports,e(b)),c.l=!0,c.exports}var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this.webpackHotUpdate;return this.webpackHotUpdate=function(a,b){j(a,b),F&&F(a,b)},s=!0,t="e011a723d4d38b992e81",u={},v=[],w=[],x=[],y="idle",z=0,A=0,B={},C={},D={},E={},n.m=a,n.c=E,n.i=function(a){return a},n.d=function(a,b,c){n.o(a,b)||Object.defineProperty(a,b,{configurable:!1,enumerable:!0,get:c})},n.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};return n.d(b,"a",b),b},n.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},n.p="",n.h=function(){return t},e(0)(n.s=0)}({"./src/index.js":function(a,b,c){"use strict";var d,e=c("./src/oppsula.js");try{window.cmTag&&(d=window.cmTag.config.ms||{},d.oppsula=d.oppsula||{},d.oppsula["1.2.8"]=e,window.cmTag.set("ms",d)),window.TRC&&(window.TRC.oppsula=window.TRC.oppsula||{},window.TRC.oppsula["1.2.8"]=e)}catch(a){}a.exports={}},"./src/opportunityType.js":function(a,b,c){"use strict";a.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,firstImpression:99,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,adLoaded:41,startAd:42,videoThrottle:43}},"./src/oppsula.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c("./src/xhr.js"),g=c("./src/store.js"),h=c("./src/utils.js"),i=c("./src/opportunityType.js"),j={},k=function(){function a(b,c){d(this,a);var e=this._getRedId(b)||this._getRedId(c)||"red_id";return j.hasOwnProperty(e)||(this.redId=e,this.store=new g(b,c),this.baseUrl=h.getOppsServletBaseUrl(this.store),this.xhr=new f(this.baseUrl,this.store.get("psthdrs")),this.opps=[],this.fireOppsInterval=null,this.stopped=!1,this.billableEvents=(this.store.get("bllblevt")||"").split(","),this._setFireOppsInterval(),this._setFireOppsBeforeUnload(),j[e]=this),j[e]}return e(a,[{key:"_getRedId",value:function(a){if(a)return a.get("redId")||a.get("red_id")}},{key:"send",value:function(a){a.tms=Math.floor((new Date).getTime()/1e3),this.stopped||(this._isBillableEvent(a.rst)?h.fireOpp(this.baseUrl+"?"+h.flattenParams(a)):this.opps.push(a))}},{key:"_setFireOppsInterval",value:function(){this.stopped||this.fireOppsInterval||(this.fireOpps=this._fireOpps.bind(this),this.fireOppsInterval=setInterval(this.fireOpps,this.store.get("timbtopps")))}},{key:"destroy",value:function(){this.stopped||(window.removeEventListener("beforeunload",this._destroy),this.fireOppsInterval=clearInterval(this.fireOppsInterval),this._fireOpps(),this.stopped=!0,this.store&&this.store.destroy(),this.opps=this.store=this.fireOpps=this.xhr=this._destroy=void 0,j[this.redId]=void 0)}},{key:"_fireOpps",value:function(){this.stopped||(this.opps.length>0&&this.xhr.send(h.stringify(this.opps)),this.opps=[])}},{key:"_setFireOppsBeforeUnload",value:function(){this._destroy=this.destroy.bind(this),window.addEventListener("beforeunload",this._destroy)}},{key:"_isBillableEvent",value:function(a){return this.billableEvents.indexOf(""+a)>-1}},{key:"OppsID",get:function(){return i}}]),a}();a.exports=k},"./src/store.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=(c("./src/utils.js"),function(){function a(b,c){d(this,a),this.unitModel=b,this.playerModel=c,this.data={psthdrs:"application/json",timbtopps:2e3}}return e(a,[{key:"get",value:function(a){return this._getFromPlayerModel(a)}},{key:"_getFromPlayerModel",value:function(a){var b=this.playerModel?this.playerModel.get(a):void 0;return void 0!==b?b:this._getFromUnitModel(a)}},{key:"_getFromUnitModel",value:function(a){var b=this.unitModel?this.unitModel.get(a):void 0;return void 0!==b?b:this._getFromData(a)}},{key:"_getFromData",value:function(a){return a=a.toString(),-1===a.indexOf(".")?this.data[a]:g.get(a,!1,this.data)}},{key:"set",value:function(a,b){a=a.toString(),g.set(a,b,this.data)}},{key:"destroy",value:function(){this.unitModel=this.playerModel=this.data=void 0}}]),a}()),g=function(){var a=function(a,b,c){for(var d,e=c||data,f=0;e&&(d=a[f]);f++)e=d in e?e[d]:b?e[d]={}:void 0;return e};return{set:function(b,c,d){var e=b.split("."),f=e.pop(),g=a(e,!0,d);return g&&f?g[f]=c:void 0},get:function(b,c,d){return a(b.split("."),c,d)},exists:function(a,b){return void 0!==this.get(a,!1,b)}}}();a.exports=f},"./src/utils.js":function(a,b,c){"use strict";var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};a.exports={getOppsServletBaseUrl:function(a){var b=a.get("ms_data.opps_base_path");return this.setUrlPrefix(b)+(/.*\/$/g.test(b)?"":"/")+"OpportunityServlet"},setUrlPrefix:function(a){return"string"!=typeof a?a:(a=a.replace(/^(http[s]?:|ftp:)/g,""),0!==a.indexOf("//")&&(a="//"+a),a)},stringify:function(a,b){try{var c=[];return JSON.stringify(a,function(a,b){if(null!=b&&"object"==(void 0===b?"undefined":d(b))){if(c.indexOf(b)>-1)return;c.push(b)}return b},b)}catch(a){return""}},fireOpp:function(a){try{(new Image).src=a}catch(a){}},flattenParams:function(a){var b,c=[];for(b in a)c.push(b+"="+a[b]);return c.join("&")}}},"./src/xhr.js":function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=(c("./src/utils.js"),function(){function a(b,c){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,f=arguments.length>3&&void 0!==arguments[3]&&arguments[3],g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;arguments.length>5&&void 0!==arguments[5]&&arguments[5],d(this,a),this.baseUrl=b,this.async=void 0==e||e,this.withCredentials=void 0==f||f,this.timeout=g||5e3,this.contentType=c||"application/x-www-form-urlencoded"}return e(a,[{key:"_onFail",value:function(){this.gotResponse||(this.gotResponse=!0)}},{key:"send",value:function(a){if(this.baseUrl){var b=new XMLHttpRequest;return a=a||"",b.open(a?"POST":"GET",this.baseUrl,!0),b.withCredentials=this.withCredentials,b.setRequestHeader("Content-type",this.contentType),b.async=this.async,b.timeout=this.timeout,b.gotResponse=!1,b.addEventListener("error",this._onFail),b.addEventListener("abort",this._onFail),b.addEventListener("timeout",this._onFail),b.addEventListener("readystatechange",function(a){if(4==this.readyState){if(this.gotResponse)return;this.gotResponse=!0}}),b.send(a),!0}}}]),a}());a.exports=f},0:function(a,b,c){a.exports=c("./src/index.js")}})})},{}],6:[function(a,b,c){function d(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function f(a){if(l===setTimeout)return setTimeout(a,0);if((l===d||!l)&&setTimeout)return l=setTimeout,setTimeout(a,0);try{return l(a,0)}catch(b){try{return l.call(null,a,0)}catch(b){return l.call(this,a,0)}}}function g(a){if(m===clearTimeout)return clearTimeout(a);if((m===e||!m)&&clearTimeout)return m=clearTimeout,clearTimeout(a);try{return m(a)}catch(b){try{return m.call(null,a)}catch(b){return m.call(this,a)}}}function h(){o&&p&&(o=!1,p.length?n=p.concat(n):q=-1,n.length&&i())}function i(){var a,b;if(!o){for(a=f(h),o=!0,b=n.length;b;){for(p=n,n=[];++q<b;)p&&p[q].run();q=-1,b=n.length}p=null,o=!1,g(a)}}function j(a,b){this.fun=a,this.array=b}function k(){}var l,m,n,o,p,q,r=b.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:d}catch(a){l=d}try{m="function"==typeof clearTimeout?clearTimeout:e}catch(a){m=e}}(),n=[],o=!1,q=-1,r.nextTick=function(a){var b,c=new Array(arguments.length-1);if(arguments.length>1)for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];n.push(new j(a,c)),1!==n.length||o||f(i)},j.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=k,r.addListener=k,r.once=k,r.off=k,r.removeListener=k,r.removeAllListeners=k,r.emit=k,r.prependListener=k,r.prependOnceListener=k,r.listeners=function(a){return[]},r.binding=function(a){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(a){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],7:[function(require,module,exports){!function a(b,c){var d,e;if("object"==typeof exports&&"object"==typeof module)module.exports=c();else if("function"==typeof define&&define.amd)define([],c);else{d=c();for(e in d)("object"==typeof exports?exports:b)[e]=d[e]}}(window,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.r=function(a){Object.defineProperty(a,"__esModule",{value:!0})},b.n=function(a){var c=a&&a.__esModule?function d(){return a["default"]}:function e(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=0)}({"./index.js":function(module,exports,__webpack_require__){"use strict";eval("\n\nvar Options = __webpack_require__(\"./options.js\");\nvar Utils = __webpack_require__(\"./utils.js\");\n\nvar getDefaultVersion = function getDefaultVersion(serviceName) {\n    return Options.serviceDefaultVersion[serviceName];\n};\n\nvar loadService = function loadService(serviceName, version) {\n    if (Options.mcrsrvcsnmspc === 'trc') {\n        try {\n            return window.TRC[serviceName][version];\n        } catch (ex) {}\n    }\n\n    if (Options.mcrsrvcsnmspc === 'cmTag') {\n        try {\n            return window.cmTag.config.ms[serviceName][version];\n        } catch (ex) {}\n    }\n\n    return null;\n};\n\nmodule.exports = {\n    get: function get(serviceName, version, callback, fallback) {\n        serviceName = Utils.cleanServiceName(serviceName);\n        version = version || getDefaultVersion(serviceName);\n\n        var service = loadService(serviceName, version);\n\n        if (service) {\n            if (callback) {\n                callback(service);\n            }\n\n            return;\n        }\n\n        var script = document.createElement('script');\n        var baseUrl = Utils.setUrlPrefix(Options.base_url);\n\n        script.async = Options.async;\n        script.type = 'text/javascript';\n        script.src = '' + baseUrl + (/.*\\/$/g.test(baseUrl) ? '' : '/') + serviceName + '/' + version + '/' + serviceName + '.js';\n        script.onload = function () {\n            document.head.removeChild(script);\n\n            try {\n                if (callback) {\n                    callback(loadService(serviceName, version));\n                }\n            } catch (ex) {\n                if (fallback) {\n                    fallback();\n                }\n            }\n        };\n\n        script.onerror = function () {\n            document.head.removeChild(script);\n\n            if (fallback) {\n                fallback();\n            }\n        };\n\n        document.head.appendChild(script);\n    },\n    init: function init(newOptions) {\n        for (var key in Options) {\n            if (newOptions.hasOwnProperty(key)) {\n                Options[key] = newOptions[key];\n            }\n        }\n    }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9pbmRleC5qcz80MWY1Il0sIm5hbWVzIjpbIk9wdGlvbnMiLCJyZXF1aXJlIiwiVXRpbHMiLCJnZXREZWZhdWx0VmVyc2lvbiIsInNlcnZpY2VOYW1lIiwic2VydmljZURlZmF1bHRWZXJzaW9uIiwibG9hZFNlcnZpY2UiLCJ2ZXJzaW9uIiwibWNyc3J2Y3NubXNwYyIsIndpbmRvdyIsIlRSQyIsImV4IiwiY21UYWciLCJjb25maWciLCJtcyIsIm1vZHVsZSIsImV4cG9ydHMiLCJnZXQiLCJjYWxsYmFjayIsImZhbGxiYWNrIiwiY2xlYW5TZXJ2aWNlTmFtZSIsInNlcnZpY2UiLCJzY3JpcHQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJiYXNlVXJsIiwic2V0VXJsUHJlZml4IiwiYmFzZV91cmwiLCJhc3luYyIsInR5cGUiLCJzcmMiLCJ0ZXN0Iiwib25sb2FkIiwiaGVhZCIsInJlbW92ZUNoaWxkIiwib25lcnJvciIsImFwcGVuZENoaWxkIiwiaW5pdCIsImtleSIsIm5ld09wdGlvbnMiLCJoYXNPd25Qcm9wZXJ0eSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJQSxVQUFVLG1CQUFBQyxDQUFRLGNBQVIsQ0FBZDtBQUNBLElBQUlDLFFBQVEsbUJBQUFELENBQVEsWUFBUixDQUFaOztBQUVBLElBQUlFLG9CQUFvQixTQUFwQkEsaUJBQW9CLENBQUNDLFdBQUQsRUFBaUI7QUFDckMsV0FBT0osUUFBUUsscUJBQVIsQ0FBOEJELFdBQTlCLENBQVA7QUFDSCxDQUZEOztBQUlBLElBQUlFLGNBQWMsU0FBZEEsV0FBYyxDQUFDRixXQUFELEVBQWNHLE9BQWQsRUFBMEI7QUFDeEMsUUFBSVAsUUFBUVEsYUFBUixLQUEwQixLQUE5QixFQUFxQztBQUNqQyxZQUFJO0FBQ0EsbUJBQU9DLE9BQU9DLEdBQVAsQ0FBV04sV0FBWCxFQUF3QkcsT0FBeEIsQ0FBUDtBQUNILFNBRkQsQ0FFRSxPQUFPSSxFQUFQLEVBQVcsQ0FBRztBQUNuQjs7QUFFRCxRQUFJWCxRQUFRUSxhQUFSLEtBQTBCLE9BQTlCLEVBQXVDO0FBQ25DLFlBQUk7QUFDQSxtQkFBT0MsT0FBT0csS0FBUCxDQUFhQyxNQUFiLENBQW9CQyxFQUFwQixDQUF1QlYsV0FBdkIsRUFBb0NHLE9BQXBDLENBQVA7QUFDSCxTQUZELENBRUUsT0FBT0ksRUFBUCxFQUFXLENBQUU7QUFDbEI7O0FBRUQsV0FBTyxJQUFQO0FBQ0gsQ0FkRDs7QUFnQkFJLE9BQU9DLE9BQVAsR0FBaUI7QUFDYkMsU0FBSyxhQUFDYixXQUFELEVBQWNHLE9BQWQsRUFBdUJXLFFBQXZCLEVBQWlDQyxRQUFqQyxFQUE4QztBQUMvQ2Ysc0JBQWNGLE1BQU1rQixnQkFBTixDQUF1QmhCLFdBQXZCLENBQWQ7QUFDQUcsa0JBQVVBLFdBQVdKLGtCQUFrQkMsV0FBbEIsQ0FBckI7O0FBRUEsWUFBSWlCLFVBQVVmLFlBQVlGLFdBQVosRUFBeUJHLE9BQXpCLENBQWQ7O0FBRUEsWUFBSWMsT0FBSixFQUFhO0FBQ1QsZ0JBQUlILFFBQUosRUFBYztBQUNWQSx5QkFBU0csT0FBVDtBQUNIOztBQUVEO0FBQ0g7O0FBRUQsWUFBSUMsU0FBU0MsU0FBU0MsYUFBVCxDQUF1QixRQUF2QixDQUFiO0FBQ0EsWUFBSUMsVUFBVXZCLE1BQU13QixZQUFOLENBQW1CMUIsUUFBUTJCLFFBQTNCLENBQWQ7O0FBRUFMLGVBQU9NLEtBQVAsR0FBZTVCLFFBQVE0QixLQUF2QjtBQUNBTixlQUFPTyxJQUFQLEdBQWMsaUJBQWQ7QUFDQVAsZUFBT1EsR0FBUCxRQUFpQkwsT0FBakIsSUFBNkIsU0FBU00sSUFBVCxDQUFjTixPQUFkLElBQXlCLEVBQXpCLEdBQThCLEdBQTNELElBQW1FckIsV0FBbkUsU0FBb0ZHLE9BQXBGLFNBQWlHSCxXQUFqRztBQUNBa0IsZUFBT1UsTUFBUCxHQUFnQixZQUFNO0FBQ2xCVCxxQkFBU1UsSUFBVCxDQUFjQyxXQUFkLENBQTBCWixNQUExQjs7QUFFQSxnQkFBSTtBQUNBLG9CQUFJSixRQUFKLEVBQWM7QUFDVkEsNkJBQVNaLFlBQVlGLFdBQVosRUFBeUJHLE9BQXpCLENBQVQ7QUFDSDtBQUNKLGFBSkQsQ0FJRSxPQUFPSSxFQUFQLEVBQVc7QUFDVCxvQkFBSVEsUUFBSixFQUFjO0FBQ1ZBO0FBQ0g7QUFDSjtBQUNKLFNBWkQ7O0FBY0FHLGVBQU9hLE9BQVAsR0FBaUIsWUFBTTtBQUNuQloscUJBQVNVLElBQVQsQ0FBY0MsV0FBZCxDQUEwQlosTUFBMUI7O0FBRUEsZ0JBQUlILFFBQUosRUFBYztBQUNWQTtBQUNIO0FBQ0osU0FORDs7QUFRQUksaUJBQVNVLElBQVQsQ0FBY0csV0FBZCxDQUEwQmQsTUFBMUI7QUFDSCxLQTVDWTtBQTZDYmUsVUFBTSwwQkFBYztBQUNoQixhQUFLLElBQUlDLEdBQVQsSUFBZ0J0QyxPQUFoQixFQUF5QjtBQUNyQixnQkFBSXVDLFdBQVdDLGNBQVgsQ0FBMEJGLEdBQTFCLENBQUosRUFBb0M7QUFDaEN0Qyx3QkFBUXNDLEdBQVIsSUFBZUMsV0FBV0QsR0FBWCxDQUFmO0FBQ0g7QUFDSjtBQUNKO0FBbkRZLENBQWpCIiwiZmlsZSI6Ii4vaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgT3B0aW9ucyA9IHJlcXVpcmUoJy4vb3B0aW9ucycpO1xudmFyIFV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xuXG52YXIgZ2V0RGVmYXVsdFZlcnNpb24gPSAoc2VydmljZU5hbWUpID0+IHtcbiAgICByZXR1cm4gT3B0aW9ucy5zZXJ2aWNlRGVmYXVsdFZlcnNpb25bc2VydmljZU5hbWVdO1xufTtcblxudmFyIGxvYWRTZXJ2aWNlID0gKHNlcnZpY2VOYW1lLCB2ZXJzaW9uKSA9PiB7XG4gICAgaWYgKE9wdGlvbnMubWNyc3J2Y3NubXNwYyA9PT0gJ3RyYycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuVFJDW3NlcnZpY2VOYW1lXVt2ZXJzaW9uXTtcbiAgICAgICAgfSBjYXRjaCAoZXgpIHsgfVxuICAgIH1cblxuICAgIGlmIChPcHRpb25zLm1jcnNydmNzbm1zcGMgPT09ICdjbVRhZycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuY21UYWcuY29uZmlnLm1zW3NlcnZpY2VOYW1lXVt2ZXJzaW9uXTtcbiAgICAgICAgfSBjYXRjaCAoZXgpIHt9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGdldDogKHNlcnZpY2VOYW1lLCB2ZXJzaW9uLCBjYWxsYmFjaywgZmFsbGJhY2spID0+IHtcbiAgICAgICAgc2VydmljZU5hbWUgPSBVdGlscy5jbGVhblNlcnZpY2VOYW1lKHNlcnZpY2VOYW1lKTtcbiAgICAgICAgdmVyc2lvbiA9IHZlcnNpb24gfHwgZ2V0RGVmYXVsdFZlcnNpb24oc2VydmljZU5hbWUpO1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0gbG9hZFNlcnZpY2Uoc2VydmljZU5hbWUsIHZlcnNpb24pO1xuICAgICAgICBcbiAgICAgICAgaWYgKHNlcnZpY2UpIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHNlcnZpY2UpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgIHZhciBiYXNlVXJsID0gVXRpbHMuc2V0VXJsUHJlZml4KE9wdGlvbnMuYmFzZV91cmwpO1xuXG4gICAgICAgIHNjcmlwdC5hc3luYyA9IE9wdGlvbnMuYXN5bmM7XG4gICAgICAgIHNjcmlwdC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XG4gICAgICAgIHNjcmlwdC5zcmMgPSBgJHsgYmFzZVVybCB9JHsgLy4qXFwvJC9nLnRlc3QoYmFzZVVybCkgPyAnJyA6ICcvJyB9JHsgc2VydmljZU5hbWUgfS8keyB2ZXJzaW9uIH0vJHsgc2VydmljZU5hbWUgfS5qc2A7XG4gICAgICAgIHNjcmlwdC5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGxvYWRTZXJ2aWNlKHNlcnZpY2VOYW1lLCB2ZXJzaW9uKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoZmFsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgZmFsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5oZWFkLnJlbW92ZUNoaWxkKHNjcmlwdCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChmYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGZhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgIH0sXG4gICAgaW5pdDogbmV3T3B0aW9ucyA9PiB7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBPcHRpb25zKSB7XG4gICAgICAgICAgICBpZiAobmV3T3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgT3B0aW9uc1trZXldID0gbmV3T3B0aW9uc1trZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./index.js\n")},"./options.js":function(module,exports,__webpack_require__){"use strict";eval("\n\nmodule.exports = {\n    base_url: '//vidstat.taboola.com/',\n    async: true,\n    mcrsrvcsnmspc: 'trc',\n    serviceDefaultVersion: {\n        oppsula: '1.0.1'\n    }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9vcHRpb25zLmpzP2M5ZmEiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsImJhc2VfdXJsIiwiYXN5bmMiLCJtY3JzcnZjc25tc3BjIiwic2VydmljZURlZmF1bHRWZXJzaW9uIiwib3Bwc3VsYSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBT0MsT0FBUCxHQUFpQjtBQUNiQyxjQUFVLHdCQURHO0FBRWJDLFdBQU8sSUFGTTtBQUdiQyxtQkFBZSxLQUhGO0FBSWJDLDJCQUF1QjtBQUNuQkMsaUJBQVM7QUFEVTtBQUpWLENBQWpCIiwiZmlsZSI6Ii4vb3B0aW9ucy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0ge1xuICAgIGJhc2VfdXJsOiAnLy92aWRzdGF0LnRhYm9vbGEuY29tLycsXG4gICAgYXN5bmM6IHRydWUsXG4gICAgbWNyc3J2Y3NubXNwYzogJ3RyYycsXG4gICAgc2VydmljZURlZmF1bHRWZXJzaW9uOiB7XG4gICAgICAgIG9wcHN1bGE6ICcxLjAuMSdcbiAgICB9XG59OyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./options.js\n")},"./utils.js":function(module,exports,__webpack_require__){"use strict";eval('\n\nmodule.exports = {\n    setUrlPrefix: function setUrlPrefix(url) {\n        if (typeof url !== "string") {\n            return url;\n        }\n\n        url = url.replace(/^(http[s]?:|ftp:)/g, "");\n\n        if (url.indexOf("//") !== 0) {\n            url = "//" + url;\n        }\n\n        return url;\n    },\n    cleanServiceName: function cleanServiceName(serviceName) {\n        return serviceName.replace(/.js$/, \'\');\n    }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi91dGlscy5qcz8xYjIzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJzZXRVcmxQcmVmaXgiLCJ1cmwiLCJyZXBsYWNlIiwiaW5kZXhPZiIsImNsZWFuU2VydmljZU5hbWUiLCJzZXJ2aWNlTmFtZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBT0MsT0FBUCxHQUFpQjtBQUNiQyxrQkFBYyxzQkFBVUMsR0FBVixFQUFlO0FBQ3pCLFlBQUksT0FBT0EsR0FBUCxLQUFlLFFBQW5CLEVBQTZCO0FBQ3pCLG1CQUFPQSxHQUFQO0FBQ0g7O0FBRURBLGNBQU1BLElBQUlDLE9BQUosQ0FBWSxvQkFBWixFQUFpQyxFQUFqQyxDQUFOOztBQUVBLFlBQUlELElBQUlFLE9BQUosQ0FBWSxJQUFaLE1BQXNCLENBQTFCLEVBQTZCO0FBQ3pCRixrQkFBTyxPQUFPQSxHQUFkO0FBQ0g7O0FBRUQsZUFBT0EsR0FBUDtBQUNILEtBYlk7QUFjYkcsc0JBQWtCLDBCQUFVQyxXQUFWLEVBQXVCO0FBQ3JDLGVBQU9BLFlBQVlILE9BQVosQ0FBb0IsTUFBcEIsRUFBNEIsRUFBNUIsQ0FBUDtBQUNIO0FBaEJZLENBQWpCIiwiZmlsZSI6Ii4vdXRpbHMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgICBzZXRVcmxQcmVmaXg6IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmw7XG4gICAgICAgIH1cblxuICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgvXihodHRwW3NdPzp8ZnRwOikvZyxcIlwiKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh1cmwuaW5kZXhPZihcIi8vXCIpICE9PSAwKSB7XG4gICAgICAgICAgICB1cmwgPSAgXCIvL1wiICsgdXJsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIGNsZWFuU2VydmljZU5hbWU6IGZ1bmN0aW9uIChzZXJ2aWNlTmFtZSkge1xuICAgICAgICByZXR1cm4gc2VydmljZU5hbWUucmVwbGFjZSgvLmpzJC8sICcnKTtcbiAgICB9XG59OyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./utils.js\n')},0:function(a,b,c){a.exports=c("./index.js")}})})},{}],8:[function(a,b,c){b.exports=function(){var a,b,c,d=document.getSelection();if(!d.rangeCount)return function(){};for(a=document.activeElement,b=[],c=0;c<d.rangeCount;c++)b.push(d.getRangeAt(c));switch(a.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":a.blur();break;default:a=null}return d.removeAllRanges(),function(){"Caret"===d.type&&d.removeAllRanges(),d.rangeCount||b.forEach(function(a){d.addRange(a)}),a&&a.focus()}}},{}],9:[function(a,b,c){!function(a,d){"use strict";var e,f,g="0.7.12",h="",i="?",j="function",k="undefined",l="object",m="string",n="major",o="model",p="name",q="type",r="vendor",s="version",t="architecture",u="console",v="mobile",w="tablet",x="smarttv",y="wearable",z="embedded",A={extend:function(a,b){var c,d={};for(c in a)b[c]&&b[c].length%2===0?d[c]=b[c].concat(a[c]):d[c]=a[c];return d},has:function(a,b){return"string"==typeof a&&b.toLowerCase().indexOf(a.toLowerCase())!==-1},lowerize:function(a){return a.toLowerCase()},major:function(a){return typeof a===m?a.replace(/[^\d\.]/g,"").split(".")[0]:d},trim:function(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},B={rgx:function(){for(var a,b,c,e,f,g,h,i,m,n=0,o=arguments;n<o.length&&!g;){if(i=o[n],m=o[n+1],typeof a===k){a={};for(e in m)m.hasOwnProperty(e)&&(f=m[e],typeof f===l?a[f[0]]=d:a[f]=d)}for(b=c=0;b<i.length&&!g;)if(g=i[b++].exec(this.getUA()))for(e=0;e<m.length;e++)h=g[++c],f=m[e],typeof f===l&&f.length>0?2==f.length?typeof f[1]==j?a[f[0]]=f[1].call(this,h):a[f[0]]=f[1]:3==f.length?typeof f[1]!==j||f[1].exec&&f[1].test?a[f[0]]=h?h.replace(f[1],f[2]):d:a[f[0]]=h?f[1].call(this,h,f[2]):d:4==f.length&&(a[f[0]]=h?f[3].call(this,h.replace(f[1],f[2])):d):a[f]=h?h:d;n+=2}return a},str:function(a,b){var c,e;for(c in b)if(typeof b[c]===l&&b[c].length>0){for(e=0;e<b[c].length;e++)if(A.has(b[c][e],a))return c===i?d:c}else if(A.has(b[c],a))return c===i?d:c;return a}},C={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},D={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[p,s],[/(opios)[\/\s]+([\w\.]+)/i],[[p,"Opera Mini"],s],[/\s(opr)\/([\w\.]+)/i],[[p,"Opera"],s],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs)\/([\w\.-]+)/i],[p,s],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[p,"IE"],s],[/(edge)\/((\d+)?[\w\.]+)/i],[p,s],[/(yabrowser)\/([\w\.]+)/i],[[p,"Yandex"],s],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],s],[/(micromessenger)\/([\w\.]+)/i],[[p,"WeChat"],s],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[s,[p,"MIUI Browser"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[p,/(.+)/,"$1 WebView"],s],[/android.+samsungbrowser\/([\w\.]+)/i,/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[s,[p,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(qqbrowser)[\/\s]?([\w\.]+)/i],[p,s],[/(uc\s?browser)[\/\s]?([\w\.]+)/i,/ucweb.+(ucbrowser)[\/\s]?([\w\.]+)/i,/juc.+(ucweb)[\/\s]?([\w\.]+)/i],[[p,"UCBrowser"],s],[/(dolfin)\/([\w\.]+)/i],[[p,"Dolphin"],s],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[p,"Chrome"],s],[/;fbav\/([\w\.]+);/i],[s,[p,"Facebook"]],[/fxios\/([\w\.-]+)/i],[s,[p,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[s,[p,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[s,p],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[p,[s,B.str,C.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[p,s],[/(navigator|netscape)\/([\w\.-]+)/i],[[p,"Netscape"],s],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[p,s]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[t,"amd64"]],[/(ia32(?=;))/i],[[t,A.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[t,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[t,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[t,/ower/,"",A.lowerize]],[/(sun4\w)[;\)]/i],[[t,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[t,A.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[o,r,[q,w]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[r,"Apple"],[q,w]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[r,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[r,o,[q,w]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[o,[r,"Amazon"],[q,w]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[o,B.str,C.device.amazon.model],[r,"Amazon"],[q,v]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,r,[q,v]],[/\((ip[honed|\s\w*]+);/i],[o,[r,"Apple"],[q,v]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[r,o,[q,v]],[/\(bb10;\s(\w+)/i],[o,[r,"BlackBerry"],[q,v]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[o,[r,"Asus"],[q,w]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[r,"Sony"],[o,"Xperia Tablet"],[q,w]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[r,"Sony"],[o,"Xperia Phone"],[q,v]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[r,o,[q,u]],[/android.+;\s(shield)\sbuild/i],[o,[r,"Nvidia"],[q,u]],[/(playstation\s[34portablevi]+)/i],[o,[r,"Sony"],[q,u]],[/(sprint\s(\w+))/i],[[r,B.str,C.device.sprint.vendor],[o,B.str,C.device.sprint.model],[q,v]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[r,o,[q,w]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[r,[o,/_/g," "],[q,v]],[/(nexus\s9)/i],[o,[r,"HTC"],[q,w]],[/(nexus\s6p)/i],[o,[r,"Huawei"],[q,v]],[/(microsoft);\s(lumia[\s\w]+)/i],[r,o,[q,v]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[r,"Microsoft"],[q,u]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[r,"Microsoft"],[q,v]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[r,"Motorola"],[q,v]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[r,"Motorola"],[q,w]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[r,A.trim],[o,A.trim],[q,x]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[r,"Samsung"],[q,x]],[/\(dtv[\);].+(aquos)/i],[o,[r,"Sharp"],[q,x]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[r,"Samsung"],o,[q,w]],[/smart-tv.+(samsung)/i],[r,[q,x],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[r,"Samsung"],o,[q,v]],[/sie-(\w+)*/i],[o,[r,"Siemens"],[q,v]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[r,"Nokia"],o,[q,v]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[o,[r,"Acer"],[q,w]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[r,"LG"],o,[q,w]],[/(lg) netcast\.tv/i],[r,o,[q,x]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[o,[r,"LG"],[q,v]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[r,"Lenovo"],[q,w]],[/linux;.+((jolla));/i],[r,o,[q,v]],[/((pebble))app\/[\d\.]+\s/i],[r,o,[q,y]],[/android.+;\s(glass)\s\d/i],[o,[r,"Google"],[q,y]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i],[[o,/_/g," "],[r,"Xiaomi"],[q,v]],[/android.+a000(1)\s+build/i],[o,[r,"OnePlus"],[q,v]],[/\s(tablet)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[q,A.lowerize],r,o]],
engine:[[/windows.+\sedge\/([\w\.]+)/i],[s,[p,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[p,s],[/rv\:([\w\.]+).*(gecko)/i],[s,p]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[p,s],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[p,[s,B.str,C.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[p,"Windows"],[s,B.str,C.os.windows.version]],[/\((bb)(10);/i],[[p,"BlackBerry"],s],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[p,s],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[p,"Symbian"],s],[/\((series40);/i],[p],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[p,"Firefox OS"],s],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[p,s],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[p,"Chromium OS"],s],[/(sunos)\s?([\w\.]+\d)*/i],[[p,"Solaris"],s],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[p,s],[/(haiku)\s(\w+)/i],[p,s],[/(ip[honead]+)(?:.*os\s([\w]+)*\slike\smac|;\sopera)/i],[[p,"iOS"],[s,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[p,"Mac OS"],[s,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[p,s]]},E=function(b,c){var d,e;return this instanceof E?(d=b||(a&&a.navigator&&a.navigator.userAgent?a.navigator.userAgent:h),e=c?A.extend(D,c):D,this.getBrowser=function(){var a=B.rgx.apply(this,e.browser);return a.major=A.major(a.version),a},this.getCPU=function(){return B.rgx.apply(this,e.cpu)},this.getDevice=function(){return B.rgx.apply(this,e.device)},this.getEngine=function(){return B.rgx.apply(this,e.engine)},this.getOS=function(){return B.rgx.apply(this,e.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return d},this.setUA=function(a){return d=a,this},this):new E(b,c).getResult()};E.VERSION=g,E.BROWSER={NAME:p,MAJOR:n,VERSION:s},E.CPU={ARCHITECTURE:t},E.DEVICE={MODEL:o,VENDOR:r,TYPE:q,CONSOLE:u,MOBILE:v,SMARTTV:x,TABLET:w,WEARABLE:y,EMBEDDED:z},E.ENGINE={NAME:p,VERSION:s},E.OS={NAME:p,VERSION:s},typeof c!==k?(typeof b!==k&&b.exports&&(c=b.exports=E),c.UAParser=E):typeof define===j&&define.amd?define(function(){return E}):a.UAParser=E,e=a.jQuery||a.Zepto,typeof e!==k&&(f=new E,e.ua=f.getResult(),e.ua.get=function(){return f.getUA()},e.ua.set=function(a){var b,c;f.setUA(a),b=f.getResult();for(c in b)e.ua[c]=b[c]})}("object"==typeof window?window:this)},{}],10:[function(a,b,c){"use strict";function d(a,b,c){}function e(a,b,c){Object.defineProperty(a,b,{writable:!1,configurable:!1,value:c})}var f,g=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"],h=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"],i=["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"],j=["setAdVolume"];d.prototype.handshakeVersion=function(a,b){},d.prototype.initAd=function(a,b,c,d,e,f,g){},d.prototype.startAd=function(a){},d.prototype.stopAd=function(a){},d.prototype.skipAd=function(a){},d.prototype.resizeAd=function(a,b,c,d){},d.prototype.pauseAd=function(a){},d.prototype.resumeAd=function(a){},d.prototype.expandAd=function(a){},d.prototype.collapseAd=function(a){},d.prototype.subscribe=function(a,b,c){},d.prototype.unsubscribe=function(a,b){},d.prototype.getAdLinear=function(a){},d.prototype.getAdWidth=function(a){},d.prototype.getAdHeight=function(a){},d.prototype.getAdExpanded=function(a){},d.prototype.getAdSkippableState=function(a){},d.prototype.getAdRemainingTime=function(a){},d.prototype.getAdDuration=function(a){},d.prototype.getAdVolume=function(a){},d.prototype.getAdCompanions=function(a){},d.prototype.getAdIcons=function(a){},d.prototype.setAdVolume=function(a,b){},e(d,"METHODS",g),e(d,"GETTERS",i),e(d,"SETTERS",j),e(d,"EVENTS",h),f=g.filter(function(a){return["skipAd"].indexOf(a)===-1}),e(d,"checkVPAIDInterface",function k(a){var b=f.every(function(b){return"function"==typeof a[b]});return b}),b.exports=d},{}],11:[function(a,b,c){"use strict";function d(a,b,c,d){this._isValid=l(a),this._isValid&&(this._creative=a,this._el=b,this._videoEl=c,this._iframe=d,this._subscribers=new k,m.setFullSizeStyle(b),f.call(this))}function e(a,b){var c,d=j.prototype[a].length,e=d===b.length?b.pop():void 0,f=null;try{c=this._creative[a].apply(this._creative,b)}catch(g){f=g}i(e,this._subscribers,f,c)}function f(){var a,b;q.forEach(function(a){this._creative.subscribe(h.bind(this,a),a)}.bind(this)),this._creative.subscribe(g.bind(this),p),this._videoEl&&(a=this._iframe.contentDocument.documentElement,b=this._videoEl,a.addEventListener("click",function(c){c.target===a&&b.click()}))}function g(a,b,c){this._subscribers.triggerSync(p,{url:a,id:b,playerHandles:c})}function h(a){this._subscribers.trigger(a,Array.prototype.slice.call(arguments).slice(1))}function i(a,b,c,d){a?a(c,d):c&&b.trigger(o,c)}var j=a("./IVPAIDAdUnit"),k=a("./subscriber"),l=j.checkVPAIDInterface,m=a("./utils"),n=j.METHODS,o="AdError",p="AdClickThru",q=j.EVENTS.filter(function(a){return a!=p});d.prototype=Object.create(j.prototype),d.prototype.isValidVPAIDAd=function r(){return this._isValid},j.METHODS.forEach(function(a){var b=["subscribe","unsubscribe","initAd"];b.indexOf(a)===-1&&(d.prototype[a]=function(){var b=Array.prototype.slice.call(arguments);this.syncmthds&&this.syncmthds.indexOf(a)>-1?e.call(this,a,b):setTimeout(function(){e.call(this,a,b)}.bind(this),0)})}),d.prototype.initAd=function s(a,b,c,d,e,f,g){e=e||{},f=m.extend({slot:this._el,videoSlot:this._videoEl},f||{}),setTimeout(function(){var h;try{this._creative.initAd(a,b,c,d,e,f)}catch(j){h=j}i(g,this._subscribers,h)}.bind(this),0)},d.prototype.subscribe=function t(a,b,c){this._subscribers.subscribe(b,a,c)},d.prototype.unsubscribe=function u(a,b){this._subscribers.unsubscribe(b,a)},d.prototype.on=d.prototype.subscribe,d.prototype.off=d.prototype.unsubscribe,j.GETTERS.forEach(function(a){d.prototype[a]=function(b){setTimeout(function(){var c,d=null;try{c=this._creative[a]()}catch(e){d=e}i(b,this._subscribers,d,c)}.bind(this),0)}}),d.prototype.setAdVolume=function v(a,b){setTimeout(function(){var c,d=null;try{this._creative.setAdVolume(a),c=this._creative.getAdVolume()}catch(e){}i(b,this._subscribers,d,c)}.bind(this),0)},d.prototype._destroy=function w(){this.stopAd(),this._subscribers.unsubscribeAll()},b.exports=d},{"./IVPAIDAdUnit":10,"./subscriber":13,"./utils":14}],12:[function(a,b,c){"use strict";function d(a,b,c,d){c=c||{},this._id=n(),this._destroyed=!1,this._frameContainer=m.createElementInEl(a,"div"),this._videoEl=b,this._vpaidOptions=d||{timeout:1e4},this._templateConfig={template:c.template||p,extraOptions:c.extraOptions||{}}}function e(a){var b=this[a];b&&(b.remove&&b.remove(),delete this[a])}function f(){h.call(this),delete this._adUnit}function g(){h.call(this),j.call(this)}function h(){e.call(this,"_frame"),i.call(this)}function i(){this._onLoad&&(window.removeEventListener("message",this._onLoad),m.clearCallbackTimeout(this._onLoad),delete this._onLoad)}function j(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function k(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function l(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}var m=a("./utils"),n=m.unique("vpaidIframe"),o=a("./VPAIDAdUnit"),p='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"></script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');</script></body></html>',q="AdStopped";d.prototype.destroy=function r(){this._destroyed||(this._destroyed=!0,g.call(this))},d.prototype.isDestroyed=function s(){return this._destroyed},d.prototype.loadAdUnit=function t(a,b){function c(a){var c,d,g,h,j;if(a.origin===l()){try{c=JSON.parse(a.data)}catch(a){c={}}if(c.id===e.getID())return e._frame.contentWindow?(h=e._frame.contentWindow.getVPAIDAd,g=m.validate("function"==typeof h,"the ad didn't return a function to create an ad")):g="the iframe is not anymore in the DOM tree",g||(j=e._frame.contentWindow.document.querySelector(".ad-element"),d=new o(h(),j,e._videoEl,e._frame),d.subscribe(q,f.bind(e)),g=m.validate(d.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")),e._adUnit=d,i.call(e),b(g,g?null:d),!0}}function d(){b("timeout",null)}var e,h;k.call(this),g.call(this),e=this,h=m.createIframeWithContent(this._frameContainer,this._templateConfig.template,m.extend({iframeURL_JS:a,iframeID:this.getID(),origin:l()},this._templateConfig.extraOptions)),h._src=h.src,Object.defineProperty(h,"src",{get:function j(){return h._src},set:function n(a){}}),this._frame=h,this._onLoad=m.callbackTimeout(this._vpaidOptions.timeout,c.bind(this),d.bind(this)),window.addEventListener("message",this._onLoad)},d.prototype.unloadAdUnit=function u(){g.call(this)},d.prototype.getID=function(){return this._id},b.exports=d},{"./VPAIDAdUnit":11,"./utils":14}],13:[function(a,b,c){"use strict";function d(){this._subscribers={}}function e(a,b){setTimeout(function(){a.handler.call(a.context,b)},0)}d.prototype.subscribe=function f(a,b,c){this.isHandlerAttached(a,b)||this.get(b).push({handler:a,context:c,eventName:b})},d.prototype.unsubscribe=function g(a,b){this._subscribers[b]=this.get(b).filter(function(b){return a!==b.handler})},d.prototype.unsubscribeAll=function h(){this._subscribers={}},d.prototype.trigger=function(a,b){var c,d=this,f=this.get(a);for(c=0;c<f.length;c++)e(f[c],b)},d.prototype.triggerSync=function(a,b){var c=this.get(a);c.forEach(function(a){a.handler.call(a.context,b)})},d.prototype.get=function i(a){return this._subscribers[a]||(this._subscribers[a]=[]),this._subscribers[a]||[]},d.prototype.isHandlerAttached=function j(a,b){return this.get(b).some(function(b){return a===b.handler})},b.exports=d},{}],14:[function(a,b,c){"use strict";function d(){}function e(a,b){return a?null:new Error(b)}function f(a){var b=q[a];b&&(clearTimeout(b),delete q[a])}function g(a,b,c){var e,g;return g=setTimeout(function(){b=d,delete g[e],c()},a),e=function h(){b.apply(this,arguments)&&f(e)},q[e]=g,e}function h(a,b,c){var d=document.createElement(b);return c&&(d.id=c),a.appendChild(d),d}function i(a,b,c){var d=j(a,null,c.zIndex);if(m(d,l(b,c)))return d}function j(a,b,c){var d=document.createElement("iframe");return d.src=b||"about:blank",d.marginWidth="0",d.marginHeight="0",d.frameBorder="0",d.width="100%",d.height="100%",k(d),c&&(d.style.zIndex=c),d.setAttribute("SCROLLING","NO"),a.innerHTML="",a.appendChild(d),d}function k(a){a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.margin="0px",a.style.padding="0px",a.style.border="none",a.style.width="100%",a.style.height="100%"}function l(a,b){return Object.keys(b).forEach(function(c){var d="object"===("undefined"==typeof d?"undefined":p(d))?JSON.stringify(b[c]):b[c];a=a.replace(new RegExp("{{"+c+"}}","g"),d)}),a}function m(a,b){var c=a.contentWindow&&a.contentWindow.document;return!!c&&(c.write(b),!0)}function n(a,b){return Object.keys(b).forEach(function(c){a[c]=b[c]}),a}function o(a){var b=-1;return function(){return a+"_"+ ++b}}var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},q={};b.exports={noop:d,validate:e,clearCallbackTimeout:f,callbackTimeout:g,createElementInEl:h,createIframeWithContent:i,createIframe:j,setFullSizeStyle:k,simpleTemplate:l,setIframeContent:m,extend:n,unique:o}},{}],15:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.os=b.os.name,this.osVersion=parseInt(b.os.version),this.browserName=b.browser.name,this.browserMajorVersion=parseInt(b.browser.major)}return e(a,[{key:"isAutoplaySupported",value:function b(){switch(this.os){case"Android":return this.isAutoplaySupportedAndroid();case"iOS":return this.isAutoplaySupportedIOS();default:return!1}}},{key:"isAutoplaySupportedIOS",value:function c(){if(this.osVersion<10)return!1;switch(this.browserName){case"Firefox":return this.browserMajorVersion>=7;default:return!0}}},{key:"isAutoplaySupportedAndroid",value:function f(){switch(this.browserName){case"Chrome":case"Chrome WebView":return parseInt(this.browserMajorVersion)>=53;case"Firefox":return parseInt(this.browserMajorVersion)>=49;case"Android Browser":return parseInt(this.browserMajorVersion)>=7;default:return!1}}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],16:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.decodedData=atob(b),this.nextBits=0,this.numBitsRemaining=0,this.isEndOfStream=!1,this.pointerInDecodedData=0}return e(a,[{key:"getNextByte",value:function b(){return this.pointerInDecodedData===this.decodedData.length?-1:this.decodedData.charCodeAt(this.pointerInDecodedData++)}},{key:"read",value:function c(){if(this.isEndOfStream)return-1;if(0===this.numBitsRemaining){if(this.nextBits=this.getNextByte(),this.nextBits===-1)return this.isEndOfStream=!0,-1;this.numBitsRemaining=8}return this.numBitsRemaining--,this.nextBits>>7-this.numBitsRemaining&1}},{key:"isEof",value:function f(){return this.isEndOfStream||0==this.numBitsRemaining&&this.pointerInDecodedData==this.decodedData.length-1}},{key:"readChar",value:function g(){var a,b,c=0;for(a=0;a<7;a++)b=this.read(),c|=b<<a;return String.fromCharCode(c)}},{key:"readByte",value:function h(){var a,b,c=0;for(a=0;a<8;a++)b=this.read(),c|=b<<a;return c}},{key:"read7bitString",value:function i(a){var b,c="";for(b=0;b<a;b++)c+=this.readChar();return c}},{key:"read8bitString",value:function j(a){var b,c="";for(b=0;b<a;b++)c+=String.fromCharCode(this.readByte());return c}},{key:"readBytes",value:function k(a){var b,c=new ArrayBuffer(a);for(b=0;b<a;b++)c[b]=this.readByte();return c}},{key:"readInt",value:function l(a){var b,c,d,e;if(void 0!==a){for(b=0,c=0;c<a;c++)d=this.read(),b|=d<<c;return b}for(e=0,c=3;c>=0;c--)e+=this.readByte(),c>0&&(e<<=8);return e}},{key:"readLong",value:function m(){var a,b=0;for(a=7;a>=0;a--)b+=this.readByte(),a>0&&(b<<=8);return b}},{key:"readShort",value:function n(){var a,b=0;for(a=1;a>=0;a--)b+=this.readByte(),a>0&&(b<<=8);return b}},{key:"readFloat",value:function o(){var a,b,c=new ArrayBuffer(4),d=new DataView(c);for(a=0;a<4;a++)d.setUint8(a,this.readByte());return b=d.getFloat32(0)}},{key:"readDouble",value:function p(){var a,b,c=new ArrayBuffer(8),d=new DataView(c);for(a=0;a<8;a++)d.setUint8(a,this.readByte());return b=d.getFloat64(0)}},{key:"readBool",value:function q(){return this.read()>0}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],17:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.store=b,this.effectiveTypes={"slow-2g":1,"2g":2,"3g":3,"4g":4},this.types={bluetooth:1,cellular:2,ethernet:3,none:4,wifi:5,wimax:6,other:7,unknown:8},this.navigatorConnection={},this._detectConnectionType()}return e(a,[{key:"_detectConnectionType",value:function b(){var a,b=this,c=navigator.connection||navigator.mozConnection||navigator.webkitConnection;c?(a=function d(){var a=navigator.connection||navigator.mozConnection||navigator.webkitConnection,c=a.effectiveType||"",d=a.type||"";b.navigatorConnection={browserSupport:!0,downlink:a.downlink||0,effectiveType:c,type:d,effectiveTypeId:b.effectiveTypes.hasOwnProperty(c)?b.effectiveTypes[c]:0,typeId:b.types.hasOwnProperty(d)?b.types[d]:0,rtt:a.rtt||0,saveData:a.saveData||!1},b.store.set("navigatorConnection",b.navigatorConnection),b.store.emit("navigatorConnectionChange",b.navigatorConnection)},c.onchange=a,a()):(this.navigatorConnection={browserSupport:!1},this.store.set("navigatorConnection",this.navigatorConnection))}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],18:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./PerformanceSampler"),i=e(h),j=a("../vpaidjs/OpportunityType"),k=e(j),l=a("../player/utils"),m=d(l),n=70,o=function(){function a(b,c){f(this,a),this._store=b,this._intervalDuration=this._store.get("kpitrvldrt"),this._numOfSamplesPerMeasurment=this._store.get("prfsmpmsnt"),this._durationOfSamplePerMeasurment=this._store.get("prfsmitrvpmsnt"),this._playerOpportunityManager=c,this.dataSaverUrl=this._store.get("dtsvrurl"),this._addListeners(),this._startLoopTimeInterval(),this._measure(),this._runFirstMeasurmentCycle()}return g(a,[{key:"_addListeners",value:function b(){this._store.once("stop",this._onStop.bind(this)),this._store.once("beforeunload",this._onBeforeunload.bind(this))}},{key:"_startLoopTimeInterval",value:function c(){var a,b=this._store.get("msrkpifctr")||100;b=Math.min(100,b),1!==b&&m.getRandomInt(0,b)!==b||(a=m.normalizeMilliseconds(this._store.get("msrkpiintvl")||15),this._loopInterval=setInterval(this._sendLoopKpiPixel.bind(this),a))}},{key:"_sendLoopKpiPixel",value:function d(){var a=m.createPixelParams(n,this._store);a.kpipm=this._store.get("performance.performanceMeasurment"),a.kpinw=this._store.get("performance.wfRoundTripAverageDuration"),m.sendPixel(a,this._store)}},{key:"_measure",value:function e(){var a=this;this._running=!0,this._runSampling("first_kpi"),this.intervalMeasureId=setInterval(function(){a._runSampling("last_kpi")},this._intervalDuration)}},{key:"_runSampling",value:function h(a){var b=this,c=new i["default"];c.runEventLoopSampling(this._numOfSamplesPerMeasurment,this._durationOfSamplePerMeasurment).then(function(d){b._store.set(a,d),b._saveData(d),c.cleanResources()}),this._measureDataSaverRoundtripDuration()}},{key:"_measureDataSaverRoundtripDuration",value:function j(){var a,b,c=this;this.dataSaverUrl&&(a=(new Date).getTime(),b=new XMLHttpRequest,b.onreadystatechange=function(){b.readyState==XMLHttpRequest.DONE&&c._store.set("performance.dtsvrRoundTripAverageDuration",(new Date).getTime()-a)},b.open("GET",this.dataSaverUrl,!0),b.send(null))}},{key:"_sendOpp",value:function l(a){this._playerOpportunityManager.send(a)}},{key:"_runFirstMeasurmentCycle",value:function o(){var a=this,b=new i["default"];b.runOneEventLoopSampling().then(function(b){a._saveData(b),a._sendOpp(k["default"].firstWfMeasurment)})}},{key:"_saveData",value:function p(a){this._store.set("performance.wfRoundTripAverageDuration",this._store.get("waterfall_data.average_duration")),this._store.set("performance.performanceMeasurment",Math.round(a))}},{key:"_onBeforeunload",value:function q(){this._destroy()}},{key:"_onStop",value:function r(){this._destroy()}},{key:"_destroy",value:function s(){this._running&&(clearInterval(this.intervalMeasureId),clearInterval(this._loopInterval),this._running=!1,this._saveData(this._store.get("last_kpi")),this._sendOpp(k["default"].playerClosedMeasurment))}}]),a}(),c["default"]=o,b.exports=c["default"]},{"../player/utils":38,"../vpaidjs/OpportunityType":53,"./PerformanceSampler":21}],19:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b,c){d(this,a),this.parent=b,this.getAdSkippableRemainingTime=this.build_vpaid_get_controller(b,"getAdSkippableRemainingTime",-1),this.getAdLinear=this.build_vpaid_get_controller(b,"getAdLinear",!0),this.getAdWidth=this.build_vpaid_get_controller(b,"getAdWidth",0,"width"),this.getAdHeight=this.build_vpaid_get_controller(b,"getAdHeight",0,"height"),this.getAdExpanded=this.build_vpaid_get_controller(b,"getAdExpanded",!0),this.getAdSkippableState=this.build_vpaid_get_controller(b,"getAdSkippableState",!0),this.getAdRemainingTime=this.build_vpaid_get_controller(b,"getAdRemainingTime",-1),this.getAdDuration=this.build_vpaid_get_controller(b,"getAdDuration",-1),this.getAdCompanions=this.build_vpaid_get_controller(b,"getAdCompanions",[]),this.getAdIcons=this.build_vpaid_get_controller(b,"getAdIcons",[]),this.pauseAd=this.build_vpaid_set_controller(b,"pauseAd"),this.resumeAd=this.build_vpaid_set_controller(b,"resumeAd"),this.expandAd=this.build_vpaid_set_controller(b,"expandAd"),this.collapseAd=this.build_vpaid_set_controller(b,"collapseAd"),this.skipAd=this.build_vpaid_set_controller(b,"skipAd"),this.stopAd=this.build_vpaid_set_controller(b,"stopAd"),this.store=c,this.isMultiAdsActive=this.store.get("mltads")}return e(a,[{key:"startAd",value:function b(){this.parent.vpaidHandler.startAd()}},{key:"getAdVolume",value:function c(){if(!this.isMultiAdsActive){var a=this.parent.volume();return a}}},{key:"setAdVolume",value:function f(a,b){this.isMultiAdsActive||this.store.get("forceMute")&&a>0||(this.parent.volume(a),this.parent.runningVpaid&&this.parent.runningVpaid.vpaid&&this.parent.runningVpaid.vpaid.setAdVolume(a))}},{key:"resizeAd",value:function g(a,b,c){if(!this.isMultiAdsActive)return!!this.parent.runningVpaid&&this.parent.runningVpaid.resize(a,b,c)}},{key:"muteAd",value:function h(){}},{key:"unmuteAd",value:function i(){}},{key:"setParam",value:function j(a,b){return this.store(a,b)}},{key:"getParam",value:function k(a){return this.store(a)}},{key:"build_vpaid_set_controller",value:function l(a,b){var c=function d(){return!!a.scheduleMaster.gotVpaid&&(!!a.scheduleMaster.runningVpaid.vpaid[d.type]&&a.scheduleMaster.vpaid[d.type]())};return c.proxy=a,c.type=b,c}},{key:"build_vpaid_get_controller",value:function m(a,b,c,d){var e=function f(){return a.scheduleMaster.gotVpaid?a.scheduleMaster.vpaid[f.type]():f.default_value_key&&void 0!=a.options[f.default_value_key]?a.options[f.default_value_key]:f.default_value};return e.proxy=a,e.default_value=c,d?e.default_value_key=d:e.default_value_key=void 0,e.type=b,e}},{key:"gotVpaid",get:function n(){return!!(this.parent&&this.parent.scheduleMaster&&this.parent.scheduleMaster.gotVpaid)}},{key:"gotAd",get:function o(){return!(!this.gotVpaid||!this.parent.scheduleMaster.runningVpaid.adPlaying)}}]),a}(),c["default"]=f,f.prototype.getAdSkippableRemainingTime=f.prototype.build_vpaid_get_controller(parent,"getAdSkippableRemainingTime",-1),b.exports=c["default"]},{}],20:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){function b(){var a,b,c,d;if(this.isMobile){if(a=this.store.get("forcecnvsmpg"),b=this.store.get("useapforcntnt"),a&&!b)return this.store.set("hasAutoPlay",!1),void(this.hasAutoPlay=!1);c=this.store.get("ua"),d=new A["default"](c),d.isAutoplaySupported()?(this.store.set("hasAutoPlay",!0),this.hasAutoPlay=!0):(this.store.set("hasAutoPlay",!1),this.hasAutoPlay=!1)}}var c,d,e,f,g,i,k,n,p,r,t,v,x,z,B,D,F,H,J=this;this.overrideWindowMethods=function(){Object.assign=function(a){var b,c,d;for(b=1;b<arguments.length;b++){c=arguments[b];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}},c=w.parseUserAgent(),d=void 0==Object.assign||!w.isNativeCode(Object.assign),d&&this.overrideWindowMethods(),this.status="loading",this.videoLength=0,this.ga_set=!1,this.video=void 0,this.repeatCount=0,this.schedule={},this.playerIsClosed=!1,this.options=(0,m.getDefaults)(a),e=Object.assign((0,m.getUnitParams)(),a.dplayerSettings),this.options=Object.assign({},this.options,e),f=new o["default"](this.options),this.store=f,this.store.set("player_id",Date.now()+"_"+w.generateGuid(30)),this.store.set("fullPageUrl",window.location.href),this.store.set("forcePause",!1),this.store.set("forceMute",!1),this.store.set("dataSaverDetected",!1),this.store.set("conversionsCount",0),this.store.set("getAdData.count",0),this.store.set("playerAspectRatio",this.options.aspect_ratio),this.store.set("noplrcntr",this.store.get("noplrcntr")&&this.store.get("isMultiVpaidUnit")),l["default"].prototype.debugLevels=this.store.get("debugLevels")||"",this.logConnectionType=function(a){var b="unknown",c={1:"dialup",2:"wired",3:"wifi",4:"mobile",5:"satellite"};a&&(b=c.hasOwnProperty(a)?c[a]:a.toString()),this.store.set("connectionType",{type:b})},g={};try{i=new E["default"](a.auc_dast,this.store),g=i.fetchResults(),g&&(g.sesid&&this.store.set("sessionId",g.sesid),this.logConnectionType(g.ct))}catch(L){this.store.set("dastDecoderError",w.stringify(L))}return this.store.set("dast",g),g.hasOwnProperty("abt")&&(this.store.set("dast_AbTest",g.abt),this.store.set("abTest",this.store.get("abTest")?this.store.get("abTest")+"|"+g.abt:g.abt)),k=this.store.get("isMobile"),n=this.store.get("measureKPI"),(k||n)&&(this.playerOpportunityManager=new K["default"](this.store)),this.dependenciesLoader=new S["default"](this.store),this.dependenciesLoader.getDynamicSettings(),p=this.store.getLatestVersion("prtct"),p&&p.value&&(r=p.value.match(/(?:\/vpaid\/hjk.)(.*).js/),r&&2===r.length&&(t=r[1],this.dependenciesLoader.get("hjk",t,"hjkFuncString",p.value,this.store.get("hjkclb")))),v=this.store.getLatestVersion("anltcsurl"),v&&v.value&&(x=v.value.match(/(?:\/vpaid\/vpaidAnalytics.)(.*).js/),x&&2===x.length&&(z=x[1],this.dependenciesLoader.get("vpaidAnalytics",z,"analyticsFuncString",v.value,this.store.get("anltcsclb")))),this.store.get("base_url")&&0!==this.store.get("base_url").length||(this.store.set("original_base_url","empty"),this.store.set("href",window.location.href),this.store.set("base_url","//www.cmbestsrv.com")),this.resourceLoader=new G["default"](this.store),this.store.set("resourceLoader",this.resourceLoader),this.store.get("loadrsrc")&&this.resourceLoader.loadCSSResources(document),this.connectionTypeDetector=new U["default"](this.store),this.store.set("queueLength",0),this.store.set("vpaidReadyCount",0),this.store.set("document.visible",!document.hidden),w.reportDebug("player_waterfall","ctor1",{type:"debug",message:"ctor1",options:this.store.data},this.store),f.set("ads_playing",0),f.set("ads_started",0),f.set("total_impressions",0),n&&(this.KPIsRecorder=new y["default"](this.store,this.playerOpportunityManager)),this.options.schedule&&this.options.schedule.length&&this.options.schedule[0].ad_parameters&&this.options.schedule[0].ad_parameters.length>2&&f.set("static_schedule",this.options.schedule),this.overrideNonNativeFunctions=function(){var a,b,c=this.store.get("ovrdnonntvfnclst");if(Object.keys(c).length>0){a=document.createElement("iframe"),a.style.width=0,a.style.height=0,a.style.visibility="hidden",a.style.display="none",document.body.appendChild(a);for(b in c)w.isNativeCode(window[b])||(window[b]=c[b](a))}},this.overrideNonNativeFunctions(),this.isMobile=this.store.get("isMobile"),b.call(this),this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit"),B=this,D=36e5*(this.store.get("kill_after_hour")||0),D&&setTimeout(function(){B.closeCleanPlayer("kill_after_hour")},D),window.addEventListener("beforeunload",function(a){J.store.emit("beforeunload")}),this.store.on("AdImpression",function(){B.killAfterXWithNoConversion()}),this.playerStatus="content",this.store.on("AdPlayerVisible",function(){if(!this.playerIsClosed){this.playerStatus="ad";var a={playerState:this.playerStatus,isVisible:!1};this.VideoControls&&(this.isMobile?this.VideoControls.setState(a):(this.wasContentPausedBeforeAd=this.VideoControls.getValueFromControlsState("isPaused"),a.isPaused=!1,this.VideoControls.setState(a),this.runningVpaid&&(this.runningVpaid.vpaid.vpaidHandler.setPaused(!1),this.runningVpaid.vpaid.vpaidHandler.volume(this.VideoControls.getValueFromControlsState("volume")))),this.store.emit("playerStatusChanged",this.playerStatus))}}.bind(this)),this.store.on("AdPlayerHidden",function(){if(!this.playerIsClosed){this.playerStatus="content";var a={playerState:this.playerStatus,isVisible:!0};this.VideoControls&&(this.isMobile?(this.volume(0),this.VideoControls.setState(a)):(a.isPaused=this.wasContentPausedBeforeAd,this.VideoControls.setState(a),this.volume(this.VideoControls.getValueFromControlsState("volume"))),this.store.emit("playerStatusChanged",this.playerStatus))}}.bind(this)),this.debugTracker=new l["default"]("OvaMediaPlayer"),this.debugTracker.info("unit-version: "+this.store.get("unit_loader_version")+", player-version: "+this.store.get("player_version"),this.store,{color:"#D15EFF"}),this.seek=function(a){if(!this._isAdState())try{if(void 0==a)return this.video.currentTime;if(isNaN(parseFloat(a)))return;this.video.currentTime=parseFloat(a)}catch(b){return 0}},this.killAfterXWithNoConversion=function(){var a=this.store.get("kaxwnc");a&&(this.kaxwnc&&clearTimeout(this.kaxwnc),this.kaxwnc=setTimeout(function(){B.closeCleanPlayer("killAfterXWithNoConversion")},a))},this.killAfterXWithNoConversion(),this.play=function(){if(!this.store.get("forcePause"))return this._isAdState()?void this.vpaidHandler.vpaid.manager.play():void this.video.play()},this.pause=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.pause():(this.store.emit("contentPaused"),
void this.video.pause())},this.resume=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.play():(this.store.emit("contentResumed"),void("paused"==this.status&&this.video.play()))},this.stop=function(){try{if("stopped"==this.status||this._isAdState())return;this.status="stopping",this.video.pause(),this.seek(0),this.status="stopped",this.options.onPlayerStop(this)}catch(a){}},this.resize=function(a,b,c){this.vpaidManager&&this.vpaidManager.resize(a,b);var d=0,e=0,f=0;try{(void 0==a||isNaN(parseInt(a)))&&(a=!1),(void 0==b||isNaN(parseInt(b)))&&(b=!1),a||b||(this.debugTracker.error("resize","No `height` or `width` specified!"),a=this.store.get("width"),b=this.store.get("height")),b&&a?(this.options.height=b+"",this.options.width=a+"",this.setVideoSize(this.options.width.search(/px$/g)>-1?this.options.width:this.options.width+"px",this.options.height.search(/px$/g)>-1?this.options.height:this.options.height+"px")):(c&&c.split(":").length>1&&(this.options.aspect_ratio=c),a?(this.options.height=!1,this.options.width=a+"",f=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0],d=this.options.width.search(/px$/g)>-1?this.options.width:parseFloat(this.options.width)+"px",e=Math.floor(parseFloat(d)*f)+"px",this.setVideoSize(d,e)):(this.options.width=!1,this.options.height=b+"",f=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1],e=this.options.height.search(/px$/g)>-1?this.options.height:parseFloat(this.options.height)+"px",d=Math.floor(parseFloat(e)*f)+"px",this.setVideoSize(d,e)))}catch(g){this.debugTracker.error("resize","Resizing component failed!")}},this.setVideoSize=function(a,b){this.isMultiVpaidUnit||(this.store.get("noplrcntr")||(this.target.style.width=a,this.target.style.height=b,this.target.setAttribute("width",parseInt(a)),this.target.setAttribute("height",parseInt(b))),this.video.style.width=a,this.video.style.height=b,this.video.setAttribute("width",parseInt(a)),this.video.setAttribute("height",parseInt(b))),this.scheduleMaster.runningVpaid&&!this.scheduleMaster.runningVpaid.finished&&this.scheduleMaster.runningVpaid.resize(parseInt(a),parseInt(b))},this.handleTarget=function(a){var b;return b=this.store.get("noplrcntr")?document.querySelector(a):"string"==typeof a?document.getElementById(a):a},this.stringToSeconds=function(a){var b,c,d=a.split(":"),e=[];for(b=0;b<d.length;b++)e.push(isNaN(parseInt(d[b]))?0:parseInt(d[b]));switch(c=0,e.length){case 1:c=parseInt(a);break;case 2:c=60*parseInt(e[0])+parseInt(e[1]);break;case 3:c=3600*parseInt(e[1])+60*parseInt(e[1])+parseInt(e[2])}return c},this.secondsToString=function(a){var b,c;return a=Math.floor(a),b=(a-a%3600)/3600,b=b<10?"0"+b:b,a-=3600*b,c=(a-a%60)/60,c=c<10?"0"+c:c,a-=60*c,a=a<10?"0"+a:a,(b>0?b+":":"")+c+":"+a},this.generateId=function(){for(var a="vpaid-"+Math.floor(65536*(1+Math.random()));document.getElementById(a);)a="vpaid-"+Math.floor(1e5*Math.random());return a},this.ova=new h["default"](this,this.store),this.initVpaidManager=function(){this.vpaidManager=new u["default"](this.store,this)},this.store.on("closePlayer",function(){J.closePlayer()}),this.initScheduleMaster=function(){this.scheduleMaster=new j["default"](this,this.store),this.store.get("vForce")&&this.scheduleMaster.disable()},this.initScheduleMaster(),this.handlePlayerPause=function(){if(!this.playerIsClosed)switch(this.status){case"loading-play":case"playing":this.status="paused",this.options.onPlayerPause(this);break;default:return}},this.handlePlayerPlay=function(){if(!this.playerIsClosed)switch(this.status){case"loading":this.status="loading-play";break;case"ended":this.status="playing",window.setTimeout(function(){!this.playerIsClosed&&this.options._onPlayerRepeat&&this.options._onPlayerRepeat()}.bind(this),0),window.setTimeout(function(){!this.playerIsClosed&&this.options._onPlayerRepeat&&this.options._onPlayerRepeat()}.bind(this),0),window.setTimeout(function(){!this.playerIsClosed&&this.options.onPlayerPlay&&this.options.onPlayerPlay()}.bind(this),0);break;case"loading-play":case"stopped":case"paused":this.status="playing",window.setTimeout(function(){!this.playerIsClosed&&this.options.onPlayerResume&&this.options.onPlayerResume()}.bind(this),0);break;default:return}},this._onPlayerRepeat=function(){this.repeatCount++},this.handleOnCanPlay=function(){if(!this.playerIsClosed)switch(this.status){case"loading-play":this.status="playing",this.createSchedule(),window.setTimeout(function(){this.onPlayerReadyRun(),this.options.onPlayerReady()}.bind(this),0),window.setTimeout(function(){this.options.onPlayerPlay()}.bind(this),0);break;case"loading":this.createSchedule(),window.setTimeout(function(){this.onPlayerReadyRun(),this.options.onPlayerReady()}.bind(this),0);break;default:return}},this.handlePlayerEnd=function(){if(!this.playerIsClosed)switch(this.store.emit("contentChanged"),this.status){case"playing":window.setTimeout(function(){this.options.onPlayerPause()}.bind(this),0);case"paused":this.status="ended",this.options.repeat?window.setTimeout(function(a){a.play()}.bind(this,this.video),0):(this.options.onPlayerComplete(this),this.options.onPlayerStop(this));break;default:return}},this.handlePlayerSeeked=function(a){this.playerIsClosed||window.setTimeout(function(){this.options.onPlayerSeek()}.bind(this),0)},this.handlePlayerError=function(a){this.status="stopping",this.video.pause(),this.status="loading",this.options.onPlayerError(this,a)},this.handlePlayerVolume=function(){this.debugTracker.info("Event","Player Volume Was Changed!")},this.muteToggle=function(){this.options.mute?this.unMute():this.mute()},this.mute=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.mute():(this.video.muted=this.options.mute=!0,this.vpaidManager&&this.vpaidManager.mute(),void this.volume(0))},this.unMute=function(){return this._isAdState()?void this.vpaidHandler.vpaid.manager.unmute():(this.video.muted=this.options.mute=!1,this.vpaidManager&&this.vpaidManager.unmute(this.options.volume>1?this.options.volume/100:this.options.volume),void this.volume(this.options.volumeBeforeMute))},this.volume=function(a){if("stopped"!=this.status&&!(this.store.get("forceMute")&&a>0)){if(this.vpaidManager&&this.vpaidManager.volume(a),void 0==a)return this._getCurrentVolume();if(!(this.options.videoControlsForceMute&&a>0))return 0===a&&0!=this.options.volume&&(this.options.volumeBeforeMute=this.options.volume),this.options.volume=a,a=a>1?a/100:a,0==a?(this.video.muted=this.options.mute=!0,this.video.volume=0):(this.video.muted=this.options.mute=!1,this.video.volume=a),B.store.set("volume",a),this.VideoControls&&this.VideoControls.setState({volume:a}),a}},this._getCurrentVolume=function(){return this._isAdState()?this.vpaidHandler.vpaid.manager.getCurrentWorkingVpaidVolume():this.options.volume},this.onPlayerReadyRun=function(){var a,b=this.onPlayerReadyActions.length;if(0!=b){for(a=0;a<b;a++)this.onPlayerReadyActions[a].apply(this,[]);this.onPlayerReadyActions=new Array}},this.onPlayerReadyActions=new Array,this.attachEventsToVideo=function(a){var b,c,d,e,f,g=this,h=this,i=function j(a){j.player.handlePlayerSeeked(a)};i.player=this,a.addEventListener("seeked",i,!0),b=function k(){k.player.handleOnCanPlay()},b.player=this,a.addEventListener("canplay",b,!0),c=function l(){l.player.handlePlayerPlay()},c.player=this,a.addEventListener("play",c,!0),d=function m(){m.player.handlePlayerPause()},d.player=this,a.addEventListener("pause",d,!0),e=function n(){n.player.handlePlayerEnd()},e.player=this,a.addEventListener("ended",e,!0),f=function o(a){h.isMobile||h.handlePlayerError(a)},f.player=this,h=this,a.addEventListener("error",f,!0),a.addEventListener("click",function(){0===a.currentTime&&this.store.get("dataSaverDetected")&&(a.play(),h.VideoControls&&h.VideoControls.setState({isPaused:!1}))}),this.contentInterval=setInterval(function(){var a=h.video.currentTime,b=h.video.duration;g.store.set("contentTime",a),g.store.set("contentDuration",b)},5e3)},this._switchToCanvas=function(a){var b,c,d,e=this;this.isCanvas=!0,this.playerOpportunityManager.send(I["default"].fallBackCanvas),this._shouldPlayContent()&&(b=this,c=function f(){b.canvas.destroy(),b.store.set("sncad",!0),b.canvas=!1},d="",a.src?d=a.src:this.options.files.map(function(a){if(!d){if(/\.mpg$/.test(a.url)||/\.mpeg$/.test(a.url))return;d=a.url}}),this.canvas=new s["default"](a,{_onPlayerError:c},(!0),{position:"absolute",zIndex:102},this.store,this.store.get("repeat"),this.target),this.canvas.on("newVidCreated",this._onNewVidCreated.bind(this)),this.isCanvaMode=!0,setTimeout(function(){a._vidSetAttr("src",""),setTimeout(function(){e.canvas&&(e.canvas.setSrc(d),a.style.display="none",e.handleOnCanPlay())},2e3)},2))},this.createMediaPlayer=function(){var b,c,d,e,g,h,i,j,k,l;this.store.get("noplrcntr")||(this.target.className+=" vpaid-player-container",this.isMultiVpaidUnit&&w.addClass(this.target,"multi-vpaids")),b=document.createElement("video"),this.playerTag=b,b.id=this.generateId(),b.className=this.options.video_class_name,this.isMultiVpaidUnit&&w.addClass(b,"multi-vpaids"),b.style.cssText="position: relative; z-index:99; cursor:pointer; display:block",b.setAttribute("playsinline",""),b.setAttribute("autoplay",""),this.isMobile&&this.hasAutoPlay&&(c=this.store.get("ua"),"Android"===c.os.name?(d=function n(){this.store.get("dataSaver")&&(this.store.set("forcecnvsmpg",!0),this._switchToCanvas(b),this.VideoControls&&this.VideoControls.setCanvas(this.canvas))},this.store.get("dtsvr")?(f.on("dataSaverDetectionFinished",d.bind(this)),C["default"].detect(this.store)):this.store.get("dataSaver")?(this.store.set("serverSideDataSaver","on"),d.call(this)):this.store.set("serverSideDataSaver","off")):"iOS"===c.os.name&&(b.removeAttribute("autoplay",""),b.setAttribute("muted",""),b.muted=!0)),this.attachEventsToVideo(b),this.isMultiVpaidUnit&&(this.options.height||this.options.width?this.options.height&&this.options.width?(b.style.height=this.options.height.search(/px$/g)>-1?this.options.height:this.options.height+"px",b.style.width=this.options.width.search(/px$/g)>-1?this.options.width:this.options.width+"px"):this.options.width?(e=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0],b.style.width=this.options.width.search(/px$/g)>-1?this.options.width:parseFloat(this.options.width)+"px",b.style.height=Math.floor(parseFloat(b.style.width)*e)+"px"):(g=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1],b.style.height=this.options.height.search(/px$/g)>-1?this.options.height:parseFloat(this.options.height)+"px",b.style.width=Math.floor(parseFloat(b.style.height)*g)+"px"):this.debugTracker.error("createMediaPlayer","No `height` or `width` specified!")),b.muted=!0,b.setAttribute("width",parseFloat(b.style.width)+""),b.setAttribute("height",parseFloat(b.style.height)+""),b.setAttribute("playsinline",""),h=this,setTimeout(function(){try{h.handleOnCanPlay()}catch(a){}},200),this.options.repeat&&(b.playerRepeat=!0),this.options.image&&b.setAttribute("poster",this.options.image);try{if(this._shouldPlayContent())for(i=0;i<this.options.files.length;i++)j=this.options.files[i],/\.mpg$/.test(j.url)||/\.mpeg$/.test(j.url)||(this.isMobile&&!this.hasAutoPlay?this.playerTag.src=j.url:(k=document.createElement("source"),k.setAttribute("type",j.type),k.src=j.url,b.name||(b.name=j.name?j.name:j.url),b.appendChild(k)))}catch(m){this.debugTracker.error("createMediaPlayer","Files array supplied is corrupted or malformed!")}this._shouldPlayContent()&&this.target.appendChild(b),this.video=b,this.store.get("noplrcntr")||(this.target.id="_cm-css-reset"),this.isMobile&&!this.hasAutoPlay?this._switchToCanvas(b):b.volume=this.options.volume/100,l=!this.isMobile&&(this.options.controls||this.store.get("ad_controls"))||this.isMobile&&this.options.controls,this.store.set("useVideoControls",!0),l&&this._shouldPlayContent()&&this.addVideoControls(),this.volume(this.options.mute?0:this.options.volume),this.setVideoSize(a.width+"px",a.height+"px"),this.VideoControls&&this.VideoControls.setState({playerState:this.playerStatus})},this._shouldPlayContent=function(){return!this.store.get("vForce")||this.store.get("cntonvfrc")},this._onNewVidCreated=function(a){this.video.parentElement.removeChild(this.video),this.video=a,this.canvas=!1,this.VideoControls&&(this.VideoControls.setCanvas(this.canvas),this.VideoControls.setVideo(this.video))},this.addVideoControls=function(){this.VideoControls=new q["default"](this.video,this.store,this.target,"content"),this.canvas&&this.VideoControls.setCanvas(this.canvas),this.store.on("videoControlsVolume",this._onVideoControlVolumeChanged.bind(this)),this.store.on("volumeBeforeMuteChanged",this._onVideoControlsVolumeBeforeMuteChanged.bind(this)),this.isMobile||(this.store.on("videoControlsMute",this._onVideoControlMuteChanged.bind(this)),this.store.on("videoControlsPause",this._onVideoControlPauseChanged.bind(this)),this.store.on("videoProgressBar",this._onVideoProgressBarChanged.bind(this)))},this._onVideoControlsVolumeBeforeMuteChanged=function(a){this.options.volumeBeforeMute=a},this._isAdState=function(){return"ad"===this.playerStatus},this._onVideoControlMuteChanged=function(a){this.options.videoControlsForceMute=a,this.store.set("forceMute",a),a?this.mute():this.unMute()},this._onVideoControlVolumeChanged=function(a){this.options.videoControlsForceMute=!1,this.store.set("forceMute",0===a),this.volume(a)},this._onVideoControlPauseChanged=function(a){this.store.set("forcePause",a),a?this.pause():this.video.currentTime===this.video.duration?this.play():this.resume()},this._onVideoProgressBarChanged=function(a){if(!this._isAdState()){var b=Math.floor(a*this.video.duration);this.store.emit("videoProgressBarTransition",this.video.duration,b),this.video.currentTime=b}},this.onVpaidCreated=function(a){this.runningVpaid=a,this.vpaidHandler=a}.bind(this),this.store.on("vpaidHandlerCreated",this.onVpaidCreated),this.ga={sendGaMessage:function M(){}},B=this,this.createGA=function N(){},this.removeGA=function O(){this.ga_set},this.convertPreMidPostToTime=function(a,b){var c,d,e,f,g,h,i;if(b=Math.round(b),c={},d=this.options.schedule_auto,e=void 0,e=a["pre-roll"].length>0?a["pre-roll"][0]:a["mid-roll"].length>0?a["mid-roll"][0]:a["post-roll"].length>0?a["post-roll"][0]:void 0,void 0==e)return this.debugTracker.error("PreMidPostToTime","Error creating automatic schedule!Pleace check the schedule preset!"),{};for(c["00:00"]=e,f=[],a["mid-roll"].length>0?f=a["mid-roll"]:a["post-roll"].length>0?f=a["post-roll"]:f.push(e),g=void 0,g=a["post-roll"].length>0?a["post-roll"][0]:f[0];d<b;)h=this.secondsToString(d),i=f.shift(),f.push(i),d+=this.options.schedule_auto,d>b&&(i=g),c[h]=i;return c},this.createSchedule=function(){var a,b,c,d,e,f;if(!this.scheduleCreated&&!this.store.get("vForce")){for(this.scheduleCreated=!0,this.videoLength=this.video.duration,this.videoLength=this.videoLength||120,a=this.options.schedule,b={},c=this.options.schedule_auto,0===this.options.schedule_auto&&(this.options.schedule_auto=1),d=0;d<a.length;d++)if(e=a[d],this.options.schedule_auto)b[e.roll_type]||(b[e.roll_type]=[]),b[e.roll_type].push(e);else for(f=0;f<e.positions.length;f++)!b[e.positions[f]]&&this.videoLength-this.options.min_vpaid_run_time>this.stringToSeconds(e.positions[f])&&(b[e.positions[f]]=e);this.options.schedule_auto&&(b["pre-roll"]||(b["pre-roll"]=[]),b["mid-roll"]||(b["mid-roll"]=[]),b["post-roll"]||(b["post-roll"]=[]),b=this.convertPreMidPostToTime(b,this.videoLength)),this.options.schedule_auto=c,this.scheduleMaster.schedule=b,this.store.set("contentSchedule",b),this.scheduleMaster.start()}},this.setVideoFile=function(a,b,c){for(var d,e,f;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);b?this.video.setAttribute("poster",b):this.video.removeAttribute("poster"),c?(this.status="loading",this.video.setAttribute("autoplay","true")):this.video.removeAttribute("autoplay");try{for(this.video.removeAttribute("src"),d=0;d<a.length;d++)e=a[d],f=document.createElement("source"),f.setAttribute("type",e.type),f.src=e.url,this.video.name||(this.video.name=e.name?e.name:e.url),this.video.appendChild(f);this.video.load()}catch(g){this.debugTracker.error("setVideoFile","Error creating video sources!")}},this._onVpaidClosed=function(){},this._pausePlayer=function(){this.scheduleMaster.stop(!0),this.seek(0),this.stop(),this.store.emit("pausePlayer")},this.closePlayer=function P(){this._onVpaidClosed=this.closeCleanPlayer.bind(this,"_onVpaidClosed"),this.options.onPlayerClose(this),this.scheduleMaster.stop()},this.closeCleanPlayer=function(a){var b=this;this.store.set("playerClosed",!0),setTimeout(function(){if(a=a||"none",b.store.emit("stop","close:"+a),!b.playerIsClosed){if(clearInterval(b.contentInterval),b.vpaidManager&&b.vpaidManager.stop(),b.VideoControls&&b.VideoControls.destroy(),b.playerIsClosed=!0,b._onVpaidClosed=function(){},b.stop(),b.removeGA(),!b.store.get("noplrcntr"))for(;b.target.childNodes.length;)b.target.removeChild(b.target.childNodes[0]);b.onPlayerReadyActions=b.debugTracker=b.video=b.schedule=b.ova=b.ga=b.scheduleMaster=b.KPIsRecorder=b.VideoControls=void 0,b.options=b.target=void 0}},0)},this.target=this.handleTarget(a.target_id),this.target&&this.target.appendChild?(this.store.set("can_opt_out",this.store.get("can_opt_out")||null!==this.target.parentElement.querySelector("#_cm-opt-out-view")),this.options.htmlVideoSupport?this.createMediaPlayer():(this.debugTracker.error("Constructor","Browser does not support <video> Tag!Nothing to do, aborting..."),this.options.onPlayerLoadError(this)),F=this.store.get("base_url"),this.set=function(a,b){this.store.set(a,b)},this.get=function(a){return this.store.get(a)},this.on=function(a,b){this.store.on(a,b)},this.off=function(a,b){this.store.removeListener(a,b)},this.getVpaidLogs=function(){return this.vpaidManager?this.vpaidManager.getVpaidLogs():this.scheduleMaster?this.scheduleMaster.getVpaidLogs():void 0},this.startWaterfall=function(){try{this.scheduleMaster.vpaid.waterfallManager.start()}catch(a){return!1}return!0},this.stopWaterfall=function(){try{this.scheduleMaster.vpaid.waterfallManager.stop()}catch(a){return!1}return!0},this.emit=function(a,b){a&&this.store.emit(a,b)},H=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,H&&setTimeout(function(){B.handleOnCanPlay()},500),this.store.get("vForce")&&this.initVpaidManager(),this.getAd=function(a){if(this.vpaidManager)return this.vpaidManager.getAd(a)},this.startIdleMode=function(){this.store.set("isIdleMode",!0)},this.stopIdleMode=function(){this.store.set("isIdleMode",!1)},void(this.startWf=function(){this.store.emit("startWf")})):void this.debugTracker.error("Constructor","No player target!Can't build player in ["+this.target+"]... aborting!")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=f,g=a("./Ova"),h=e(g),i=a("./ScheduleMaster"),j=e(i),k=a("./Tracker"),l=e(k),m=a("./extendPlayerOptions"),n=a("./Store"),o=e(n),p=a("./VideoControls"),q=e(p),r=a("../vpaidjs/Mpg1Canvas"),s=e(r),t=a("./VpaidManager"),u=e(t),v=a("./utils"),w=d(v),x=a("./KPIsRecorder"),y=e(x),z=a("./AutoplayDetector"),A=e(z),B=a("./dataSaverDetector"),C=e(B),D=a("./dastDecoder"),E=e(D),F=a("./ResourceLoader"),G=e(F),H=a("../vpaidjs/OpportunityType"),I=e(H),J=a("../vpaidjs/PlayerOpportunityManager"),K=e(J),L=a("./assets/dsm/143/dsm.js"),M=d(L),N=a("./assets/hjk/211/hjk.js"),O=d(N),P=a("./assets/vpaidAnalytics/25/vpaidAnalytics.js"),Q=d(P),R=a("./dependenciesLoader"),S=e(R),T=a("./ConnectionTypeDetector"),U=e(T),window.OvaMediaPlayer=f,b.exports=c["default"]},{"../vpaidjs/Mpg1Canvas":50,"../vpaidjs/OpportunityType":53,"../vpaidjs/PlayerOpportunityManager":56,"./AutoplayDetector":15,"./ConnectionTypeDetector":17,"./KPIsRecorder":18,"./Ova":19,"./ResourceLoader":23,"./ScheduleMaster":24,"./Store":26,"./Tracker":27,"./VideoControls":28,"./VpaidManager":30,"./assets/dsm/143/dsm.js":31,"./assets/hjk/211/hjk.js":32,"./assets/vpaidAnalytics/25/vpaidAnalytics.js":33,"./dastDecoder":34,"./dataSaverDetector":35,"./dependenciesLoader":36,"./extendPlayerOptions":37,"./utils":38}],21:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j,k;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./Stopwatch"),h=d(g),i=a("bluebird"),j=d(i),k=function(){function a(){e(this,a),this._stopwatchs=[]}return f(a,[{key:"startSampling",value:function b(){var a=new h["default"];return this._stopwatchs.push(a),a.start(),this._stopwatchs.length-1}},{key:"stopSampling",value:function c(a){this._stopwatchs[a].stop()}},{key:"getDuration",value:function d(a){return this._stopwatchs[a].duration()}},{key:"runOneEventLoopSampling",value:function g(){var a=this;return new j["default"](function(b){var c=a.startSampling();setTimeout(function(){a.stopSampling(c),b(a.getDuration(c))},0)})}},{key:"runEventLoopSampling",value:function i(a,b){var c=this;return new j["default"](function(d){var e=[],f=0,g=setInterval(function(){f<a?(e.push(c.runOneEventLoopSampling()),f++):(clearInterval(g),j["default"].all(e).then(function(a){var b=a.reduce(function(a,b){return Math.max(a,b)},0);d(b)}))},b)})}},{key:"cleanResources",value:function k(){this._stopwatchs.length=0}}]),a}(),c["default"]=k,b.exports=c["default"]},{"./Stopwatch":25,bluebird:1}],22:[function(a,b,c){"use strict";function d(a,b,c,d,e,f){function g(a,b,c,d,e,f,g){var i,k;return!!a&&(b=b||"",i=new XMLHttpRequest,k=b?"POST":"GET",i.open(k,a,!0),i.withCredentials=!0,f===!1&&(i.withCredentials=!1),i.setRequestHeader("Content-type",j),i.async=void 0==e||e,i.callback="function"==typeof c?c:function(){},i.fallback="function"==typeof d?d:function(){},i.timeout=g,i.gotResponse=!1,i.addEventListener("error",function(a){this.gotResponse||(this.gotResponse=!0,i.fallback())}),i.addEventListener("load",function(a){this.gotResponse||(this.gotResponse=!0,i.fallback())}),i.addEventListener("abort",function(a){this.gotResponse||(this.gotResponse=!0,i.fallback())}),i.addEventListener("timeout",function(a){this.gotResponse||(this.gotResponse=!0,i.fallback())}),i.addEventListener("readystatechange",function(f){if(4==this.readyState){if(this.gotResponse)return;switch(this.gotResponse=!0,this.status+""){case"200":case"460":this.callback(this.responseText,m);break;default:if(!l)return m.push(this.status),void h(a,b,c,d,e,!1,g);m.push(this.status),this.fallback(m,a)}}}),i.send(b),!0)}function h(a,b,c,d,e,f,h){l=!0,g(a,b,c,d,e,!1,h)}var i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5e3,j=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"application/x-www-form-urlencoded",k=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],l=!k,m=[];g(a,b,c,d,e,f,i)}Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=d,b.exports=c["default"]},{}],23:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.store=b,this.baseUrl=this.store.get("base_url"),this.playerVersion=this.store.get("full_player_version"),this.useIframeOnVpaidWrapper=this.store.get("isMobile")&&this.store.get("usifrmonvpdwrpr"),this.deployFolder="/vpaid/vPlayer/player/v",this.filename=this.store.get("plyrcss"),this.css="player"==this.filename?'#_cm-css-reset { height: inherit; width: inherit; direction: ltr; text-align: left; } #_cm-css-reset.vpaid-player-container .vjs-tech { background-color: #000000; } #_cm-css-reset.vpaid-player-container { position: relative; z-index: 99; } #_cm-css-reset.vpaid-player-container video ~ iframe { z-index: 10; position: absolute; left: 0; top: 0; } #_cm-css-reset .vpaid-ad-controls { -webkit-transition: opacity 500ms ease-out; -moz-transition: opacity 500ms ease-out; -o-transition: opacity 500ms ease-out; transition: opacity 500ms ease-out; opacity: 0; } #_cm-css-reset.vpaid-player-container:hover .vpaid-ad-controls { opacity: 1; } #_cm-css-reset.vpaid-player-container .vpaid-ad-controls, #_cm-css-reset.vpaid-player-container .vpaid-ad-pause { height: 30px; right: 0; position: absolute; left: 0px; bottom: 0; z-index: 1001; background-color: rgba(0, 0, 0, 1); border-top: 1px rgba(255, 255, 255, 0.7) solid; } #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control { width: 2em; } /* #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control:before { line-height: 2; font-size: 16px; }*/ #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control.c-paused:before { content: "e001"; } #_cm-css-reset.vpaid-player-container .vpaid-ad-volume-container { height: 30px; width: 60px; position: relative; float: right; margin-right: 10px; top: 0; cursor: pointer; } #_cm-css-reset.vpaid-player-container .vpaid-ad-mute-container { height: 30px; width: 30px; position: relative; float: right; top: 0; cursor: pointer; } #_cm-css-reset.vpaid-player-container .vpaid-ad-volume-track { height: 8px; border: 1px #000000 solid; box-shadow: 0 0 5px 1px rgb(255, 255, 255); position: absolute; z-index: 0; right: 0; top: 11px; left: 0; background: rgba(51, 51, 51, 0.9) } #_cm-css-reset.vpaid-player-container .vpaid-ad-volume-slider { height: 8px; border: 1px #000000 solid; position: absolute; width: 40%; top: 11px; left: 0; background: rgba(183, 234, 187, 0.9); z-index: 1; } /*#_cm-css-reset .mpegcnv::before { content: ""; position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 100; }*/ #_cm-css-reset .tbl-text { font-family: Arial,Helvetica,sans-serif; white-space: nowrap; font-size: 11px; color: #fff; left: 10px; top: 4px; position: absolute; font-weight: bold; z-index: 1001; } #_cm-css-reset .mc-video { z-index: 101; } #_cm-css-reset .vpaid-handler { z-index: 1000; height: 100%; width: 100%; } #_cm-css-reset .speaker { position: absolute; width: 46px; height: 46px; bottom: -3px; right: -5px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset .speaker.mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset .hide { display: none } #_cm-css-reset .mc-loud-video{ position:absolute; pointer-events: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset .mc-loud-video::--webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works */ #_cm-css-reset .mc-loud-video::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls { display:none !important; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-enclosure { display:none !important; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show{ display: block; margin: 0; padding: 0; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show *{ position: absolute !important; display: block; margin: 0; padding: 0; background-color: transparent; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls { width: 100%; height: 100%; z-index: 1000; left: 0; bottom: -32px; -webkit-transition: bottom 0.35s ease-in-out; -moz-transition: bottom 0.35s ease-in-out; -o-transition: bottom 0.35s ease-in-out; transition: bottom 0.35s ease-in-out; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .control { z-index: 100; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .interactive { pointer-events: all; cursor: pointer; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.hide, #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .hide { display: none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show, #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .show { display: block; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_progressbar_area { width: 100%; height: 5px; bottom: 0%; cursor: default; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar { height: 100%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar_bg { width: 100%; height: 100%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .white_bg { background: rgba(255,255,255,0.3); } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; width: 0%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls { width: 100%; height: 27px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .play_pause { top: 3px; left: 5px; width: 20px; height: 20px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .play_pause .pause { width: 40px; height: 27px; top: -7px; left: -8px; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); background-size: 36px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .play_pause .play { border-top: 5px solid transparent; border-left: 10px solid #fff; border-bottom: 5px solid transparent; left: 6px; top: 5px; z-index: 102; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .title { top: 7px; left: 30px; width: 140px; text-align: left; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .cm_video_controls_main_area .timer { top: 6px; right: 110px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .text { color: white; font-size: 13px; font-weight: bold; font-family: Arial,Helvetica,sans-serif; top: 10px; left: 28px; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .text.opt-out-hidden { left: 13px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls { width: 100%; height: 100%; right: 0px; bottom: 0; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_mute { width: 35px; height: 27px; right: 8px; bottom: 5px; background-size: 44px; box-sizing: content-box; background-position-y: center; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_mute.display_mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_mute.display_unmute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .video-controls-scroller-area { width: 80px; height: 100%; right: 5px; top: 0%; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .playerSaveButton { position: absolute; border: 1px solid #fff; border-radius: 9px; width: 50px; height: 24px; top: 20%; left: 0; font-size: 14px; color: #fff; text-align: center; line-height: 24px; cursor: pointer; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls_mobile { width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1001; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area { pointer-events: none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause.hide { display: none; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause.show { display: block; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause { bottom: 28px; left: 5px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause .pause { width: 40px; height: 27px; top: -10px; left: -8px; background-image: url(data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>); background-size: 40px; } #_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .video_controls_main_area .cm_video_controls_playpause .play { border-top: 6px solid transparent; border-left: 10px solid #fff; border-bottom: 6px solid transparent; left: 7px; top: 3px; z-index: 102; } #_cm-css-reset .mc-play { width: 0; height: 0; border-top: 7px solid transparent; border-left: 9px solid #fff; border-bottom: 7px solid transparent; left: 14px; position: absolute; bottom: 10px; z-index: 1001; } #_cm-css-reset .mc-pause { display: block; width: 42px; height: 42px; left: -4px; position: absolute; bottom: -2px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); } #_cm-css-reset .mc-pause.hide, #_cm-css-reset .mc-play.hide { display: none; } #_cm-css-reset .mc-pause.show, #_cm-css-reset .mc-play.show { display: block; } #_cm-css-reset .mc-canvas { pointer-events: none; } #_cm-css-reset .mc-progressbar_area { width: 100%; height: 5px; bottom: 0%; position: absolute; z-index: 9999; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.white_bg { background: rgba(255,255,255,0.3); width: 100%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; position: absolute; bottom: 0%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset > .multi-vpaids { height: 0px; } #_cm-css-reset *::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset *::-webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works! */ #_cm-css-reset *::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .cm-ad-player { cursor: pointer; position: absolute; left: 0px; top: 0px; z-index: 0; } #_cm-css-reset ._cm-ad-feed-manager ._cm-ad { display: block !important; visibility: hidden !important; } #_cm-css-reset ._cm-ad-choices-player { position: absolute; top: 16px; left: 13px; } #_cm-css-reset ._cm-ad-choices-player-anchor { display: inline-block; opacity: 0.5; vertical-align: middle; }':'#_cm-css-reset .vjs-tech { background-color: #000000; } #_cm-css-reset video ~ iframe { z-index: 10; position: absolute; left: 0; top: 0; } #_cm-css-reset .vpaid-ad-controls { -webkit-transition: opacity 500ms ease-out; -moz-transition: opacity 500ms ease-out; -o-transition: opacity 500ms ease-out; transition: opacity 500ms ease-out; opacity: 0; } #_cm-css-reset:hover .vpaid-ad-controls { opacity: 1; } #_cm-css-reset .vpaid-ad-controls, #_cm-css-reset .vpaid-ad-pause { height: 30px; right: 0; position: absolute; left: 0px; bottom: 0; z-index: 1001; background-color: rgba(0, 0, 0, 1); border-top: 1px rgba(255, 255, 255, 0.7) solid; } #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control { width: 2em; } /* #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control:before { line-height: 2; font-size: 16px; }*/ #_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control.c-paused:before { content: "e001"; } #_cm-css-reset .vpaid-ad-volume-container { height: 30px; width: 60px; position: relative; float: right; margin-right: 10px; top: 0; cursor: pointer; } #_cm-css-reset .vpaid-ad-mute-container { height: 30px; width: 30px; position: relative; float: right; top: 0; cursor: pointer; } #_cm-css-reset .vpaid-ad-volume-track { height: 8px; border: 1px #000000 solid; box-shadow: 0 0 5px 1px rgb(255, 255, 255); position: absolute; z-index: 0; right: 0; top: 11px; left: 0; background: rgba(51, 51, 51, 0.9) } #_cm-css-reset .vpaid-ad-volume-slider { height: 8px; border: 1px #000000 solid; position: absolute; width: 40%; top: 11px; left: 0; background: rgba(183, 234, 187, 0.9); z-index: 1; } /*#_cm-css-reset .mpegcnv::before { content: ""; position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 100; }*/ #_cm-css-reset .tbl-text { font-family: Arial,Helvetica,sans-serif; white-space: nowrap; font-size: 11px; color: #fff; left: 10px; top: 4px; position: absolute; font-weight: bold; z-index: 1001; } #_cm-css-reset .mc-video { z-index: 101; } #_cm-css-reset .speaker { position: absolute; width: 46px; height: 46px; bottom: -3px; right: -5px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset .speaker.mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset .hide { display: none } #_cm-css-reset .mc-loud-video{ position:absolute; pointer-events: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset .mc-loud-video::--webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works */ #_cm-css-reset .mc-loud-video::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .mc-loud-video::-webkit-media-controls { display:none !important; } #_cm-css-reset .mc-loud-video::-webkit-media-controls-enclosure { display:none !important; } #_cm-css-reset ._cm-video-ad-iframe { border: none; } #_cm-css-reset._cm-video-ad .video_controls.show{ display: block; margin: 0; padding: 0; } #_cm-css-reset._cm-video-ad .video_controls.show *{ position: absolute !important; display: block; margin: 0; padding: 0; background-color: transparent; } #_cm-css-reset._cm-video-ad .video_controls { width: 100%; height: 100%; z-index: 1000; left: 0; bottom: -32px; -webkit-transition: bottom 0.35s ease-in-out; -moz-transition: bottom 0.35s ease-in-out; -o-transition: bottom 0.35s ease-in-out; transition: bottom 0.35s ease-in-out; } #_cm-css-reset._cm-video-ad .video_controls .control { z-index: 100; } #_cm-css-reset._cm-video-ad .video_controls .interactive { pointer-events: all; cursor: pointer; } #_cm-css-reset._cm-video-ad .video_controls.hide, #_cm-css-reset._cm-video-ad .video_controls .hide { display: none; } #_cm-css-reset._cm-video-ad .video_controls.show, #_cm-css-reset._cm-video-ad .video_controls .show { display: block; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_progressbar_area { width: 100%; height: 5px; bottom: 0%; cursor: default; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar { height: 100%; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_progressbar_area .cm_video_controls_progressbar_bg { width: 100%; height: 100%; } #_cm-css-reset._cm-video-ad .video_controls .white_bg { background: rgba(255,255,255,0.3); } #_cm-css-reset._cm-video-ad .video_controls .blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; width: 0%; } #_cm-css-reset._cm-video-ad .video_controls .blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset._cm-video-ad .video_controls { width: 100%; height: 27px; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .play_pause { top: 3px; left: 5px; width: 20px; height: 20px; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .play_pause .pause { width: 40px; height: 27px; top: -7px; left: -8px; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); background-size: 36px; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .play_pause .play { border-top: 5px solid transparent; border-left: 10px solid #fff; border-bottom: 5px solid transparent; left: 6px; top: 5px; z-index: 102; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .title { top: 7px; left: 30px; width: 140px; text-align: left; } #_cm-css-reset._cm-video-ad .video_controls .cm_video_controls_main_area .timer { top: 6px; right: 110px; } #_cm-css-reset._cm-video-ad .video_controls .text { color: white; font-size: 13px; font-weight: bold; font-family: Arial,Helvetica,sans-serif; top: 10px; left: 28px; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: default; } #_cm-css-reset._cm-video-ad .video_controls .text.opt-out-hidden { left: 13px; } #_cm-css-reset._cm-video-ad .video_controls { width: 100%; height: 100%; right: 0px; bottom: 0; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_mute { width: 35px; height: 27px; right: 8px; bottom: 5px; background-size: 44px; box-sizing: content-box; background-position-y: center; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_mute.display_mute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M20.22,26.66a.72.72,0,0,1-.41.65.71.71,0,0,1-.31.07.72.72,0,0,1-.46-.17L15.12,24H13a.72.72,0,0,1-.72-.72V20.38a.72.72,0,0,1,.72-.72h2.09L19,16.41a.72.72,0,0,1,1.18.55ZM26,27.76"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(62.22 18.06) rotate(135)"/><rect class="cls-1" x="26.15" y="16.31" width="2.43" height="11.22" rx="1.22" ry="1.22" transform="translate(31.23 56.77) rotate(-135)"/></svg>\'); } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_mute.display_unmute { background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><path class="cls-1" d="M22,27.26a.76.76,0,0,1-.44.69.75.75,0,0,1-.33.07.76.76,0,0,1-.49-.18l-4.19-3.47H14.33a.77.77,0,0,1-.77-.77V20.56a.77.77,0,0,1,.77-.77h2.23l4.19-3.47a.77.77,0,0,1,1.26.59Zm2.94-1.2h-.06a.76.76,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1-.07-1,4.45,4.45,0,0,0-.12-5.46.77.77,0,0,1,.05-1l.1-.1a.75.75,0,0,1,.58-.22.77.77,0,0,1,.56.28,6.13,6.13,0,0,1,.16,7.55.76.76,0,0,1-.56.31Zm3.17,2.37a.77.77,0,0,1-.55.27h0a.77.77,0,0,1-.54-.22l-.1-.1a.77.77,0,0,1,0-1,8.16,8.16,0,0,0-.13-10.67.77.77,0,0,1,0-1l.1-.1a.75.75,0,0,1,.56-.23.77.77,0,0,1,.55.26,9.84,9.84,0,0,1,.16,12.87Zm0,0"/></svg>\'); } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .video-controls-scroller-area { width: 80px; height: 100%; right: 5px; top: 0%; } #_cm-css-reset._cm-video-ad .playerSaveButton { position: absolute; border: 1px solid #fff; border-radius: 9px; width: 50px; height: 24px; top: 20%; left: 0; font-size: 14px; color: #fff; text-align: center; line-height: 24px; cursor: pointer; } #_cm-css-reset._cm-video-ad .video_controls_mobile { width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1001; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area { pointer-events: none; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause.hide { display: none; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause.show { display: block; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause { bottom: 28px; left: 5px; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause .pause { width: 40px; height: 27px; top: -10px; left: -8px; background-image: url(data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>); background-size: 40px; } #_cm-css-reset._cm-video-ad .video_controls .video_controls_main_area .cm_video_controls_playpause .play { border-top: 6px solid transparent; border-left: 10px solid #fff; border-bottom: 6px solid transparent; left: 7px; top: 3px; z-index: 102; } #_cm-css-reset .mc-play { width: 0; height: 0; border-top: 7px solid transparent; border-left: 9px solid #fff; border-bottom: 7px solid transparent; left: 14px; position: absolute; bottom: 10px; z-index: 1001; } #_cm-css-reset .mc-pause { display: block; width: 42px; height: 42px; left: -4px; position: absolute; bottom: -2px; z-index: 1001; background-image: url(\'data:image/svg+xml;charset=utf8,<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 44"><defs><style>.cls-1{fill:%23fff;}</style></defs><title>white_mobile icons_V1_NG_close</title><rect class="cls-1" x="17.23" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/><rect class="cls-1" x="23.63" y="15.39" width="3.14" height="13.22" rx="1.41" ry="1.41"/></svg>\'); } #_cm-css-reset .mc-pause.hide, #_cm-css-reset .mc-play.hide { display: none; } #_cm-css-reset .mc-pause.show, #_cm-css-reset .mc-play.show { display: block; } #_cm-css-reset .mc-canvas { pointer-events: none; } #_cm-css-reset .mc-progressbar_area { width: 100%; height: 5px; bottom: 0%; position: absolute; z-index: 9999; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.white_bg { background: rgba(255,255,255,0.3); width: 100%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg { background: rgba(21,75,145,1); -webkit-transition : width 0.5s ease; -moz-transition : width 0.5s ease; -o-transition : width 0.5s ease; transition : width 0.5s ease; position: absolute; bottom: 0%; height: 100%; } #_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg.init_bg { -webkit-transition : none; -moz-transition : none; -o-transition : none; transition : none; } #_cm-css-reset > .multi-vpaids { height: 0px; } #_cm-css-reset *::-webkit-media-controls-panel { display: none!important; -webkit-appearance: none; } /* Old shadow dom for play button */ #_cm-css-reset *::-webkit-media-controls-play-button { display: none!important; -webkit-appearance: none; } /* New shadow dom for play button */ /* This one works! */ #_cm-css-reset *::-webkit-media-controls-start-playback-button { display: none!important; -webkit-appearance: none; } #_cm-css-reset .cm-ad-player { cursor: pointer; position: absolute; left: 0px; top: 0px; z-index: 0; } #_cm-css-reset ._cm-ad-choices-player { position: absolute; top: 16px; left: 13px; } #_cm-css-reset ._cm-ad-choices-player-anchor { display: inline-block; opacity: 0.5; vertical-align: middle; }',
this.replacedCssMacro=this.css&&this.css.indexOf("_PLAYERCSS_")==-1&&this.css.indexOf("_PLAYERWITHOUTCONTAINERCSS_")==-1,this.playerCssUrl=""+this.baseUrl+this.deployFolder+this.playerVersion+"/assets/"+this.filename+".css"}return e(a,[{key:"loadCSSResources",value:function b(a){if(a){var b=null;this.useIframeOnVpaidWrapper&&this.replacedCssMacro?(b=document.createElement("style"),b.type="text/css",b.innerHTML=this.css):(b=document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.href=this.playerCssUrl),a.head.appendChild(b)}}},{key:"loadExternalResource",value:function c(a,b){var c=document.createElement("script");c.src=a,c.type="text/javascript",c.async=!0,c.onload=function(a){document.head.removeChild(c),b&&b(a)},document.head.appendChild(c)}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],24:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j,k,l;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./VpaidHandler"),h=d(g),i=a("./Tracker"),j=d(i),k=500,l=function(){function a(b,c){e(this,a),this.schedule={},this.parent=b,this.savedTime=-1,this.runningVpaid=!1,this.runningVpaidTagData={},this.runTimeId=0,this.bug_feature=b.options.bug_feature,this.vpaidCount=0,this._firstImpression=!1,this.minTimeBetweenRuns=5e3,this.store=c,this.lastEndedPlayedVpaid=-1e6,this.timeBetweenAds=this.store.get("schedule_auto"),this.store.on("stop",this.stop.bind(this)),this.useNewScheduler=this.store.get("evtbsschdl"),this.useNewScheduler&&(this._bindedLoop2=this._loop2.bind(this),this._bindedOnVpaidReady=this._onVpaidReady.bind(this),this._bindedOnVpaidEnded=this._onVpaidEnded.bind(this),this.loop2Ticker=setInterval(this._bindedLoop2,k))}return f(a,[{key:"stop",value:function b(){this.stopped=!0,window.clearTimeout(this.runTimeId),this.runningVpaid&&!this.runningVpaid.finished?(this.runningVpaid.stop(),this.savedTime=-1,this.parent=void 0,this.runningVpaid=void 0,this.schedule=void 0):(this.parent,this.savedTime=-1,this.parent=void 0,this.runningVpaid=void 0,this.schedule=void 0),this.useNewScheduler&&(this.store.removeListener("vpaidReady",this._bindedOnVpaidReady),this.store.removeListener("vpaidEnded",this._bindedOnVpaidEnded),clearInterval(this.loop2Ticker))}},{key:"stopVpaid",value:function c(){this.runningVpaid&&!this.runningVpaid.finished&&this.runningVpaid.stop()}},{key:"start",value:function d(){window.clearTimeout(this.runTimeId),this.useNewScheduler?(this.vpaidToRun={vpaid:this.schedule["00:00"],time:"00:00"},this.store.on("vpaidReady",this._bindedOnVpaidReady),this.store.on("vpaidEnded",this._bindedOnVpaidEnded),this._bindedLoop2()):this._loop()}},{key:"disable",value:function g(){this.isDisabled=!0}},{key:"_onVpaidReady",value:function i(a){this._loop2()}},{key:"_onVpaidEnded",value:function j(a){a.hadImpression&&(this.lastEndedPlayedVpaid=Date.now()),this._loop2()}},{key:"_loop2",value:function l(){if(!this.stopped&&!this.store.get("playerClosed")&&!this.isDisabled&&0===this.store.get("ads_started")){var a=Date.now()-this.lastEndedPlayedVpaid;a>=1e3*this.timeBetweenAds&&this.runVpaid(this.vpaidToRun.vpaid,this.vpaidToRun.time)}}},{key:"_loop",value:function m(){var a,b,c,d,e,f,g;if(!this.isDisabled){if(window.clearTimeout(this.runTimeId),a=this,b=Math.floor(this.parent.video.currentTime),this._isContentPaused()&&(b=NaN),1===this.timeBetweenAds||b!=this.savedTime&&!isNaN(b)&&"repeating"!=this.parent.status){if(this.savedTime>b&&(this.savedTime=-1),c=(new Date).getTime(),c-this.lastRun<this.minTimeBetweenRuns)return void(a.runTimeId=window.setTimeout(function(){a._loop()},1e3));for(isNaN(this.savedTime)&&(this.savedTime=0),d=this.savedTime+1,d>b&&(d=b),e={vpaid:!1,time:0};d<=b;)f=this.parent.secondsToString(d),this.schedule[f]&&(e.vpaid=this.schedule[f],e.time=f),d++;e.vpaid&&(window.lastRun=Date.now(),g=this.runVpaid(e.vpaid,e.time),g&&(this.lastRun=c)),this.savedTime=b}a.runTimeId=window.setTimeout(function(b){a._loop()},700)}}},{key:"_isContentPaused",value:function n(){return this.parent.canvas?"PAUSED"===this.parent.canvas.status:this.parent.video&&this.parent.video.paused}},{key:"runVpaid",value:function o(a,b){return this.runningVpaidTagData=a,this.vpaidCount++,a.vpaidCount=this.vpaidCount,this.runningVpaid?this.runningVpaid.run():(this.runningVpaid=new h["default"]({isFirstImpression:this.isFirstImpression,vpaidTag:a,uid:b,parent:this.parent,isPreRoll:"00:00"===b&&0===this.vpaidCount},this.parent.options,this.store),!0)}},{key:"_checkFirstImpression",value:function p(){var a=!this._firstImpression;return this._firstImpression=!0,a}},{key:"getTagData",value:function q(){return!!this.gotVpaid&&this.runningVpaidTagData}},{key:"getVpaidLogs",value:function r(){if(this.runningVpaid)return this.runningVpaid.getVpaidLogs()}},{key:"isFirstImpression",get:function s(){return this._checkFirstImpression.bind(this)}},{key:"tagVolume",set:function t(a){this.runningVpaidTagData.volume=a}},{key:"vpaid",get:function u(){return this.gotVpaid?this.runningVpaid.vpaid:{}}},{key:"gotVpaid",get:function v(){return!(!this.runningVpaid||this.runningVpaid.finished||!this.runningVpaid.vpaidCreated)}}]),a}(),c["default"]=l,b.exports=c["default"]},{"./Tracker":27,"./VpaidHandler":29}],25:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(){d(this,a),this._startTime=0,this._stopTime=0,this._now=window.performance?window.performance.now.bind(window.performance):Date.now.bind(Date)}return e(a,[{key:"now",value:function b(){return parseInt(this._now())}},{key:"start",value:function c(){this._startTime=this.now()}},{key:"stop",value:function f(){this._stopTime=this.now()}},{key:"reset",value:function g(){this._stopTime=this._startTime=0}},{key:"duration",value:function h(){if(this._startTime&&this._stopTime)return this._stopTime-this._startTime;throw"You did not use the stopwatch as expected!"}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],26:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var h,i,j,k,l,m;Object.defineProperty(c,"__esModule",{value:!0}),h=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("events"),j=a("./utils"),k=d(j),l=function(a){function b(a){var c,d,g,h,i;e(this,b),c=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this)),c._maxListeners=100,c.data={},Object.assign(c.data,a),d="9.3.7",c.data.full_player_version=d,d=d.replace(/\./g,""),d=parseInt(d),c.data.debugLevels=a.debug?a.debug:"",c.data.debug=a.debug.indexOf("*")!=-1,c.data.player_version=d,g="",h="",i="";try{h=a.unit_name,g=a.abTest,i=a.unit_main_version}catch(j){}return c.data.ab_test=g,c.data.unit_type=h,c.data.unit_version=i,c.data.session_started=Date.now(),window.cmTag&&window.cmTag.config&&window.cmTag.config.contentClickUrl&&(c.data.contentClickUrl=window.cmTag.config.contentClickUrl),c.set("ua",k.parseUserAgent()),c}return g(b,a),h(b,[{key:"incr",value:function c(a){m.exists(a,this.data)||m.set(a,0,this.data);var b=m.get(a,!0,this.data)||0;if("number"==typeof b)return m.set(a,b+1,this.data),m.get(a,!1,this.data)}},{key:"decr",value:function d(a){var b=m.get(a,!1,this.data);if("number"==typeof b)return m.set(a,b-1,this.data),m.get(a,!1,this.data)}},{key:"get",value:function i(a){return a=a.toString(),a.indexOf(".")===-1?this.data[a]:m.get(a,!1,this.data)}},{key:"getByAdvId",value:function j(a,b){var c=this.get("dsm")||{};return c&&c.hasOwnProperty(b)&&c[b].hasOwnProperty(a)?c[b][a]:this.get(a,!1,this.data)}},{key:"getByLineItem",value:function l(a,b){var c=this.get("dsm")||{},d=b?b.lineItem:"";return c&&c.hasOwnProperty(d)&&c[d].hasOwnProperty(a)?c[d][a]:this.getByCampaignId(a,b)}},{key:"getByTech",value:function n(a,b){var c=this.get("dsm")||{};return c&&c.hasOwnProperty(b)&&c[b].hasOwnProperty(a)?c[b][a]:null}},{key:"getByCampaignId",value:function o(a,b){var c=this.get("dsm")||{},d=b?b.campaignId:"";return c&&c.hasOwnProperty(d)&&c[d].hasOwnProperty(a)?c[d][a]:this.getByAdvId(a,b?b.advId:"")}},{key:"getLatestVersion",value:function p(a){var b,c,d,e,f,g;if(a=a.toString(),b=a+"_latest",c=this.get(b),void 0!==c)return c;d=new RegExp(a+"[v]*\\d+$"),e={value:void 0,version:0};for(f in this.data)d.exec(f)?(g=parseInt(f.match(/\d+$/)[0]),(!e.value||e.version<g)&&this.data[f]&&(e.version=g,e.value=this.data[f])):0===e.version&&f===a&&(e.value=this.data[f]);return this.set(b,e),e}},{key:"set",value:function q(a,b){a=a.toString(),m.set(a,b,this.data)}},{key:"getWfData",value:function r(){var a,b=this.get("dsm")||{},c=[];for(a in b)/^\d+$/.test(a)&&b[a]&&b[a].hasOwnProperty("ftchVst")&&c.push({id:a,fv:b[a].ftchVst});return c}}]),b}(i.EventEmitter),c["default"]=l,m=function(){var a=function b(a,c,d){var e,f,g=d||data;for(e=0;g&&(f=a[e]);e++)g=f in g?g[f]:c?g[f]={}:void 0;return g};return{set:function c(b,d,e){var f=b.split("."),g=f.pop(),h=a(f,!0,e);return h&&g?h[g]=d:void 0},get:function d(b,c,e){return a(b.split("."),c,e)},exists:function e(a,b){return void 0!==this.get(a,!1,b)}}}(),b.exports=c["default"]},{"./utils":38,events:3}],27:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.label="["+b+"]",this.isDevelopModeOn=this.debugLevels.indexOf("develop")>-1,this.isTrackerOn=this.debugLevels.indexOf("*")>-1||this.debugLevels.indexOf("qa")>-1||this.isDevelopModeOn}return e(a,[{key:"table",value:function b(a){this.isDevelopModeOn&&console.table(a)}},{key:"_templateLogging",value:function c(a,b,d,e){var f,g;if(this.isTrackerOn){f="";for(g in d)f+=g+": "+d[g]+"; ";"string"==typeof b?console[e]("%c"+this.label+" ["+a+"] "+b,f):console[e]("%c"+this.label+" ["+a+"]",f,b)}}},{key:"debug",value:function f(a,b,c){}},{key:"error",value:function g(a,b,c){this._templateLogging(a,b,c,"error")}},{key:"warn",value:function h(a,b,c){this._templateLogging(a,b,c,"warn")}},{key:"info",value:function i(a,b,c){this._templateLogging(a,b,c,"info")}},{key:"log",value:function j(a,b,c){this._templateLogging(a,b,c,"log")}}]),a}(),f.prototype.debugLevels="",c["default"]=f,b.exports=c["default"]},{}],28:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./utils"),h=d(g),i="ad",j=function(){function a(b,c,d,f,g){e(this,a),this.store=c,this.video=b,this.target=b.parentElement||d,this.isMobile=this.store.get("isMobile"),this.useVideoControls=this.store.get("useVideoControls"),this.disclosureText=this.store.get("disctxt"),this.defaultVolume=this.store.get("dfltvlm"),this.hideAdsPlayPauseButton=this.store.get("hdeadsplypusbtn"),this.showAdMuteButton=this.store.get("shwadmtebtn"),this.initBg=!1,this.vpaidWrapper=g,this.mutedChangeByUserGesture=!1,this.state={},this._onSoundChange=function(){},this.isMobile?this._buildMobileControls():this._buildDesktopControls(),this._createElements(),this._addControlsEventListeres(),this._addSoundEventListener(),this._setInitialState(f),this.store.on("playerStatusChanged",this._onPlayerStatusChanged.bind(this))}return f(a,[{key:"_setInitialState",value:function b(a){var b={volume:0,volumeBeforeMute:0,adDuration:0,adCurrentTime:0,adTickerId:0,adLastTickTime:0,isMuted:0===this.store.get("volume")||this.isMobile||!!this.canvas,isPaused:!1,playerState:a,vidDuration:30,vidCurrentTime:0,isVisible:a!==i};this.setState(b)}},{key:"_buildDesktopControls",value:function c(){this._createElements=this._createDesktopElements.bind(this),this._addControlsEventListeres=this._addDesktopControlsEventListeners.bind(this),this._renderControls=this._renderDesktopControls.bind(this),this._onVolumeStateChanged=this._onDesktopVolumeStateChanged.bind(this),this._destroyControlsEvents=this._destroyDesktopControlsEvents.bind(this)}},{key:"_buildMobileControls",value:function d(){this._createElements=this._createMobileElements.bind(this),this._addControlsEventListeres=this._addMobileControlsEventListeners.bind(this),this._renderControls=this._renderMobileControls.bind(this),this._onVolumeStateChanged=this._onMobileVolumeStateChanged.bind(this),this._destroyControlsEvents=this._destroyMobileControlsEvents.bind(this),this._toggleVpaidMute=this.resetAdControls=function(){}}},{key:"resetAdControls",value:function g(){this._isAdState()&&this.vpaidWrapper&&this.setState({preventAdTicker:""!==this.vpaidWrapper.getVideoUrl(),isMuted:!0})}},{key:"_onPlayerStatusChanged",value:function j(a){this.setState({playerState:a})}},{key:"_isAdState",value:function k(){return this.state.playerState===i}},{key:"_isWorkingVpaid",value:function l(a){return this._isAdState()&&a.workingVpaid}},{key:"_onControlsVisibilityChanged",value:function m(){var a=this;this.useVideoControls&&requestAnimationFrame(function(){h.removeClass(a.element,a.state.isVisible?"hide":"show"),h.addClass(a.element,a.state.isVisible?"show":"hide")})}},{key:"_addDesktopControlsEventListeners",value:function n(){this.target.addEventListener("dragstart",function(){}),this.element.addEventListener("click",function(a){a.stopPropagation()}),this._bindedOnProgressBarDown=this._onProgressBarDown.bind(this),this.progressBarArea.addEventListener("mousedown",this._bindedOnProgressBarDown),this._bindedOnPlayPauseClicked=this._onDesktopPlayPauseClicked.bind(this),this.playBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this._bindedOnProgressBarOut=this._onProgressBarOut.bind(this),this._bindedOnProgressBarMove=this._onProgressBarMove.bind(this),this._addContentVideoEventListeners(),this._bindedOnMuteClicked=this._onDesktopMuteClicked.bind(this)}},{key:"_addMobileControlsEventListeners",value:function o(){this._bindedOnPlayPauseClicked=this._onMobilePlayPauseClicked.bind(this),this._bindedOnMuteClicked=this._onMobileMuteClicked.bind(this),this._bindedOnVideoEvent=this._onVideoEvent.bind(this),this.playPauseArea.addEventListener("click",this._bindedOnPlayPauseClicked),this.video&&this.video.addEventListener("timeupdate",this._bindedOnVideoEvent)}},{key:"_addSoundEventListener",value:function p(){this.soundElement.addEventListener("click",this._bindedOnMuteClicked)}},{key:"_createDesktopElements",value:function q(){this.element=document.createElement("div"),this.element.className="video_controls hide",this.element.innerHTML="<div class='video_controls video_controls_main_area'>\n                <div class='title text'>"+this.disclosureText+"</div>\n                <div class='cm_video_controls_progressbar_area'>\n                    <div class='cm_video_controls_progressbar_bg white_bg'></div>\n                    <div class='cm_video_controls_progressbar blue_bg'></div>\n                </div>\n                <div class='cm_video_controls_mute interactive display_mute'></div>\n                <div class='cm_video_controls_playpause interactive hide'>\n                    <div class='pause hide'></div>\n                    <div class='play'></div>\n                </div>\n            </div>",this.target.appendChild(this.element),this.mainArea=this.element.children[0],this.progressBarArea=this.mainArea.children[1],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1],this.soundElement=this.mainArea.children[2],this.playPauseArea=this.mainArea.children[3],this.pauseBtn=this.playPauseArea.children[0],this.playBtn=this.playPauseArea.children[1],this.store.get("can_opt_out")||h.addClass(this.mainArea.children[0],"opt-out-hidden")}},{key:"_createMobileElements",value:function r(){this.element=document.createElement("div"),this.element.className="video_controls_mobile",this.element.innerHTML='<div class="mc-pause hide" style="pointer-events: all;"></div>\n            <div class="speaker mute" style="pointer-events: all;"></div>\n            <div class="mc-progressbar_area">\n                <div class=\'mc-progressbar_bg white_bg\'></div>\n                <div class=\'mc-progressbar_bg blue_bg\'></div>\n            </div>\n            <div class="tbl-text">'+this.disclosureText+"</div>",(this.video.parentElement||this.target).appendChild(this.element),this.playPauseArea=this.element.children[0],this.soundElement=this.element.children[1],this.progressBarArea=this.element.children[2],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1]}},{key:"_setVideoProgress",value:function s(){var a=this;requestAnimationFrame(function(){var b,c=(a.state.vidDuration-a.state.vidCurrentTime)/a.state.vidDuration*100,d=100-c,e=d+"%";a.progressBarPercentager.style.width!==e&&(b=parseInt(a.progressBarPercentager.style.width),isNaN(b)||parseInt(d)<b?a.initBg||(a.initBg=!0,h.addClass(a.progressBarPercentager,"init_bg")):a.initBg&&(a.initBg=!1,h.removeClass(a.progressBarPercentager,"init_bg")),a.progressBarPercentager.style.width=e)})}},{key:"_addContentVideoEventListeners",value:function t(){this._bindedOnVideoEvent=this._onVideoEvent.bind(this),this._bindedOnVideoClick=this._onVideoClick.bind(this),this.video.addEventListener("durationchange",this._bindedOnVideoEvent),this.video.addEventListener("progress",this._bindedOnVideoEvent),this.video.addEventListener("timeupdate",this._bindedOnVideoEvent),this.video.addEventListener("playing",this._bindedOnVideoEvent),this.video.addEventListener("pause",this._bindedOnVideoEvent),this.video.addEventListener("click",this._bindedOnVideoClick)}},{key:"_onVideoClick",value:function u(a){this.video.currentTime===this.video.duration&&(this._isAdState()||(this.video.play(),a.stopPropagation()))}},{key:"_onVideoEvent",value:function v(a){if(!this._isAdState()){if("timeupdate"===a.type)return void this.setState({vidDuration:this.video.duration,vidCurrentTime:this.video.currentTime});var b={volume:this.video.volume,isMuted:0===this.video.volume};"pause"!==a.type&&"playing"!==a.type||(b.isPaused="pause"===a.type),this.setState(b)}}},{key:"setVpaidHandler",value:function w(a){this.vpaid=a,this._addVpaidListeners()}},{key:"_addVpaidListeners",value:function x(){this._bindedOnVpaidEvent=this._onVpaidEvent.bind(this),this.vpaid.on("AdVolumeChange",this._bindedOnVpaidEvent),this.vpaid.on("AdPaused",this._bindedOnVpaidEvent),this.vpaid.on("AdPlaying",this._bindedOnVpaidEvent)}},{key:"_removeVpaidListeners",value:function y(){this.vpaid&&this._bindedOnVpaidEvent&&(this.vpaid.removeListener("AdVolumeChange",this._bindedOnVpaidEvent),this.vpaid.removeListener("AdPaused",this._bindedOnVpaidEvent),this.vpaid.removeListener("AdPlaying",this._bindedOnVpaidEvent))}},{key:"_onVpaidEvent",value:function z(a){var b,c;this._isWorkingVpaid(this.vpaidWrapper)&&(b={},"AdVolumeChange"===a.type?this.isMobile||(b.volume=this.vpaidWrapper.adVolume,b.isMuted=0===this.vpaidWrapper.adVolume):(c="AdPaused"===a.type,this.state.isPaused!==c&&(b.isPaused=c)),this.setState(b))}},{key:"_onAdTicks",value:function A(){var a=Date.now(),b={};this.state.isPaused?0!=this.state.adLastTickTime&&(this.adStartTime+=a-this.state.adLastTickTime):(b.adCurrentTime=(a-this.adStartTime)/1e3,b.adCurrentTime>this.state.adDuration&&(b.adCurrentTime=this.adStartTime>0?this.state.adDuration:0),b.vidDuration=b.adDuration,b.vidCurrentTime=b.adCurrentTime),b.adLastTickTime=a,this.setState(b)}},{key:"_isAdsPlayPauseButtonHidden",value:function B(){return this.hideAdsPlayPauseButton&&this._isAdState()}},{key:"_onDesktopPlayPauseClicked",value:function C(a){var b=!this.state.isPaused;this._isAdsPlayPauseButtonHidden()||(!this.isMobile&&this.video&&(b?this.video.pause():this.video.play()),this.setState({isPaused:b}),a.stopPropagation())}},{key:"_onMobilePlayPauseClicked",value:function D(a){this.canvas&&this.canvas.playButtonClick(),this.setState({isPaused:!this.state.isPaused}),a.stopPropagation()}},{key:"_onDesktopMuteClicked",value:function E(a){if(this.showAdMuteButton){var b={};this.store.set("forceMute",!this.state.isMuted),this.state.isMuted?0===this.state.volumeBeforeMute&&(b.volumeBeforeMute=this.defaultVolume):b.volumeBeforeMute=this.state.volume,b.volume=this.state.isMuted?this.state.volumeBeforeMute||b.volumeBeforeMute:0,this.setState(b),a.stopPropagation()}}},{key:"_onMobileMuteClicked",value:function F(a){this.showAdMuteButton&&(this.mutedChangeByUserGesture=!0,this.canvas&&this.canvas.muteButtonClick(),this.setState({isMuted:!this.state.isMuted}),this.mutedChangeByUserGesture=!1,a.stopPropagation())}},{key:"_onProgressBarDown",value:function G(a){this._sendProgressBarPercentagesChanged(a.offsetX/this.progressBarArea.offsetWidth,a),this.progressBarArea.addEventListener("mouseleave",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mouseup",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mouseout",this._bindedOnProgressBarOut),this.progressBarArea.addEventListener("mousemove",this._bindedOnProgressBarMove),a.stopPropagation()}},{key:"_sendProgressBarPercentagesChanged",value:function H(a,b){this.store.emit("videoProgressBar",a),b.stopPropagation()}},{key:"_onProgressBarOut",value:function I(a){this.progressBarArea.removeEventListener("mouseleave",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mouseup",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mouseout",this._bindedOnProgressBarOut),this.progressBarArea.removeEventListener("mousemove",this._bindedOnProgressBarMove),a.stopPropagation()}},{key:"_onProgressBarMove",value:function J(a){this._sendProgressBarPercentagesChanged(a.offsetX/this.progressBarArea.offsetWidth,a)}},{key:"_didStateChanged",value:function K(a){for(var b in a)if(void 0!==a[b]&&!this.state.hasOwnProperty(b)||this.state[b]!==a[b])return!0;return!1}},{key:"setState",value:function L(a){if(this.state&&a&&Object.keys(a).length>0&&this._didStateChanged(a)){var b=!1;void 0!==a.playerState&&(this.state.playerState=a.playerState,this._updateMuteAndPlayPauseVisibility()),void 0===a.volume&&void 0===a.isMuted||(b=!0,this._onVolumeStateChanged(a),this._setVpaidVolume(),this._toggleVpaidMute(),this._onSoundChange(this.state.isMuted)),void 0!==a.isPaused&&this.state.isPaused!==a.isPaused&&(b=!0,this.state.isPaused=a.isPaused,this._onPausedChanged(),this._isAdState()||this._toggleVpaidPlayPause(a)),void 0!==a.preventAdTicker&&a.preventAdTicker!==this.state.preventAdTicker&&(this.state.preventAdTicker=a.preventAdTicker,this.state.adTickerId=clearInterval(this.state.adTickerId),this.state.preventAdTicker?this.vpaidWrapper.registerToVPAIDVideoTimeupdateEvent():(this.adStartTime=Date.now(),this.vpaidWrapper.getAdDuration(),this.state.adTickerId=setInterval(this._onAdTicks.bind(this),250))),void 0===a.vidDuration&&void 0===a.vidCurrentTime||(this.state.vidDuration=a.vidDuration||this.state.vidDuration,this.state.vidCurrentTime=a.vidCurrentTime||this.state.vidCurrentTime,this._setVideoProgress()),void 0!==a.isVisible&&(this.state.isVisible=a.isVisible,this._onControlsVisibilityChanged()),b&&this._renderControls()}}},{key:"_onDesktopVolumeStateChanged",value:function M(a){0===a.volume||a.isMuted?(this.state.volumeBeforeMute=void 0!==a.volumeBeforeMute?a.volumeBeforeMute:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume,this.store.emit("volumeBeforeMuteChanged",this.state.volumeBeforeMute),this.state.volume=0,this.state.isMuted=!0):(this.state.isMuted=!1,this.state.volume=void 0!==a.volume?a.volume:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume)}},{key:"_onMobileVolumeStateChanged",value:function N(a){0===a.volume||a.isMuted?(this.state.volumeBeforeMute=void 0!==a.volumeBeforeMute?a.volumeBeforeMute:this.state.volume||this.state.volumeBeforeMute||this.defaultVolume,this.state.volume=0,this.state.isMuted=!0):(this.state.isMuted=void 0!==a.isMuted?a.isMuted:this.state.isMuted,this.state.volume=void 0!==a.volume?a.volume:this.state.volumeBeforeMute||this.defaultVolume)}},{key:"_onPausedChanged",value:function O(){if(this.video){if(this._isAdsPlayPauseButtonHidden()||this._isVideoEmpty()||!this.isMobile||this.canvas)return;this.state.isPaused?this.video.pause():this.video.play()}}},{key:"_isVideoEmpty",value:function P(){return!(this.video.src&&this.video.attributes.src&&""!==this.video.attributes.src.value||0!==this.video.childNodes.length)}},{key:"_renderDesktopControls",value:function Q(){this._renderDesktopVolume(),this._renderDesktopPlayPause()}},{key:"_renderDesktopVolume",value:function R(){if(!this._isAdState()){var a=this.state.volume>1?this.state.volume/100:this.state.volume;this.video.volume=a,this.video.muted=this.state.isMuted}h.removeClass(this.soundElement,"display_unmute"),h.removeClass(this.soundElement,"display_mute"),h.addClass(this.soundElement,"display_"+(this.state.isMuted?"mute":"unmute"))}},{key:"_renderDesktopPlayPause",value:function S(){var a=this.state.isPaused?this.playBtn:this.pauseBtn,b=this.state.isPaused?this.pauseBtn:this.playBtn;h.removeClass(b,"show"),h.addClass(b,"hide"),h.removeClass(a,"hide"),h.addClass(a,"show")}},{key:"_renderMobileControls",value:function T(){this._setMobilePlayPauseButton(),this._setMobileSoundButton()}},{key:"_setMobilePlayPauseButton",value:function U(){var a=this;requestAnimationFrame(function(){a.state.isPaused?(h.removeClass(a.playPauseArea,"mc-pause"),h.addClass(a.playPauseArea,"mc-play")):(h.removeClass(a.playPauseArea,"mc-play"),h.addClass(a.playPauseArea,"mc-pause"))})}},{key:"_setMobileSoundButton",value:function V(){var a=this;!this._isAdState()&&this.video&&(this.video.volume=this.state.volume,this.video.muted=this.state.isMuted),requestAnimationFrame(function(){a.state.isMuted?h.addClass(a.soundElement,"mute"):h.removeClass(a.soundElement,"mute")})}},{key:"_toggleVpaidPlayPause",value:function W(){this._isAdState()&&this.vpaid&&(this.state.isPaused?this.vpaid.vpaidHandler.pauseAd():this.vpaid.vpaidHandler.resumeAd())}},{key:"_toggleVpaidMute",value:function X(){this._isAdState()&&this.vpaid&&this.vpaidWrapper&&(this.state.isMuted?this.vpaidWrapper.setAdVolume(0):this.vpaidWrapper.setAdVolume(this.state.volume))}},{key:"_setVpaidVolume",value:function Y(){this._isAdState()&&this.vpaid&&this.vpaidWrapper&&this.vpaidWrapper.workingVpaid&&this.vpaidWrapper.setAdVolume(this.state.volume,this.mutedChangeByUserGesture)}},{key:"getValueFromControlsState",value:function Z(a){return this.state.hasOwnProperty(a)?this.state[a]:void 0}},{key:"destroy",value:function $(){this._removeVpaidListeners(),this._destroyControlsEvents(),this._destroySoundEvents(),this.element.parentElement.removeChild(this.element),this.vpaid=this._bindedOnVpaidEvent=void 0,clearInterval(this.state.adTickerId)}},{key:"_destroyDesktopControlsEvents",value:function _(){this.target.removeEventListener("dragstart",function(){}),this.element.removeEventListener("click",function(a){a.stopPropagation()}),this.progressBarArea.removeEventListener("mousedown",this._bindedOnProgressBarDown),this.video.removeEventListener("durationchange",this._bindedOnVideoEvent),this.video.removeEventListener("progress",this._bindedOnVideoEvent),this.video.removeEventListener("playing",this._bindedOnVideoEvent),this.video.removeEventListener("pause",this._bindedOnVideoEvent),this.video.removeEventListener("click",this._bindedOnVideoClick),this.playBtn.removeEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.removeEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_destroyMobileControlsEvents",value:function aa(){this.playPauseArea.removeEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_destroySoundEvents",value:function ba(){this.soundElement.removeEventListener("click",this._bindedOnMuteClicked),this.video&&this.video.removeEventListener("timeupdate",this._bindedOnVideoEvent)}},{key:"_updateMuteAndPlayPauseVisibility",value:function ca(){var a=this;requestAnimationFrame(function(){h.removeClass(a.playPauseArea,"hide"),h.removeClass(a.playPauseArea,"show"),h.removeClass(a.soundElement,"hide"),h.removeClass(a.soundElement,"show"),h.addClass(a.playPauseArea,a._isAdsPlayPauseButtonHidden()?"hide":"show"),h.addClass(a.soundElement,a.showAdMuteButton?"show":"hide")})}},{key:"setOnSoundChangeCallback",value:function da(a){this._onSoundChange=a}},{key:"setCanvas",value:function ea(a){this.canvas=a}},{key:"setVideo",value:function fa(a){this.video=a,this.video.volume===this.state.volume&&this.video.muted===this.state.isMuted||(this.video.volume=this.state.volume,this.video.muted=this.state.isMuted)}}]),a}(),c["default"]=j,b.exports=c["default"]},{"./utils":38}],29:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function f(a){return a&&a.__esModule?a:{"default":a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function i(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;Object.defineProperty(c,"__esModule",{value:!0}),j=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=a("./Post"),l=f(k),m=a("./Tracker"),n=f(m),o=a("../vpaidjs/ConvertVpaidMain"),p=f(o),q=a("./utils"),r=d(q),s=a("events"),t=a("../vpaidjs/OpportunityAggregator"),
u=f(t),v=100,w=0,x=function(a){function b(a,c,d){var e,f;return g(this,b),e=h(this,(b.__proto__||Object.getPrototypeOf(b)).call(this)),e.store=d,e.finished=!1,e.isFirstImpression=a.isFirstImpression,e.soundViolationFired=!1,e.iframe={},e.vpaid=null,e.uid="",e.debugTracker=new n["default"]("VpaidHandler"),e.vpaidCreated=!1,e.store.get("noplrcntr")||(e.videoWrapper={}),e.options=a,e.parent=a.parent,e.parentOptions=c,e.creativeData={},e.height=0,e.width=0,e.eventFunctions={},e.viewMode="normal",e.bitRate=512,e.timerId=0,e.adPlaying=!1,e.isAdPlayerVisible=!1,e.isMultiVpaidUnit=e.store.get("isMultiVpaidUnit"),e.environmentVars={},f=Object.assign({},e.parentOptions.tagDefault,e.options.vpaidTag),e.normalizeVpaidParam(f),e.options.vpaidTag=f,e.prepareVideoTag(),e.run(a.isPreRoll),e.store.on("stop",e.stop.bind(e)),e.isMultiAdsActive=e.store.get("mltads"),e.isMultiAdsActive&&e.store.on("resizeVpaidWrapper",e._onResizeAd.bind(e)),e.volumeBeforeMute=0,e.paused=!1,e.hideAdPlayerDelayId=0,e.store.emit("vpaidHandlerCreated",e),e}return i(b,a),j(b,[{key:"_onResizeAd",value:function c(a){this.finished||(this.options.width=a.width,this.options.height=a.height)}},{key:"volumeControlClick",value:function d(a,b,c){var d=a.parentNode.getBoundingClientRect(),e=parseInt((c.pageX-(d.left+5))/(d.width-10)*100);this.setVolumeControls(a,b,e),e>100&&(e=100),this.volume(e/100),this.options.parent.volume(e)}},{key:"setVolumeControls",value:function f(a,b,c){c>100&&(c=100),c<=0?(c=0,b.className="vjs-mute-control vjs-control vjs-vol-0",b.muted=!0):(b.className="vjs-mute-control vjs-control vjs-vol-"+Math.floor(c/25),b.muted=!1),a.style.width=c+"%"}},{key:"muteControlClick",value:function k(a,b,c){if(b.muted){b.className="vjs-mute-control vjs-control vjs-vol-4",b.muted=!1;var d=100*(this._beforeMuteVolume||1);a.style.width=d+"%",this.volume(d),this.options.parent.volume(100)}else b.className="vjs-mute-control vjs-control vjs-vol-0",b.muted=!0,this._beforeMuteVolume=this._volume,a.style.width="0",this.volume(0),this.options.parent.volume(0)}},{key:"playPauseClick",value:function l(a,b){this.paused?(this.vpaid.resumeAd(),this.paused=!1,a.className="vjs-play-control vjs-control"):(this.vpaid.pauseAd(),this.paused=!0,a.className="vjs-play-control vjs-control vjs-playing c-paused"),b.stopPropagation()}},{key:"onVpaidCreated",value:function m(a){this.vpaid=a,this.vpaid||this.debugTracker.error("onVpaidCreated","Vpaid Object is Invalid!"),this.subscribeToVpaid(a),this.environmentVars={slot:this.store.get("noplrcntr")?this.parent.target:this.videoWrapper,videoSlotCanAutoPlay:!0,videoSlotControls:!0},this.store.get("contentClickUrl")&&!this.store.get("noplrcntr")&&this.videoWrapper.addEventListener("click",function(a){a.stopPropagation()}),this.debugTracker.info("onVpaidCreated","Vpaid-Player->Creating..."),this.options.vpaidTag.skip_vast||!this.creativeData.adParameters?this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters=this.options.vpaidTag.ad_parameters:this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters;try{this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars),this.vpaidCreated=!0}catch(b){this.debugTracker.error("onVpaidCreated: Vpaid-initAd->failed!Trying to run with parsed <adParameters>...",b);try{var c=this.creativeData.adParameters;this.creativeData.adParameters={},this.creativeData.adParameters=new Function("return "+c+";")(),this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters,this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars),this.vpaidCreated=!0}catch(d){this.vpaidCreated=!1,this.onVpaidLoadError(b,d)}}this.vpaidCreated&&this.parent.ga.sendGaMessage({type:"vpaidInitiated"})}},{key:"resize",value:function o(a,b,c){if(c=c||"normal",b=parseInt(b),a=parseInt(a),this.options.height=b,this.options.width=a,this.viewmode=c,!isNaN(a)||!isNaN(b)){this.store.get("noplrcntr")||(this.videoWrapper.style.width=a+"px",this.videoWrapper.style.height=b+"px");var d=this.isMultiVpaidUnit||!1;if(!this.isMultiVpaidUnit)try{this.vpaid&&(d=this.vpaid.resizeAd(a,b,c))}catch(e){this.debugTracker.error("resize",e),d=!1}return d}}},{key:"viewAdPlayer",value:function q(a){clearTimeout(this.hideAdPlayerDelayId),this.adPlaying||(this.store.get("isMobile")||this.antiFlashBlackScreen(),this.adPlaying=!0,this.parent.video.pause(),this.parent.video.style.display="none",this.parent.canvas?this.parent.canvas.hide():(this.parent.video.style.display="none",this.parent.video.style.zIndex=0),this.store.get("noplrcntr")||(this.videoWrapper.style.zIndex=100,this.videoWrapper.classList.add("_ad-cm-playing"),this.videoWrapper.style.display="block")),this.store.get("vForce")?this.isAdPlayerVisible||(this.isAdPlayerVisible=!0,this.store.emit("AdPlayerVisible")):this.store.emit("AdPlayerVisible")}},{key:"antiFlashBlackScreen",value:function s(){document.body.scrollTop=document.body.scrollTop+1,setTimeout(function(){document.body.scrollTop=document.body.scrollTop-1},2)}},{key:"hideAdPlayer",value:function t(a){var b,c=this;clearTimeout(this.hideAdPlayerDelayId),b=this,this.hideAdPlayerDelayId=setTimeout(function(){window.clearTimeout(b.timerId),b.parent.playerIsClosed||b.adPlaying&&(b.adPlaying=!1,b.parent.canvas?(b.parent.video.play(),b.parent.canvas.show(),b.parent.canvas._play()):(b.parent.video&&b.parent.video.paused&&(b.store.get("dataSaver")||(c.store.get("isMobile")&&(b.parent.video.muted=!0),b.parent.video.play())),b.parent.video&&(b.parent.video.style.display="block",b.parent.video.style.zIndex=1e3)),c.store.get("noplrcntr")||b.videoWrapper.classList.remove("_ad-cm-playing"),b.store.emit("AdPlayerHidden"),a&&a.stop("global_ad_timeout"))})}},{key:"onVpaidError",value:function v(a,b,c){c?this.debugTracker.error("VPAID-"+this.options.uid,c?c[0]:""):this.debugTracker.error("VPAID-"+this.options.uid,"Vpaid Threw Error"),this.parent.options.onAdError(this.parent,this),window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"onVpaidLoadError",value:function w(a,b){var c,d;if(a=a||"",b=b||"",this.parent.ga.sendGaMessage({type:"VpaidLoadError"}),500==parseInt(1e3*Math.random()))try{c="VpaidLoadError="+encodeURIComponent(a.toString()+"[][][][]"+b.toString()),d=new XMLHttpRequest,d.open("POST","//www.mikysrv.com/push.html",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send(c),this.debugTracker.error("VPAID-"+this.options.uid,[a,b])}catch(e){}this.parent.options.onAdLoadError(this.parent,this),window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"onVpaidPageError",value:function x(a){this.debugTracker.warn("VpaidPageError",a)}},{key:"stop",value:function y(a){window.setTimeout(function(a){this.hideAdPlayer(a)}.bind(this,a),0)}},{key:"onVpaidStop",value:function z(){window.setTimeout(function(){this.hideAdPlayer()}.bind(this),0)}},{key:"run",value:function A(a){var b,c,d=this.store.get("ads_playing")||0,e=this.store.get("sncad")||!1;return(!e||!d)&&(b=this.options.vpaidTag,this.vpaid||(this.creativeData.adparameters=this.creativeData.AdParameters=this.creativeData.adParameters=this.options.vpaidTag.ad_parameters,this.vpaid=new p["default"](b,this,this.store),this.store.get("cmbopps")&&(c=new u["default"](this.store,this.vpaid.config.creatives),this.store.set("oppsAggregator",c)),this.onVpaidCreated(this.vpaid),this.vpaid.initAd(this.options.width,this.options.height,this.viewMode,parseInt(this.bitRate),this.creativeData,this.environmentVars)),this.store.set("currentPubid",b.pubid),this.store.set("currentTagid",b.tagid),this.store.set("rollType",b.roll_type),this.vpaid.startAd(a),this.vpaidCreated=!0,!0)}},{key:"startAd",value:function B(){this.startAdFired=!0,this.vpaid.startAd()}},{key:"prepareVideoTag",value:function C(){var a,b,c=this.getWorkingVolume();this.store.get("noplrcntr")||(a=this.parent.target,this.videoWrapper=document.createElement("div"),this.videoWrapper.className=a.className,this.videoWrapper.className+=" vpaid-handler",this.videoWrapper.id=this.options.uid+"_"+a.id,this.videoWrapper.style.cssText=a.style.cssText+";position:absolute;top:0;left:0;border:0; z-index:0"),b=this.options.vpaidTag.mute?this.options.vpaidTag.mute:this.parentOptions.mute,this.options.vpaidTag.mute=b,this.options.height=r.roundNumericValue(this.store.get("height")),this.options.width=r.roundNumericValue(this.store.get("width")),this.store.get("noplrcntr")||a.appendChild(this.videoWrapper)}},{key:"getWorkingVolume",value:function D(){var a=0;return this.options.vpaidTag.volume?"auto"==this.options.vpaidTag.volume&&(a=this.parent.volume()/100,a=this.store.get("volume")):a=this.parentOptions.volume/100,0==a&&this.vpaid&&(a=this.vpaid.manager.getCurrentWorkingVpaidVolume()),a<1?parseInt(100*a):parseInt(a)}},{key:"normalizeVpaidParam",value:function E(a){a.adto=a.ad_timeout,a["player-width"]=this.parent.video.offsetWidth||this.parent.video.width,a["player-height"]=this.parent.video.offsetHeight||this.parent.video.height,a["video-url"]=this.parent.video.name,a.vidlength=parseInt(this.parent.video.duration),a.sts=this.parent.repeatCount,a["vpaid-version"]=a.vpaid_version,a["auc-dast"]=a.auc_dast;var b=2;a.use_as_is||(b=0==a.plmd?a.muted?2:1:a.plmd),a.plmd=b}},{key:"volume",value:function F(a){if(a=a>1?a/100:a,void 0!=a)try{this.vpaid&&(this.vpaid.setAdVolume(a),this._volume=a)}catch(b){return 0}else try{return this.vpaid.getAdVolume()}catch(b){return 0}}},{key:"_handleClickThru",value:function G(a){var b,c;return this.debugTracker.info("Opening Url","Opening url: "+a.url),b=r.replaceMacros(a.url,this.store),this.store.get("isInApp")&&window.taboolaMobile&&window.tbNativeBridge&&(c=window.tbNativeBridge(),c.onClick)?void c.onClick("",b,b,!1,0,"video"):void window.open(b)}},{key:"subscribeToVpaid",value:function H(a){var b,c,d=this;this.eventFunctions={AdLoaded:function f(a){d.parent.ga.sendGaMessage({type:"AdLoaded"})},AdVideoStart:function g(a){if(a.dispatcher.adPlayedCounter||a.dispatcher.isBf||(this.store.incr("ads_playing"),a.dispatcher.adPlayedCounter=!0),!d.finished){var b=d.getWorkingVolume();d.volume(b),d.viewAdPlayer(a?a.dispatcher:void 0),d.parent.options.onAdVideoStart(d.parent,d)}},AdImpression:function h(a){var b,c,e=this.store.get("ads_playing"),f=this.store.incr("total_impressions");if(a.dispatcher.adPlayedCounter||a.dispatcher.isBf||(this.store.incr("ads_playing"),a.dispatcher.adPlayedCounter=!0),!d.finished){if(d.parent.ga.sendGaMessage({type:"AdImpression"},{vage:parseInt((Date.now()-a.dispatcher.created)/1e3),vpaidReadyInQue:a.vpaidReady,qsize:a.qsize,dp:a.dp,adImpInMS:a.adImpInMS,readyInMS:a.readyInMS,loadToImpMS:a.loadToImpMS,vast:a.dispatcher.vast,adsPlaying:e,totalImpressions:f,xhrErrors:a.dispatcher.xhrErrors||""}),b=a.tag,d.isFirstImpression()&&d.vpaid&&d.vpaid.fire99&&d.parent.options.fire99)try{a.dispatcher.fire99()}catch(g){}if(d.parent.options.onAdImpression(d,a.dispatcher,b),c=d.getWorkingVolume(),d.volume(c),d.vpaid&&!d.store.get("isMultiVpaidUnit"))try{d.vpaid.resizeAd(d.options.width,d.options.height,d.viewmode)}catch(g){console.log(g)}}},AdStopped:function i(a){a.dispatcher.adPlayedCounter&&!a.dispatcher.isBf&&this.store.set("ads_playing",0),d.parent.options.onAdStopped(e.dispatcher.index,d),d.onVpaidStop()},AdVideoComplete:function j(a){d.hideAdPlayer(),a.dispatcher.adPlayedCounter&&!a.dispatcher.isBf&&this.store.set("ads_playing",0),d.parent.options&&d.parent.options.onAdVideoEnd(d.parent,d)},AdError:function k(a){d.onVpaidError("[VPAID-"+d.options.uid+"]::AdError","AdError",arguments),a.dispatcher.adPlayedCounter&&!a.dispatcher.isBf&&this.store.set("ads_playing",0)},AdClickThru:function l(a){this.isMultiAdsActive||this.store.set("forcePause",!1),a&&a.clickThru&&(a.clickThru.playerHandles&&a.clickThru.url&&d._handleClickThru(a.clickThru),d.parent.options.onAdClick(d.parent,d,a.clickThru.url))},AdStarted:function m(){setTimeout(function(){d.viewAdPlayer()},2);var a=d.getWorkingVolume();d.volume(a)},VpaidSpecial:function n(){d.parent.ga.sendGaMessage({type:"VpaidSpecial"})},AdBlockEnabled:function o(){d.parent.ga.sendGaMessage({type:"AdBlockEnabled"})},SoundViolation:function p(){d.soundViolationFired||(d.soundViolationFired=!0,d.parent.ga.sendGaMessage({type:"SoundViolation"}))},HijackAttempt:function q(a){var b="";"string"==typeof a&&(b=a),d.parent.ga.sendGaMessage({type:"HijackAttempt"}),(new Image).src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=31542217&dast="+d.options.vpaidTag.auc_dast+"&"+(new Date).getTime()},AdPaused:function r(a){this.store.emit("contentPaused"),d.paused=!0,d.playButton&&(d.playButton.className="vjs-play-control vjs-control vjs-playing c-paused")},AdPlaying:function s(a){d.paused&&(this.store.emit("contentResumed"),d.paused=!1),d.paused=!1,d.playButton&&(d.playButton.className="vjs-play-control vjs-control"),d.finished},AdSkipped:function t(){d.eventFunctions.AdStopped()}},b=this.vpaidEvents;for(c in b)b[c]&&this.eventFunctions[c]&&(this.eventFunctions[c].controller=this,a.subscribe(this.eventFunctions[c],b[c]),this.on(b[c],this.eventFunctions[c]));this.on("viewAdPlayer",d.viewAdPlayer)}},{key:"trigger",value:function I(a,b){this.eventFunctions.hasOwnProperty(a)&&"function"==typeof this.eventFunctions&&(this.emit(a,b),console.log("trigger event",a))}},{key:"getVpaidLogs",value:function J(){if(this.vpaid)return this.vpaid.getVpaidLogs()}},{key:"getAd",value:function K(a){return this.vpaid.getAd(a)}},{key:"runWaterfall",value:function L(a){this.vpaid.runWaterfall(a)}},{key:"pause",value:function M(){this.paused||(this.vpaid.pauseAd(),this.paused=!0)}},{key:"resume",value:function N(){this.adPlaying&&this.paused&&(this.vpaid.resumeAd(),this.paused=!1)}},{key:"mute",value:function O(){this.volumeBeforeMute=0===this._volume?50:this._volume,this.volume(0)}},{key:"unMute",value:function P(a){this.volumeBeforeMute||(this.parentOptions.volumeBeforeMute=this.volumeBeforeMute=a||50),this._volume=a,this.volume(this._volume)}},{key:"setPaused",value:function Q(a){this.paused=a}},{key:"vpaidEvents",get:function R(){return{VpaidSpecial:"VpaidSpecial",AdBlockEnabled:"AdBlockEnabled",AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt"}}}]),b}(s.EventEmitter),c["default"]=x,b.exports=c["default"]},{"../vpaidjs/ConvertVpaidMain":40,"../vpaidjs/OpportunityAggregator":51,"./Post":22,"./Tracker":27,"./utils":38,events:3}],30:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./VpaidHandler"),h=d(g),i=0,j=function(){function a(b,c){e(this,a),this.store=b,this.parent=c,this.initVpaid(),this.hadFirstImpression=!1}return f(a,[{key:"initVpaid",value:function b(){var a=this.getVpaidTag(),b={"00:00":a,"00:01":a};this.store.set("contentSchedule",b),this.store.set("autoplay_on_pre_roll",!1),this.vpaidHandler=new h["default"]({isFirstImpression:this.isFirstImpression,vpaidTag:a,uid:i++,parent:this.parent},this.parent.options,this.store),this.vpaidHandler.runWaterfall("vforceInit")}},{key:"getVpaidTag",value:function c(){var a="pre-roll",b=this.store.get("schedule"),c={};return b.forEach(function(a){a&&"pre-roll"===a.roll_type&&(c=a)}),c}},{key:"isFirstImpression",value:function d(){return!this.hadFirstImpression&&(this.hadFirstImpression=!0,!0)}},{key:"getVpaidLogs",value:function g(){if(this.vpaidHandler)return this.vpaidHandler.getVpaidLogs()}},{key:"getAd",value:function j(a){return this.vpaidHandler.getAd(a)}},{key:"stop",value:function k(){this.vpaidHandler&&!this.vpaidHandler.finished?this.vpaidHandler.stop():this.parent&&this.parent._onVpaidClosed(),this.vpaidHandler=void 0,this.schedule=void 0,this.parent=void 0,this.savedTime=-1}},{key:"pause",value:function l(){this.vpaidHandler.pause()}},{key:"resume",value:function m(){this.vpaidHandler.resume()}},{key:"volume",value:function n(a){this.vpaidHandler.volume(a)}},{key:"mute",value:function o(){this.volume(0)}},{key:"unmute",value:function p(a){this.volume(a)}},{key:"resize",value:function q(a,b,c){this.vpaidHandler.resize(a,b,c)}}]),a}(),c["default"]=j,b.exports=c["default"]},{"./VpaidHandler":29}],31:[function(a,b,c){"use strict";var d=d||{};d.dSettings={203745:{global_ad_timeout:999999999,fkadchcs:!0},203735:{global_ad_timeout:999999999,adto:999999999,fkadchcs:!0},203391:{pxlnotsmtp:!0},1544895:{ad_controls:!1},1699035:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},1731795:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},1727795:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},1725135:{cstmdl:14,vpdcss:{".cm_video_controls_mute":{right:"3px",bottom:"25px"}}},204595:{fkadchcs:!0},202697:{fkadchcs:!0},1746345:{cmpltonstpd:!0},1746335:{cmpltonstpd:!0},1749845:{cmpltonstpd:!0},1749835:{cmpltonstpd:!0},1775385:{adddsttotvpaid:!0}},window.TRC&&(window.TRC.dsm=window.TRC.dsm||{},window.TRC.dsm[143]=d.dSettings)},{}],32:[function(a,b,c){"use strict";var d='!function(){function t(t,isEarly){var r=p.test(t);return r&&e(t,isEarly),r}function searchExist(){var scripts = document.scripts || [];for (var i = 0; i < scripts.length; i++) {scripts[i].src && t(scripts[i].src, true);}var iframes = document.querySelectorAll(\'iframe\') || [];for (var i = 0; i < iframes.length; i++) {t(iframes[i].src,true);}}function e(t,isEarly){(new Image).src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&"+(new Date).getTime(),window.ReportHijackAttempt(t,isEarly)}window.ReportHijackAttempt=window.ReportHijackAttempt||function(){};var r=["tags.bkrtx.com","lipikar_bodycare_awareness","gacdn","mirra.io","brtmedia","UA-57084257-7","coin-hive.com","bundle.clearstream.tv",".clrstm.com","video.leadzu.com",".leadzu.com","s0.2mdn.net/ads/richmedia/studio/pv2/60128696/","advertisingstory.com","mediagroupads.com","elitelmediaadvertising.com","vertamedia.com","mediagrouppro.com","highratedads.com","videogrammic.com","marketingvideonow.com","static.marketingvideonow.com","files.webvideoglobal.com","webvideoglobal.com","webmediaapp.com","files.webmediaapp.com","popovideoad.com","sb.voicefive.com","one.m4dc.com"];var p=new RegExp(r.join("|"),"i");try{searchExist();HTMLIFrameElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLIFrameElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,"src")),Object.defineProperty(HTMLIFrameElement.prototype,"src",{get:function(){return this._src},set:function(e){t(e)?(this._src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&"+(new Date).getTime(),window.ReportHijackAttempt(e)):this._src=e}})),HTMLElement.prototype._appendChild=HTMLElement.prototype.appendChild,HTMLElement.prototype.appendChild=function(t){return this._appendChild(t)},HTMLElement.prototype._insertBefore=HTMLElement.prototype.insertBefore,HTMLElement.prototype.insertBefore=function(e,r){return t(e.outerHTML)?void window.ReportHijackAttempt(e.childNodes[0].src):void this._insertBefore(e,r)},HTMLIFrameElement.prototype._setAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(e,r){"src"==e.toLowerCase()&&t(r)?(this._setAttribute(e,"//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&"+(new Date).getTime()),window.ReportHijackAttempt(r)):this._setAttribute(e,r)},HTMLScriptElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLScriptElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src")),Object.defineProperty(HTMLScriptElement.prototype,"src",{get:function(){return this._src},set:function(e){t(e)?(this._src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&"+(new Date).getTime(),window.ReportHijackAttempt(e)):this._src=e}}),HTMLScriptElement.prototype._setAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(e,r){"src"==e.toLowerCase()&&t(r)?(this._setAttribute(e,"//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=51591248&dast=&"+(new Date).getTime()),window.ReportHijackAttempt(r)):this._setAttribute(e,r)},HTMLObjectElement.prototype._scrollIntoView=HTMLScriptElement.prototype.scrollIntoView,HTMLObjectElement.prototype.scrollIntoView=function(){return window.ReportHijackAttempt("scrollIntoView"),!1},HTMLDivElement.prototype.scrollIntoView=function(){return!1}),XMLHttpRequest.prototype._open=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,r,o,n,i){return t(r)?window.ReportHijackAttempt(r):this._open.apply(this, arguments)}}catch(t){}}();';try{HijackResponse(d)}catch(e){}window.TRC&&(window.TRC.hjk=window.TRC.hjk||{},window.TRC.hjk[211]=d)},{}],33:[function(a,b,c){"use strict";var d="!function(){if((window.ignoreGetVpaidAd||'function'==typeof window.getVPAIDAd)&&function(){try{return window.self!==window.top}catch(t){return!0}}()){function t(){for(var t=document.scripts||[],e=[],i=0;i<t.length;i++)e.push(t[i].src);return e}function e(){for(var t=document.querySelectorAll('iframe'),e=[],i=0;i<t.length;i++)e.push(t[i].src);return e}function i(i,r,o){var n=window._vaThis||this;if(window._vaThis){var s=t(),a=e();n.scripts=n.scripts.concat(s),n.iframes=n.iframes.concat(a),n.firstCount+=a.length+s.length}else n.data={},n.XHRUrls=[],n.XHRResponses=[],n.iframes=e(),n.scripts=t(),n.firstCount=n.iframes.length+n.scripts.length,n.timeoutLength=o.timeout||3e3,n.callback=r,n.adImpressionEvent='AdImpression',n.networkCallCounter=0,n.maxNetworkCalls=o.maxNetworkCalls||!1,n.networkCallsLimitExceeded=!1,n.latencies=[],n.iframesWeights={gen:8,ggl:4,pxls:2},n.isVideoUrlPublic=void 0,n.requestId=0,n.requestStartTimes={},Object.defineProperty(n,'AnalyticsData',{get:function(){return n.data},enumerable:!0,configurable:!1}),i&&n.subscribeToAdImpression(i);if(o&&(o.withXHR&&window.XMLHttpRequest&&this.createXMLHTTPHook(),o.withIframes&&void 0!==window.HTMLIFrameElement&&this.createIframesSrcHook(o),o.withScripts&&void 0!==window.HTMLScriptElement&&this.createScriptsSrcHook(),o.timeout&&(n.timeoutLength=o.timeout),o.iframesWeights))for(var c in o.iframesWeights)n.iframesWeights[c]=o.iframesWeights[c];window.destroyAnalyticsReporter=function(){n.data=n.XHRUrls=n.XHRResponses=n.iframes=n.scripts=n.timeoutLength=n.iframesWeights=n.requestStartTimes=void 0,window.getVpaidAnalyticsReport=window.destroyAnalyticsReporter=window.onNetworkCallsLimitExceeded=window.setIsVideoUrlPublic=void 0,window.AnalyticsReporter=void 0},window.getVpaidAnalyticsReport=function(){var e=window._vaThis||this,i=[],r={scripts:e.scripts.length>0?e.scripts.slice():t(),XHRUrls:e.XHRUrls.slice(),iframes:e.iframes.slice()};for(var o in r)i=i.concat(r[o]);r.totalRequests=i,r.totalRequestsCounter=i.length,r.firstCount=e.firstCount,r.latencies=e.latencies.slice();var n=r.latencies.reduce(function(t,e){return t+e},0);return r.averageLatency=r.latencies.length?n/r.latencies.length:0,r.averageIntLatency=parseInt(r.averageLatency),r}.bind(n),window.setIsVideoUrlPublic=function(t){(window._vaThis||this).isVideoUrlPublic=t}.bind(n)}i.prototype.subscribeToAdImpression=function(t){var e=window._vaThis||this;t.subscribe(function(){e.adImpFired=!0,setTimeout(function(){e.sendData()},e.timeoutLength)},e.adImpressionEvent,e)},i.prototype.sendData=function(){var t=window._vaThis||this;t.collectData(t.adImpressionEvent),t.callback(t.adImpressionEvent,t.AnalyticsData)},i.prototype.collectData=function(e){var i=window._vaThis||this,r={};r.eventName=e,r.scripts=i.scripts.length>0?i.scripts.slice():t(),r.XHRUrls=i.XHRUrls.slice(),r.XHRResponses=i.XHRResponses.slice(),r.iframes=i.iframes.slice(),i.data[e]=r},i.prototype.onUrlHooked=function(t,e,i){var r=window._vaThis||this;r[t].push(e),i._id=r.requestId++,r.requestStartTimes[i._id]=Date.now();var o=function(){r.requestStartTimes.hasOwnProperty(this._id)&&(r.latencies.push(Date.now()-r.requestStartTimes[this._id]),delete r.requestStartTimes[this._id]),this.removeEventListener('load',o)}.bind(i);i.addEventListener('load',o),'iframes'!==t||void 0===r.isVideoUrlPublic?r.networkCallCounter++:r.networkCallCounter+=r.getIframeWeight(e),r.isMaxNetworkCallsLimitExceeded()&&r.onNetworkCallsLimitExceeded()},i.prototype.getIframeWeight=function(t){var e=window._vaThis||this;return t.indexOf('imasdk')?e.iframesWeights.ggl:e.isVideoUrlPublic?e.iframesWeights.pxls:e.iframesWeights.gen},i.prototype.createXMLHTTPHook=function(){var t=window._vaThis||this;window.XMLHttpRequest.prototype._vaOpen=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(e,i,r,o,n){return t.onUrlHooked('XHRUrls',i,this),this.addEventListener('load',function(){t.XHRResponses.push('load: '+this.responseText)}),window.XMLHttpRequest.prototype._vaOpen.apply(this,arguments)}},i.prototype.createIframesSrcHook=function(t){var e=window._vaThis||this;Object.defineProperty(HTMLIFrameElement.prototype,'_vaSrc',Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'src'));var i=function(i,r){if(e.onUrlHooked('iframes',i,r),t.deepIframes){var o=function(){try{r.removeEventListener('load',o),r.contentWindow.ignoreGetVpaidAd=!0,r.contentWindow._vaThis=e,r.contentWindow.eval(e.vpaidAnalyticsFunc),new r.contentWindow.AnalyticsReporter(null,function(){},t)}catch(t){}};r.addEventListener('load',o)}};Object.defineProperty(HTMLIFrameElement.prototype,'src',{get:function(){return this._vaSrc},set:function(t){i(t,this),this._vaSrc=t}}),HTMLIFrameElement.prototype._vaSetAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(t,e){'src'===t&&i(e,this),this._vaSetAttribute(t,e)}},i.prototype.createScriptsSrcHook=function(){var t=window._vaThis||this;Object.defineProperty(HTMLScriptElement.prototype,'_vaSrc',Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,'src')),Object.defineProperty(HTMLScriptElement.prototype,'src',{get:function(){return this._vaSrc},set:function(e){t.onUrlHooked('scripts',e,this),this._vaSrc=e}}),HTMLScriptElement.prototype._vaSetAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(e,i){'src'===e&&t.onUrlHooked('scripts',i,this),this._vaSetAttribute(e,i)}},i.prototype.unHook=function(){var t=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,'_vaSrc'),e=Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,'_vaSrc');t&&(Object.defineProperty(HTMLIFrameElement.prototype,'src',t),HTMLIFrameElement.prototype.setAttribute=HTMLIFrameElement.prototype._vaSetAttribute),e&&(Object.defineProperty(HTMLIFrameElement.prototype,'src',e),HTMLScriptElement.prototype.setAttribute=HTMLScriptElement.prototype._vaSetAttribute),window.XMLHttpRequest.prototype._vaOpen&&(window.XMLHttpRequest.prototype.open=window.XMLHttpRequest.prototype._vaOpen)},i.prototype.onNetworkCallsLimitExceeded=function(){var t=window._vaThis||this;t.networkCallsLimitExceeded||(t.adImpFired||t.unHook(),t.networkCallsLimitExceeded=!0,t.sendData(),window.onNetworkCallsLimitExceeded())},i.prototype.isMaxNetworkCallsLimitExceeded=function(){var t=window._vaThis||this;return t.networkCallsLimitExceeded||t.maxNetworkCalls&&t.networkCallCounter>=t.maxNetworkCalls},window.AnalyticsReporter=i}}();";try{VpaidAnalytics(d)}catch(e){}window.TRC&&(window.TRC.vpaidAnalytics=window.TRC.vpaidAnalytics||{},window.TRC.vpaidAnalytics[25]=d)},{}],34:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./Bitstream"),h=d(g),i=function(){function a(b,c){var d,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(e(this,a),this.results=null,b){for(d=[],this.dastKeys={0:{name:"stid",type:2},1:{name:"extuid",type:3},2:{name:"excid",type:10},3:{name:"ciuid",type:3},4:{name:"ciuidst",type:3},5:{name:"ciums",type:2},6:{name:"szid",type:10},7:{name:"cirid",type:5},8:{name:"cisid",type:5},9:{name:"segid",type:5},10:{name:"pstn",type:5},11:{name:"plcmnt",type:5},12:{name:"RID",type:2},13:{name:"cirf",type:5},14:{name:"base64",type:2},15:{name:"crid",type:2},16:{name:"cibp",type:7},17:{name:"cisbp",type:7},18:{name:"ciprbp",type:7},19:{name:"cmbb",type:7},20:{name:"noaop",type:10},21:{name:"ciage",type:1},22:{name:"cigndr",type:10},23:{name:"invc",type:2},24:{name:"slid",type:2},25:{name:"oslid",type:2},26:{name:"cntry",type:8},27:{name:"rgn",type:5},28:{name:"cty",type:5},29:{name:"citbp",type:7},30:{name:"rcatid",type:5},31:{name:"brsr",type:2},32:{name:"osid",type:2},33:{name:"frimp",type:2},34:{name:"frclk",type:2},35:{name:"frcnv",type:2},36:{name:"pubid",type:2},37:{name:"subid",type:2},38:{name:"ltstmp",type:3},39:{name:"mtmdlid",type:3},40:{name:"mdlid",type:3},41:{name:"cu1",type:2},42:{name:"cu2",type:2},43:{name:"cu3",type:2},44:{name:"cu4",type:2},45:{name:"cu5",type:2},46:{name:"cu6",type:2},47:{name:"cu7",type:2},48:{name:"cu8",type:2},49:{name:"cipid",type:2},50:{name:"cicmp",type:2},51:{name:"impts",type:2},52:{name:"clcts",type:2},53:{name:"convts",type:2},54:{name:"adid",type:3},55:{name:"dcid",type:10},56:{name:"compid",type:2},58:{name:"siteid",type:2},59:{name:"pix",type:3},60:{name:"chan",type:3},61:{name:"bo",type:8},62:{name:"so",type:8},63:{name:"oid",type:10},64:{name:"csec",type:3},65:{name:"skw",type:2},66:{name:"alng",type:2},67:{name:"auc64",type:3},68:{name:"mid",type:8},69:{name:"wif",type:6},70:{name:"ciipd",type:3},71:{name:"sec",type:6},72:{name:"adt",type:2},73:{name:"nsl",type:6},74:{name:"pti",type:6},75:{name:"dncf",type:6},76:{name:"obp",type:7},77:{name:"tz",type:5},78:{name:"md",type:6},79:{name:"mmt",type:1},83:{name:"udc",type:6},84:{name:"umexcid",type:10},85:{name:"verticalId",type:2},86:{name:"mbr",type:10},87:{name:"ts",type:3},88:{name:"omni",type:2},89:{name:"rpm",type:7},90:{name:"abt",type:5},91:{name:"dspadid",type:5},92:{name:"dspbid",type:5},93:{name:"dspcid",type:5},94:{name:"dspcrid",type:5},95:{name:"dspid",type:2},96:{name:"dspseat",type:5},97:{name:"urlDepth",type:2},98:{name:"ordid",type:3},99:{name:"servingDomain",type:5},100:{name:"omniType",type:9},101:{name:"frmi",type:3},102:{name:"fmmt",type:1},103:{name:"cmt",type:1},104:{name:"lat",type:7},105:{name:"long",type:7},106:{name:"prrp",type:7},107:{name:"pfrp",type:7},108:{name:"pgtp",type:9},109:{name:"tblc",type:9},110:{name:"mcr",type:8},111:{name:"ct",type:10},112:{name:"platform",type:9},113:{name:"cncat",type:5},114:{name:"cisrf",type:5},115:{name:"sortOrderType",type:1},116:{name:"groupId",type:5},117:{name:"testId",type:5},118:{name:"prl",type:2},119:{
name:"pfrl",type:2},120:{name:"rtd",type:3},121:{name:"rndmt",type:2},122:{name:"sesid",type:5},123:{name:"seshas",type:3},124:{name:"palfr",type:7},125:{name:"splcmt",type:5},126:{name:"wurflb",type:5},127:{name:"wurflbv",type:5},128:{name:"wurflo",type:5},129:{name:"wurflov",type:5},130:{name:"wurflbn",type:5},131:{name:"wurflff",type:5},132:{name:"wurflmn",type:5},133:{name:"difa",type:5},134:{name:"aid",type:5},135:{name:"extuidst",type:5},136:{name:"tbuidst",type:5},137:{name:"aname",type:5},138:{name:"abRTB",type:5},139:{name:"mda",type:5},140:{name:"audsegid",type:5},141:{name:"smdt",type:3}},f=1,g=2,i=3,j=4,k=5,l=6,m=7,n=8,o=9,p=10,b=b.substring(2,b.length-1),b=b.replace(/_/g,"/"),b=b.replace(/-/g,"+"),this.bis=new h["default"](b),this.bis.readInt(16),q={};;){if(r=this.bis.readInt(8),this.bis.isEof())break;if(this.dastKeys.hasOwnProperty(r)){if(s=this.dastKeys[r],s.type==i&&(t=this.bis.readLong()),s.type==k){try{u=this.decodeBerLength()}catch(w){d.push("key:"+r+", "+w);continue}t="",u==-1?(v=this.bis.readByte(),0==v&&(t="ENTER_PLACEMENT_ID_HERE")):t=this.bis.read7bitString(u)}s.type==g&&(t=this.bis.readInt()),s.type==o&&(t=this.bis.readInt(4)),s.type==j&&(t=this.bis.readDouble()),s.type==f&&(t=this.bis.readByte(),t>127&&(t-=256)),s.type==p&&(t=this.bis.readByte()),s.type==l&&(t=this.bis.readBool()),s.type==n&&(t=this.bis.readShort(),t>32767&&(t-=65536)),s.type==m&&(t=this.bis.readFloat()),q[s.name]=t}else d.push("missing key:"+r+" in dastDecoder")}this.results=q,d.length>0&&c.set("dastDecoderError",d)}}return f(a,[{key:"fetchResults",value:function b(){return this.results}},{key:"decodeBerLength",value:function c(){var a,b,c=this.bis.readByte();if(255==c)return-1;if(128==(128&c)){if(c&=127,0==c)throw"Indefinite length not supported";if(c>4)throw"Encoding too long";for(a=0,b=0;b<c;b++)a=(a<<8)+(255&this.bis.readByte());return a>1e3&&(a=1e3),a}return c>1e3&&(c=1e3),c}}]),a}(),c["default"]=i,b.exports=c["default"]},{"./Bitstream":16}],35:[function(a,b,c){"use strict";function d(a){var b=a.get("dtsvrurl"),c=new XMLHttpRequest;c.open("GET",b,!0),c.onreadystatechange=function(){var b,d;if(c.readyState==XMLHttpRequest.DONE){b=c.responseText,d={};try{d=JSON.parse(b)}catch(f){}e(d,a)}},c.send(null)}function e(a,b){var c=!!a.dataSaver;b&&(b.set(f,c),b.set("clientSideDataSaver",c),b.emit("dataSaverDetectionFinished"))}var f="dataSaver";b.exports={detect:d}},{}],36:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../vpaidjs/JSONPHandler"),h=d(g),i=function(){function b(c){e(this,b),this.ServiceLoader=a("serviceloader"),this.ServiceLoader.init(c.data),this.store=c}return f(b,[{key:"get",value:function c(a,b,d,e,f){var g=this;this.ServiceLoader.get(a,b,function(a){g.store.get(d)||g.store.set(d,a)},function(){g.store.get("JSONPHandler")||(g.JSONPHandler=new h["default"](g.store.get("base_url"))),g.JSONPHandler.load(e,f,function(a){g.store.get(d)||g.store.set(d,a)})})}},{key:"getDynamicSettings",value:function d(){var a,b=this,c=this.store.get("dsu"),d=c.match(/(?:\/vpaid\/ds\/)(.*)\//);d&&2===d.length&&(a=d[1],this.ServiceLoader.get("dsm",a,function(a){b.store.set("dsm",a)},function(){var a=b.store.get("base_url"),c=a+b.store.get("dsu");b.getScript(c,function(){b.store.set("dsm",cmTag.dSettings)})}))}},{key:"getScript",value:function g(a,b){var c=document.createElement("script"),d=document.getElementsByTagName("script")[0];c.src=a,d.parentNode.insertBefore(c,d),c.onload=function(){b()}}}]),b}(),c["default"]=i,b.exports=c["default"]},{"../vpaidjs/JSONPHandler":44,serviceloader:7}],37:[function(a,b,c){"use strict";function d(a){var b,c,d={domain:window.location.hostname,cirf:"",referrer:document.referrer?document.referrer.split("//")[1]:window.location.hostname,vertical:"default",auc_dast:"0",title:"",description:"",keywords:"",default_ad_parameters:"",files:[],image:!1,target_id:"",height:!1,width:!1,controls:!0,aspect_ratio:"16:9",repeat:!0,mute:!1,oid:0,default_ad_timeout:30,volume:0,video_class_name:"video-js vjs-default-skin",schedule:[],schedule_auto:1,min_vpaid_run_time:4,debug:[],htmlVideoSupport:function(){return!!document.createElement("video").canPlayType}(),ga_factor:1,fire99:!0,ad_controls:!1,time_between_waterfall:10,tmbtwfs:function e(a,b,c,d){return c.get("time_between_waterfall")},mntmbtwfsf:function f(a,b,c,d){return c.get("mintimwf")},mintimwf:5e3,mntmbtwfs:5,mxtmbtwfs:900,queue_size:6,max_ready_vpaid:3,waterfall_watermark:0,base_url:"//vidstat.taboola.com",wf_path:"VideoBidRequestHandlerServlet",run_wf_when_empty:!0,kill_after_hour:0,kaxwnc:18e5,pstflrs:!0,pvpd:"javascript",pvidtp:"",sncad:!1,blkflshjs:!0,vjshndlrlgcy:!1,altmot:6e4,adimptmot:0,prtctv2:"/vpaid/hjk.184.js",hjkclb:"HijackResponse",jsnoflshdtct:!1,qsrtscr:function g(a,b){return 100*b.alfrox},psthdrs:"text/plain",rstmrai:!0,vstprxy:!1,pxyurl:"http://vid.mikysrv.com/fetch?url=",global_ad_timeout:18e4,mprdct:void 0,uscnvsmpg:!0,forcecnvsmpg:!1,gtvid2:"//mpg.taboola.com/getts?url",cnvsldrt:5,mpgclrslv:["gcdn.2mdn.net"],dsu:"/vpaid/ds/117/dsm.js",run_wf_on_init:!0,useapforcntnt:!1,wf_dynmc_ps:!0,sprssviderr:!1,vForce:!1,get_ad_timeout_seconds:10,wf_manual:!1,disctxt:"By Taboola",httpsOverride:!1,usscrtgurl:!1,evtbsschdl:!0,timbtopps:2e3,cmbopps:!0,anltcsurlv4:"",anltcsurlv5:"",anltcsclb:"VpaidAnalytics",anltcsOptions:{withXHR:!0,withIframes:!0,withScripts:!0,maxNetworkCalls:0,timeout:3e3,deepIframes:!0},moat:!1,measureKPI:!1,prfsmpmsnt:5,prfsmitrvpmsnt:1500,kpitrvldrt:15e3,msrkpifctr:0,msrkpiintvl:15,moatPartnerCode:"taboolajsvideo2446883476",sndvltopp:!0,novdtrm:!1,dcdvdurl:!1,firstWaterfallNoaop:0,mxlifls:0,kbnul:"//vidanalytics.taboola.com",frcmtfrms:!0,frcvlm:!1,pxlnotsmtp:!1,cntonvfrc:!0,mxemptwf:0,dtsvrurl:"//vidutils.taboola.com",dtsvr:!1,mltads:!1,erlyai:!1,frcadvlmtrvl:1e3,dbncadvltm:50,stpfrcvlevnt:"AdVideoFirstQuartile",imapihok:!1,trmrdyvpaid:!0,dfltvlm:.4,usstrckisyn:!1,dlywf:!1,adto:3e5,vakll:3e5,ovrtgbydc:!1,strgprvdrttl:6048e5,frstlk:!1,pusvidprtctn:!1,encwfrs:!1,dsktmouttoadcmpltn:0,mbltmouttoadcmpltn:0,loadrsrc:!1,sptxadossrc:"//js.spotx.tv/directsdk/v1/{{chnl}}.js",wfv:1,aderrbfradlddopactv:!1,isMultiVpaidUnit:!1,vtrtlon:!1,hdeadsplypusbtn:!0,isIdleMode:!1,bfrmd:!1,mttst:"",mxntwrkclls:0,rplvpdactv:!1,rvfctr:0,dnapmxvl:0,usopsla:!1,opslavrsn:"1.0.7",mcrsrvcsnmspc:"trc",bllblevt:"",ifrmswghts:{gen:15,ggl:6,pxls:30},dskVidMuted:!1,ovrdnonntvfnclst:{},fkadchcs:!1,istblvpd:!1,usifrmonvpdwrpr:!1,mtdhkactv:!1,addprld:!1,blckbrngtofrnt:!1,tglifrmcntndsplyactv:!1,cmpltonstpddmn:["innovid.com"],syncmthds:!1,cmpltonstpdms:0,aduntldflbfruntld:!1,adwrprstoplrdst:!0,bckflldlyms:5e3,mxbckflldlyitms:0,bfprty:0,lgvpdtxtelmnts:!1,shwadmtebtn:!0,wtfradpsdbfrrsmad:!1,pstnnaggops:!1,mtfctr:0,noplrcntr:!1,plyrcss:"player",vpdcntrcstmcss:"",onPlayerReady:function h(a){},onPlayerLoadError:function i(a){},onPlayerError:function j(a){},onPlayerPlay:function k(a){},onPlayerStop:function l(a){},onPlayerClose:function m(a){},onPlayerPause:function n(a){},onPlayerResume:function o(a){},onPlayerSeek:function p(a){},onPlayerRepeat:function q(a){},onPlayerComplete:function r(a){},onAdLoadError:function s(a,b){},onAdError:function t(a,b){},onAdStopped:function u(a,b){},onAdImpression:function v(a,b){},onAdVideoStart:function w(a,b){},onAdVideoEnd:function x(a,b){},onAdClick:function y(a,b,c){}};for(b in d)void 0==a[b]&&(a[b]=d[b]);return a.description||(a.description=a.title),a.keywords||(a.keywords=a.title),parseFloat(a.width)||parseFloat(a.height)||(a.width="377",a.height="314"),c=parseInt(100*Math.random())+1<=a.ron_percent,a.tagDefault={ad_controls:a.ad_controls,url:"",pubid:"",tagid:"",vidlength:"",video_url:a.files[0],title:a.title,cirf:a.cirf,description:a.description,keywords:a.keywords,ad_parameters:a.default_ad_parameters,muted:a.mute?1:0,auc_dast:a.auc_dast,referrer:a.referrer,domain:a.domain,vertical:a.vertical,roll_type:"mid-roll",oid:a.oid,ad_timeout:a.default_ad_timeout,rs:"1",st:"1",sts:"1",type:"wf",noaop:"10",sortOrderType:0,mfp:4,afbp:a.use_flash_bypass,isRon:c,isvideo:0,mindur:1,maxdur:a.default_ad_timeout,minbr:1,maxbr:1e4,plmd:0,defaultTagTimeout:30,totaltimeout:60,use_as_is:!1,skip_vast:!1},a}function e(){var a,b,c,d={};try{d=window.cmTag.config}catch(e){return{}}a={};for(b in d)0===b.indexOf("player.settings.")&&(c=b.substr(16,b.length-16),a[c]=f(d[b]));return a}function f(a){var b,c=/^\d+$/.test(a);return c?parseInt(a):(b=/^true$|^false$/g.test(a),b?"true"===a||a===!0:a)}Object.defineProperty(c,"__esModule",{value:!0}),c.getDefaults=d,c.getUnitParams=e},{}],38:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){var b,c;return!!a&&(b=parseInt(a.get("ga_factor")),null===V&&b?1===b?V=!0:(b>100&&(b=100),c=o(0,b),V=c===b):V)}function f(a,b,c){e(c)&&k(a,b,c)}function g(a,b,c,d){e(d)&&l(a,b,c,d)}function h(a,b,c){e(c)&&m(a,b,c)}function i(a){return a?1:0}function j(a,b){var c,d=store.get("report_version"),e=new XMLHttpRequest;e.open("POST",store.get("kbnul")+"/put",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c=n(b),e.send("report,event="+a+",version="+d+c+" value=1")}function k(a,b,c){var d,e,f=c.get("player_version"),g=c.get("ab_test")||"";b.tag.requiredViewabilityDrawn&&(g+="!ronrv"),d=new XMLHttpRequest,d.open("POST",c.get("kbnul")+"/putes",!0),e={event:a,timestamp:(new Date).toISOString(),version:f,abTest:g},e=Object.assign(e,b),d.send(F(e))}function l(a,b,c,d){var e,f=d.get("player_version"),g=d.get("ab_test")||"",h=new XMLHttpRequest;h.open("POST",d.get("kbnul")+"/putes/"+a,!0),e={event:b,timestamp:(new Date).toISOString(),version:f,abTest:g},e=Object.assign(e,c),h.send(F(e))}function m(a,b,c){var d=c.get("player_version"),e=new XMLHttpRequest;e.open("POST",c.get("kbnul")+"/putes/vast",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a=Object.assign(a,{version:d,timestamp:(new Date).toISOString()},b),e.send(F(a))}function n(a){var b,c;if("object"!==("undefined"==typeof a?"undefined":S(a)))return"";b="";for(c in a)b+=","+c+"="+a[c];return b}function o(a,b){var c=Math.floor(Math.random()*(b-a+1))+a;return c}function p(a,b){var c=W,d=[],e=0;for(b=b||c.length,a=a||22,e=0;e<a;e++)d[e]=c[0|Math.random()*b];return d.join("")}function q(a){return"string"!=typeof a?a:(a=a.replace(/^(http[s]?:|ftp:)/g,""),0!==a.indexOf("//")&&(a="//"+a),a)}function r(a){var b,c,d,e,f,g;if(!a||"string"!=typeof a)return 0;for(a=u(a),c="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D","undefined"==typeof b&&(b=0),d=0,e=0,b^=-1,f=0,g=a.length;f<g;f++)e=255&(b^a.charCodeAt(f)),d="0x"+c.substr(9*e,8),b=b>>>8^d;return b^-1}function s(a){var b,c,d,e;for(a=a||{},c=function f(){},d=["debug","error","info","log","warn"],e=d.length;e--;)b=d[e],a[b]&&(a[b]=c)}function t(a){var b=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n]+)/im.exec(a);return b&&b.length?b[1]:null}function u(a){var b,c,d;for(a=a.replace(/\r\n/g,"\n"),b="",c=0;c<a.length;c++)d=a.charCodeAt(c),d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128));return b}function v(a){var b=0,c={"pre-roll":0,preroll:0,"mid-roll":-1,midroll:-1,"post-roll":-2,postroll:-2};return c.hasOwnProperty(a)&&(b=c[a]),b}function w(a){return a.replace(/\s/g,"")}function x(a,b){a.className.indexOf(b)===-1&&(a.className+=" "+b),a.className=a.className.split("  ").join(" ")}function y(a,b){a.className=a.className.split(b).join("").split("  ").join(" ")}function z(a){var b,c,d,e={};for(b in a)if(a.hasOwnProperty(b))if("object"==S(a[b])){c=z(a[b]);for(d in c)c.hasOwnProperty(d)&&"function"!=typeof c[d]&&(e[b+"_"+d]=c[d])}else e[b]=a[b];return e}function A(a){try{return JSON.parse(F(a))}catch(b){return{}}}function B(a,b,c,d,e){var f,g,h=this;try{if(!e&&a.contentWindow.console.error&&(a.contentWindow.console.error=function(){}),f="iframe"==a.tagName.toLowerCase()?a.contentDocument:a,!f)return;g=f.querySelectorAll(b),g.forEach(function(a){h.DOMIterator(a,b,c,d,e)}),c(f.querySelectorAll(d))}catch(i){return}}function C(a){if(!a)return null;for(var b=a.querySelector("iframe");b;)try{b=b.contentDocument.querySelector("iframe")}catch(c){break}return b}function D(a,b){return{current:a,hasNext:function c(){try{return!b&&a.contentWindow.console.error&&(this.current.contentWindow.console.error=function(){}),this.current=this.current.contentDocument.querySelector("iframe"),!0}catch(c){return!1}}}}function E(a){try{return/\{\s*\[native code\]\s*\}/.test(a.toString())}catch(b){return!0}}function F(a,b){var c,d,e;try{c=[],d=null,this.isNativeCode(Array.prototype.toJSON)||(d=Array.prototype.toJSON,delete Array.prototype.toJSON),e=JSON.stringify(a,function(a,b){if(null!=b&&"object"==("undefined"==typeof b?"undefined":S(b))){if(c.indexOf(b)>-1)return;c.push(b)}return b},b)}catch(f){e=""}return null!==d&&(Array.prototype.toJSON=d),e}function G(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a&&a.push(b,c,d)}function H(a){return a>1?a/100:a}function I(a){return parseInt(a)}function J(a){return a<1e3?1e3*a:a}function K(a,b){var c=window.cmTag&&window.cmTag.config?window.cmTag.config:{baseReportD:"taboola.com",dataCenter:"am"},d=b.get("baseReportD")||c.baseReportD,e=b.get("dataCenter")||c.dataCenter,f={baseReportD:d,dataCenter:e,cijs:"convusmp",ttype:a,cisd:"convusmp",cipid:b.get("cipid")||"",crid:b.get("creativeId")||"",dast:b.get("auc_dast")||"",cmcv:"",uv:b.get("unit_version")||"",unm:b.get("unit_type")||"",cb:Date.now(),abt:b.get("ab_test")||""};return f}function L(a){var b,c,d="//conv"+a.dataCenter+"mp."+a.baseReportD+"/st?";for(b in a)d+=b+"="+a[b]+"&";c=document.createElement("img"),c.src=d}function M(a,b){return a.filter(function(a){var c=b&&a.hasOwnProperty(b)?a[b]:a;return void 0!==c})}function N(a){var b={};return a.forEach(function(a){b[a.key]=a.value}),b}function O(a,b){for(var c in a)if(a[c]===b)return c;return""}function P(a){var b=a.split("."),c=b[0],d=c.split(":"),e=0,f=1;for(2===b.length&&(e+=parseInt(b[1])/1e3);d.length>0;)e+=f*parseInt(d.pop(),10),f*=60;return e}function Q(a,b){var c=b.get("creatives"),d=encodeURIComponent(c.VIDEO_URL&&c.VIDEO_URL.url?c.VIDEO_URL.url:c.VIDEO_URL),e=(new Date).getTime();return a=a.replace(/%%referrer%%/gi,c.REFERRER),a=a.replace(/%%domain%%/gi,c.DOMAIN),a=a.replace(/%%video-url%%/gi,d),a=a.replace(/%%page-url%%/gi,c.PAGE_URL),a=a.replace(/%%player-width%%/gi,c.PLAYER_WIDTH),a=a.replace(/%%player-height%%/gi,c.PLAYER_HEIGHT),a=a.replace(/%%timestamp%%/gi,Math.floor(e/1e3)),a=a.replace(/%%vidlength%%/gi,c.VIDLENGTH),a=a.replace(/%%keywords%%/gi,c.KEY_WORDS),a=a.replace(/%%description%%/gi,c.DESCRIPTION),a=a.replace(/%%vertical%%/gi,c.VERTICAL),a=a.replace(/%%tag%%/gi,c.TAG?c.TAG:""),a=a.replace(/%%title%%/gi,c.TITLE),a=a.replace(/%%cirf%%/gi,encodeURIComponent(decodeURIComponent(c.CIRF))),a=a.replace(/%%cb%%/gi,"R0."+e),a=a.replace(/%%country%%/gi,b.get("country")),a=a.replace(/%%ip%%/gi,b.get("ip")),a=a.replace(/%%ua%%/gi,encodeURIComponent(navigator.userAgent)),a=a.replace(/%%dast%%/gi,b.get("auc_dast")||""),a=a.replace(/%%[^%]*%%/gi,"")}function R(){return U.UAParser(window.navigator.userAgent)}var S,T,U,V,W;Object.defineProperty(c,"__esModule",{value:!0}),S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c.shouldReport=e,c.reportDb=f,c.reportDebug=g,c.reportVastToDb=h,c.boolToInt=i,c.getRandomInt=o,c.generateGuid=p,c.setUrlPrefix=q,c.crc32=r,c._suppressConsoleMethods=s,c.stripDomain=t,c.getStreamType=v,c.trim=w,c.addClass=x,c.removeClass=y,c.flattenObject=z,c.deepClone=A,c.DOMIterator=B,c.getDeepestIframe=C,c.domIframeIterator=D,c.isNativeCode=E,c.stringify=F,c.logToBI=G,c.normalizeVolume=H,c.roundNumericValue=I,c.normalizeMilliseconds=J,c.createPixelParams=K,c.sendPixel=L,c.filterUndefinededValues=M,c.flattenKeys=N,c.getObjectKeyByValue=O,c.hmsmToSecondsOnly=P,c.replaceMacros=Q,c.parseUserAgent=R,T=a("ua-parser-js"),U=d(T),V=null,W="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split("")},{"ua-parser-js":9}],39:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var e=function f(a){d(this,f),this.parent=a,this.events={},this.dispatchEvent=function b(a,c,d){var e,f=b.beacon;if(void 0==c&&(c={}),a&&f.events[a]){for(e=0;e<f.events[a].useCapture.length;e++)f.events[a].useCapture[e].assignedFunction.apply(f.parent,[{dispatcher:d?d:f.parent,type:a,eventData:c,staticData:f.events[a].useCapture[e].static_data}]);for(e=0;e<f.events[a].noCapture.length;e++)f.events[a].noCapture[e].assignedFunction.apply(f.parent,[{dispatcher:d?d:f.parent,type:a,eventData:c,staticData:f.events[a].noCapture[e].static_data}])}},this.dispatchEvent.beacon=this,this.removeEventListener=function c(a,b){var d,e,f=c.beacon;if(a){if(void 0==b&&f.events[a])return void(f.events[a]={useCapture:[],noCapture:[]});if(b&&f.events[a]&&"function"==typeof b){for(d=[],e=0;e<f.events[a].useCapture.length;e++)f.events[a].useCapture[e].assignedFunction!=b&&d.push(f.events[a].useCapture[e]);for(f.events[a].useCapture=d,d=[],e=0;e<f.events[a].noCapture.length;e++)f.events[a].noCapture[e].assignedFunction==b&&d.push(f.events[a].noCapture[e]);f.events[a].noCapture=d}}},this.removeEventListener.beacon=this,this.addEventListener=function e(a,b,c){var d,f,g=e.beacon;if(a&&"function"==typeof b){for(d=[],f=3;f<arguments.length;f++)d.push(arguments[f]);g.events[a]||(g.events[a]={useCapture:[],noCapture:[]}),c?g.events[a].useCapture.push({assignedFunction:b,static_data:d}):g.events[a].noCapture.push({assignedFunction:b,static_data:d})}},this.addEventListener.beacon=this,this.listEvents=function g(){return Object.keys(g.beacon.events)},this.listEvents.beacon=this,this.listEventHandlers=function h(a){var b,c,d,e=dispatchEvent.beacon;if(!a||!e.events[a])return[];for(c=[],b=e.events[a].useCapture,d=0;d<b;d++)c.push(e.events[a].useCapture[d]);for(b=e.events[a].noCapture,d=0;d<b;d++)c.push(e.events[a].noCapture[d]);return c},this.listEventHandlers.beacon=this,this.destroy=function(){for(var a in self.events)self.events[a]=null;self.events={}}};c["default"]=e,b.exports=c["default"]},{}],40:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;Object.defineProperty(c,"__esModule",{value:!0}),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./Beacon"),i=d(h),j=a("../player/Post"),k=d(j),l=a("./Manager"),m=d(l),n=a("../player/Tracker"),o=d(n),p=a("./WaterfallManager"),q=d(p),r=a("./vpaidEvents"),s=d(r),t=a("./IframesDetector"),u=d(t),v=a("serviceloader"),w=a("oppsula"),x=0,y=function(){function a(b,c,d){var f,g,h;e(this,a),this.vpaidHandler=c,this.store=d,this.vpaidCount=1,this.version="VPAID-1.0.0",this.VPAIDversion="1.1",this.debugTracker=new o["default"](this.version),this.beacon=new i["default"](this),this.vpaidParameters=this._defaultVpaidParameters,this.config=this._defaultVpaidConfig,f={},this._createIframesDetector(),this.store.get("mltads")&&this.store.on("resizeVpaidWrapper",this._onResizeAd.bind(this));for(g in b)f[g.toUpperCase()]=b[g];this.config.creatives=Object.assign({},this._defaultVpaidParameters,f),this.store.get("cmbopps")&&this.store.get("usopsla")&&this._loadOppsula(),this.manager=!1,this._initWaterfall();for(h in this.vpaidEvents)this.beacon.addEventListener(this.vpaidEvents[h],this._runEventFunction.bind(this));this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,""),this.store.emit("mainVpaidCreated",this.config)}return g(a,[{key:"_createIframesDetector",value:function b(){this.store.set("iframesDetector",new u["default"](this.store.get("ifrmswghts")))}},{key:"setVpaidId",value:function c(a){this.version="["+a.wfIndex+"_"+a.dp+"]"}},{key:"_loadOppsula",value:function d(){var a=this;v.init(this.store.data),v.get("oppsula",this.store.get("opslavrsn"),function(b){a.store.set("ms_data",{opps_base_path:a.store.get("opps_base_path")||a.config.creatives.CM_DOMAIN});var c=new b(a.store.get("unit_model"),a.store);a.store.set("oppsula",c),a.store.emit("oppsulaCreated",c)},function(){a.debugTracker.error("Load Oppsula","Error while loading from service loader")})}},{key:"_onResizeAd",value:function h(a){this.config&&(this.config.width=a.width,this.config.height=a.height)}},{key:"trigger",value:function j(a,b){this.vpaidHandler.emit(a,b)}},{key:"runWaterfall",value:function k(a){this.waterfallManager.runWaterfall(a)}},{key:"getVpaidReadyCount",value:function l(){return this.manager.getVpaidReadyCount()}},{key:"_initWaterfall",value:function n(){this.waterfallManager=new q["default"](this.store),this.config.creativeData=this._getCreativeData(this.config),this.waterfallManager.init(this.config.creatives,this.config.creativeData.AdParameters),this.waterfallManager.SetWaterfallError(this._waterfallError.bind(this)),this.waterfallManager.SetWaterfallSuccess(this._waterfallSuccess.bind(this));var a=this;this.waterfallManager.SetShouldRun(function(){var b=this.store.get("max_ready_vpaid")||2,c=this.store.get("waterfall_watermark")||0;return!a.manager||a.manager.getVpaidReadyCount()+c<b})}},{key:"_getSlot",value:function p(a){var b=!1;switch("undefined"==typeof a?"undefined":f(a)){case"string":document.getElementById(a)&&(b=document.getElementById(a));break;case"object":a.style&&a.tagName&&(b=a);break;default:this.debugTracker.error("initAd","Bad slot in 'environmentVars'")}return b}},{key:"_getCreativeData",value:function r(a){var b,c=!1;switch("undefined"==typeof a?"undefined":f(a)){case"object":Object.keys(a).length>0&&(c=!0);break;case"string":if(a.length>0)try{a=new Function("return "+a+";")(),c=!0}catch(d){}}if(c){for(b in this.config.creatives)(void 0==a[b]||this.config.protectedCreatives.indexOf(b)>-1)&&(a[b]=this.config.creatives[b]);a.AdParameters&&(a.AdParameters=this._handleAdParams(a.AdParameters))}return a}},{key:"_handleAdParams",value:function t(a){var b={};switch("undefined"==typeof a?"undefined":f(a)){case"object":Object.keys(a).length>0&&(b=a);break;case"string":if(a.length>0)try{b=new Function("return "+a+";")()}catch(c){}}return b}},{key:"_dataFromUrl",value:function w(a){var b,c,d,e,f=a.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=f.length)return this.debugTracker.warn("dataFromUrl","Bad source parameter!"),this.vpaidParameters;b=f[1].split(/\?|&/gi);for(c in b)if(b[c]&&(d=b[c].split(/=(.+)?/gi,2),2==d.length))if(e=d[0].replace(/\-/gi,"_").toUpperCase(),void 0!=this.vpaidParameters[e])switch(e){case"ISVIDEO":case"PLMD":case"MINDUR":case"MAXDUR":case"MINBR":case"MAXBR":case"VPD":case"VPTD":case"RS":case"ST":case"PLAYER_WIDTH":case"PLAYER_HEIGHT":case"PUBID":case"STS":case"MFP":case"ADTO":case"B2B":case"VMT":case"SORTORDERTYPE":case"TAGID":case"VIDLENGTH":case"DEFAULTTAGTIMEOUT":case"TOTALTIMEOUT":this.vpaidParameters[e]=isNaN(parseInt(d[1]))?0:parseInt(d[1]);break;case"MUTED":case"AFBP":case"DEBUG":case"PAUSE_ON_START":switch(d[1]){case"1":case"true":case"TRUE":this.vpaidParameters[e]=!0;break;case"0":case"false":case"FALSE":this.vpaidParameters[e]=!1}break;case"WP":case"SERVICE":case"PV":case"PT":case"SDID":break;default:this.vpaidParameters[e]=d[1]}else this.debugTracker.warn("dataFromUrl","Parameter '"+d[0]+"' is not supported!");return this.vpaidParameters}},{key:"_runEventFunction",value:function y(a){this["on"+a.type]&&this["on"+a.type](a)}},{key:"_waterfallError",value:function z(a){x||(x=!0)}},{key:"_waterfallSuccess",value:function A(a,b){this.manager&&(this.config.waterfall=a,this.manager.fillSchedule(a,b))}},{key:"_onManagerStopped",value:function B(){this.beacon.dispatchEvent(this.vpaidEvents.AdStopped)}},{key:"getTime",value:function C(){var a=new Date;return a.getTime()}},{key:"initAd",value:function D(a,b,c,d,e,f){this.config.inited||(this.config.target=this._getSlot(f.slot),this.config.target&&(this.config.videoSlotControls=this.store.get("ad_controls"),this.config.videoSlotCanAutoPlay=!0,this.config.width=parseInt(a),this.config.height=parseInt(b),this.config.bitrate=d,this.config.viewMode=c,this.config.creatives.PLAYER_WIDTH=this.config.width,this.config.creatives.PLAYER_HEIGHT=this.config.height,this.config.creativeData=this._getCreativeData(e),this.config.inited=!0,this.manager||(this.manager=new m["default"](this,this.store)),this.manager.onStop=this._onManagerStopped.bind(this),this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded,"")))}},{key:"subscribe",value:function E(a,b){return this.beacon?void(this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)):void this.debugTracker.error("subscribe"," Null ConvertVpaidMain::Beacon ")}},{key:"unsubscribe",value:function F(a,b){if(this.vpaidEvents[b]){if(void 0==a)return;this.beacon.removeEventListener(b,a)}}},{key:"handshakeVersion",value:function G(a){return this.VPAIDversion}},{key:"startAd",value:function H(a){this.manager.playFromQueue(a),this.config.started=!0}},{key:"fire99",value:function I(a,b){this.manager&&this.manager.fire99({waterfallTagId:a,dast:b})}},{key:"resizeAd",value:function J(a,b,c){this.config.width=a,this.config.height=b,this.config.viewMode=c,this.manager&&this.manager.resizeAd(a,b,c)}},{key:"stopAd",value:function K(){this.manager?this.manager.stop():this.beacon.dispatchEvent(this.vpaidEvents.AdStopped)}},{key:"setAdVolume",value:function L(a){if(!this.store.get("isMobile"))return a=a>1?a/100:a,!isNaN(parseFloat(a))&&void(this.manager&&!this.store.get("isMobile")&&this.manager.setAdVolume(a))}},{key:"getAdVolume",value:function M(){return this.manager?this.manager.callWorkingVpaid("getAdVolume",[],0):0}},{key:"getAdLinear",value:function N(){return!this.manager||this.manager.callWorkingVpaid("getAdLinear",[],!0)}},{key:"getAdWidth",value:function O(){return this.manager?this.manager.callWorkingVpaid("getAdWidth",[],this.config.width):this.config.width}},{key:"getAdHeight",value:function P(){return this.manager?this.manager.callWorkingVpaid("getAdHeight",[],this.config.height):this.config.height}},{key:"getAdExpanded",value:function Q(){return!this.manager||this.manager.callWorkingVpaid("getAdExpanded",[],!0)}},{key:"getAdSkippableState",value:function R(){return!!this.manager&&this.manager.callWorkingVpaid("getAdSkippableState",[],!1)}},{key:"getAdSkippableRemainingTime",value:function S(){return this.manager?this.manager.callWorkingVpaid("getAdSkippableRemainingTime",[],-1):-1}},{key:"getAdRemainingTime",value:function T(){return this.manager?this.manager.callWorkingVpaid("getAdRemainingTime",[],-1):-1}},{key:"getAdDuration",value:function U(){return this.manager?this.manager.callWorkingVpaid("getAdDuration",[],-1):-1}},{key:"getAdCompanions",value:function V(){return this.manager?this.manager.callWorkingVpaid("getAdCompanions",[],[]):[]}},{key:"getAdIcons",value:function W(){return this.manager?this.manager.callWorkingVpaid("getAdIcons",[],[]):[]}},{key:"pauseAd",value:function X(){this.manager&&this.manager.callWorkingVpaid("pauseAd",[],!0)}},{key:"resumeAd",value:function Y(){this.manager&&this.manager.callWorkingVpaid("resumeAd",[],!0)}},{key:"expandAd",value:function Z(){this.manager&&this.manager.callWorkingVpaid("expandAd",[],!0)}},{key:"collapseAd",value:function $(){this.manager&&this.manager.callWorkingVpaid("collapseAd",[],!0)}},{key:"skipAd",value:function _(){this.manager&&this.manager.callWorkingVpaid("skipAd",[],!0)}},{key:"getVpaidLogs",value:function aa(){if(this.manager)return this.manager.getVpaidLogs()}},{key:"getAd",value:function ba(a){if(this.manager)return this.manager.getAd(a)}},{key:"onAdLoaded",value:function ca(){}},{key:"onAdStarted",value:function da(){}},{key:"onAdStopped",value:function ea(){}},{key:"onAdSkipped",value:function fa(){}},{key:"onAdSkippableStateChange",value:function ga(){}},{key:"onAdSizeChange",value:function ha(){}},{key:"onAdLinearChange",value:function ia(){}},{key:"onAdDurationChange",value:function ja(){}},{key:"onAdExpandedChange",value:function ka(){}},{key:"onAdVolumeChange",value:function la(){}},{key:"onAdImpression",value:function ma(){}},{key:"onAdVideoStart",value:function na(){}},{key:"onAdVideoFirstQuartile",value:function oa(){}},{key:"onAdVideoMidpoint",value:function pa(){}},{key:"onAdVideoThirdQuartile",value:function qa(){}},{key:"onAdVideoComplete",value:function ra(){}},{key:"onAdClickThru",value:function sa(){}},{key:"onAdInteraction",value:function ta(){}},{key:"onAdUserAcceptInvitation",value:function ua(){}},{key:"onAdUserMinimize",value:function va(){}},{key:"onAdUserClose",value:function wa(){}},{key:"onAdPaused",value:function xa(){}},{key:"onAdPlaying",
value:function ya(){}},{key:"onAdLog",value:function za(){}},{key:"onAdError",value:function Aa(){}},{key:"onVpaidSpecial",value:function Ba(){}},{key:"onSonudViolation",value:function Ca(){}},{key:"vpaidEvents",set:function Da(a){},get:function Ea(){return s["default"]}},{key:"_defaultVpaidParameters",set:function Fa(a){},get:function Ga(){return{VIEW_MODE:"normal",REFERRER:"",VIDEO_URL:"",DOMAIN:"",PUBID:0,TAGID:0,VPD:0,VPTD:0,AUC_DAST:"",VIDLENGTH:0,KEY_WORDS:"",DESCRIPTION:"",SERVICE:"WhiteLabelBidRequestHandlerServlet",VERTICAL:"",SCHEMA:"vast2-vpaid",TYPE:"application/javascript",PV:this.version,RS:1,ST:1,WP:1,PT:5,CIRF:"",SDID:1,STS:0,CB:"",VOLUME:0,TAG:"",PAGE_URL:"",TIME_STAMP:"",TITLE:"",MFP:4,ISVIDEO:1,PLMD:2,MINDUR:1,MAXDUR:60,MINBR:1,MAXBR:512,AFBP:!1,ADTO:60,B2B:1,VMT:0,SORTORDERTYPE:0,DEFAULTTAGTIMEOUT:30,OID:"",NOAOP:"",TOTALTIMEOUT:60,CM_DOMAIN:"http://exchange.basebanner.com",OFFSET:0,MODE:"paralel",MUTED:!1,DEBUG:!1,PAUSE_ON_START:!1,PLAYER_WIDTH:0,PLAYER_HEIGHT:0}}},{key:"_defaultVpaidConfig",set:function Ha(a){},get:function Ia(){return{waterfall:{},source:this.src,videoSlotCanAutoPlay:!0,videoSlotControls:!1,vpaid_protect_path:!1,running:!1,inited:!1,stopped:!1,started:!1,target:!1,video:!1,bitrate:512,creatives:{},protectedCreatives:["WP","PV","PT","SDID","CM_DOMAIN","SERVICE"]}}}]),a}(),c["default"]=y,b.exports=c["default"]},{"../player/Post":22,"../player/Tracker":27,"./Beacon":39,"./IframesDetector":42,"./Manager":48,"./WaterfallManager":63,"./vpaidEvents":71,oppsula:5,serviceloader:7}],41:[function(a,b,c){"use strict";b.exports={tags:7,dCPM:9,CPCV:14}},{}],42:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.iframesWeights=b}return e(a,[{key:"detect",value:function b(a,c){var d=this,e={};return a.map(function(a){var b=d._detectIframeTypeFromUrl(a,c);e[b]=e[b]||{urls:[],counter:0},e[b].urls.push(a),e[b].counter++}),e}},{key:"_detectIframeTypeFromUrl",value:function c(a,b){return a.indexOf("imasdk")>-1?"ggl":b?"pxls":"gen"}},{key:"calculateWeightsByIframeType",value:function f(a){var b,c=0;for(b in a)c+=this.iframesWeights[b]*a[b].counter;return c}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],43:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../player/utils"),h=d(g),i=function(){function a(b,c,d){e(this,a),this.iframe=b,this.channel=void 0,this.sid=void 0,this.store=c,this.vpaidLog=d,this.protocol=this.store.get("httpsOverride")?"https:":window.location.protocol||"http:",h.logToBI(this.vpaidLog,"imaapi_ctor",{event:"ctor"})}return f(a,[{key:"listenToMessages",value:function b(){this.iframe.contentWindow.addEventListener("message",this.onmessage.bind(this))}},{key:"removeMessagesListener",value:function c(){this.iframe.contentWindow.removeEventListener("message",this.onmessage.bind(this))}},{key:"onmessage",value:function d(a){if(a){var b={};try{b=JSON.parse(a.data.replace("ima://",""))}catch(c){return void h.logToBI(this.vpaidLog,"imaapi_message_ex",{ex:c,msg:a})}"viewabilityMeasurement"!==b.type&&(void 0!==b.channel&&void 0===this.channel&&(this.channel=b.channel),void 0!==b.sid&&"*"!==b.sid&&void 0===this.sid&&(this.sid=b.sid),h.logToBI(this.vpaidLog,"imaapi_message",{data:b})),void 0!==this.channel&&void 0!==this.sid&&this.removeMessagesListener()}}},{key:"callApi",value:function g(a,b){if(this.channel&&this.sid&&this.iframe){var c={name:"adsManager",type:a.replace("Ad",""),sid:this.sid,channel:this.channel};"volume"==a&&(c.data={volume:b}),h.logToBI(this.vpaidLog,"imaapi_postmessage",{msg:c}),this.iframe.contentWindow.eval("\n                    var ifrms = document.querySelectorAll('iframe');\n\n                    ifrms.forEach(ifrm => {\n                        if (ifrm.src.indexOf('imasdk.googleapis.com') > -1 && ifrm.src.indexOf('bridge') > -1 && (ifrm.src.indexOf('#"+this.sid+"') > -1 || ifrm.src.indexOf('#"+this.channel+"') > -1)) {\n                            ifrm.contentWindow.postMessage('ima://"+h.stringify(c)+"', '"+this.protocol+"//imasdk.googleapis.com');\n                        }\n                    });\n                ")}}}]),a}(),c["default"]=i,b.exports=c["default"]},{"../player/utils":38}],44:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var e,f;Object.defineProperty(c,"__esModule",{value:!0}),e=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=function(){function a(b){d(this,a),this.baseUrl=b}return e(a,[{key:"load",value:function b(a,c,d){a&&a.length&&window.cmTag&&(this._setWindowLoaderObject(),this._registerOnLoaderResponse(c),this._loadScript(a,c,d))}},{key:"_setWindowLoaderObject",value:function c(){window.cmTag.cmLoader||(window.cmTag.cmLoader={addLoaderCb:function a(b,c){window.cmTag.cmLoader[b]=window.cmTag.cmLoader[b]||{callbacks:[]},window.cmTag.cmLoader[b].callbacks.push(c)}})}},{key:"_registerOnLoaderResponse",value:function f(a){window[a]||(window[a]=function(b){window.cmTag.cmLoader[a].callbacks.map(function(a){try{a(b)}catch(c){}})})}},{key:"_loadScript",value:function g(a,b,c){window.cmTag.cmLoader.addLoaderCb(b,c);var d=document.createElement("script");d.src=this.baseUrl+a,document.body.appendChild(d)}}]),a}(),c["default"]=f,b.exports=c["default"]},{}],45:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function f(a){return a&&a.__esModule?a:{"default":a}}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var h,i,j,k,l,m,n,o;Object.defineProperty(c,"__esModule",{value:!0}),h=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),i=a("../player/Tracker"),j=f(i),k=a("./vpaidEvents"),l=f(k),m=a("../player/utils"),n=d(m),o=function(){function a(b,c,d){g(this,a),this.vpaidLog=c,this.store=d,this.type="vpaid",this.stopped=!1,this.version="1.1",this.target=b.slot,this.video=b.videoSlot,this.mediaFiles=b.vpaidFiles,this.videoSlotControls=b.videoSlotControls,this.videoSlotCanAutoPlay=b.videoSlotCanAutoPlay,this.debugTracker=new j["default"]("JsVpaid");var e=this.store.get("prtct");this.baseUrl=this.store.get("base_url"),this._VpaidProtection=this.baseUrl+e,this._onReady=b.onReady,this._onError=b.onError,this.vpaidEvents=Object.assign({},l["default"]),this.iframe=this._createIframe(),this.VPAID={},this.mediaUrl}return h(a,[{key:"_onIframeWindowError",value:function b(a){this.debugTracker.warn("IframeError",a);var b=this.store.get("debug");return!b}},{key:"_createIframe",value:function c(){var a,b;if(!this.stopped)return a=document.createElement("iframe"),a.style.display="none",this.target.parentNode?this.target.appendChild(a):(b=document.getElementsByTagName("body")[0]||document.getElementsByTagName("div")[0],b.appendChild(a)),a.onload=this._onIframeLoaded.bind(this,a),a.contentWindow.document.open(),a.contentWindow.document.write("<html><head>"+(this._VpaidProtection?"<script type='text/javascript' src='"+this._VpaidProtection+"'></script>":"")+"</head><body></body></html>"),a.contentWindow.document.close(),a}},{key:"_onIframeLoaded",value:function d(a,b){var c,d,e;this.stopped||(this.debugTracker.info("Loading","Iframe was loaded!"),c=a.contentWindow,c.ReportHijackAttempt=this._onHijackAttempt,d=this.store.get("dlgverr")||!1,d&&(c.onerror=this._onIframeWindowError.bind(this)),e=c.document.createElement("script"),e.onerror=this._onVpaidLoadError.bind(this),this.mediaUrl=this.mediaFiles[0].url,e.src=this.mediaUrl,e.onload=this._onVpaidLoadSuccess.bind(this,a),c.document.body.appendChild(e))}},{key:"_onVpaidLoadError",value:function f(a){this.debugTracker.error("ErrorLoadingVpaid",a),this.stopped||this._onError(this,a)}},{key:"_onVpaidLoadSuccess",value:function i(a,b){if(!this.stopped)try{var c=a.contentWindow;this.VPAID=c.getVPAIDAd(),this._onReady(this)}catch(d){n.logToBI(this.vpaidLog,"initJsError",{err:e.message}),this._onVpaidLoadError(d)}}},{key:"_safeCall",value:function k(a,b){if(!this.stopped)try{return this.VPAID[a].apply(this.VPAID,b)}catch(c){return n.logToBI(this.vpaidLog,"jsCallError",{err:c.message}),this._onAdError(c),!1}}},{key:"restartAd",value:function m(){this.video.currentTime=0,this.video.play()}},{key:"handshakeVersion",value:function o(a){return this._safeCall("handshakeVersion",[a])}},{key:"resizeAd",value:function p(a,b,c){this.target.style.width=a+"px",this.target.style.height=b+"px",this.target.setAttribute("width",a),this.target.setAttribute("height",b),this._safeCall("resizeAd",[a,b,c])}},{key:"initAd",value:function q(a,b,c,d,e,f){this._safeCall("initAd",[a,b,c,d,e,f])}},{key:"stopAd",value:function r(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_stopAd",value:function s(){this.stopped||(this.iframe&&this.iframe.parentNode.removeChild(this.iframe),this.iframe=this.VPAID=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=void 0,this.vpaidLog=null,this.stopped=!0,this.onAfterStop())}},{key:"pauseAd",value:function t(){this._safeCall("pauseAd",[])}},{key:"resumeAd",value:function u(){this._safeCall("resumeAd",[])}},{key:"skipAd",value:function v(){this._safeCall("skipAd",[])}},{key:"startAd",value:function w(){this._safeCall("startAd",[])}},{key:"expandAd",value:function x(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function y(){this._safeCall("collapseAd",[])}},{key:"setAdVolume",value:function z(a){this._safeCall("setAdVolume",[a])}},{key:"getAdWidth",value:function A(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function B(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function C(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function D(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function E(){return this._safeCall("getAdDuration",[])}},{key:"getAdSkippableState",value:function F(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function G(a){return this._safeCall("getAdVolume",[a])}},{key:"getAdIcons",value:function H(){return this._safeCall("getAdIcons",[])}},{key:"getAdCompanions",value:function I(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function J(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function K(){return this._safeCall("getAdLinear",[])}},{key:"subscribe",value:function L(a,b){this.vpaidEvents[b]&&(b==this.vpaidEvents.AdError&&(this._onAdError=a),b==this.vpaidEvents.HijackAttempt?this._onHijackAttempt=a:this._safeCall("subscribe",[a,b],!0))}},{key:"unsubscribe",value:function M(a,b){if(this.vpaidEvents[b]){if(void 0==a)return;this._safeCall("unsubscribe",[a,b],!0)}}},{key:"onAfterStop",value:function N(){}},{key:"_onAdError",value:function O(){}},{key:"_onHijackAttempt",value:function P(){}},{key:"_getMediaUrl",value:function Q(){return this.mediaUrl}}]),a}(),c["default"]=o,b.exports=c["default"]},{"../player/Tracker":27,"../player/utils":38,"./vpaidEvents":71}],46:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("./vpaidEvents"),k=e(j),l=a("./Beacon"),m=e(l),n=a("../player/utils"),o=d(n),p=a("./ImaApi"),q=e(p),r=a("../VPAIDHTML5Client/js/VPAIDHTML5Client"),s=!0,t=function(){function a(b,c,d){var e=this;f(this,a),this.vpaidLog=c,this.store=d,this.type="vpaid",this.stopped=!1,this.version="1.1",this.target=b.slot,this.video=b.videoSlot,this.mediaFiles=b.vpaidFiles,this.mediaUrl,this.videoSlotControls=b.videoSlotControls,this.videoSlotCanAutoPlay=b.videoSlotCanAutoPlay,this.debugTracker=new i["default"]("JsVpaid"),this.baseUrl=this.store.get("base_url"),this._onReady=b.onReady,this._onError=b.onError,this.vpaidEvents=Object.assign({},k["default"]),this.beacon=new m["default"](this),this.volume=0,this.isMuted=!0,this.callIMAApi=void 0,this.pauseVideoProtectionDuration=500,this.registerAnalyticsToVpaidLog=b.extra.registerAnalyticsToVpaidLog,this.analyticsRegistered=!1,this.adLoaded=!1,this.playerDAST=b.playerDAST,setTimeout(function(){e._onReady()},2)}return g(a,[{key:"_safeCall",value:function b(a,c){if(!this.stopped&&this.adUnit)try{return this.adUnit[a].apply(this.adUnit,c)}catch(d){return o.logToBI(this.vpaidLog,"initJsError",{err:d.message,funcName:a,stack:d.stack}),this._onAdError(d),!1}}},{key:"restartAd",value:function c(a,b){if(o.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),!this.stopped)if(this.clickThruUrl=b,""===this._getVideoSrc(this.video)){if(!a)return void o.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!1});o.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!0}),this.video.src=a,this._bindedOnRestartVideoLoad=this._onRestartVideoLoad.bind(this),this.video.addEventListener("canplay",this._bindedOnRestartVideoLoad),this.video.load()}else this._onRestartVideoLoad()}},{key:"_onRestartVideoLoad",value:function d(){var a,b,c=this;this.adRestarted=!0,this._bindedOnRestartVideoLoad&&(this.video.removeEventListener("canplay",this._bindedOnRestartVideoLoad),this._bindedOnRestartVideoLoad=void 0),this.video.currentTime=0,this._resizeVideotoParentSize(),this.video.play(),a=function d(){o.logToBI(c.vpaidLog,"restartAd",{videoClicked:!0,url:c.clickThruUrl}),c.beacon.dispatchEvent(c.vpaidEvents.AdClickThru,{url:c.clickThruUrl,playerHandles:!0})},b=function e(){o.logToBI(c.vpaidLog,"restartAd",{videoComplete:!0}),c.video.removeEventListener("ended",e),c.video.removeEventListener("click",a),c._allEventsHandler(c.vpaidEvents.AdVideoComplete,{})},this.video.addEventListener("ended",b),this.video.addEventListener("click",a)}},{key:"isReplayable",value:function e(){return this.video&&""!==this._getVideoSrc(this.video)}},{key:"_resizeVideotoParentSize",value:function h(){this.video.style.width=this.target.style.width,this.video.style.height=this.target.style.height}},{key:"handshakeVersion",value:function j(a){return"2.0"}},{key:"resizeAd",value:function l(a,b,c){this.target.style.width=a+"px",this.target.style.height=b+"px",this.target.setAttribute("width",a),this.target.setAttribute("height",b),this._safeCall("resizeAd",[a,b,c])}},{key:"initAd",value:function n(a,b,c,d,e,f){function g(d,f){function g(d,g){f.initAd(a,b,c,-1,e,{})}if(!i.stopped){if(d)return o.logToBI(i.vpaidLog,"loadVPAIDJSScript",{scriptLoadedError:!0}),void(i.store&&i.store.get("aduntldflbfruntld")&&!i.adUnit?i._onError(d,"adUnitLoadFailed"):i._onError());o.logToBI(i.vpaidLog,"loadVPAIDJSScript",{scriptLoaded:!0}),i.adUnit=f,i.store.get("imapihok")&&(i.imaApi=new q["default"](i.adUnit._iframe,i.store,i.vpaidLog),i.imaApi.listenToMessages(),i.callIMAApi=i.imaApi.callApi.bind(i.imaApi)),i._bindIframe(f),i._bindAdUnitEvents(f),f.handshakeVersion("2.0",g);var h=i.store.get("cmpltonstpddmn");h&&h.length>0&&i.mediaUrl.search(new RegExp(h.join("|"),"i"))!=-1&&(i.completeOnAdStop=!0)}}var h,i,j=this.mediaFiles[0];this.playerDAST.set({vbr:j.bitrate,vwd:j.width,vht:j.height,ot:j.originalType,st:j.subType}),this.mediaUrl=j.url,this.stopped||(this.debugTracker.info("Loading","Iframe was loaded!"),h=new r(this.target,this.video,{}),this.vpaid=h,h.loadAdUnit(this.mediaUrl,g),i=this)}},{key:"checkUnfriendlyIframe",value:function p(){var a=o.getDeepestIframe(this.target),b="";try{return a&&a.contentDocument,!1}catch(c){return b=a.src,o.logToBI(this.vpaidLog,"unfriendlyIframe",{src:b}),!0}}},{key:"_bindIframe",value:function s(a){var b,c,d=a._iframe;this.analyticsRegistered=this.registerAnalyticsToVpaidLog(d),this.store.get("hjkFuncString")?(d.contentWindow.ReportHijackAttempt=this._onHijackAttempt,d.contentWindow.eval(this.store.get("hjkFuncString"))):o.logToBI(this.vpaidLog,"missingHjk",{}),b=this.store.get("debug"),b||(d.contentWindow.onerror=function(){return!0},o._suppressConsoleMethods(d.contentWindow.console)),this._soundProtection(this.video),c=this.store.get("blkflshjs")||!1,this._blockDOMObjectInWin(d.contentWindow)}},{key:"_bindAdUnitEvents",value:function t(a){var b,c=this;for(b in this.vpaidEvents)!function(b){a.subscribe(b,function(a){c._allEventsHandler(b,a)})}(b)}},{key:"_blockDOMObjectInWin",value:function u(a){var b=this.store.get("jsnoflshdtct"),c="window.navigator.__defineGetter__('plugins', function () { return []; });",d='\n        \n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "_data",\n            Object.getOwnPropertyDescriptor(\n                HTMLObjectElement.prototype,\n                "data"\n            )\n        );\n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "data", {\n                set : function(val){\n                    console.log(\'HTMLObjectElement block\');\n                    return;\n                }\n            }\n        );';b&&(d=c+d);try{a.eval(d)}catch(e){console.log(e)}}},{key:"_soundProtection",value:function v(a){var b=this;a.addEventListener("volumechange",function(){b.adLoaded&&b.isMuted&&0!=a.volume&&b.beacon.dispatchEvent(b.vpaidEvents.SoundViolation,{vol:a.volume}),a.volume!==b.volume&&(o.logToBI(this.vpaidLog,"soundProtection",{selfSound:b.volume,videoSound:a.volume}),a.volume=b.volume)})}},{key:"_allEventsHandler",value:function w(a,b){if(!this.stopped){if("AdImpression"===a){var c=this.video.src;c&&o.logToBI(this.vpaidLog,"videoUrl",{url:c})}a===this.vpaidEvents.AdStopped&&(this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout)),"AdLoaded"===a&&(this.adLoaded=!0),this.beacon.dispatchEvent(a,b)}}},{key:"stopAd",value:function x(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_stopAd",value:function y(){if(this.adUnit){if(this.adUnit._iframe&&this.adUnit._iframe.contentWindow&&(this.adUnit._iframe.contentWindow.ReportHijackAttempt=null,this.analyticsRegistered))try{this.adUnit._iframe.contentWindow.destroyAnalyticsReporter&&(this.adUnit._iframe.contentWindow.destroyAnalyticsReporter(),o.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!0}))}catch(a){o.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!1,ex:a})}this.adUnit._destroy()}this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this.iframe=this.vpaid=this.imaApi=this.callIMAApi=this.adUnit=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=this.registerAnalyticsToVpaidLog=void 0,this.vpaidLog=null,this.store=void 0,this.stopped=!0,this.onAfterStop()}},{key:"pauseAd",value:function z(){var a=this,b=function c(){};(this.store.get("pusvidprtctn")||this.adRestarted)&&(b=function d(){a.adRestarted||(a.pauseAdProtectionTimeout=clearTimeout(a.pauseAdProtectionTimeout))},this.pauseAdProtectionTimeout||(this.pauseAdProtectionTimeout=setTimeout(function(){a.video&&(o.logToBI(a.vpaidLog,"pauseAdProtection",{state:!1,adRestarted:a.adRestarted}),a.video.pause())},this.pauseVideoProtectionDuration))),this._safeCall("pauseAd",[b])}},{key:"resumeAd",value:function A(){var a=this,b=function c(){};this.adRestarted&&(b=function d(){a.video.play()}),this._safeCall("resumeAd",[b])}},{key:"skipAd",value:function B(){this._safeCall("skipAd",[])}},{key:"startAd",value:function C(){this._safeCall("startAd",[])}},{key:"expandAd",value:function D(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function E(){this._safeCall("collapseAd",[])}},{key:"setAdVolume",value:function F(a){var b=this;this.volume=a,this.isMuted=0===this.volume,this.store.get("frcvlm")&&(this.video.volume=a,this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{dispatcher:this})),this._safeCall("setAdVolume",[a,function(){b.adRestarted&&(b.video.volume=a,b.video.muted=0===a)}])}},{key:"getAdWidth",value:function G(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function H(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function I(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function J(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function K(a){return this._safeCall("getAdDuration",[a])}},{key:"getAdSkippableState",value:function L(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function M(a){return this._safeCall("getAdVolume",[a])}},{key:"getAdIcons",value:function N(a){this._safeCall("getAdIcons",[a])}},{key:"getAdCompanions",value:function O(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function P(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function Q(){return this._safeCall("getAdLinear",[])}},{key:"getDOMContainer",value:function R(){return this.target}},{key:"subscribe",value:function S(a,b){this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)}},{key:"unsubscribe",value:function T(a,b){if(this.vpaidEvents[b]){if(!a)return;this.beacon.removeEventListener(b,a)}}},{key:"onAfterStop",value:function U(){}},{key:"_onAdError",value:function V(){}},{key:"_getMediaUrl",value:function W(){return this.mediaUrl}},{key:"getVideoUrl",value:function X(){return this._getVideoSrc(this.video)||this._findVideoUrlInIframes(this.target.querySelectorAll("iframe"))}},{key:"getVPAIDVideoElement",value:function Y(){return this.vpaidVideoElement||null}},{key:"logVideoUrl",value:function Z(){var a=this.getVideoUrl();a?(o.logToBI(this.vpaidLog,"jsVpaidVideoUrl",{videoUrl:a}),this.vpaidLog.friendlyVideoUrl=!0):o.logToBI(this.vpaidLog,"jsVpaidUnfriendlyVideo",{unfriendlyVideo:!0})}},{key:"_findVideoUrlInIframes",value:function $(a){var b=this,c="";if(!a||0===a.length)return c;try{o.DOMIterator(a[0],"iframe",function(a){a.forEach(function(a){c||(b.vpaidVideoElement=a,c=b._getVideoSrc(a))})},"video",this.store.get("debug")),c||(c=this._findVideoUrlInIframes(a[0].contentDocument.querySelectorAll("iframe")))}catch(d){}return c}},{key:"_getVideoSrc",value:function _(a){var b,c,d;if(a.src)return a.src;if(b="",a.childNodes.length>0)for(c=a.querySelectorAll("source"),d=0;d<c.length;d++)if(c[d].src){b=c[d].src;break}return b}},{key:"onMuteChanged",value:function aa(a){this.isMuted=a}},{key:"toggleIframeContentDisplay",value:function ba(a){try{var b="none";"hide"===a?b="hidden":"show"===a&&(b="visible"),this.adUnit._iframe.contentWindow.document.body.style.visibility=b}catch(c){o.logToBI(this.vpaidLog,"toggleIframeContentDisplayFail",{ex:c})}}},{key:"setCompletionOnAdStoppedTimeout",value:function ca(){var a=this,b=this.store.getByLineItem("cmpltonstpdms");b>0&&(this.completionOnAdStoppedTimeout||(this.completionOnAdStoppedTimeout=setTimeout(function(){a.stopped||a.beacon.dispatchEvent(a.vpaidEvents.AdStopped)},b)))}},{key:"logVpaidElements",value:function da(){this.adUnit._iframe&&(this.vpaidTextElements={},this._logVpaidElementsFromIframe(this.adUnit._iframe),o.logToBI(this.vpaidLog,"vpaidTextElements",this.vpaidTextElements))}},{key:"_logVpaidElementsFromIframe",value:function ea(a){var b,c,d,e;try{for(b=a.contentWindow.document.body.getElementsByTagName("*")||[],c=0;c<b.length;c++)d=b[c],e=d.nodeName.toLowerCase(),"iframe"===e?this._logVpaidElementsFromIframe(d):"script"!==e&&d.textContent&&(this.vpaidTextElements[e]=this.vpaidTextElements[e]||[],this.vpaidTextElements[e].push({id:d.id,className:d.className,text:d.textContent}))}catch(f){}}}]),a}(),c["default"]=t,b.exports=c["default"]},{"../VPAIDHTML5Client/js/VPAIDHTML5Client":12,"../player/Tracker":27,"../player/utils":38,"./Beacon":39,"./ImaApi":43,"./vpaidEvents":71}],47:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("./vpaidEvents"),k=e(j),l=a("./Beacon"),m=e(l),n=a("../player/utils"),o=d(n),p=a("./Mpg1Canvas"),q=e(p),r=a("../VPAIDHTML5Client/js/VPAIDHTML5Client"),s=0,t=function(){function a(b,c,d){var e,g,h,j=this;f(this,a),this.vpaidLog=c,this.store=d,this.type="vpaid",this.tech="javascript",this.stopped=!1,this.version="1.1",this.target=b.slot,this.video=b.videoSlot,this.mediaFiles=b.vpaidFiles,this.mediaUrl,this.videoSlotControls=b.videoSlotControls,this.videoSlotCanAutoPlay=b.videoSlotCanAutoPlay,this.debugTracker=new i["default"]("JsVpaid"),this._onReady=b.onReady,this._onError=b.onError,this.tag=b.tag,this.vpaidEvents=Object.assign({},k["default"]),this.beacon=new m["default"](this),this.volume=0,this.isMuted=!0,this.pauseVideoProtectionDuration=500,this.registerAnalyticsToVpaidLog=b.extra.registerAnalyticsToVpaidLog,this.analyticsRegistered=!1,e=this.store.get("ua"),this.video.muted=!0,this.video.setAttribute("vcounter",s++),this.video.setAttribute("playsinline",""),this.useCanvasMpeg=this.store.get("uscnvsmpg")||!1,this.hasAutoPlay=this.store.get("hasAutoPlay")||!1,this.isMobile=this.store.get("isMobile")||!1,this.isCanvasMpeg=this._decideCanvas(),this.canvasReady=!1,this.playerDAST=b.playerDAST,g=this.store.get("sprssviderr"),g&&this._hookeEventListener(b.videoSlot),this.isCanvasMpeg&&(this.canvas=new q["default"](this.video,this,null,null,d),this.canvas.on("ready",function(){}),this.canvas.on("play",function(){j.beacon.dispatchEvent(j.vpaidEvents.AdStarted)}),this.canvas.on("newVidCreated",function(a){a.addEventListener("ended",function(){j.beacon.dispatchEvent(j.vpaidEvents.AdVideoComplete)}),j.canvas&&(j.canvas.removeListener(j.vpaidEvents.AdVideoFirstQuartile,j._bindedAdVideoFirstQuartileDispatcher),j.canvas.removeListener(j.vpaidEvents.AdVideoMidpoint,j._bindedAdVideoMidpointDispatcher),j.canvas.removeListener(j.vpaidEvents.AdVideoThirdQuartile,j._bindedAdVideoThirdQuartileDispatcher))}),this._bindedAdVideoFirstQuartileDispatcher=this._dispatchQuartileEvent.bind(this,this.vpaidEvents.AdVideoFirstQuartile),this._bindedAdVideoMidpointDispatcher=this._dispatchQuartileEvent.bind(this,this.vpaidEvents.AdVideoMidpoint),this._bindedAdVideoThirdQuartileDispatcher=this._dispatchQuartileEvent.bind(this,this.vpaidEvents.AdVideoThirdQuartile),this.canvas.once(this.vpaidEvents.AdVideoFirstQuartile,this._bindedAdVideoFirstQuartileDispatcher),this.canvas.once(this.vpaidEvents.AdVideoMidpoint,this._bindedAdVideoMidpointDispatcher),this.canvas.once(this.vpaidEvents.AdVideoThirdQuartile,this._bindedAdVideoThirdQuartileDispatcher),h=document.getElementsByClassName("vpaid-ad-controls")[0],h&&(h.className+=" hide")),setTimeout(function(){j._onReady()},2),o.logToBI(this.vpaidLog,"vpaidInit",{hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg,forceCavnas:this.store.get("forcecnvsmpg"),useAutoPlayForContent:this.store.get("useapforcntnt"),isMobile:this.isMobile}),this.canvas&&this.canvas.on("canvasEnded",function(){j._allEventsHandler("AdVideoComplete",[])})}return g(a,[{key:"_dispatchQuartileEvent",value:function b(a){this.beacon.dispatchEvent(a)}},{key:"muteClick",value:function c(){this.stopped||(this.canvas?this.canvas.muteButtonClick():this.volume?this.setAdVolume(0):this.setAdVolume(.7))}},{key:"_hookeEventListener",value:function d(a){var b=a.addEventListener;a.addEventListener=function(c,d){"error"!==c&&b.apply(a,[c,d])}}},{key:"_decideCanvas",value:function e(){var a,b,c,d;return!!this.store.get("uscnvsmpg")&&(a=this.store.get("dsm")||{},b=a.mobAp||[],c=this.tag.advId,b.indexOf(c)>-1?(o.logToBI(this.vpaidLog,"canvasOptOutByAdvId",{advId:c}),!1):(d=this.store.get("forcecnvsmpg")||!1,this.useCanvasMpeg&&!this.hasAutoPlay&&this.isMobile||d))}},{key:"_resizeAd",value:function h(a){this.stopped||this.canvas&&this.canvas.onResize(a[0],a[1])}},{key:"_safeCall",value:function j(a,b){if(!this.stopped&&this.adUnit){"resizeAd"===a&&this._resizeAd(b);try{return this.adUnit[a].apply(this.adUnit,b)}catch(c){return o.logToBI(this.vpaidLog,"initJsError",{err:c.message,funcName:a,args:b,stack:c.stack}),!1}}}},{key:"restartAd",value:function l(a,b){if(o.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),!this.stopped)if(this.clickThruUrl=b,""===this._getVideoSrc(this.video)){if(!a)return void o.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!1});o.logToBI(this.vpaidLog,"restartAd",{videoUrlReplaced:!0}),this.video.src=a,this._bindedOnRestartVideoLoad=this._onRestartVideoLoad.bind(this),this.video.addEventListener("canplay",this._bindedOnRestartVideoLoad),this.video.load()}else this._onRestartVideoLoad()}},{key:"_onRestartVideoLoad",value:function n(){var a,b,c=this;this.adRestarted=!0,this._bindedOnRestartVideoLoad&&(this.video.removeEventListener("canplay",this._bindedOnRestartVideoLoad),this._bindedOnRestartVideoLoad=void 0),this.video.currentTime=0,this._resizeVideotoParentSize(),this.video.play(),a=function d(){o.logToBI(c.vpaidLog,"restartAd",{videoClicked:!0,url:c.clickThruUrl}),c.beacon.dispatchEvent(c.vpaidEvents.AdClickThru,{url:c.clickThruUrl,playerHandles:!0})},b=function e(){o.logToBI(c.vpaidLog,"restartAd",{videoComplete:!0}),c.video.removeEventListener("ended",e),c.video.removeEventListener("click",a),c._allEventsHandler(c.vpaidEvents.AdVideoComplete,{})},this.video.addEventListener("ended",b),this.video.addEventListener("click",a)}},{key:"isReplayable",value:function p(){return!this.canvas&&this.video&&""!==this._getVideoSrc(this.video)}},{key:"_resizeVideotoParentSize",value:function t(){this.video.style.width=this.target.style.width,this.video.style.height=this.target.style.height}},{key:"handshakeVersion",value:function u(a){return"2.0"}},{key:"resizeAd",value:function v(a,b,c){this.stopped||(this.target.style.width=a+"px",this.target.style.height=b+"px",this.target.setAttribute("width",a),this.target.setAttribute("height",b),this._safeCall("resizeAd",[a,b,c]),this.canvas&&this.canvas.onResize(a,b));
}},{key:"initAd",value:function w(a,b,c,d,e,f){function g(d,f){var g,h;try{if(g=function k(d,g){d?o.logToBI(j.vpaidLog,"handshakeVPAIDJSScript",{handshake:!1,error:d}):o.logToBI(j.vpaidLog,"handshakeVPAIDJSScript",{handshake:!0}),f.initAd(a,b,c,-1,e,{})},j.stopped)return void o.logToBI(j.vpaidLog,"loadVPAIDJSScript",{stopped:!0});if(d)return o.logToBI(j.vpaidLog,"loadVPAIDJSScript",{scriptLoadedError:!0}),void(j.store.get("aduntldflbfruntld")&&j.adUnit?j._onError():j._onError(d,"adUnitLoadFailed"));o.logToBI(j.vpaidLog,"loadVPAIDJSScript",{scriptLoaded:!0}),j.adUnit=f,j.adUnit.syncmthds=j.store.get("syncmthds"),j._bindIframe(f),j._bindAdUnitEvents(f),f.handshakeVersion("2.0",g),h=j.store.get("cmpltonstpddmn"),h&&h.length>0&&j.mediaUrl.search(new RegExp(h.join("|"),"i"))!=-1&&(j.completeOnAdStop=!0)}catch(i){o.logToBI(j.vpaidLog,"loadVPAIDJSScriptErr",{err:i.message})}}var h,i,j;this.stopped||(h=this.mediaFiles[0],this.playerDAST.set({vbr:h.bitrate,vwd:h.width,vht:h.height,ot:h.originalType,st:h.subType}),this.mediaUrl=h.url,this.debugTracker.info("Loading","Iframe was loaded!"),i=new r(this.target,this.video,{}),this.vpaid=i,i.loadAdUnit(this.mediaUrl,g),j=this)}},{key:"checkUnfriendlyIframe",value:function x(){var a=o.getDeepestIframe(this.target),b="";try{return a&&a.contentDocument,!1}catch(c){return b=a.src,o.logToBI(this.vpaidLog,"unfriendlyIframe",{src:b}),!0}}},{key:"_bindIframe",value:function y(a){var b,c=a._iframe;this.analyticsRegistered=this.registerAnalyticsToVpaidLog(c),this.store.get("hjkFuncString")?(c.contentWindow.ReportHijackAttempt=this._onHijackAttempt,c.contentWindow.eval(this.store.get("hjkFuncString"))):o.logToBI(this.vpaidLog,"missingHjk",{}),b=this.store.get("debug"),b||(c.contentWindow.onerror=function(){return!0},o._suppressConsoleMethods(c.contentWindow.console)),this._unmuteHook()}},{key:"_bindAdUnitEvents",value:function z(a){var b,c=this;for(b in this.vpaidEvents)!function(b){a.subscribe(b,function(a){c._allEventsHandler(b,a)})}(b)}},{key:"_unmuteHook",value:function A(){if(this.store.get("mtdhkactv")){var a=this;this.video.__defineSetter__("_muted",this.video.__lookupSetter__("muted")),this.video.__defineSetter__("muted",function(a){return this._mutedChangeByUserGesture?(this._muted=a,void this.__defineSetter__("muted",this.__lookupSetter__("_muted"))):void(this._muted=!0)})}}},{key:"_allEventsHandler",value:function B(a,b){var c,d=this;this.stopped||(a===this.vpaidEvents.AdStopped&&(this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout)),"AdImpression"===a?(c=this.video.src,c&&o.logToBI(this.vpaidLog,"videoUrl",{url:c}),this.canvas&&!this.canvas.loaded?this.canvas.on("ready",function(){d.beacon.dispatchEvent("AdImpression",[])}):this.beacon.dispatchEvent(a,b)):this.beacon.dispatchEvent(a,b))}},{key:"stopAd",value:function C(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_stopAd",value:function D(){if(!this.stopped){if(this.stopped=!0,this.adUnit&&this.adUnit._iframe&&this.adUnit._iframe.contentWindow&&(this.adUnit._iframe.contentWindow.ReportHijackAttempt=null,this.analyticsRegistered))try{this.adUnit._iframe.contentWindow.destroyAnalyticsReporter&&(this.adUnit._iframe.contentWindow.destroyAnalyticsReporter(),o.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!0}))}catch(a){o.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!1,ex:a})}this.adUnit&&this.adUnit._destroy(),this.vpaid&&this.vpaid.destroy(),this.canvas&&this.canvas.destroy(),this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this._bindedAdVideoFirstQuartileDispatcher=this._bindedAdVideoMidpointDispatcher=this._bindedAdVideoThirdQuartileDispatcher=void 0,this.iframe=this.vpaid=this.adUnit=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.debugTracker=this.beacon=this.registerAnalyticsToVpaidLog=void 0,this.vpaidLog=null,this.tag=void 0,this.store=void 0,this.onAfterStop()}}},{key:"pauseAd",value:function E(){var a=this,b=function c(){};(this.store.get("pusvidprtctn")||this.adRestarted)&&(b=function d(){a.adRestarted||(a.pauseAdProtectionTimeout=clearTimeout(a.pauseAdProtectionTimeout))},this.pauseAdProtectionTimeout||(this.pauseAdProtectionTimeout=setTimeout(function(){a.video&&(o.logToBI(a.vpaidLog,"pauseAdProtection",{state:!1,adRestarted:a.adRestarted}),a.video.pause())},this.pauseVideoProtectionDuration))),this._safeCall("pauseAd",[b])}},{key:"resumeAd",value:function F(){var a=this,b=function c(){};this.adRestarted&&(b=function d(){a.video.play()}),this._safeCall("resumeAd",[b])}},{key:"skipAd",value:function G(){this._safeCall("skipAd",[])}},{key:"startAd",value:function H(){o.logToBI(this.vpaidLog,"jsMobileStartAd",{start:!0}),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.canvas&&this.canvas.emitStartAd(),this._safeCall("startAd",[])}},{key:"expandAd",value:function I(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function J(){this._safeCall("collapseAd",[])}},{key:"setAdVolume",value:function K(a,b){var c=this;this.volume=a,this.video._mutedChangeByUserGesture=b,this.video.muted=this.isMuted=0===this.volume,this._safeCall("setAdVolume",[a,function(){c.adRestarted&&(c.video.volume=a,c.video.muted=0===a)}])}},{key:"getAdWidth",value:function L(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function M(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function N(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function O(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function P(a){return this._safeCall("getAdDuration",[a])}},{key:"getAdSkippableState",value:function Q(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function R(a){return this._safeCall("getAdVolume",[a])}},{key:"getAdIcons",value:function S(a){this._safeCall("getAdIcons",[a])}},{key:"getAdCompanions",value:function T(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function U(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function V(){return this._safeCall("getAdLinear",[])}},{key:"getDOMContainer",value:function W(){return this.target}},{key:"subscribe",value:function X(a,b){this.stopped||this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)}},{key:"unsubscribe",value:function Y(a,b){if(!this.stopped&&this.vpaidEvents[b]){if(!a)return;this.beacon.removeEventListener(b,a)}}},{key:"onAfterStop",value:function Z(){}},{key:"_onAdError",value:function $(){}},{key:"_getMediaUrl",value:function _(){return this.mediaUrl}},{key:"getVideoUrl",value:function aa(){return this._getVideoSrc(this.video)||this._findVideoUrlInIframes(this.target.querySelectorAll("iframe"))}},{key:"getVPAIDVideoElement",value:function ba(){return this.vpaidVideoElement||null}},{key:"logVideoUrl",value:function ca(){var a=this.getVideoUrl();a?(o.logToBI(this.vpaidLog,"jsVpaidVideoUrl",{videoUrl:a}),this.vpaidLog.friendlyVideoUrl=!0):o.logToBI(this.vpaidLog,"jsVpaidUnfriendlyVideo",{unfriendlyVideo:!0})}},{key:"_findVideoUrlInIframes",value:function da(a){var b=this,c="";if(!a||0===a.length)return c;try{o.DOMIterator(a[0],"iframe",function(a){a.forEach(function(a){c||(b.vpaidVideoElement=a,c=b._getVideoSrc(a))})},"video",this.store.get("debug")),c||(c=this._findVideoUrlInIframes(a[0].contentDocument.querySelectorAll("iframe")))}catch(d){}return c}},{key:"_getVideoSrc",value:function ea(a){if(a.src)return a.src;var b="";return a.childNodes.length>0&&a.querySelectorAll("source").forEach(function(a){!b&&a.src&&(b=a.src)}),b}},{key:"toggleIframeContentDisplay",value:function fa(a){try{var b="none";"hide"===a?b="hidden":"show"===a&&(b="visible"),this.adUnit._iframe.contentWindow.document.body.style.visibility=b}catch(c){o.logToBI(this.vpaidLog,"toggleIframeContentDisplayFail",{ex:c})}}},{key:"setCompletionOnAdStoppedTimeout",value:function ga(){var a=this,b=this.store.getByLineItem("cmpltonstpdms");b>0&&(this.completionOnAdStoppedTimeout||(this.completionOnAdStoppedTimeout=setTimeout(function(){a.stopped||a.beacon.dispatchEvent(a.vpaidEvents.AdStopped)},b)))}},{key:"logVpaidElements",value:function ha(){this.adUnit._iframe&&(this.vpaidTextElements={},this._logVpaidElementsFromIframe(this.adUnit._iframe),o.logToBI(this.vpaidLog,"vpaidTextElements",this.vpaidTextElements))}},{key:"_logVpaidElementsFromIframe",value:function ia(a){var b,c,d,e;try{for(b=a.contentWindow.document.body.getElementsByTagName("*")||[],c=0;c<b.length;c++)d=b[c],e=d.nodeName.toLowerCase(),"iframe"===e?this._logVpaidElementsFromIframe(d):"script"!==e&&d.textContent&&(this.vpaidTextElements[e]=this.vpaidTextElements[e]||[],this.vpaidTextElements[e].push({id:d.id,className:d.className,text:d.textContent}))}catch(f){}}}]),a}(),c["default"]=t,b.exports=c["default"]},{"../VPAIDHTML5Client/js/VPAIDHTML5Client":12,"../player/Tracker":27,"../player/utils":38,"./Beacon":39,"./Mpg1Canvas":50,"./vpaidEvents":71}],48:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./VpaidWrapper"),i=e(h),j=a("../player/Tracker"),k=e(j),l=a("./queue-sorter"),m=e(l),n=a("./OpportunityType"),o=e(n),p=a("bluebird"),q=e(p),r=a("../player/utils"),s=d(r),q["default"].config({cancellation:!0}),t=function(){function a(b,c){var d=this;f(this,a),this.mainVpaid=b,this.store=c,this.time=(new Date).getTime(),this.sequenceId=((new Date).getTime()+"").substring(3,11),this.loops=0,this.stopped=!1,this.started=!1,this.schedule=[],this.timedTimeout=0,this.waterfall={},this.adSlots=1,this.filledSlots=0,this.adIsPlaying=!1,this.debugTracker=new k["default"]("Manager"),this.isVideoThrottleOn=this.store.get("vtrtlon"),this.isBufferModeOn=this.store.get("bfrmd"),this.oppsID=o["default"],this.queueSize=this.store.get("queue_size")||10,this.isVforce=c.get("vForce"),this.store.on("stop",this.stop.bind(this)),this.store.on("emitQueueStatus",this._emitQueueStatus.bind(this)),this.store.get("debug")&&setInterval(function(){d._postMessageSchedule()},1e3),this.dontTrimMp4=this.store.get("novdtrm"),this.maxBackfillDelayItems=this.store.get("mxbckflldlyitms"),this.maxBackfillDelayItems&&(this.backfilldelayTime=this.store.get("bckflldlyms"),this.backfillPriority=this.store.get("bfprty"))}return g(a,[{key:"_postMessageSchedule",value:function b(){var a,b;if(window.cmPlayerDeubg){a=this.schedule,b=this.store;try{window.cmPlayerDeubg({schedule:a,store:b})}catch(c){console.log(c)}}}},{key:"trigger",value:function c(a,b,d){if(this._handleAllEvents({type:a,dispatcher:b}),this.store.emit(a,b),b.working||a===this.mainVpaid.vpaidEvents.AdImpression){var e={type:a,dispatcher:b};a===this.mainVpaid.vpaidEvents.AdImpression&&(e.tag=b.tag),e.vpaidReady=this.getVpaidReadyCount(),e.qsize=this.schedule.length,e.dp=b&&b.tag?b.tag.dp:"na",e.adImpMS=b?b.adImpInMS:0,e.readyInMS=b?b.readyInMS:0,e.loadToImpMS=b?b.adImpInMS-b.readyInMS:0,e.clickThru={url:d?d.url:"",playerHandles:d&&d.playerHandles!==!1},this.mainVpaid.trigger(a,e)}}},{key:"getVpaidReadyCount",value:function d(){var a=0;return this.schedule.map(function(b){b&&b.vpaidWrapper&&"ready"===b.vpaidWrapper.status&&a++}),a}},{key:"subscribeToVpaid",value:function e(a){this.stopped||a.subscribe(this._handleError.bind(this),this.mainVpaid.vpaidEvents.AdError)}},{key:"_handleAllEvents",value:function h(a){var b,c=this;a.type!==this.mainVpaid.vpaidEvents.AdVideoStart&&a.type!==this.mainVpaid.vpaidEvents.AdImpression&&a.type!==this.mainVpaid.vpaidEvents.AdPlaying||!a.dispatcher.isPlaying||this.trigger("viewAdPlayer",a.dispatcher.tag),a.type===this.mainVpaid.vpaidEvents.AdLoaded&&this.shouldPlayWhenAvialable&&!this.store.get("evtbsschdl")&&(setTimeout(function(){c.playFromQueue(c.shouldPlayWhenAvialable)},2),b=a.dispatcher?a.dispatcher.tag:{},this.shouldPlayWhenAvialable=!1),a.type===this.mainVpaid.vpaidEvents.AdImpression&&(a.dispatcher.options&&a.dispatcher.options.getAdContext?(a.dispatcher.gotAd=!0,this.debugTracker.info("gotAd",a.dispatcher,{color:"#5EB9FF"}),s.logToBI(a.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:!1}),a.dispatcher.options.getAdContext.getAdCallback(a.dispatcher)):a.dispatcher&&a.dispatcher.vpaidLog&&s.logToBI(a.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:!0}))}},{key:"_runNextAd",value:function j(){}},{key:"_handleError",value:function l(a){var b=a.dispatcher,c="";this.adIsPlaying&&b.isStarted&&!b.hadImpression&&!this.store.get("evtbsschdl")&&this.playFromQueue()}},{key:"initVpaidInQue",value:function n(a){var b,c,d,e;if(!this.stopped)for(b=this.schedule,c={},d="",e=0;e<b.length;e++)c=b[e],d=e+"-"+c.waterfallTagId,c.vpaidWrapper||(this.maxBackfillDelayItems&&c.priority===this.backfillPriority?c.backfillDelay=setTimeout(this._createVpaidWrapper.bind(this,c,d,a),this.backfilldelayTime):this._createVpaidWrapper(c,d,a))}},{key:"_createVpaidWrapper",value:function p(a,b,c){a.backfillDelay&&(a.backfillDelay=window.clearTimeout(a.backfillDelay)),a.sequenceId=a.wfIndex,a.vpaidWrapper=new i["default"]({tag:a,creatives:this.mainVpaid.config.creatives,vpaidEvents:this.mainVpaid.vpaidEvents,config:this.mainVpaid.config,tagid:b,manager:this,wfStats:a.wfStats},this.mainVpaid,this.store,c);var d=this;a.vpaidWrapper.on("vpaidCleaned",function(){d.cleanExpierd(d.queueSize)}),this.isVideoThrottleOn&&a.vpaidWrapper.on("throttleVideo",this._throttleVideo.bind(this)),this.isBufferModeOn&&a.vpaidWrapper.on("setBufferModeForAdvertiser",this._setBufferModeForAdvertiser.bind(this)),this.subscribeToVpaid(a.vpaidWrapper)}},{key:"unsubscribeFromVpaid",value:function r(a){this.stopped||(a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdError),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdFound),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdStopped),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSkipped),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdImpression),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSkippableStateChange),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdSizeChange),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdLinearChange),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdDurationChange),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdExpandedChange),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVolumeChange),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoStart),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoFirstQuartile),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoMidpoint),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoThirdQuartile),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdVideoComplete),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdClickThru),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdInteraction),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserAcceptInvitation),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserMinimize),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdUserClose),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdPaused),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdPlaying),a.unsubscribe(null,this.mainVpaid.vpaidEvents.AdLog))}},{key:"cleanExpierd",value:function t(a){var b,c,d,e=this;this.schedule.map(function(a,b){var c,d;!a||!a.vpaidWrapper||a.vpaidWrapper.working||"error"!==a.vpaidWrapper.status&&"stopped"!==a.vpaidWrapper.status||(a.vpaidWrapper._status=a.vpaidWrapper.status,e.unsubscribeFromVpaid(e.schedule[b].vpaidWrapper),c="error"===a.vpaidWrapper.status,d=c?e.oppsID.vastError:e.oppsID.adError,e.schedule[b].vpaidWrapper.stop("cleanExpierd",d),e.schedule[b]&&(e.schedule[b].vpaidWrapper=null),e.schedule[b]=void 0)}),this.schedule=this.schedule.filter(function(a){return a}),this.schedule=m["default"].sort(this.schedule,this.store),this.schedule.length>a&&(b=this.mainVpaid.config.creatives,c=this.mainVpaid.config.creatives.ADTO||6e4,d=this.store.get("trmrdyvpaid"),this.schedule.map(function(b,f){var g,h;if(e.schedule[f]&&!b.vpaidWrapper.working&&(d||"ready"!==b.vpaidWrapper.status)&&(g=Date.now()-e.schedule[f].vpaidWrapper.created,b&&(f<e.schedule.length-a||g>c))){if(e.unsubscribeFromVpaid(e.schedule[f].vpaidWrapper),h=g>c?"queueExpired":"queueTrimmed",!e._canTrim(h,b))return;e.schedule[f].vpaidWrapper.stop(h,e.oppsID[h]),e.schedule[f]=void 0}})),this.schedule=this.schedule.filter(function(a){return a})}},{key:"_canTrim",value:function u(a,b){return"queueTrimmed"!==a||!(b.vpaidWrapper&&"mp4"===b.vpaidWrapper.type&&this.dontTrimMp4)}},{key:"fillSchedule",value:function v(a,b){var c,d,e,f,g;for(this.schedule.length>this.queueSize&&this.cleanExpierd(this.queueSize),this.started=!0,this.stopped=!1,c={},d=0,e=this.mainVpaid.config.creatives,e.ADTO=parseInt(e.ADTO)>1?parseInt(e.ADTO):60,e.ADTO=e.ADTO<1e3?1e3*e.ADTO:e.ADTO,this.adSlots=parseInt(e.B2B)&&parseInt(e.B2B)>1?parseInt(e.B2B):1,f=0,g=e.DEFAULTTAGTIMEOUT<1e3?1e3*e.DEFAULTTAGTIMEOUT:e.DEFAULTTAGTIMEOUT,d=0;d<a.tags.length;d++)this._shouldInsertToQueue(a.tags[d])?(c=a.tags[d],c.active=!1,c.adFound=!1,c.offset=f,c.tagStart=f,c.tagTimeout=g,c.queueNumber=0,c.ADTO=e.ADTO,c.vpaidWrapper=!1,c.tagEnd=1*c.tagStart+1*c.tagTimeout,c.wfStats=a.data,this.store.get("frstlk")&&this._updateItemFirstLook(c),this.schedule.push(c)):b.push("tagResponse_"+d+"_backfillThrown",!0);this._printQueue(this.schedule),this.mainVpaid.setVpaidId(c),this.time=(new Date).getTime(),this.initVpaidInQue(b),this.store.set("queueLength",this.schedule.length),this.store.set("vpaidReadyCount",this.getVpaidReadyCount())}},{key:"_shouldInsertToQueue",value:function w(a){return!this.maxBackfillDelayItems||a.priority!==this.backfillPriority||a.priority===this.backfillPriority&&this._getBackfillCount()<this.maxBackfillDelayItems}},{key:"_printQueue",value:function x(a){var b=a.map(function(a){return{dp:a.dp,lineItem:a.lineItem,alfrox:a.alfrox,waterfallIndex:a.wfIndex,status:a.vpaidWrapper?a.vpaidWrapper.status:"",videoUrl:a.vpaidWrapper?a.vpaidWrapper.getVideoUrl():""}});this.debugTracker.table(b)}},{key:"_updateItemFirstLook",value:function y(a){a.flad&&(this.store.get("first_look_ad_loaded")?(a.flad_delay=a.flad,delete a.flad):this._startFladTimeout(a.flad))}},{key:"_startFladTimeout",value:function z(a){this.store.set("first_look_ad_loaded",a),this.fladTimeout=setTimeout(this._onFladTimeout.bind(this),1e3*a)}},{key:"_onFladTimeout",value:function A(){var a,b=null;for(a=0;a<this.schedule.length;a++)if(b=this.schedule[a],b.flad_delay)return b.flad=b.flad_delay,delete b.flad_delay,void this._startFladTimeout(b.flad);this.store.set("first_look_ad_loaded",!1),this.store.emit("fladInactive")}},{key:"stop",value:function B(){if(!this.stopped){this.stopped=!0,window.clearTimeout(this.timedTimeout);for(var a=0;a<this.schedule.length;a++)this.schedule[a].backfillDelay?window.clearTimeout(this.schedule[a].backfillDelay):this.schedule[a].vpaidWrapper.stop("playerClosed",this.oppsID.playerClosed)}}},{key:"managerEnd",value:function C(){}},{key:"playFromQueue",value:function D(a){var b,c,d,e,f,g,h,i,j,k;if(!this.store.get("isIdleMode")&&!this.stopped){for(b=Date.now(),this.store.set("playFromQueue",b),c=this.getVpaidReadyCount(),(0===c||a)&&(this.store.get("vForce")||(this.shouldPlayWhenAvialable=!0)),this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=m["default"].sort(this.schedule,this.store)),d=this.mainVpaid.config.creatives.ADTO||6e4,d+=1e4,e=this,f=!1,g=this._getItemScores(),h=this._getItemDps(),i=this.schedule.length-1;i>=0;i--)j=this.schedule[i],j&&(this._setItemScores(j,i,g),this._setItemDps(j,i,h),"ready"!==j.vpaidWrapper.status||j.vpaidWrapper.working||j.vpaidWrapper.isStarted||f||this.store.get("first_look_ad_loaded")&&!j.flad||(this.store.set("playFromQueueFound",b),j.vpaidWrapper.bringToFront(),j.vpaidWrapper.workingVpaid=!0,this.store.set("ad_controls",this.store.getByLineItem("ad_controls",j.vpaidWrapper.tag)!==!1),j.vpaidWrapper.working=!0,j.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,f=!0,j.vpaidWrapper.startAd(),s.logToBI(j.vpaidWrapper.vpaidLog,"startFromQ",{score:j.score})));k=this.store.get("run_wf_when_empty"),k&&0===c&&this.store.emit("playFromEmptyQueue")}}},{key:"_getItemScores",value:function E(){var a,b,c=[];for(a=this.schedule.length-1;a>=0;a--)b=this.schedule[a],b&&c.push(b.score);return c}},{key:"_getItemDps",value:function F(){var a,b,c=[];for(a=this.schedule.length-1;a>=0;a--)b=this.schedule[a],b&&c.push(b.dp);return c}},{key:"_setItemScores",value:function G(a,b,c){a.vpaidWrapper&&a.vpaidWrapper.vpaidLog&&a.vpaidWrapper.vpaidLog.data&&(a.vpaidWrapper.vpaidLog.data.itemScore=a.score,c&&s.logToBI(a.vpaidWrapper.vpaidLog,"itemScores",{index:b,scores:c}))}},{key:"_setItemDps",value:function H(a,b,c){a.vpaidWrapper&&c&&s.logToBI(a.vpaidWrapper.vpaidLog,"itemDps",{index:b,dps:c})}},{key:"resizeAd",value:function I(a,b,c){if(!this.stopped){this.mainVpaid.config.creatives.PLAYER_WIDTH=this.mainVpaid.config.width=parseInt(a),this.mainVpaid.config.creatives.PLAYER_HEIGHT=this.mainVpaid.config.height=parseInt(b),this.mainVpaid.config.creatives.VIEW_MODE=this.mainVpaid.config.viewMode=c;for(var d=0;d<this.schedule.length;d++)this.schedule[d].vpaidWrapper&&!this.schedule[d].vpaidWrapper.stopped&&this.schedule[d].vpaidWrapper.workingVpaid&&this.schedule[d].vpaidWrapper.callVpaidMethod("resizeAd",[a,b,c],0)}}},{key:"setAdVolume",value:function J(a,b){if(!this.stopped){if(a=a>1?a/100:a,isNaN(parseFloat(a)))return!1;a=parseFloat(a),b||(this.mainVpaid.config.creatives.VOLUME=a),this.mainVpaid.config.creatives.MUTED=0==a;for(var c=0;c<this.schedule.length;c++)this.schedule[c].vpaidWrapper&&!this.schedule[c].vpaidWrapper.stopped&&this.schedule[c].vpaidWrapper.workingVpaid&&this.schedule[c].vpaidWrapper.setAdVolume(a)}}},{key:"callWorkingVpaid",value:function K(a,b,c){var d,e;if(!this.stopped)for(d=0;d<this.schedule.length;d++)if(e=this.schedule[d].vpaidWrapper,e&&e.workingVpaid)return e.callVpaidMethod(a,b,c)}},{key:"getVpaidLogs",value:function L(){var a,b,c=[];for(a=0;a<this.schedule.length;a++)b=this.schedule[a],b&&b.vpaidWrapper&&b.vpaidWrapper.vpaidLog&&c.push(b.vpaidWrapper.vpaidLog);return c}},{key:"getAd",value:function M(a){this.store.incr("getAdData.count");var b=this;return this.debugTracker.info("getAd",a?a:"empty getAd",{color:"#5EB9FF"}),new q["default"](function(c,d,e){a=a||{};var f={getAdCallback:c};a.getAdContext=f,a.getAdContext.getAdTimeout=setTimeout(function(){a.getAdContext=void 0,d({name:"error",message:"couldn't find a suitable ad to play"})},1e3*b.store.get("get_ad_timeout_seconds")),b.getAdFromQueue(a),e(function(){b.cancelGetAd(a),this.debugTracker.info("getAd","getAd cancelled!",{color:"#5EB9FF"})}.bind(b))})}},{key:"cancelGetAd",value:function N(a){this.store.decr("getAdData.count"),clearTimeout(a.getAdContext.getAdTimeout),a.getAdContext=void 0}},{key:"getAdFromQueue",value:function O(a){var b,c,d,e;if(!this.store.get("isIdleMode")&&!this.stopped&&(a=a||{},a&&a.getAdContext&&(!a.requiredViewability||!document.hidden))){for(this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=m["default"].sort(this.schedule,this.store)),b=!1,c=this.schedule.length-1;c>=0;c--)if(d=this.schedule[c],this._updateStatusesOnGetAd(d,a),this._setItemScores(d,c),this.isViewabilityMatch(d,a)&&"ready"===d.vpaidWrapper.status&&!d.vpaidWrapper.working&&!d.vpaidWrapper.isStarted&&(!this.store.get("first_look_ad_loaded")||d.flad)){d.vpaidWrapper.bringToFront(),d.vpaidWrapper.working=!0,d.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,b=!0,d.vpaidWrapper.startAd(a),s.logToBI(d.vpaidWrapper.vpaidLog,"startFromQ",{score:d.score}),clearTimeout(a.getAdContext.getAdTimeout),a.getAdContext.getAdTimeout=void 0;break}e=this.store.get("run_wf_when_empty"),e&&0==this.getVpaidReadyCount()&&this.store.emit("playFromEmptyQueue"),b||(this.nextAdFromQueue=setTimeout(this.getAdFromQueue.bind(this,a),1e3))}}},{key:"_updateStatusesOnGetAd",value:function P(a,b){a.vpaidWrapper&&a.vpaidWrapper.vpaidLog&&!a.vpaidWrapper.gotAd&&a.vpaidWrapper.updateStatusesOnGetAd(b)}},{key:"isViewabilityMatch",value:function Q(a,b){return!(!a||!a.vpaidWrapper)&&("undefined"==typeof b.requiredViewability||(b.requiredViewability?a.requiredViewability:!a.requiredViewability))}},{key:"onStop",value:function R(){}},{key:"isActivePausedAd",value:function S(){var a,b;for(a=0;a<this.schedule.length;a++)if(b=this.schedule[a],b&&b.vpaidWrapper&&b.vpaidWrapper.isPlaying&&!b.vpaidWrapper.isUnPaused)return!0;return!1}},{key:"isWorkingVpaidItem",value:function T(a){var b=!1;return this.schedule.map(function(c){c&&c.vpaidWrapper&&c.vpaidWrapper==a&&c.vpaidWrapper.working&&(b=!0)}),b}},{key:"_saveCountersToStore",value:function U(a,b,c){!b&&this.store&&c&&this.store.set(a,c)}},{key:"callAllWorkingVpaids",value:function V(a){this.schedule.map(function(b){b.vpaidWrapper&&!b.vpaidWrapper.stopped&&b.vpaidWrapper.workingVpaid&&a(b.vpaidWrapper)})}},{key:"mute",value:function W(){this.callAllWorkingVpaids(function(a){return a.mute()})}},{key:"unmute",value:function X(){this.callAllWorkingVpaids(function(a){return a.unmute()})}},{key:"play",value:function Y(){this.callAllWorkingVpaids(function(a){return a.resumeAd()})}},{key:"pause",value:function Z(){this.callAllWorkingVpaids(function(a){return a.pauseAd()})}},{key:"getCurrentWorkingVpaidVolume",value:function $(){var a=null;return this.callAllWorkingVpaids(function(b){null===a&&(a=b.getCurrentVolume())}),a||0}},{key:"_throttleVideo",value:function _(a){var b=this;setTimeout(function(){b.stopped||b.store.emit("onThrottleEnd_"+a.videoUrl)},a.delay)}},{key:"_setBufferModeForAdvertiser",value:function aa(a){var b=this;setTimeout(function(){if(!b.stopped){var c=b.store.get("bufferModeList")||[];c.splice(c.indexOf(a.advId),1),b.store.set("bufferModeList",c)}},a.delay)}},{key:"_emitQueueStatus",value:function ba(){this.store.emit("queueStatus",this._getQueueStatus())}},{key:"_getQueueStatus",value:function ca(){var a,b,c={requiredViewabilityCount:0};for(a=0;a<this.schedule.length;a++)b=this.schedule[a],b.requiredViewability&&c.requiredViewabilityCount++;return c}},{key:"_getBackfillCount",value:function da(){var a=this,b=0;return this.schedule.map(function(c){c&&c.priority===a.backfillPriority&&b++}),b}}]),a}(),c["default"]=t,b.exports=c["default"]},{"../player/Tracker":27,"../player/utils":38,"./OpportunityType":53,"./VpaidWrapper":62,"./queue-sorter":69,bluebird:1}],49:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b,c,d,e){var f,g,h=document.createElement("script"),i=[];b={adData:{ids:b,duration:c,url:e},dispatchEvent:function k(a){this.sendEvent?(i&&(i.push(a),a=i,i=!1),this.sendEvent(a)):i.push(a)}},c="_moatApi"+Math.floor(1e8*Math.random());try{f=a.ownerDocument,g=f.defaultView||f.parentWindow}catch(j){f=document,g=window}return g[c]=b,h.type="text/javascript",a&&a.insertBefore(h,a.childNodes[0]||null),h.src="https://z.moatads.com/"+d+"/moatvideo.js#"+c,b}var g,h,i,j;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/utils"),i=d(h),j=function(){function a(b){e(this,a);var c=b.store.getByLineItem("mttst",b.tag);c&&(c+="_"),c=""+c+(b.store.get("unit_type")||"")+(b.store.get("isMobile")?"_Mobile":""),this.moatApiReference=f(b.container||document.body,b.tag?{level1:c,level2:b.tag.advId,level3:b.tag.lineItemId,level4:b.store.get("domain")||"",slicer1:b.url,slicer2:b.tag.tagId}:{level1:"",level2:"",level3:"",level4:"",slicer1:"",slicer2:""},b.duration||0,b.moatPartnerCode,b.url),i.logToBI(b.vpaidLog,"moatTracker",{abTest:c,partnerCode:b.moatPartnerCode})}return g(a,[{key:"dispatch",value:function b(a){this.moatApiReference&&this.moatApiReference.dispatchEvent(a)}},{key:"dispose",value:function c(){this.moatApiReference=void 0}}]),a}(),c["default"]=j,b.exports=c["default"]},{"../player/utils":38}],50:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(c,"__esModule",{value:!0}),i=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=a("../player/Tracker"),k=e(j),l=a("events"),m=a("../player/utils"),n=d(m),o=a("./vpaidEvents"),p=e(o),q=a("./jsmpeg"),r=2e3,s=function(a){function b(a,c,d,e,h,i,j){f(this,b);var k=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return k.video=a,k.target=j,k.store=h,k.createCanvas(),k.modifyVideo(a),k.owner=c,k.shouldAutoPlay=d||!1,k.canvasCss=e||{},k.bypass=!1,k.clntRedirRslvWhiteList=k.store.get("mpgclrslv")||[],k.ready=!1,k.loop=i,k.vidAttr={},a.muted=!0,k.status="LOADING",k.quartiles=[{event:p["default"].AdVideoFirstQuartile,percentage:.25},{event:p["default"].AdVideoMidpoint,percentage:.5},{event:p["default"].AdVideoThirdQuartile,percentage:.75}],k.owner&&n.logToBI(k.owner.vpaidLog,"canvas",{ctor:!0}),k}return h(b,a),i(b,[{key:"emitStartAd",value:function c(){var a=this;this.stratAdCalled=!0,this._playTimeout=setTimeout(function(){a._play()},r)}},{key:"backToVideoTag",value:function d(a){var b,c,d,e,f,g,h=this;!this.bypass&&this.src&&(this.bypass=!0,b=this.jsmpeg.currentTime,c=this.video.style,d=this.video.parentElement||this.target,e=parseInt(this.canvas.style.zIndex),f=this.jsmpeg.loop,this.newVid=d.appendChild(document.createElement("video")),this.newVid.className="mc-loud-video",this.newVid.setAttribute("playsinline",""),this.newVid.setAttribute("autoplay",""),f&&this.newVid.setAttribute("loop",""),this.newVid.style.height=c.height,this.newVid.style.width=c.width,this.newVid.style.top=c.top?c.top:"0",this.newVid.style.left=c.left?c.left:"0",this.newVid.style.background="#000000",this.newVid.style.zIndex=e,this.newVid.style.display="none",this.newVid.src=this.src,this.newVid.volume="muteChanged"===a.type?this.store.get("dfltvlm"):0,this.newVid.muted=0===this.newVid.volume,this.newVid.addEventListener("ended",function(a){h.dispatchDOM("ended")},!1),this.newVid.addEventListener("click",function(a){h.dispatchDOM("click",a)}),g=function i(){h.newVid.removeEventListener("playing",i),h.newVid.removeEventListener("timeupdate",i),h.tuTicker=clearInterval(h.tuTicker),h.jsmpeg.stop(),h.jsmpeg=void 0,h.newVid.style.display="block",h.canvas.style.display="none",h.video.style.display="none",("playChanged"===a.type||h.video.paused)&&h._pause(),
h.emit("newVidCreated",h.newVid)},this.newVid.addEventListener("playing",g),this.newVid.addEventListener("timeupdate",g),this.newVid.currentTime=b,this.newVid.play().then(function(){h.newVid.currentTime=b}),this.isCanvasFinished=!1)}},{key:"mpegFinish",value:function e(){this.isCanvasFinished||(this.emit("canvasEnded"),this.dispatchDOM("ended"),this.isCanvasFinished=!0)}},{key:"onLoad",value:function j(){var a,b,c=this;this.loaded||(this.loaded=!0,a=parseInt(this.store.get("width")),b=parseInt(this.store.get("height")),this.onResize(a,b),setTimeout(function(){c.ready=!0,c.emit("ready"),c.dispatchDOM("loadedmetadata")},0))}},{key:"createCanvas",value:function k(){var a,b,c=this,d=document.createElement("canvas");d.className="mc-video mc-canvas",this.store.get("isMultiVpaidUnit")&&n.addClass(d,"multi-vpaids"),a=this.video.parentElement||this.target,this.canvas=a.appendChild(d),a.className+=" mpegcnv",b=this,this.video&&this.video.addEventListener("resize",function(a){b.onResize(a.target.clientWidth,a.target.clientHeight)}),this.canvas.addEventListener("click",function(a){c.dispatchDOM("click",a)})}},{key:"onResize",value:function l(a,b){this.jsmpeg&&this.canvas&&(this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.width=a+"px",this.canvas.style.height=b+"px"),this.height=b,this.width=a}},{key:"hookProp",value:function m(a,b,c,d){var e="alt_"+b;a.hasOwnProperty(e)||(a[e]="",Object.defineProperty(a,b,{get:function f(){var a=c?c():this[e];return a},set:function g(c){this[e]=c,d&&d(c)&&a.setAttribute(b,c)}}))}},{key:"hookMethod",value:function o(a,b,c){this.hooks||(this.hooks=[]),this.hooks[b]=a[b];var d=this;a[b]=function(){var a,e={};if(c(arguments,e))return!(!d.hooks.hasOwnProperty(b)||"function"!=typeof d.hooks[b])&&(a=d.hooks[b].apply(this,arguments),e.res?e.res:a)}}},{key:"dispatchDOM",value:function s(a,b){if(this.video){var c=new Event(a);this.video.dispatchEvent(c)}}},{key:"errHndlr",value:function t(a){this.owner&&(n.logToBI(this.owner.vpaidLog,"jsmpegError",a),this.owner._onPlayerError&&this.owner._onPlayerError())}},{key:"isUrlInRslvWhiteList",value:function u(a){if(!this.clntRedirRslvWhiteList.length)return!0;for(var b=0;b<this.clntRedirRslvWhiteList.length;++b)if(a.indexOf(this.clntRedirRslvWhiteList[b])>-1)return!0;return!1}},{key:"setSrc",value:function v(a){var b,c,d,e,f,g;if(a=a.trim(),a&&!this.hasVidUrl)return n.logToBI(this.owner.vpaidLog,"canvasUrl",{url:a}),this.hasVidUrl=!0,"javascript"==this.owner.tech&&this.video&&this.video._vidSetAttr("src",a),this.src=a,b=this.store.get("cnvsldrt"),c=parseInt(this.store.get("width")),d=parseInt(this.store.get("height")),e={loadeReadyRate:b,canvas:this.canvas,audio:!1,centerVertically:!0,autoplay:this.shouldAutoPlay,loop:this.loop||!1,pcy:d,pcx:c,onload:this.onLoad.bind(this),errHndlr:this.errHndlr.bind(this),onfinished:this.mpegFinish.bind(this),progressive:!1,canvasCss:this.canvasCss},f=this.store.get("gtvid2"),g=f+"="+encodeURIComponent(a),(/\.mpg$/.test(a)||/\.mpeg$/.test(a))&&(g=a),this.jsmpeg=new q(g,e,this),this._setVideoDuration(this.src),!1}},{key:"_play",value:function w(){var a=this;if(!this.blockActions){if(clearTimeout(this._playTimeout),this._timeUpdateTicker(),!this.ready)return void this.on("ready",function(){a.emit("play"),a._play()});this.newVid?this.newVid.play():this.jsmpeg.play(),this.dispatchDOM("playing"),this.status="PLAYING",this._render()}}},{key:"_timeUpdateTicker",value:function x(){var a=this;clearInterval(this.tuTicker),this.tuTicker=setInterval(function(){a.dispatchDOM("timeupdate"),a.quartiles.length>0&&a.video.currentTime/a.video.duration>=a.quartiles[0].percentage&&(a.emit(a.quartiles[0].event),a.quartiles.shift())},1e3)}},{key:"_pause",value:function y(){this.stopped||(this.status="PAUSED",this._render(),this.newVid?this.newVid.pause():this.jsmpeg?this.jsmpeg.pause():"")}},{key:"muteButtonClick",value:function z(a){if(!this.stopped){var b=!!this.newVid&&!this.newVid.muted;if(n.logToBI(this.owner.vpaidLog,"canvasMuteToggle",{muted:b}),!this.newVid)return void this.backToVideoTag({type:"muteChanged"});this.newVid.volume=this.newVid.muted?this.store.get("dfltvlm"):0,this.newVid.muted=0===this.newVid.volume}}},{key:"playButtonClick",value:function A(a){var b,c;if(!this.stopped){if(b="PLAYING"===this.status?"PAUSED":"PLAYING",n.logToBI(this.owner.vpaidLog,"canvasPlayToggle",{status:b,view:this.newVid?"newVid":"canvas"}),this.status=b,!this.newVid)return void this.backToVideoTag({type:"playChanged"});c=this.newVid||this.jsmpeg,"PLAYING"===this.status?c.play():c.pause(),this._render()}}},{key:"modifyVideo",value:function B(a){var b,c=this;this.stopped||(b=this,a._vidSetAttr=a.setAttribute,a.getAttribute=function(a,b){return c.vidAttr[a]},a.setAttribute=function(d,e){if(!b.stopped)return c.vidAttr[d]=e,"volume"===d&&(c._volume=e),n.logToBI(b.owner.vpaidLog,"hookSetAttribute",{key:d,val:e}),"src"===d?void c.setSrc(e):a._vidSetAttr(d,e)},this.hookMethod(a,"play",function(){if(!b.stopped)return n.logToBI(b.owner.vpaidLog,"hookMethodPlay",{hookMethod:!0}),b._play(),b.dispatchDOM("playing"),!1}),this.hookMethod(a,"pause",function(){if(!b.stopped)return n.logToBI(b.owner.vpaidLog,"hookMethodPause",{hookMethod:!0}),b._pause(),!0}),this.hookMethod(a,"stop",function(){if(n.logToBI(b.owner.vpaidLog,"hookMethodStop",{hookMethod:!0}),!b.stopped)return b.jsmpeg.stop(),!0}),this.hookProp(a,"paused",function(){return"PAUSED"===this.status}.bind(this),null),this.hookProp(a,"src",null,this.setSrc.bind(this)),this.hookProp(this.video,"volume",function(){return c.newVid?c.newVid.volume:c._volume},function(a){return c._volume=a,!0}),this.hookProp(a,"currentTime",function(){var a=b.newVid||b.jsmpeg;return a?a.currentTime:0},null),this.hookProp(a,"duration",function(){if(b.duration)return b.duration},function(a){b.duration=a}))}},{key:"_setVideoDuration",value:function C(a){var b=this,c=document.createElement("video");c.src=a,c.addEventListener("loadedmetadata",function(){b.video&&(b.video.duration=c.duration),c.src="",c=void 0}),c.load()}},{key:"_render",value:function D(){var a=this.newVid||this.canvas}},{key:"hide",value:function E(){this.stopped||(this.canvas.style.display="none",this._render())}},{key:"show",value:function F(){this.stopped||(this.canvas.style.display="block",this._render())}},{key:"removeDomMember",value:function G(a){var b=a.parentNode;b.removeChild(a)}},{key:"restartAd",value:function H(){var a=this;this.stopped||(this.newVid?(this.newVid.currentTime=0,this.newVid.play()):this.jsmpeg&&(this.blockActions=!0,this.jsmpeg.stop(),setTimeout(function(){a.jsmpeg.play()},20),setTimeout(function(){a.blockActions=!1},2e3)))}},{key:"destroy",value:function I(){var a,b;clearTimeout(this._playTimeout),clearInterval(this.tuTicker),this.jsmpeg=void 0,a=this._events;for(b in a)this.removeAllListeners(b);this.removeDomMember(this.canvas),this.canvas=void 0}}]),b}(l.EventEmitter),c["default"]=s,b.exports=c["default"]},{"../player/Tracker":27,"../player/utils":38,"./jsmpeg":67,"./vpaidEvents":71,events:3}],51:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("../player/utils"),k=d(j),l=a("../player/Post"),m=e(l),n=function(){function a(b,c){var d,e;f(this,a),this.store=b,this.debugTracker=new i["default"]("OpportunityAggregator"),this.opps=[],d=this.store.get("opps_base_path")||c.CM_DOMAIN,this.url=k.setUrlPrefix(d)+(/.*\/$/g.test(d)?"":"/")+"OpportunityServlet",this.postHeaders=this.store.get("psthdrs")||"application/json",this.onFail=this._onFail.bind(this),this.onSuccess=this._onSuccess.bind(this),e=this._sendTicker.bind(this),setInterval(e,this.store.get("timbtopps")),this.store.on("sendOpps",e),this.store.on("beforeunload",e)}return g(a,[{key:"send",value:function b(a){this.opps.push(a)}},{key:"_sendTicker",value:function c(){this.opps.length>0&&(0,m["default"])(this.url,k.stringify(this.opps),this.onSuccess,this.onFail,void 0,!1,5e3,this.postHeaders,!1),this.opps=[]}},{key:"_onSuccess",value:function d(a){}},{key:"_onFail",value:function e(a){this.debugTracker.warn("Error Firing Opps",a)}}]),a}(),c["default"]=n,b.exports=c["default"]},{"../player/Post":22,"../player/Tracker":27,"../player/utils":38}],52:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("../player/utils"),k=d(j),l=a("./OpportunityType"),m=e(l),n=a("../player/Post"),o=e(n),p=function(){function a(b,c,d){if(f(this,a),this.parameters=b,this.store=c,this.debugTracker=new i["default"]("OpportunityManager"),this.store.get("usopsla")&&this.store.get("oppsula")?(k.logToBI(d,"oppsAggregatorType",{type:"oppsula"}),this.oppsAggregator=this.store.get("oppsula")):(k.logToBI(d,"oppsAggregatorType",{type:"opportunityAggregator"}),this.oppsAggregator=this.store.get("oppsAggregator")),this._sentOpps={},this._oppsToSendOnlyOnce=[1,41,21,22,23,24,70],this._isPaused=!1,this.vpaidLog=d,this.billableEvents=this.store.get("bllblevt").split(","),this.postNonAggregatedOpps=this.store.get("pstnnaggops"),this.postNonAggregatedOpps){var e=this.store.get("opps_base_path")||creativeConfig.CM_DOMAIN;this.url=k.setUrlPrefix(e)+(/.*\/$/g.test(e)?"":"/")+"OpportunityServlet",this.postHeaders=this.store.get("psthdrs")||"application/json"}}return g(a,[{key:"alreadySent",value:function b(a,c){return!(!this._sentOpps[a.sequenceId]||!this._sentOpps[a.sequenceId][a.lineItemId])&&this._sentOpps[a.sequenceId][a.lineItemId].indexOf(c)!=-1}},{key:"send",value:function c(a,b,d,e){var f,g,h,i,j,l,m,n,p,q,r,s;if(a){if(this._isPaused)return void this.debugTracker.info("OpportunityPixel","[tag-"+(1*a.waterfallTagId+1)+"] Disgarded sending '"+b);if(this._oppsToSendOnlyOnce.indexOf(b)==-1||!this.alreadySent(a,b))if(this._sentOpps[a.sequenceId]=this._sentOpps[a.sequenceId]||{},this._sentOpps[a.sequenceId][a.lineItemId]=this._sentOpps[a.sequenceId][a.lineItemId]||[],this._sentOpps[a.sequenceId][a.lineItemId].push(b),this.debugTracker.info("OpportunityPixel","[tag-"+(1*a.waterfallTagId+1)+"] Sending '"+b,{color:"#6ef936"}),f=a.lineItemStats,g=this.store.get("pstn")||1,h=a.vidDast||a.dast,i=(new Date).getTime()-a.created,j=this.store.get("ab_test"),a.requiredViewabilityDrawn&&(j+="!ronrv"),l=[{key:"st",value:k.getStreamType(a.rollType)},{key:"rs",value:a.sequenceId},{key:"os",value:1*a.waterfallTagId+1},{key:"tms",value:Math.floor((new Date).getTime()/1e3)},{key:"d",value:i},{key:"rst",value:b},{key:"dast",value:h},{key:"pstn",value:g},{key:"dp",value:k.crc32(a.dp)},{key:"mob",value:k.boolToInt(this.store.get("isMobile"))},{key:"vstt",value:k.boolToInt(!document.hidden)},{key:"unv",value:this.store.get("unit_version")},{key:"unt",value:k.crc32(this.store.get("unit_type"))},{key:"abt",value:j},{key:"frd",value:this.store.get("fdScore")},{key:"agl",value:this.store.get("preset.level")},{key:"rp",value:a.vpaidWrapperData&&a.vpaidWrapperData.vastPrice},{key:"mty",value:a.vpaidWrapperData&&a.vpaidWrapperData.mediatype},{key:"vstp",value:a.vpaidWrapperData&&a.vpaidWrapperData.vastType},{key:"fv_t",value:f&&f.tries},{key:"fv_c",value:f&&f.conversions},{key:"fv_f",value:f&&f.fails},{key:"fv_fr",value:f&&f.failsRow},{key:"awr",value:this.store.get("performance.dtsvrRoundTripAverageDuration")},{key:"pm",value:this.store.get("performance.performanceMeasurment")},{key:"dbg",value:this.store.get("debugStr")},{key:"su",value:this.store.get("subUnitType")},{key:"pdast",value:d}],m=k.filterUndefinededValues(l,"value"),n=m.concat(this._delayedParams(a)),p=k.flattenKeys(n),this.oppsAggregator&&!this._isBillableEvent(b))this._reportOppToKibana(p,b,e),this.oppsAggregator.send(p);else if(this.postNonAggregatedOpps)(0,o["default"])(this.url,k.stringify([p]),null,null,void 0,!1,5e3,this.postHeaders,!1);else{q=this._getBaseUrl(a),r=this._flattenParams(m),s=q+"&"+r.join("&"),this._reportOppToKibana(this._flattenKeys(m),b,e);try{return(new Image).src=s,!0}catch(t){return this.debugTracker.warn("manager","Error firing pixel!"),!1}}}}},{key:"_reportOppToKibana",value:function d(a,b,c){var d={rstStr:k.getObjectKeyByValue(m["default"],b)};c&&this._isQuartileOpportunity(b)&&(d.vidCurrentTime=c),k.logToBI(this.vpaidLog,"Opps",Object.assign({},a,d))}},{key:"_isQuartileOpportunity",value:function e(a){return a>=21&&a<=25}},{key:"_flattenParams",value:function h(a){return a.map(function(a){return a.key+"="+a.value})}},{key:"_flattenKeys",value:function j(a){var b={};return a.forEach(function(a,c,d){b[a.key]=a.value}),b}},{key:"_getBaseUrl",value:function l(a){var b=this.parameters,c=this.store.get("opps_base_path")||b.CM_DOMAIN,d=k.setUrlPrefix(c)+(/.*\/$/g.test(c)?"":"/")+"OpportunityServlet?";return d+="&auc-dast="+b.AUC_DAST,d+="&sts="+b.STS,d+="&wp="+b.WP,d+="&vpd="+(a.pubId||b.VPD),d+="&vptd="+(a.tagId||b.VPTD),d+="&vmt="+((a.isRon?1:0)||b.VMT||0),d+="&pv="+(this.store.get("player_version")||999),d+="&pt="+k.crc32(this.store.get("ab_test")||999),d+="&w="+this.store.get("width"),d+="&h="+this.store.get("height")}},{key:"_delayedParams",value:function n(a){var b=this.parameters,c=[];return c.push({key:"auc-dast",value:b.AUC_DAST}),c.push({key:"sts",value:b.STS}),c.push({key:"wp",value:b.WP}),c.push({key:"vpd",value:a.pubId||b.VPD}),c.push({key:"vptd",value:a.tagId||b.VPTD}),c.push({key:"vmt",value:(a.isRon?1:0)||b.VMT||0}),c.push({key:"pv",value:this.store.get("player_version")||999}),c.push({key:"pt",value:k.crc32(this.store.get("ab_test")||999)}),c.push({key:"w",value:k.roundNumericValue(this.store.get("width")).toString()}),c.push({key:"h",value:k.roundNumericValue(this.store.get("height")).toString()}),c}},{key:"destroy",value:function p(){this.debugTracker=void 0,this.store=void 0,this.oppsAggregator=void 0,this.billableEvents=void 0}},{key:"pause",value:function q(){this._isPaused=!0}},{key:"unpause",value:function r(){this._isPaused=!1}},{key:"_isBillableEvent",value:function s(a){return this.billableEvents.indexOf(""+a)>-1}}]),a}(),c["default"]=p,b.exports=c["default"]},{"../player/Post":22,"../player/Tracker":27,"../player/utils":38,"./OpportunityType":53}],53:[function(a,b,c){"use strict";b.exports={tagStarted:0,tagImpression:1,vastFecthError:2,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,totalTimeout:9,adErrorBeforeLoad:10,networkError:11,adUnitLoadFailed:12,queueExpired:13,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,firstImpression:99,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,soundViolation:34,firstWfMeasurment:35,playerClosedMeasurment:36,maxNetworkCalls:39,fallBackCanvas:70,adLoaded:41,startAd:42,videoThrottle:48}},{}],54:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("./trackingPixels"),k=d(j),l=a("./global-logger"),m=d(l),n=a("../player/utils"),o=d(n),p=a("./vpaidEvents"),q=e(p),r=function(){function a(b){f(this,a),this.trackingPixels=Object.assign({},k),this.pixelDataLoaded=!1,this.events=[],this.done=[],this.store=b,this.vpaidEvents=q["default"],this.state="",this.clickThruUrl="",this._isPaused=!1,this.buildPixelsRestrictions(),this._isPaused=!1}return g(a,[{key:"buildPixelsRestrictions",value:function b(){this.pixelsRestrictions={},this.pixelsRestrictions.baseState=this.vpaidEvents.AdVideoThirdQuartile,this.pixelsRestrictions[this.vpaidEvents.AdVideoComplete]=this.vpaidEvents.AdVideoThirdQuartile}},{key:"loadPixelData",value:function c(a){this.pixelDataLoaded,this.pixelDataLoaded=!0,this.trackingPixels=a}},{key:"getClickThruUrl",value:function d(){var a,b,c;if(!this.clickThruUrl)for(a=["adclickthrough","clickthrough","adclickthru","clickthru"],b=0;b<a.length;b++)if(c=a[b],this.trackingPixels.hasOwnProperty(c)&&this.trackingPixels[c].length>0){this.clickThruUrl=this.trackingPixels[c][0];break}return this.clickThruUrl}},{key:"firePixel",value:function e(a,b,c){var d,e,f;if(this._isPaused)return!1;if(!this.isValid(a,c))return o.logToBI(b,"firePixelStateViolation",{event:a,pixelManagerState:this.state}),!1;switch(d=a.toLowerCase().replace(/^advideo|^aduser|^ad/gi,""),e=[],d){case"clickthrough":case"clickthru":e=e.concat(this._checkConcatPixels(this.trackingPixels.adclicktracking)),e=e.concat(this._checkConcatPixels(this.trackingPixels.clicktracking));break;case"progress":c&&c.hasOwnProperty("eventData")&&c.eventData<this.trackingPixels[d].length&&(e=e.concat(this.trackingPixels[d][c.eventData].pixel));break;case"start":this.trackingPixels.hasOwnProperty("creativeview")&&this.trackingPixels.creativeview.map(function(a){e.push(a)});default:e=e.concat(this._checkConcatPixels(this.trackingPixels[d])),e=e.concat(this._checkConcatPixels(this.trackingPixels["aduser"+d])),e=e.concat(this._checkConcatPixels(this.trackingPixels["advideo"+d])),e=e.concat(this._checkConcatPixels(this.trackingPixels["ad"+d]))}for(f=0;f<e.length;f++)!this._sendPixel(e[f],a,b);return this.events.push(a),""===this.state&&a===this.pixelsRestrictions.baseState&&(this.state=this.pixelsRestrictions.baseState),!0}},{key:"isValid",value:function h(a,b){if(!this.pixelsRestrictions.hasOwnProperty(a))return!0;if(a===this.vpaidEvents.AdVideoComplete&&b&&b.newCompletion===!0)return!0;var c=this.pixelsRestrictions[a];return c===this.state&&(this.state=a,!0)}},{key:"destroy",value:function i(){this.trackingPixels=this.done=this.events=this.vpaidEvents=this.pixelsRestrictions=this.state=this.clickThruUrl=void 0}},{key:"_checkConcatPixels",value:function j(a){return a&&a.length?a:[]}},{key:"_sendPixel",value:function l(a,b,c){var d,e=c?c.data:null;if(m.reportPixel(a,b,e),this.done.indexOf(a)===-1){m.reportCleanPixel(a,b,e),d=c&&c.tag?c.tag.advId:null,this.done.push(a);try{return a=this._replaceMacros(a),d&&(this.store.getByAdvId("pxlnotsmtp",d)||(a+=(a.search(/\?/)>-1?"&":"?")+(new Date).getTime())),(new Image).src=a,!0}catch(f){return!1}}}},{key:"_replaceMacros",value:function n(a){var b=Date.now().toString(),c=b.substring(5);return a=a.replace("[CACHEBUSTING]",c)}},{key:"pause",value:function p(){this._isPaused=!0}}]),a}(),c["default"]=r,b.exports=c["default"]},{"../player/Tracker":27,"../player/utils":38,"./global-logger":66,"./trackingPixels":70,"./vpaidEvents":71}],55:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../player/utils"),h=d(g),i=function(){function a(b){e(this,a),this.store=b,this.onNavigatorConnectionChange=this._onNavigatorConnectionChange.bind(this),this.store.on("navigatorConnectionChange",this.onNavigatorConnectionChange);var c=this.store.get("navigatorConnection")||{};this.dast={vdr:void 0,edr:void 0,vwd:void 0,ewd:void 0,vht:void 0,eht:void 0,vbr:void 0,vu:void 0,vt:void 0,ot:void 0,st:void 0,ect:c.effectiveTypeId,ct:c.typeId,vst:[]}}return f(a,[{key:"set",value:function b(a){this.stopped||(a.hasOwnProperty("vu")&&""!==a.vu&&(a.vt=this._getVideoTypeFromUrl(a.vu)),this.dast=Object.assign(this.dast,a))}},{key:"_getVideoTypeFromUrl",value:function c(a){var b=void 0,c=a.match(/\.([^\/#?]+)([#?][^\/]*)?$/);return c&&c.length>1&&(b=c[1]),b}},{key:"addWrapper",value:function d(a){this.stopped||(a.hasOwnProperty("wu")&&""!==a.wu&&(a.wu=this._getHostnameFromWrapperUrl(a.wu)),this.dast.vst.push(a))}},{key:"_getHostnameFromWrapperUrl",value:function g(a){var b=document.createElement("a"),c="";return b.href=a,c=b.hostname,b=null,c}},{key:"_onNavigatorConnectionChange",value:function i(a){this.stopped||(this.dast.ect=a.effectiveTypeId,this.dast.ct=a.typeId)}},{key:"get",value:function j(){if(!this.stopped)return this._escapeBase64(btoa(h.stringify(this.dast)))}},{key:"_escapeBase64",value:function k(a){return a.replace(/\//g,"_").replace(/\+/g,"-")}},{key:"destroy",value:function l(){this.stopped=!0,this.store.removeListener("navigatorConnectionChange",this.onNavigatorConnectionChange),this.store=this.onNavigatorConnectionChange=this.dast=void 0}}]),a}(),c["default"]=i,b.exports=c["default"]},{"../player/utils":38}],56:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("./OpportunityManager"),h=d(g),i=function(){function a(b){e(this,a),this.store=b,this.data=[],this.useOppsula=this.store.get("usopsla")&&this.store.get("cmbopps"),this.oppsula=this.store.get("oppsula"),this.useOppsula&&!this.oppsula&&this.store.once("oppsulaCreated",this._onOppsulaCreated.bind(this)),this.store.once("waterfallData",this._onWaterfallData.bind(this)),this.store.once("mainVpaidCreated",this._onMainVpaidCreated.bind(this))}return f(a,[{key:"send",value:function b(a){this.opportunityManager?this.opportunityManager.send(this._fixedItem,a):this.data.push(a)}},{key:"_sendData",value:function c(){var a=this;this.data.forEach(function(b){a.send(b)}),this.data=[]}},{key:"_onWaterfallData",value:function d(a){this._fixedItem||(this._fixedItem=a.tags[0],this._createNewPom())}},{key:"_onOppsulaCreated",value:function g(a){this.oppsula=a,this._createNewPom()}},{key:"_createNewPom",value:function i(){this._fixedItem&&this.config&&(this.useOppsula&&!this.oppsula||this._fixedItem&&this.config&&(this.opportunityManager=new h["default"]({CM_DOMAIN:this.config.creatives.CM_DOMAIN,AUC_DAST:this.config.creatives.AUC_DAST,sequenceId:this._fixedItem.sequenceId,ST:this.config.creatives.ST,STS:this.config.creatives.STS,SDID:this.config.creatives.SDID,PT:this.config.creatives.PT,PV:this.config.creatives.PV,WP:this.config.creatives.WP,VPD:this.config.creatives.PUBID,VPTD:this.config.creatives.TAGID,VMT:this.config.creatives.VMT},this.store),this._sendData()))}},{key:"_onMainVpaidCreated",value:function j(a){this.config=a}}]),a}(),c["default"]=i,b.exports=c["default"]},{"./OpportunityManager":52}],57:[function(require,module,exports){"use strict";function _interopRequireWildcard(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _typeof,_createClass,_Tracker,_Tracker2,_vpaidEvents,_vpaidEvents2,_Beacon,_Beacon2,_utils,Utils,SpotxAdOs;Object.defineProperty(exports,"__esModule",{value:!0}),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_Tracker=require("../player/Tracker"),_Tracker2=_interopRequireDefault(_Tracker),_vpaidEvents=require("./vpaidEvents"),_vpaidEvents2=_interopRequireDefault(_vpaidEvents),_Beacon=require("./Beacon"),_Beacon2=_interopRequireDefault(_Beacon),_utils=require("../player/utils"),Utils=_interopRequireWildcard(_utils),SpotxAdOs=function(){function SpotxAdOs(a,b,c){_classCallCheck(this,SpotxAdOs),this.vpaidLog=b,this.vastParser=a.extra.vastParser,this.store=c,this.type="spotxAdOs",this.stopped=!1,this.target=a.slot,this.video=a.videoSlot,this.videoSlotControls=a.videoSlotControls,this.videoSlotCanAutoPlay=a.videoSlotCanAutoPlay,this.baseUrl=this.store.get("base_url"),this._onReady=a.onReady,this._onError=a.onError,this.vpaidEvents=Object.assign({},_vpaidEvents2["default"]),this.beacon=new _Beacon2["default"](this),this.volume=0,this.isMuted=!0,this.adOptions={},this.registerAnalyticsToVpaidLog=a.extra.registerAnalyticsToVpaidLog,this.analyticsRegistered=!1,this._setAdOptions(a.extra.adOptions),this._loadAndCreateDirectAdOs()}return _createClass(SpotxAdOs,[{key:"_setAdOptions",value:function a(b){var c,d,e;for(c in b)d=this._parseAdOption(b[c]),0===c.indexOf("custom.")?(this.adOptions.custom=this.adOptions.custom||{},this.adOptions.custom[c.substring(7)]=d):0===c.indexOf("ados.")?(e=c.substring(5).split("."),this.adOptions.ados=this.adOptions.ados||{},"qp"===e[0]?(this.adOptions.ados.query_params=this.adOptions.ados.query_params||[],this.adOptions.ados.query_params.push(e[1]+"="+d)):(this.adOptions.ados[e[0]]=this.adOptions.ados[e[0]]||{},this.adOptions.ados[e[0]][e[1]]=d)):this.adOptions[c]=d;this.adOptions.ados&&this.adOptions.ados.query_params&&this.adOptions.ados.query_params.length>0&&(this.adOptions.ados.query_params=this.adOptions.ados.query_params.join("&")),this.adOptions.channel_id=this.adOptions.channel_id.toString(),this.adOptions.hide_skin=this.adOptions.hide_skin||!1,this.adOptions.autoplay=this.adOptions.autoplay||!0,this.adOptions.ad_mute=this.adOptions.ad_mute||!0,this.adOptions.slot=this.target,this.adOptions.video_slot=this.video,this.adOptions.content_width=parseInt(this.store.get("width")),this.adOptions.content_height=parseInt(this.store.get("height")),Utils.logToBI(this.vpaidLog,"SpotxAdOsOptions",{options:Utils.stringify(this.adOptions)})}},{key:"_parseAdOption",value:function _parseAdOption(value){var nodeList,_this=this;return value&&"["===value[0]&&"]"===value[value.length-1]&&(value=eval(value)),Array.isArray(value)?value.map(function(a){return _this._parseAdOption(a)}):"object"===("undefined"==typeof value?"undefined":_typeof(value))&&(nodeList=document.querySelectorAll(value),nodeList.length>0)?nodeList[0]:"true"===value||value===!0||"false"!==value&&value!==!1&&(""===value?value:isNaN(value)?value:Number(value))}},{key:"_loadAndCreateDirectAdOs",value:function b(){var a,b=this,c=this.store.get("spotxAdOsLoadedSources")||[];this._bindedOnSpotxAdOsSourceLoaded=this._onSpotxAdOsSourceLoaded.bind(this),c.indexOf(this.adOptions.channel_id)<0?(a=document.createElement("script"),a.type="text/javascript",a.src=this.store.get("sptxadossrc").replace("{{chnl}}",this.adOptions.channel_id),a.onload=function(){c.push(b.adOptions.channel_id),b.store.set("spotxAdOsLoadedSources",c),b._bindedOnSpotxAdOsSourceLoaded()},document.body.appendChild(a)):this._bindedOnSpotxAdOsSourceLoaded()}},{key:"_onSpotxAdOsSourceLoaded",value:function c(){var a=this;this.directAdOs=new SpotX.DirectAdOS(this.adOptions),this._bindAdUnitEvents(),setTimeout(function(){a._onReady()},2)}},{key:"_bindAdUnitEvents",value:function d(a){var b,c=this;for(b in this.vpaidEvents)!function(a){c.directAdOs.subscribe(function(b){c._allEventsHandler(a,b)},a)}(b)}},{key:"initAd",value:function e(){this.directAdOs.loadAd(),this.iframe=this.directAdOs.slot().querySelectorAll("iframe")[0],this.iframe.contentWindow.ignoreGetVpaidAd=!0,this.analyticsRegistered=this.registerAnalyticsToVpaidLog(this.iframe,this.directAdOs,this._handleAnalytics.bind(this)),this.analyticsRegistered||this._createXHRHook(),this.store.get("hjkFuncString")&&(this.iframe.contentWindow.ReportHijackAttempt=this._onHijackAttempt,this.iframe.contentWindow.eval(this.store.get("hjkFuncString")))}},{key:"_handleAnalytics",value:function f(a,b){var c,d=this;this.stopped||(c=b[a],c.hasOwnProperty("XHRUrls")&&c.XHRUrls.map(function(a){a&&Utils.logToBI(d.vpaidLog,"parseVastFromUrl",{url:a})}),c.hasOwnProperty("XHRResponses")&&c.XHRResponses.map(function(a){a&&d._onVASTFetched(a)}))}},{key:"_onVASTFetched",value:function g(a){!this.stopped&&this.vastParser&&(this.vastParser.onFail=this.vastParser._extractTrackingEvents=this.vastParser._onWrapper=this.vastParser.onVpaidJs=this.vastParser.onMp4Video=this.vastParser.onVpaidJsMobile=this.vastParser.onMp4VideoMobile=function(){},this.vastParser.parseVastFromString(a.replace(/^load:/,"").trim()))}},{key:"_createXHRHook",value:function h(){var a=this;a.oldXHROpen=this.iframe.contentWindow.XMLHttpRequest.prototype.open,a.XHRUrls=[],a.XHRResponses=[],this.iframe.contentWindow.XMLHttpRequest.prototype.open=function(b,c,d,e,f){return a.XHRUrls.push(c),this.addEventListener("load",function(){a.XHRResponses.push("load: "+this.responseText)}),a.oldXHROpen.apply(this,arguments)}}},{key:"_stopAd",value:function i(){if(this.iframe&&this.iframe.contentWindow&&(this.iframe.contentWindow.ReportHijackAttempt=null,this.analyticsRegistered&&this.registerAnalyticsToVpaidLog))try{this.adUnit._iframe.contentWindow.destroyAnalyticsReporter&&(this.adUnit._iframe.contentWindow.destroyAnalyticsReporter(),Utils.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!0}))}catch(a){Utils.logToBI(this.vpaidLog,"vpaidAnalyticsDestroy",{success:!1,ex:a})}this.iframe=this.directAdOs=this.video=this.vpaidEvents=this.target=this.vpaidLog=this.store=this.vastParser=this.registerAnalyticsToVpaidLog=void 0,this.stopped=!0,this.onAfterStop()}},{key:"subscribe",value:function j(a,b){this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)}},{key:"unsubscribe",value:function k(a,b){if(this.vpaidEvents[b]){if(!a)return;this.beacon.removeEventListener(b,a)}}},{key:"stopAd",value:function l(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"_safeCall",value:function m(a,b){if(!this.stopped&&this.directAdOs)try{return this.directAdOs[a].apply(this.directAdOs,b)}catch(c){return Utils.logToBI(this.vpaidLog,"SpotxAdOsSafeCallError",{err:c.message,funcName:a,stack:c.stack}),this._onAdError(c),!1}}},{key:"_onAdError",value:function n(){}},{key:"onAfterStop",value:function o(){}},{key:"handshakeVersion",value:function p(a){return"2.0"}},{key:"_allEventsHandler",value:function q(a,b){var c,d;this.stopped||(a===this.vpaidEvents.AdImpression&&(this.analyticsRegistered||(c=b||{},
c.hasOwnProperty(a)||(c[a]={XHRUrls:this.XHRUrls,XHRResponses:this.XHRResponses}),this._handleAnalytics(a,c)),d=this.video.src,d&&Utils.logToBI(this.vpaidLog,"videoUrl",{url:d})),this.beacon.dispatchEvent(a,b))}},{key:"_getMediaUrl",value:function r(){return!1}},{key:"setAdVolume",value:function s(a){this.volume=a,this.isMuted=0===this.volume,this._safeCall("setAdVolume",[a])}},{key:"getAdVolume",value:function t(a){return this._safeCall("getAdVolume",[a])}},{key:"resizeAd",value:function u(a,b,c){this.target.style.width=a+"px",this.target.style.height=b+"px",this.target.setAttribute("width",a),this.target.setAttribute("height",b),this._safeCall("resize",[a,b,c])}},{key:"pauseAd",value:function v(){this._safeCall("pauseAd",[])}},{key:"resumeAd",value:function w(){this._safeCall("playAd",[])}},{key:"skipAd",value:function x(){this._safeCall("skipAd",[])}},{key:"startAd",value:function y(){this._safeCall("playAd",[])}},{key:"expandAd",value:function z(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function A(){this._safeCall("collapseAd",[])}},{key:"getAdWidth",value:function B(){return this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function C(){return this._safeCall("getAdWidth",[])}},{key:"getAdSkippableRemainingTime",value:function D(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function E(){return this._safeCall("getAdRemainingTime",[])}},{key:"getAdDuration",value:function F(){return this._safeCall("getAdDuration",[])}},{key:"getAdSkippableState",value:function G(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdIcons",value:function H(){return this._safeCall("getAdIcons",[])}},{key:"getAdCompanions",value:function I(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function J(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function K(){return this._safeCall("getAdLinear",[])}},{key:"getDOMContainer",value:function L(){return this.target}},{key:"getVideoUrl",value:function M(){return this._getVideoSrc(this.video)||this._findVideoUrlInIframes(this.target.querySelectorAll("iframe"))}},{key:"logVideoUrl",value:function N(){var a=this.getVideoUrl();a?(Utils.logToBI(this.vpaidLog,"spotxAdOsVideoUrl",{videoUrl:a}),this.vpaidLog.friendlyVideoUrl=!0):Utils.logToBI(this.vpaidLog,"spotxAdOsunfriendlyVideo",{unfriendlyVideo:!0})}},{key:"_findVideoUrlInIframes",value:function O(a){var b=this,c="";if(!a||0===a.length)return c;try{Utils.DOMIterator(a[0],"iframe",function(a){a.forEach(function(a){c||(c=b._getVideoSrc(a))})},"video",this.store.get("debug")),c||(c=this._findVideoUrlInIframes(a[0].contentDocument.querySelectorAll("iframe")))}catch(d){}return c}},{key:"_getVideoSrc",value:function P(a){var b,c,d;if(a.src)return a.src;if(b="",a.childNodes.length>0)for(c=a.querySelectorAll("source"),d=0;d<c.length;d++)if(c[d].src){b=c[d].src;break}return b}},{key:"isReplayable",value:function Q(){return!1}}]),SpotxAdOs}(),exports["default"]=SpotxAdOs,module.exports=exports["default"]},{"../player/Tracker":27,"../player/utils":38,"./Beacon":39,"./vpaidEvents":71}],58:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("../player/utils"),k=d(j),l=a("./trackingPixels"),m=e(l),n=a("./VpaidLog"),o=e(n),p=a("./OpportunityType"),q=e(p),r=a("../player/Post"),s=e(r),t=a("./mediafile-filter"),u=e(t),window.vpaidId=Date.now()+"-"+parseInt(1e4*Math.random()),v=!1,w=function(){function a(b,c){f(this,a),this.vpaidWrapper=b.vpaidWrapper,this.trackingPixels=(0,m["default"])(),this.trackingPixels.adimpression=[b.internalPixel].concat(b.tag.conversionPixels),this.store=c,this.preferdVpaid=this.store.get("pvpd")||"javascript",this.tag=b.tag,this.preferdVpaid=this.store.getByAdvId("pvpd",this.tag.advId)||this.preferdVpaid,this.pvidtp=this.store.getByLineItem("pvidtp",this.tag),this.vpaidLog=b.vpaidLog,this.stopped=!1,this.destroyed=!1,this.debugTracker=new i["default"]("VastParser"),this.width=parseInt(b.width||this.store.get("width")),this.height=parseInt(b.height||this.store.get("height")),this.bitrate=parseInt(b.bitrate),this.redirCount=0,this.isMobile=this.store.get("isMobile"),this.fileTypes=["flv","wmv","mp4","webm","ogg","mov"],this.vastUrls=[],this.wrappersCount=0,this.addWrappersToPlayerDAST=this.store.get("adwrprstoplrdst")}return g(a,[{key:"_fetch",value:function b(a,c,d,e){var f=this,g=cmTag.$||g;g.ajax({url:a,beforeSend:function h(a){d&&(a.withCredentials=!0)},timeout:1e4,complete:function i(a,b,d){a.responseText&&c(null,a.responseText)},error:function j(b,d,g){return e?c(d):void f._fetch(a,c,!1,!0)}})}},{key:"parseVastFromUrl",value:function c(a){var b,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a&&(a=k.trim(a)),a=this._replaceMacros(a),k.logToBI(this.vpaidLog,"parseVastFromUrl",{url:a}),this.vastUrls.push(a),(b=this.store.get("vstprxy"))?this._fetchVastByProxy(a):this._isSpotxAdOsUrl(a)?void this._parseSpotxAdOsUrl(a):void this._fetchVastXhr(a)}},{key:"_isSpotxAdOsUrl",value:function d(a){return 0===a.indexOf("spotx://")}},{key:"_parseSpotxAdOsUrl",value:function e(a){var b=a.replace("spotx://","").split("&")||[],c={};return b.map(function(a){if(a){var b=a.split("=");c[b[0]]=b[1]}}),c.hasOwnProperty("channel_id")?(k.logToBI(this.vpaidLog,"SpotxAdOsParsed",{params:k.stringify(c)}),void this.onSpotxAdOs(c,this.trackingPixels)):(this.debugTracker.error("SpotxAdOs","No channel id"),k.logToBI(this.vpaidLog,"SpotxAdOsError",{emptyChannelId:!0}),void this.onFail("SpotxAdOsMissingChannelId"))}},{key:"_fetchVastByProxy",value:function h(a){var b=this.store.get("pxyurl"),c=b+a;this._fetchVastXhr(c)}},{key:"_fetchVastXhr",value:function j(a){var b=this;(0,s["default"])(a,"",this._onTagResponse.bind(this),function(){b._onTagResponseError("vastxhrerror_noflash",a)})}},{key:"parseVastFromString",value:function l(a){k.logToBI(this.vpaidLog,"parseVastFromString",{xml:a}),this._onTagResponse(a)}},{key:"stop",value:function n(){this.stopped=!0,this.vpaidLog=null,this.debugTracker=this.trackingPixels=void 0}},{key:"_extractDuration",value:function o(a){var b=this._extractTag("duration",a),c=30;return b&&b.length&&b[0].textContent&&(c=parseInt(b[0].textContent.replace("00:00:",""))),c}},{key:"_extractMediaFile",value:function p(a,b,c,d){var e,f,g,h,i,j,l,m,n,o;if(!this.stopped){for(e=!1,f=!1,g=this._getFilesTemplate(),h={},i=[],j=0;j<a.length;j++){if(l=this._getMediaFileType(a[j]),l&&l.url){if((0,u["default"])(l.url,this.store)){k.logToBI(this.vpaidLog,"badMediaFile",{url:l.url});continue}i.push(l.url)}switch(l.type){case"vpaid":"javascript"==l.subType&&(e&&"javascript"!=e?f=!0:e="javascript",h.javascript=1,g.vpaid.javascript.push(l));break;case"video":e&&"video"!=e?f=!0:e="video",h.video=1,g.videoFiles[l.subType].push(l);break;default:f=!0,g.mixed.push(l)}}if(f&&this.preferdVpaid&&h.hasOwnProperty(this.preferdVpaid)&&(e=this.preferdVpaid),"video"===e){for(m=null,j=0;j<this.fileTypes.length;j++)n=g.videoFiles[this.fileTypes[j]],m||n.length>0&&n[0].url&&(m=n[0]),o=this._chooseBestVideoFile(n,this.bitrate,this.width,this.height),o&&o.url&&g.video.push(o);0===g.video.length&&null!==m&&(k.logToBI(this.vpaidLog,"fallbackVideoOnNaNScoring",m),g.video.push(m)),this._sortVideos(g.video)}i.length&&k.logToBI(this.vpaidLog,"vastMediaFiles",{urls:i}),this.publishParseTagResults(e,g,b,c,d)}}},{key:"_sortVideos",value:function r(a){var b=this;a.length&&this.pvidtp&&(a=a.sort(function(a,c){return a.url.indexOf(b.pvidtp)!=-1?-1:c.url.indexOf(b.pvidtp)!=-1?1:0}))}},{key:"publishParseTagResults",value:function t(a,b,c,d,e){if(!this.stopped){var f=!1;switch(a){case"javascript":b.vpaid.javascript.length>0&&(f=!0);break;case"video":b.video.length>0&&(f=!0)}if(f)switch(k.logToBI(this.vpaidLog,"vpiadWrapperFound",{wrapperMode:a}),this.isMobile&&(a+="Mobile"),a){case"javascript":this.onVpaidJs(b.vpaid.javascript,c,this.trackingPixels,b,e);break;case"video":this.onMp4Video(b.video,c,this.trackingPixels,b,e);break;case"javascriptMobile":this.onVpaidJsMobile(b.vpaid.javascript,c,this.trackingPixels,b,e);break;case"videoMobile":this.onMp4VideoMobile(b.video,c,this.trackingPixels,b,e)}else this._onVastError("NoMediaFileAfterSort",d,q["default"].mediaFileNotSupported),k.logToBI(this.vpaidLog,"noMediaFileAfterSort",{})}}},{key:"_chooseBestVideoFile",value:function v(a,b,c,d){var e,f,g,h,i;if(this.stopped)return!1;for(e=!1,f=this.store.get("isMobile"),g=d/c,h=99999999,i=0;i<a.length;i++)a[i].ratioFactor=Math.abs(g-a[i].ratio),a[i].sizeFactor=Math.abs(c-a[i].width)+Math.abs(d-a[i].height),a[i].rateFactor=Math.abs(b-a[i].bitrate),a[i].weight=0,f&&(a[i].rateFactor*=-1,this._isRtmp(a[i].url)&&(a[i].weight=1e6)),a[i].score=100*a[i].ratioFactor+1*a[i].sizeFactor+a[i].rateFactor+a[i].weight,h>a[i].score&&(h=a[i].score,e=a[i]);return e}},{key:"_isRtmp",value:function w(a){return 0===a.indexOf("rtmp://")}},{key:"_getFilesTemplate",value:function x(){var a,b={video:[],videoFiles:{},vpaid:{flash:[],javascript:[]},mixed:[]};for(a=0;a<this.fileTypes.length;a++)b.videoFiles[this.fileTypes[a]]=[];return b}},{key:"_getMediaFileType",value:function y(a){var b,c,d,e,f;if(this.stopped)return{};switch(b={},b.url=a.textContent,b.url&&(b.url=b.url.trim()),c=parseInt(a.getAttribute("bitrate")),b.bitrate=c?c:0,d=parseInt(a.getAttribute("width")),b.width=d?d:0,e=parseInt(a.getAttribute("height")),b.height=e?e:0,b.originalType=a.getAttribute("type"),b.originalType){case"video/x-flv":b.type="video",b.subType="flv";break;case"video/x-ms-wmv":b.type="video",b.subType="wmv";break;case"video/mp4":b.type="video",b.subType="mp4";break;case"video/webm":b.type="video",b.subType="webm";break;case"video/ogg":b.type="video",b.subType="ogg";break;case"video/quicktime":f=this.store.get("ua"),"Safari"!==f.browser.name?(b.originalType="video/mp4",b.type="video",b.subType="mp4"):(b.type="video",b.subType="mov");break;case"application/javascript":case"application/x-javascript":case"text/javascript":b.type="vpaid",b.subType="javascript";break;case"application/x-shockwave-flash":b.type="vpaid",b.subType="flash";break;default:k.logToBI(this.vpaidLog,"unknownMediaFileType",{type:b.originalType}),b.type="unknown",b.subType="unknown"}return b.width&&b.height?b.ratio=b.height/b.width:b.ratio="1:1",b}},{key:"_extractTrackingEvents",value:function z(a){var b,c,d,e,f,g;if(!this.stopped&&(this._checkForSpecificEvent("impression",a),this._checkForSpecificEvent("error",a),this._checkForSpecificEvent("clickthru",a),this._checkForSpecificEvent("clickthrough",a),this._checkForSpecificEvent("clicktracking",a),b=this._extractTag("trackingevents",a),b.length>0))for(c=this._extractTag("tracking",b[0]),d=0;d<c.length;d++)e=c[d].getAttribute("event"),e&&("progress"===e.toLowerCase()?(g=c[d].getAttribute("offset"),g&&(f=g.indexOf("%")===-1?"time":"precentage"),this._addEventPixel(e.toLowerCase(),this._extractTagUrl(c[d]),g,f)):this._addEventPixel(e.toLowerCase(),this._extractTagUrl(c[d])))}},{key:"_extractTagUrl",value:function A(a){var b,c;if(!this.stopped)return b=this._extractTag("url",a),c="",c=b.length>0?b[0].textContent:a.textContent}},{key:"_extractTag",value:function B(a,b){var c,d,e,f,g,h;if(!this.stopped){for(c=b.childNodes,d=[],e=Array.isArray(a),f=0;f<c.length;f++)c[f].tagName&&(g=c[f].tagName.toLocaleLowerCase(),h=e?a.indexOf(g)>-1:g==a,h?d.push(c[f]):d=d.concat(this._extractTag(a,c[f])));return d}}},{key:"_extractTagArttibute",value:function C(a,b,c){var d,e,f,g;if(!this.stopped){for(d=b.childNodes,e=[],f=0;f<d.length;f++)d[f].tagName&&(d[f].tagName.toLocaleLowerCase()==a?(g=d[f].getAttribute(c),e.push(g)):e=e.concat(this._extractTagArttibute(a,d[f],c)));return e}}},{key:"_filterVastByRegex",value:function D(a){var b,c,d=this.store.getByAdvId("regx",this.tag.advId);return!!d&&(b=new RegExp(d),c=b.exec(a),!(!c||!c.length))}},{key:"_onTagResponse",value:function E(a,b){var c,d,e,f,g;if(!this.stopped){if(this.debugTracker.info("Vast was loaded",{vast:a}),k.logToBI(this.vpaidLog,"tagResponse",{response:a,xhrErrors:b}),this._filterVastByRegex(a))return k.logToBI(this.vpaidLog,"vastFilterdByRegex",{response:a,regex:this.store.getByAdvId("regx",this.tag.advId),xhrErrors:b}),void this._onVastFilterdByRegexError("VastFilterdByRegex",a,q["default"].filterVastByRegex);if(c=this._parseXml(a),null==c)return void this._onVastError("ParsingError",a,q["default"].vastError);this.vastVersion=this._extractTagArttibute("vast",c,"version").shift()||"1.1",this.vpaidWrapper.setVastPrice(this._readTagPrice(c)),this.store.get("vastTypeMap")&&this.vpaidWrapper.setVastType(this._readType(a)),this.icons||(this.icons=this._getIcons(c),this.vpaidWrapper.setVastIcons(this.icons)),d=this._extractDuration(c),e=this._extractTag("mediafiles",c),e&&1==e.length&&e[0].childNodes.length?(f=this._extractTag("mediafile",e[0]),0==f.length?(this.debugTracker.error("Vast","No media files!"),this._onVastError("NoMediaFiles",a,q["default"].emptyVast)):(this._extractMediaFileAnalysisToPlayerDAST(c,d),this._extractTrackingEvents(c),this._extractMediaFile(f,this._getAdParameters(c),a,d))):(g=this._extractTag("wrapper",c),1==g.length?(this._extractTrackingEvents(c),this._onWrapper(g[0],a,c,d)):this._onVastError("NoMediaFiles",a,q["default"].emptyVast))}}},{key:"_extractMediaFileAnalysisToPlayerDAST",value:function F(a,b,c){var d,e,f={},g=this._extractTag("ad",a).shift();g&&(f.aid=this._extractAttributeFromTag(g,"id")),d=this._extractTag("adsystem",a).shift(),d&&(f.as=this._extractTextFromTag(d)),e=this._extractTag("adtitle",a).shift(),e&&(f.at=this._extractTextFromTag(e)),c&&(f.wu=c),this.vpaidWrapper.playerDAST.set({vdr:b}),this.vpaidWrapper.playerDAST.addWrapper(f)}},{key:"_extractAttributeFromTag",value:function G(a,b){return a.getAttribute(b)||""}},{key:"_extractTextFromTag",value:function H(a){return a.textContent||""}},{key:"_readTagPrice",value:function I(a){var b,c=this._extractTag(["price","pricing"],a).shift(),d=0;if(c){b=c.textContent;try{isNaN(Number(b))&&b.indexOf("DATA")!=-1&&(d=b.replace(/[^0-9.]/g,"")),d=Number(b),d=d.toFixed(3),d=Number(d)}catch(e){d=0}}return d}},{key:"_readType",value:function J(a){var b,c=this.store.get("vastTypeMap"),d=void 0;for(b in c)a.search(new RegExp(b,"i"))!=-1&&(d=c[b]);return d}},{key:"_getIcons",value:function K(a){var b,c,d,e=[],f=this._extractTag(["icon"],a);for(b=0;b<f.length;b++)c={},d=this._isIconClicksExists(f[b]),d&&(c.clickThroughUrl=this._decodeIconData(f[b],"iconclickthrough").shift()),c.staticresource=this._decodeIconData(f[b],"staticresource").shift(),c.staticresource||(c.htmlresource=this._decodeIconData(f[b],"htmlresource").shift()),!c.htmlresource&&!c.staticresource||d&&!c.clickThroughUrl||(c.iconViewTracking=this._decodeIconData(f[b],"iconviewtracking"),c.clickTracking=this._decodeIconData(f[b],"iconclicktracking"),c.attributes=this._decodeIconAttributes(f[b]),e.push(c));return e}},{key:"_isIconClicksExists",value:function L(a){var b=this._extractTag(["iconclicks"],a).shift(),c=!!b;return c}},{key:"_decodeIconAttributes",value:function M(a){var b,c=a.attributes,d={};for(b in c)c[b].value?d[c[b].name]=c[b].value.toLowerCase():null,"width"===c[b].name||"height"===c[b].name?d[c[b].name]+="px":null;return d}},{key:"_decodeIconData",value:function N(a,b){var c,d;try{return c=this._extractTag([b],a),d=c.map(function(a){return a.textContent.trim()})}catch(e){return this.debugTracker.warn("Vast","decode Icon "+b,e),""}}},{key:"_onWrapper",value:function O(a,b,c,d){var e,f;if(!this.stopped){if(this.wrappersCount++,e=this._extractTag("vastadtagurl",a),0==e.length&&(e=this._extractTag("vastadtaguri",a),0==e.length))return this._onVastError("WrapperError",b,q["default"].vastWrapperError);if(f=this._extractTagUrl(e[0]),!f)return this._onVastError("WrapperError",b,q["default"].vastWrapperError);0===this.redirCount&&k.logToBI(this.vpaidLog,"VastWrapper",{type:"wrapper"}),this.redirCount++,this.addWrappersToPlayerDAST&&this._extractMediaFileAnalysisToPlayerDAST(c,d,f),this.parseVastFromUrl(f)}}},{key:"_getAdParameters",value:function P(a){var b,c;if(!this.stopped)return b="",c=this._extractTag("adparameters",a),c.length>0&&c[0].textContent&&(b=c[0].textContent),b}},{key:"_checkForSpecificEvent",value:function Q(a,b){var c,d;if(!this.stopped)for(c=this._extractTag(a,b),d=0;d<c.length;d++)this._addEventPixel(a,this._extractTagUrl(c[d]))}},{key:"_addEventPixel",value:function R(a,b,c,d){if(!this.stopped&&void 0!=this.trackingPixels[a]&&b)if("progress"===a){if(c&&d)try{this.trackingPixels[a].push({pixel:b,offset:"time"===d?k.hmsmToSecondsOnly(c):parseInt(c.replace("%",""))/100,offsetType:d,fired:!1})}catch(e){}}else this.trackingPixels[a].push(b)}},{key:"_parseXml",value:function S(a){if(this.stopped)return null;var b=null;if(window.DOMParser)try{b=(new DOMParser).parseFromString(a,"text/xml")}catch(c){b=null}else if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)||(b=null)}catch(c){b=null}return b}},{key:"_onTagResponseError",value:function T(a,b){if(!this.stopped){if(this.vpaidWrapper.vpaidHandler)return void k.logToBI(this.vpaidLog,"VastParserOnTagResponseError",{type:"wrapper has handler"});this.debugTracker.error("Vast","Vast url was not loaded!aborting..."),this._reportToServer(a,"VastLoadError="+a+"&URL="+encodeURIComponent(b)),k.logToBI(this.vpaidLog,"tagLoadError",{errorCodes:a,url:b,urls:this.vastUrls}),a&&Array.isArray(a)?this.onNetworkFail(a):this.onFail(a)}}},{key:"_onVastError",value:function U(a,b,c){this.stopped||(this.debugTracker.error("VAST-ERROR",a),k.logToBI(this.vpaidLog,"vastParseError",{errType:a}),this.onFail(a,c))}},{key:"_onVastFilterdByRegexError",value:function V(a,b,c){this.stopped||(this.debugTracker.error("VAST-ERROR",a),this.onFail(a,c))}},{key:"_sampleVastXml",value:function W(a){this.stopped}},{key:"_reportToServer",value:function X(a,b){}},{key:"destroy",value:function Y(){this.stopped=!0,this.destroyed=!0,this.vpaidLog=null,this.vastUrls=null,this.tag=null,this.trackingPixels=this.debugTracker=this.fileTypes=void 0,this._onTagResponse=this._onTagResponseError=function(){},this.onFail=this.onNetworkFail=this.onVpaidJs=this.onMp4Video=this.onSpotxAdOs=function(){}}},{key:"_replaceMacros",value:function Z(a){return a=a.replace(/\[CACHEBUSTER\]/,Date.now())}},{key:"onFail",value:function $(a){}},{key:"onNetworkFail",value:function _(a,b){}},{key:"onVpaidJs",value:function aa(a,b,c,d){}},{key:"onMp4Video",value:function ba(a,b,c,d){}},{key:"onSpotxAdOs",value:function ca(a,b){}}]),a}(),c["default"]=w,b.exports=c["default"]},{"../player/Post":22,"../player/Tracker":27,"../player/utils":38,"./OpportunityType":53,"./VpaidLog":61,"./mediafile-filter":68,"./trackingPixels":70}],59:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./Beacon"),i=e(h),j=a("../player/Tracker"),k=e(j),l=a("./vpaidEvents"),m=e(l),n=a("../player/utils"),o=d(n),p=function(){function a(b,c,d){f(this,a),this.vpaidLog=c,this.store=d,this.type="video",this.stopped=!1,this.version="1.1",this.target=b.slot,this.video=b.videoSlot,this.mediaFiles=b.vpaidFiles,this.mediaUrl,this.videoSlotControls=b.videoSlotControls,this._PlayerWidth=0,this._PlayerHeight=0,this._AdVolume=0,this._AdLinear=!0,this._AdExpanded=!0,this._AdCompanions=[],this._AdIcons=[],this._SkipTime=60,this._AdPlaying=!1,this._AdPaused=!1,this._PlayerReady=!1,this._FirstFired=!1,this._MidFired=!1,this._ThirdFired=!1,this._VideoLength=0,this._relevantSources=0,this._errorsCount=0,this.beacon=new i["default"](this),this.vpaidEvents=Object.assign({},m["default"]),this.decodeUrl=this.store.get("dcdvdurl"),this._createBindedCallback(),window.setTimeout(b.onReady,0),b.trackingPixels.progress.length>0&&(this._progressEvents=b.trackingPixels.progress),this.firstResume=!0,this.playerDAST=b.playerDAST}return g(a,[{key:"_createBindedCallback",value:function b(){this._onBindedCanPlay=this._onCanPlay.bind(this),this._onBindedPlay=this._onPlay.bind(this),this._onBindedPause=this._onPause.bind(this),this._onBindedComplete=this._onComplete.bind(this),this._onBindedPlayerError=this._onPlayerError.bind(this),this._onBindedClickThru=this._onClickThru.bind(this),this._onBindedVolume=this._onVolume.bind(this),this._onBindedTimeUpdate=this._onTimeUpdate.bind(this),this._onBindedDurationChange=this._onDurationChange.bind(this),this._onBindedWaiting=this._onWaiting.bind(this)}},{key:"_onWaiting",value:function c(){o.logToBI(this.vpaidLog,"waiting",{videoCurrentTime:this.video.currentTime})}},{key:"_onCanPlay",value:function d(){this.stopped||(this._VideoLength=this.video.duration,o.logToBI(this.vpaidLog,"canplay",{videoCanPlay:!0}),this._PlayerReady||(this._PlayerReady=!0,this.video.pause(),this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded),this._AdPlaying&&this._fireAdImpression()))}},{key:"_onPlay",value:function e(){return!this.startAdFired||void(this.stopped||(this._AdPaused=!1,this._AdPlaying?this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying):(this._AdPlaying=!0,this._PlayerReady&&setTimeout(function(){this._fireAdImpression()}.bind(this),200))))}},{key:"_onPause",value:function h(){this.stopped||(this._AdPaused=!0,parseInt(this.video.currentTime)<parseInt(this.video.duration)&&this.beacon.dispatchEvent(this.vpaidEvents.AdPaused))}},{key:"_onComplete",value:function j(){this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoComplete),this.beacon&&!this.stayAlive&&this.beacon.dispatchEvent(this.vpaidEvents.AdStopped))}},{key:"_onPlayerError",value:function k(a){this.stopped||(this._errorsCount++,this._errorsCount>=this._relevantSources&&this.beacon.dispatchEvent(this.vpaidEvents.AdError))}},{key:"_onVolume",value:function l(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{volume:this.video.volume})}},{key:"_onClickThru",value:function n(){this.stopped||(this.store.set("forcePause",!1),this._AdPaused?this.video.play():(this.beacon.dispatchEvent(this.vpaidEvents.AdClickThru),this.video.pause()))}},{key:"_onDurationChange",value:function p(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdDurationChange)}},{key:"_onTimeUpdate",value:function q(){var a,b,c;if(!this.stopped&&!this._ThirdFired&&this._VideoLength&&(a=this.video.currentTime/this._VideoLength,a>.25&&!this._FirstFired?(this._FirstFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoFirstQuartile)):a>.5&&!this._MidFired?(this._MidFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoMidpoint)):a>.75&&!this._ThirdFired&&(this._ThirdFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoThirdQuartile)),this._progressEvents))for(b=0;b<this._progressEvents.length;b++)c="time"===this._progressEvents[b].offsetType?this.video.currentTime>this._progressEvents[b].offset:a>this._progressEvents[b].offset,!this._progressEvents[b].fired&&c&&(this._progressEvents[b].fired=!0,this.beacon.dispatchEvent(this.vpaidEvents.Progress,b))}},{key:"_connectToVideoTag",value:function r(){this.stopped||(this.video.addEventListener("canplay",this._onBindedCanPlay,!0),this.video.addEventListener("play",this._onBindedPlay,!0),this.video.addEventListener("pause",this._onBindedPause,!0),this.video.addEventListener("ended",this._onBindedComplete,!0),this.video.addEventListener("error",this._onBindedPlayerError,!0),this.video.addEventListener("click",this._onBindedClickThru,!0),this.video.addEventListener("volumechange",this._onBindedVolume,!0),this.video.addEventListener("timeupdate",this._onBindedTimeUpdate,!0),this.video.addEventListener("durationchange",this._onBindedDurationChange,!0),this.video.addEventListener("waiting",this._onBindedWaiting,!0))}},{key:"_disconnectFromVideoTag",value:function s(){this.video.removeEventListener("canplay",this._onBindedCanPlay),this.video.removeEventListener("play",this._onBindedPlay),this.video.removeEventListener("pause",this._onBindedPause),this.video.removeEventListener("ended",this._onBindedComplete),this.video.removeEventListener("error",this._onBindedPlayerError),this.video.removeEventListener("click",this._onBindedClickThru),this.video.removeEventListener("volumechange",this._onBindedVolume),this.video.removeEventListener("timeupdate",this._onBindedTimeUpdate),this.video.removeEventListener("durationchange",this._onBindedDurationChange),this.video.removeEventListener("waiting",this._onBindedWaiting)}},{key:"_prepareVideoTag",value:function t(){this.stopped||(this.video.removeAttribute("controls"),this._connectToVideoTag(),this._loadVideoTagSources())}},{key:"_loadVideoTagSources",value:function u(){var a,b,c;if(!this.stopped){for(;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);for(a=0;a<this.mediaFiles.length;a++)b=document.createElement("source"),c=this.mediaFiles[a],this.video.canPlayType(c.originalType)&&(this._relevantSources++,this.mediaUrl=this.decodeUrl?decodeURI(c.url):c.url,b.src=this.mediaUrl,b.setAttribute("type",c.originalType),0===this.video.childNodes.length&&this.playerDAST.set({vu:this.mediaUrl,vbr:c.bitrate,vwd:c.width,vht:c.height,ot:c.originalType,st:c.subType}),this.video.appendChild(b))}}},{key:"_fireAdImpression",value:function v(){this.fireImpression||this._fireAdImprssionEvents()}},{key:"_fireAdImprssionEvents",value:function w(){this.beacon&&(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this.fireImpression=!0)}},{key:"resizeAd",value:function x(a,b,c){this.stopped||(this._PlayerWidth=parseInt(a),this._PlayerHeight=parseInt(b),this.video.style.width=this._PlayerWidth+"px",this.target.style.width=this._PlayerWidth+"px",this.video.style.height=this._PlayerHeight+"px",this.target.style.height=this._PlayerHeight+"px",this.video.setAttribute("width",this._PlayerWidth),this.target.setAttribute("width",this._PlayerWidth),this.video.setAttribute("height",this._PlayerHeight),this.target.setAttribute("height",this._PlayerHeight))}},{key:"initAd",value:function y(a,b,c,d,e,f){this.stopped||(this.resizeAd(a,b,c),this._prepareVideoTag())}},{key:"stopAd",value:function z(a){if(!this.stopped){for(this.stopped=!0,this.video.pause(),this._disconnectFromVideoTag();this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);this.video.src="",this.vpaidLog=void 0,this.store=void 0,this.mediaFiles=this.target=this.beacon=this.video=this.target=this._onError=void 0,setTimeout(this.onAfterStop,50)}}},{key:"pauseAd",value:function A(){this.stopped||this.video.pause()}},{key:"resumeAd",value:function B(){var a=this;this.stopped||(this.resumed=!0,this.video.play(),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),this.firstResume&&(setTimeout(function(){a.stopped||a._AdPaused||o.logToBI(a.vpaidLog,"videoTimeAfter3secFromResumeAd",{vidCurrentTime:a.video.currentTime})},3e3),this.firstResume=!1))}},{key:"skipAd",value:function C(){this.stopped||this.getAdSkippableState()&&this.stopAd()}},{key:"setAdVolume",value:function D(a){this.stopped||(this._AdVolume=parseFloat(a)<=1?a:parseInt(a)/100,this.video.volume=this._AdVolume)}},{key:"getAdWidth",value:function E(){return this._PlayerWidth}},{key:"getAdHeight",value:function F(){return this._PlayerHeight}},{key:"getAdSkippableRemainingTime",value:function G(){var a=this.getAdRemainingTime()-this._SkipTime;return a>0?a:0}},{key:"getAdRemainingTime",value:function H(){return this._VideoLength-this.video.currentTime}},{key:"getAdDuration",value:function I(){return this._VideoLength}},{key:"getAdSkippableState",value:function J(){return 0==this.getAdSkippableRemainingTime()}},{key:"getDOMContainer",value:function K(){return this.target}},{key:"startAd",value:function L(){this.video.play(),this.startAdFired=!0,this._onPlay()}},{key:"restartAd",value:function M(){var a,b=this;o.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),this.stopped||(this.video.currentTime=0,this.video.play(),a=function c(){o.logToBI(b.vpaidLog,"restartAd",{videoComplete:!0}),b.video.removeEventListener("ended",c),b._onComplete()},this.video.addEventListener("ended",a))}},{key:"isReplayable",value:function N(){return!0}},{key:"expandAd",value:function O(){}},{key:"collapseAd",value:function P(){}},{key:"getAdVolume",value:function Q(a){a&&a(null,this._AdVolume)}},{key:"getAdIcons",value:function R(){return this._AdIcons}},{key:"getAdCompanions",value:function S(){return this._AdCompanions}},{key:"getAdExpanded",value:function T(){return this._AdExpanded}},{key:"getAdLinear",value:function U(){return this._AdLinear}},{key:"handshakeVersion",value:function V(){return this.version}},{key:"subscribe",value:function W(a,b){this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)}},{key:"unsubscribe",value:function X(a,b){if(this.vpaidEvents[b]){if(void 0==a)return;this.beacon.removeEventListener(b,a)}}},{key:"onAfterStop",value:function Y(){}},{key:"dontDie",value:function Z(){this.stayAlive=!0}},{key:"_getMediaUrl",value:function $(){return this.mediaUrl}},{key:"getVideoUrl",value:function _(){var a,b,c;if(this.video.src)return this.video.src;if(a="",this.video.childNodes.length>0)for(b=this.video.querySelectorAll("source"),c=0;c<b.length;c++)if(b[c].src){a=b[c].src;break}return a}}]),a}(),c["default"]=p,b.exports=c["default"]},{"../player/Tracker":27,"../player/utils":38,"./Beacon":39,"./vpaidEvents":71}],60:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./Beacon"),i=e(h),j=a("../player/Tracker"),k=e(j),l=a("./vpaidEvents"),m=e(l),n=a("./Mpg1Canvas"),o=e(n),p=a("../player/utils"),q=d(p),r=function(){function a(b,c,d){var e,g,h=this;f(this,a),this.vpaidLog=c,this.store=d,this.type="video",this.stopped=!1,this.version="1.1",this.target=b.slot,this.video=b.videoSlot,this.clickableTarget=b.clickableTarget||null,this.useCanvasMpeg=this.store.get("uscnvsmpg")||!1,this.hasAutoPlay=this.store.get("hasAutoPlay")||!1,this.isMobile=this.store.get("isMobile")||!1,this.tag=b.tag,this.isCanvasMpeg=this._decideCanvas(),this._firedAdLoaded=!1,this.vpaidEvents=Object.assign({},m["default"]),this.lastClickTime=null,this.playerDAST=b.playerDAST,e=this.store.get("ua"),this.isIOS="iOS"===e.os.name,b.trackingPixels.progress.length>0&&(this._progressEvents=b.trackingPixels.progress),this.isCanvasMpeg?(this.canvas=new o["default"](this.video,this,null,null,d),this.canvas.on("newVidCreated",function(a){
a.style.pointerEvents="all",a.style.zIndex=a.style.zIndex||h.zIndex,h._AdPaused=a.paused,h.canvas&&(h.canvas.removeListener(h.vpaidEvents.AdVideoFirstQuartile,h._bindedAdVideoFirstQuartileDispatcher),h.canvas.removeListener(h.vpaidEvents.AdVideoMidpoint,h._bindedAdVideoMidpointDispatcher),h.canvas.removeListener(h.vpaidEvents.AdVideoThirdQuartile,h._bindedAdVideoThirdQuartileDispatcher))}),this.canvas.on("ready",function(){h._fireAdLoaded()}),this._bindedAdVideoFirstQuartileDispatcher=this._dispatchQuartileEvent.bind(this,this.vpaidEvents.AdVideoFirstQuartile),this._bindedAdVideoMidpointDispatcher=this._dispatchQuartileEvent.bind(this,this.vpaidEvents.AdVideoMidpoint),this._bindedAdVideoThirdQuartileDispatcher=this._dispatchQuartileEvent.bind(this,this.vpaidEvents.AdVideoThirdQuartile),this.canvas.once(this.vpaidEvents.AdVideoFirstQuartile,this._bindedAdVideoFirstQuartileDispatcher),this.canvas.once(this.vpaidEvents.AdVideoMidpoint,this._bindedAdVideoMidpointDispatcher),this.canvas.once(this.vpaidEvents.AdVideoThirdQuartile,this._bindedAdVideoThirdQuartileDispatcher),g=document.getElementsByClassName("vpaid-ad-controls")[0],g&&(g.className+=" hide")):setTimeout(function(){h.beacon&&h.beacon.dispatchEvent(h.vpaidEvents.AdLoaded)},2e3),q.logToBI(this.vpaidLog,"vpaidInit",{hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg,forceCavnas:this.store.get("forcecnvsmpg"),useAutoPlayForContent:this.store.get("useapforcntnt"),isMobile:this.isMobile}),this.mediaFiles=b.vpaidFiles,this.mediaUrl,this.videoSlotControls=b.videoSlotControls,this.videoSlotCanAutoPlay=b.videoSlotCanAutoPlay,this._PlayerWidth=0,this._PlayerHeight=0,this.volume=0,this._AdLinear=!0,this._AdExpanded=!0,this._AdCompanions=[],this._AdIcons=[],this._SkipTime=60,this._AdPlaying=!1,this._AdPaused=!1,this._PlayerReady=!1,this._FirstFired=!1,this._MidFired=!1,this._ThirdFired=!1,this._VideoLength=b.extra.duration||30,this._relevantSources=0,this._errorsCount=0,this.beacon=new i["default"](this),this.decodeUrl=this.store.get("dcdvdurl"),window.setTimeout(b.onReady,0),this.firstResume=!0}return g(a,[{key:"_dispatchQuartileEvent",value:function b(a){this.beacon.dispatchEvent(a)}},{key:"_fireAdLoaded",value:function c(){this._firedAdLoaded||this.beacon.dispatchEvent(this.vpaidEvents.AdLoaded),this._firedAdLoaded=!0}},{key:"_decideCanvas",value:function d(){var a,b,c,d;return!!this.store.get("uscnvsmpg")&&(a=this.store.get("dsm")||{},b=a.mobAp||[],c=this.tag.advId,b.indexOf(c)>-1?(q.logToBI(this.vpaidLog,"canvasOptOutByAdvId",{advId:c}),!1):(d=this.store.get("forcecnvsmpg")||!1,this.useCanvasMpeg&&!this.hasAutoPlay&&this.isMobile||d))}},{key:"muteClick",value:function e(){this.stopped||(this.canvas?this.canvas.muteButtonClick():this.volume?this.setAdVolume(0):this.setAdVolume(.7))}},{key:"playButtonClick",value:function h(){this.stopped||(this.canvas?this.canvas.playButtonClick():this._AdPaused?this.play():this.pause())}},{key:"_onCanPlay",value:function j(){this.stopped||(this._VideoLength=this.video.duration,q.logToBI(this.vpaidLog,"canplay",{videoCanPlay:!0,hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg}),this._PlayerReady||(this._PlayerReady=!0,this.isMobile||this.video.pause(),this._fireAdLoaded(),this._AdPlaying&&this._fireAdImpression()))}},{key:"_onPlaying",value:function k(){this.stopped||q.logToBI(this.vpaidLog,"videoPlaying",{vidCurrentTime:this.video.currentTime})}},{key:"_onPlay",value:function l(){var a,b=this;if(!this.stopped){if(!this.canvas&&this.store.get("dataSaverDetected")||(this._AdPaused=!1,this.video.play()),this.startAdFired)return this.store.emit("onVideoVpaidMobilePlayPauseChanged",!0),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),!0;this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),this.stopped||(this._AdPlaying?this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying):(this._AdPlaying=!0,setTimeout(function(){b._fireAdImpression()},2e3)),a=this,setTimeout(function(){a.stopped||q.logToBI(a.vpaidLog,"videoTimeAfter5sec",{vidCurrentTime:b.video.currentTime,hasAutoPlay:b.hasAutoPlay,isCanvasMpeg:b.isCanvasMpeg})},5e3),this.isMobile&&(this.timeUpdateInterval=setInterval(function(){a.stopped||a._onTimeUpdate()},2e3)))}}},{key:"_onPause",value:function n(){this.stopped||(this._AdPaused=!0,parseInt(this.video.currentTime)<parseInt(this.video.duration)&&this.beacon.dispatchEvent(this.vpaidEvents.AdPaused))}},{key:"_onComplete",value:function p(){this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoComplete),this.beacon&&this.beacon.dispatchEvent(this.vpaidEvents.AdStopped))}},{key:"_onPlayerError",value:function r(a){this.isCanvasMpeg||(q.logToBI(this.vpaidLog,"videoError",{value:a,hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg}),this.stopped||(this._errorsCount++,this._errorsCount>=this._relevantSources&&this.beacon.dispatchEvent(this.vpaidEvents.AdError)))}},{key:"_onVolume",value:function s(){this.stopped||(q.logToBI(this.vpaidLog,"volumeChange",{value:this.video.volume,hasAutoPlay:this.hasAutoPlay,isCanvasMpeg:this.isCanvasMpeg}),this.beacon.dispatchEvent(this.vpaidEvents.AdVolumeChange,{volume:this.video.volume}))}},{key:"_onClickThru",value:function t(a){if(a.preventDefault(),a.stopPropagation(),!this.stopped){if(this.isIOS){var b=(new Date).getTime();if(null!==this.lastClickTime&&b-this.lastClickTime<=100)return;this.lastClickTime=b}this._AdPaused||this.store.get("dataSaverDetected")&&0===this.video.currentTime?(this.video.play(),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying)):(this.beacon.dispatchEvent(this.vpaidEvents.AdClickThru),this.video.pause())}}},{key:"_onDurationChange",value:function u(){this.stopped||this.beacon.dispatchEvent(this.vpaidEvents.AdDurationChange)}},{key:"_onTimeUpdate",value:function v(){var a,b,c;if(!this.stopped&&!this._ThirdFired&&this._VideoLength&&(a=this.video.currentTime/this._VideoLength,a>.25&&!this._FirstFired?(this._FirstFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoFirstQuartile)):a>.5&&!this._MidFired?(this._MidFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoMidpoint)):a>.75&&!this._ThirdFired&&(this._ThirdFired=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdVideoThirdQuartile)),this._progressEvents))for(b=0;b<this._progressEvents.length;b++)c="time"===this._progressEvents[b].offsetType?this.video.currentTime>this._progressEvents[b].offset:a>this._progressEvents[b].offset,!this._progressEvents[b].fired&&c&&(this._progressEvents[b].fired=!0,this.beacon.dispatchEvent(this.vpaidEvents.Progress,b))}},{key:"_connectToVideoTag",value:function w(){this.stopped||(this.video.addEventListener("canplay",this._onCanPlay.bind(this),!0),this.video.addEventListener("play",this._onPlay.bind(this),!0),this.video.addEventListener("playing",this._onPlaying.bind(this),!0),this.video.addEventListener("pause",this._onPause.bind(this),!0),this.video.addEventListener("ended",this._onComplete.bind(this),!0),this.video.addEventListener("error",this._onPlayerError.bind(this),!0),this.video.addEventListener("volumechange",this._onVolume.bind(this),!0),this.video.addEventListener("timeupdate",this._onTimeUpdate.bind(this),!0),this.video.addEventListener("durationchange",this._onDurationChange.bind(this),!0),this.video.addEventListener("waiting",this._onWaiting.bind(this),!0),this._bindedOnClick=this._onClickThru.bind(this),this.video.addEventListener("click",this._bindedOnClick,!0),this.isIOS&&this.clickableTarget&&this.clickableTarget.addEventListener("click",this._bindedOnClick,!0))}},{key:"_disconnectFromVideoTag",value:function x(){this.video.removeEventListener("canplay",this._onCanPlay),this.video.removeEventListener("play",this._onPlay),this.video.removeEventListener("pause",this._onPause),this.video.removeEventListener("ended",this._onComplete),this.video.removeEventListener("error",this._onPlayerError),this.video.removeEventListener("volumechange",this._onVolume),this.video.removeEventListener("timeupdate",this._onTimeUpdate),this.video.removeEventListener("durationchange",this._onDurationChange),this.video.removeEventListener("click",this._bindedOnClick,!0),this.video.removeEventListener("waiting",this._onWaiting),this.isIOS&&this.clickableTarget&&this.clickableTarget.removeEventListener("click",this._bindedOnClick,!0)}},{key:"_onWaiting",value:function y(){q.logToBI(this.vpaidLog,"waiting",{videoCurrentTime:this.video.currentTime})}},{key:"_prepareVideoTag",value:function z(){this.stopped||(this.video.removeAttribute("controls"),!this.isCanvasMpeg&&this.isMobile&&this.video.classList.remove("vjs-default-skin"),this.video.muted=!0,this.video.setAttribute("playsinline",""),this._connectToVideoTag(),this._loadVideoTagSources())}},{key:"_loadVideoTagSources",value:function A(){var a,b,c;if(!this.stopped){for(;this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);for(this._sortMediaFiles(),a=null,b=0;b<this.mediaFiles.length;b++)c=this.mediaFiles[b],this.video.canPlayType(c.originalType)&&(this._relevantSources++,this.mediaUrl=this.decodeUrl?decodeURI(c.url):c.url,a=c,this.video.src=this.mediaUrl);a&&this.playerDAST.set({vu:this.mediaUrl,vbr:c.bitrate,vwd:c.width,vht:c.height,ot:c.originalType,st:c.subType})}}},{key:"_sortMediaFiles",value:function B(){var a=this._PlayerWidth;this.mediaFiles.sort(function b(c,d){var e=Math.abs(a-c.width),f=Math.abs(a-d.width);return e-f}),this.mediaFiles.sort(function(a,b){return a.bitRate-b.bitRate})}},{key:"_fireAdImpression",value:function C(){this.stopped||this.fireImpression||(this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this.fireImpression=!0)}},{key:"resizeAd",value:function D(a,b,c){this.stopped||(this._PlayerWidth=parseInt(a),this._PlayerHeight=parseInt(b),this.video.style.width=this._PlayerWidth+"px",this.target.style.width=this._PlayerWidth+"px",this.video.style.height=this._PlayerHeight+"px",this.target.style.height=this._PlayerHeight+"px",this.video.setAttribute("width",this._PlayerWidth),this.target.setAttribute("width",this._PlayerWidth),this.video.setAttribute("height",this._PlayerHeight),this.target.setAttribute("height",this._PlayerHeight),this.canvas&&this.canvas.onResize(a,b))}},{key:"initAd",value:function E(a,b,c,d,e,f){this.stopped||(this.resizeAd(a,b,c),this._prepareVideoTag())}},{key:"stopAd",value:function F(a){if(!this.stopped){for(this.stopped=!0,this.video.pause(),this._disconnectFromVideoTag(),this.canvas&&this.canvas.destroy();this.video.childNodes.length;)this.video.removeChild(this.video.childNodes[0]);this.video.src="",this.vpaidLog=void 0,this.store=void 0,this._bindedOnClick=void 0,this._bindedAdVideoFirstQuartileDispatcher=this._bindedAdVideoMidpointDispatcher=this._bindedAdVideoThirdQuartileDispatcher=void 0,this.mediaFiles=this.target=this.beacon=this.video=this.target=this._onError=void 0,clearTimeout(this.timeUpdateInterval),setTimeout(this.onAfterStop,50)}}},{key:"pauseAd",value:function G(){this.stopped||this.video.pause()}},{key:"resumeAd",value:function H(){var a=this;this.stopped||(this.video.play(),this.beacon.dispatchEvent(this.vpaidEvents.AdPlaying),this.firstResume&&(setTimeout(function(){a.stopped||a._AdPaused||q.logToBI(a.vpaidLog,"videoTimeAfter3secFromResumeAd",{vidCurrentTime:a.video.currentTime})},3e3),this.firstResume=!1))}},{key:"skipAd",value:function I(){this.stopped||this.getAdSkippableState()&&this.stopAd()}},{key:"setAdVolume",value:function J(a){this.stopped||(this.video.muted=0==a,this.video.volume=this.volume=parseFloat(a)<=1?a:parseInt(a)/100)}},{key:"getAdWidth",value:function K(){return this._PlayerWidth}},{key:"getAdHeight",value:function L(){return this._PlayerHeight}},{key:"getAdSkippableRemainingTime",value:function M(){var a=this.getAdRemainingTime()-this._SkipTime;return a>0?a:0}},{key:"getAdRemainingTime",value:function N(){return this._VideoLength-this.video.currentTime}},{key:"getAdDuration",value:function O(){return this._VideoLength}},{key:"getAdSkippableState",value:function P(){return 0==this.getAdSkippableRemainingTime()}},{key:"startAd",value:function Q(){this._onPlay(),this.startAdFired=!0}},{key:"restartAd",value:function R(){var a,b=this;q.logToBI(this.vpaidLog,"restartAd",{videoRestarted:!0,isStopped:this.stopped}),this.stopped||(this.video.currentTime=0,this.video.play(),a=function c(){q.logToBI(b.vpaidLog,"restartAd",{videoComplete:!0}),b.video.removeEventListener("ended",c),b._onComplete()},this.video.addEventListener("ended",a))}},{key:"isReplayable",value:function S(){return!this.canvas}},{key:"expandAd",value:function T(){}},{key:"collapseAd",value:function U(){}},{key:"getAdVolume",value:function V(a){a&&a(null,this.volume)}},{key:"getAdIcons",value:function W(){return this._AdIcons}},{key:"getAdCompanions",value:function X(){return this._AdCompanions}},{key:"getAdExpanded",value:function Y(){return this._AdExpanded}},{key:"getAdLinear",value:function Z(){return this._AdLinear}},{key:"getDOMContainer",value:function $(){return this.target}},{key:"handshakeVersion",value:function _(){return this.version}},{key:"subscribe",value:function aa(a,b){this.stopped||this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)}},{key:"unsubscribe",value:function ba(a,b){if(!this.stopped&&this.vpaidEvents[b]){if(void 0==a)return;this.beacon.removeEventListener(b,a)}}},{key:"onAfterStop",value:function ca(){}},{key:"_getMediaUrl",value:function da(){return this.mediaUrl}},{key:"getVideoUrl",value:function ea(){if(this.video.src)return this.video.src;var a="";return this.video.childNodes.length>0&&this.video.querySelectorAll("source").forEach(function(b){!a&&b.src&&(a=b.src)}),a}}]),a}(),c["default"]=r,b.exports=c["default"]},{"../player/Tracker":27,"../player/utils":38,"./Beacon":39,"./Mpg1Canvas":50,"./vpaidEvents":71}],61:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j,k,l,m,n,o;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../player/utils"),h=d(g),i={event_AdImpression:"conversion",event_SoundViolation:"soundViolation",adStartTimeout:"adStartTimeout",AutoKill:"auto_kill",AdStopADTO:"before_startAd_timeout",queueTrimmed:"queueTrimmed",adPlayTimeout:"adPlayTimeout",queueExpired:"removed_from_queue",tagError:"tagError",vastFilterdByRegex:"vast_blacklisted",event_AdLoaded:"adLoaded",fetchVastXhr:"fetchVastXhr",fetchVastFallToXhr:"fetchVastFallToXhr",vpaidTimeout_AdLoaded:"adload_timeout",creatingVpaidHandler:"initVpaid",createdVpaidHandler:"before_adload",creatingVpaidHandlerError:"creatingVpaidHandlerError",networkError:"networkError",adUnitLoadFailed:"vpaid_unit_failed",adloadedTimeout:"adload_timeout",adImpressionTimeout:"adImpressionTimeout",playerClosed:"playerClosed",idleMode:"idleMode",hijackAttempt:"vpaid_blacklisted_url"},j=["conversion","soundViolation","timeout","bfRon","adPlayTimeout","vast_blacklisted","tagError","queueTrimmed","before_startAd_timeout","auto_kill","vpaidTimeout","creatingVpaidHandlerError","networkError","vpaid_unit_failed","adload_timeout","adImpressionTimeout","idleMode","vpaid_blacklisted_url","removed_from_queue"],k={NoMediaFiles:"empty_vast",event_AdError:"ad_error",vastxhrerror_noflash:"vast_fetch_fail",WrapperError:"wrapper_error",ParsingError:"xml_parsing_error",NoMediaFileAfterSort:"unsupported_mediafile"},l={BfRon:!0},m={difa:"idfa",aid:"appId",aname:"appName"},n=1e4,o=function(){function a(b,c){var d,f,g,i=this;e(this,a),this.tag=b,this.store=c,this.created=Date.now(),this.dataChanged=!1,this.friendlyVideoUrl=!1,this.iframesDetector=this.store.get("iframesDetector"),d=this.store.get("dast"),f="",d&&(f=d.cicmp),g=this.store.get("subUnitType"),this.sessionStarted=this.store.get("session_started")||this.created,this.data={_id:h.generateGuid(10),player_id:this.store.get("player_id"),tag:b,isMobile:b.isMobile,created:(new Date).toISOString(),timeSinceSessionStarted:this.created-this.sessionStarted,dp:b.dp,status:"new",statuses:["new"],unitType:b.unitType,unitVersion:b.unitVersion,firstlookAD:b.flad||0,itemScore:-1,waterfallIndex:b.waterfallIndex,fullPageUrl:this.store.get("fullPageUrl"),requiredViewability:b.requiredViewability,documentVisible:!document.hidden,oneAuction:this.store.get("mltads"),su:void 0!=g?g:-99999,redId:this.store.get("red_id")||"na",displayLineItem:f,updatesCount:0,serverSideDataSaver:this.store.get("serverSideDataSaver")||"na",clientSideDataSaver:this.store.get("clientSideDataSaver")||"na",dataSaver:this.store.get("dataSaver"),taboolaVpaid:this.store.get("istblvpd"),costModel:b.costModel,hasHjk:!!this.store.get("hjkFuncString"),hasDsm:!!this.store.get("dsm"),hasVpaidAnalytics:!!this.store.get("analyticsFuncString")},Object.assign(this.data,this._getDastData()),this.isReportDb=!1,this.dtor=!1,this._dataModified=!0,this.updatingInterval=setInterval(function(){i._dataModified&&i._sendData()},n)}return f(a,[{key:"_getDastData",value:function b(){var a,b,c,d=this.store.get("dast")||{},e={},f=!1;for(a in m)b=d[a],b&&(c=m[a],e[c]=b,f=!0);return e.inApp=f,this.store.set("isInApp",f),e}},{key:"push",value:function c(a,b,d){var e,f,g;if(this.data){if(a.indexOf("AdError")>-1||"event_SoundViolation"===a?this._addStatus(this._prettyErrorStatus(a,b)):i.hasOwnProperty(a)&&"conversion"!==this.data.status?this._addStatus(i[a]):l.hasOwnProperty(a)&&(e="is"+a,this.data[e]=!0),f=Date.now(),g=f-this.created,b.time=g,this._dataChanged(),!d&&this.data.hasOwnProperty(a))return Array.isArray(this.data[a])||(this.data[a]=[this.data[a]]),this.data[a].push(b),void(this.data[a].length>3&&this.data[a].splice(0,1));this.data[a]=b,j.indexOf(this.data.status)!==-1&&this._setDpStats()}}},{key:"_dataChanged",value:function d(){this._dataModified=!0}},{key:"_sendData",value:function g(){this._collectDataFromVpaidAnalytics(),this.data&&this.data.updatesCount++,h.reportDb("VpaidLog",this.data,this.store),this._dataModified=!1}},{key:"_collectDataFromVpaidAnalytics",value:function o(){var a,b;try{this.getVpaidAnalyticsReport&&(a=this.getVpaidAnalyticsReport(),a.realTotalRequestsCounter=a.totalRequestsCounter,this._wrappersCount&&(a.totalRequestsCounter+=this._wrappersCount,a.wrappersCount=this._wrappersCount),b=this.iframesDetector.detect(a.iframes,this.friendlyVideoUrl),a.totalRequestsCounter+=this.iframesDetector.calculateWeightsByIframeType(b),a.totalRequestsCounter-=a.iframes.length,this.push("vpaidAnalytics",a,!0),this.push("vpaidIframesDetection",b,!0))}catch(c){this.push("vpaidAnalyticsCollectFail",{ex:c})}}},{key:"_prettyErrorStatus",value:function p(a,b){var c=b.errType?b.errType:a;return k.hasOwnProperty(c)?k[c]:"error_"+c}},{key:"_setDpStats",value:function q(){var a,b,c,d,e;this.isDPStatusSet||this.store.get("static_schedule")||(a=Date.now(),this.data.dtor=!0,this.data.timeFromLastPlayFromQueue=a-this.store.get("playFromQueue"),this.data.timeFromLastPlayFromQueueFound=a-this.store.get("playFromQueueFound"),this.isDPStatusSet=!0,this._incrStats(".tries"),"conversion"===this.data.status?(this._incrStats(".conversions"),this.store.set(this.tag.dp+".failsRow",0),b=this.store.get(this.tag.lineItem+".failsRow"),this.store.set(this.tag.lineItem+".failsInARowTillConversion",b<0?0:b),this.store.set(this.tag.lineItem+".failsRow",0)):(this._incrStats(".fails"),this.store.get(this.tag.lineItem+".failsRow")<0?this.store.set(this.tag.lineItem+".failsRow",1):this._incrStats(".failsRow")),c=this.store.get(this.tag.dp)||{fails:0,failsRow:0,conversions:0},d=this.store.get(this.tag.lineItem)||{},d.fails||(d.fails=0),d.failsRow||(d.failsRow=0),d.conversions||(d.conversions=0),c.lineItems=c.lineItems||[],c.lineItems.indexOf(this.tag.lineItem)===-1&&c.lineItems.push(this.tag.lineItem),this.data.lineItemLog=d,this.data.dpLog=c,this.data.conversionsCount=this.store.get("conversionsCount"),this.data.unit={width:this.store.get("width"),height:this.store.get("height")},e=this.store.get("lineItems")||[],e.indexOf(this.tag.lineItem)===-1&&(e.push(this.tag.lineItem),this.store.set("lineItems",e)),this.store.set(this.tag.lineItem,d))}},{key:"_incrStats",value:function r(a){this.store.incr(this.tag.dp+a),this.store.incr(this.tag.lineItem+a)}},{key:"saveToDb",value:function s(){if(this.data){this._setDpStats();var a;try{a=cmTag.utils.getLoopTime()}catch(b){}a&&(this.data.loopTime=a),this._reportDb()}}},{key:"_reportDb",value:function t(){this.isReportDb||(this.data.updatesCount++,h.reportDb("VpaidLog",this.data,this.store),this.tag=null,this.data=null,this.store=null,this.isReportDb=!0,this._dataModified=!1,clearInterval(this.updatingInterval))}},{key:"_addStatus",value:function u(a){var b=this;j.indexOf(this.data.status)===-1&&(this.data.status=a,this.data.statuses.push(a),"conversion"===a&&setTimeout(function(){b._sendData()},2e3))}},{key:"toString",value:function v(){return h.stringify(this.data,4)}},{key:"setVastWrapperCount",value:function w(a){this._wrappersCount=a}}]),a}(),c["default"]=o,b.exports=c["default"]},{"../player/utils":38}],62:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;Object.defineProperty(c,"__esModule",{value:!0}),i=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=a("./Beacon"),k=e(j),l=a("../player/Tracker"),m=e(l),n=a("./VastParser"),o=e(n),p=a("../player/utils"),q=d(p),r=a("./SpotxAdOs"),s=e(r),t=a("./VideoVpaid"),u=e(t),v=a("./JsVpaid"),w=e(v),x=a("./JsVpaid-legacey"),y=e(x),z=a("./JsVpaidMobile"),A=e(z),B=a("./VideoVpaidMobile"),C=e(B),D=a("./PixelManager"),E=e(D),F=a("./VpaidLog"),G=e(F),H=a("./OpportunityManager"),I=e(H),J=a("./OpportunityType"),K=e(J),L=a("events"),M=a("./MoatTracker"),N=e(M),O=a("copy-to-clipboard"),P=e(O),Q=a("../player/VideoControls"),R=e(Q),S=a("./CostModels"),T=e(S),U=a("./PlayerDAST"),V=e(U),W=a("lodash.debounce"),X=0,Y=0,Z=function(a){function b(a,c,d,e){var h,i,j,l,n,p,r;if(f(this,b),h=g(this,(b.__proto__||Object.getPrototypeOf(b)).call(this)),h.mainVpaid=c,h.store=d,h.wflog=e,h.wflog&&h.wflog.increaseNumberOfConnectedVpaids(),h.isVForceActive=h.store.get("vForce"),h.created=Date.now(),h.loadedEvent="",h.manager=a.manager,h.index=++X,h.vpaidWrapperIndex="VpaidWrapper"+h.index,h.tagid=a.tagid,h.tag=a.tag,h.tag.vpaidWrapperData={},h.error="",h.readyInMS=0,h.isMultiAdsActive=h.store.get("mltads"),h.isMultiVpaidUnit=h.store.get("isMultiVpaidUnit"),h.isAdErrorBeforeAdLoadedActive=h.store.get("aderrbfradlddopactv"),h.adLoadedFired=!1,h.hijackFired=!1,h.latestVpaidAnalytics=h.store.getLatestVersion("anltcsurl"),h.registerAnalytics=h.latestVpaidAnalytics&&h.latestVpaidAnalytics.value||h.store.get("mltprpsrvsurl")?h._registerAnalytics.bind(h):function(){},h.maxNetworkCalls=h.store.getByLineItem("mxntwrkclls",h.tag)||0,h.iframesWeights=h.store.get("ifrmswghts"),h.blockBringToFront=h.isMultiVpaidUnit&&h.store.get("blckbrngtofrnt"),h.toggleIframeContentDisplayActive=h.store.get("tglifrmcntndsplyactv"),h.waitForAdPausedBeforeResumeAd=h.store.get("wtfradpsdbfrrsmad"),i=h.store.getByLineItem("cstmdl",h.tag),void 0===i&&(i=h.tag.cstmdl),h.fireCompletionPixelOnNewCompletionEvent=i===T["default"].CPCV,h.isVideoThrottleOn=h.store.get("vtrtlon"),h.videoThrottleLength=void 0,h.isBufferModeOn=h.store.get("bfrmd"),h.isBufferModeOn&&(h.bufferModeDelay=h.store.getByLineItem("bm",h.tag),h.bufferModeDelay&&(h.bufferModeDelay=q.normalizeMilliseconds(h.bufferModeDelay))),h.playerDAST=new V["default"](h.store),h.creatives={},h.stayAlive=!1,h.oldStatus="",h.stopReason="",h.config={},h.vast=[],h.iconsPrograms=[],h.isMobile=h.store.get("isMobile")||!1,h.isIOS=!1,h.isMobile&&(j=h.store.get("ua"),h.isIOS="iOS"===j.os.name),h.timeoutLengthToAdCompletion=h.store.getByLineItem((h.isMobile?"mbl":"dsk")+"tmouttoadcmpltn",h.tag),h.fireNewCompletionPixel=h.timeoutLengthToAdCompletion>0,h.fireNewCompletionPixel&&(h.timeoutLengthToAdCompletion=q.normalizeMilliseconds(h.timeoutLengthToAdCompletion)),h.timeoutToAdCompletion=null,h.timeoutToAdCompletionStartTime=0,h.newCompletionEventFired=!1,h.globalAdTimeout=null,h.globalAdTimeoutStartTime=0,h.globalAdTimeoutLength=h.store.getByLineItem("global_ad_timeout",h.tag),h.globalAdTimeoutLength&&h.globalAdTimeoutLength>0&&(h.globalAdTimeoutLength=q.normalizeMilliseconds(h.globalAdTimeoutLength)),h.store.get("dbncadvltm")?h.setAdVolume=W(h._setAdVolume,h.store.get("dbncadvltm"),{leading:!0}):h.setAdVolume=h._setAdVolume,h.tag.advId&&h._pushUniqueAdvIdsToWaterfallLog(),l={auctionId:h.tag.auctionId,advId:h.tag.advId,dast:h.tag.dast,price:h.tag.price,queueNumber:h.tag.queueNumber,cpmFloor:h.tag.cpmFloor,dp:h.tag.dp,rollType:h.tag.rollType,lineItem:h.tag.lineItem,unitType:h.store.get("unit_type"),unitVersion:h.store.get("unit_version"),isMobile:h.isMobile,rpox:h.tag.rpox,alfrox:h.tag.alfrox,frox:h.tag.frox,waterfallIndex:h.tag.wfIndex,itemType:h.tag.itemType,requiredViewability:h.tag.requiredViewability,requiredViewabilityDrawn:h.tag.requiredViewabilityDrawn,flad:h.tag.flad||h.tag.flad_delay||0,brand:h.tag.brand,priority:h.tag.priority,costModel:h.fireCompletionPixelOnNewCompletionEvent},h.tag.crId&&(n={stId:h.tag.stId,cmpgnId:h.tag.cmpgnId,itemType:h.tag.itemType},l=Object.assign(l,n)),h.pwov=h.tag.pwov,h.vpaidLog=new G["default"](l,h.store),h._copyFromStoreToBi("connectionType"),h._copyFromStoreToBi("navigatorConnection"),h._wfStats=a.wfStats,h._wfStats.increaseVpaidsCount(),h.oppsID=K["default"],h.shouldMuteVid=h.store.get("dskVidMuted")&&!h.store.get("isMobile"),h.opportunityManager=new I["default"]({CM_DOMAIN:c.config.creatives.CM_DOMAIN,AUC_DAST:c.config.creatives.AUC_DAST,sequenceId:h.sequenceId,ST:c.config.creatives.ST,STS:c.config.creatives.STS,SDID:c.config.creatives.SDID,PT:c.config.creatives.PT,PV:c.config.creatives.PV,WP:c.config.creatives.WP,VPD:c.config.creatives.PUBID,VPTD:c.config.creatives.TAGID,VMT:c.config.creatives.VMT},h.store,h.vpaidLog),h.vpaidEventToPixelId={},h.vpaidEventToPixelId[h.mainVpaid.vpaidEvents.AdVideoFirstQuartile]=h.oppsID.videoFirstQuartile,h.vpaidEventToPixelId[h.mainVpaid.vpaidEvents.AdVideoMidpoint]=h.oppsID.videoMidpoint,h.vpaidEventToPixelId[h.mainVpaid.vpaidEvents.AdVideoThirdQuartile]=h.oppsID.videoThirdQuartile,h.vpaidEventToPixelId[h.mainVpaid.vpaidEvents.AdVideoComplete]=h.oppsID.videoComplete,h._sendOpp(h.oppsID.tagStarted),h.debugTracker=new m["default"](h.vpaidWrapperIndex),h.pixelManager=new E["default"](d),a.creatives)for(p in a.creatives)h.creatives[p]=a.creatives[p];if(a.config)for(p in a.config)h.config[p]=a.config[p];return h.adVolume=q.normalizeVolume(parseInt(h.config.VOLUME)?parseInt(h.config.VOLUME):0),h.vpaidEvents=a.vpaidEvents,h.useIframeOnVpaidWrapper=h.isMobile&&h.store.get("usifrmonvpdwrpr"),q.logToBI(h.vpaidLog,"wrapVpaidInIframe",{active:h.useIframeOnVpaidWrapper}),h.localTarget=h._createLocalTarget(h.config.target),h.localIframe=h._createLocalIframe(h.config.target),h.store.get("vpdcntrcstmcss")&&((h.adTarget||h.localTarget).style.cssText+=h.store.get("vpdcntrcstmcss")),h.isIOS&&(h.clickableTarget=h._createClickableTarget(h.localTarget)),h.localVideo=h._createLocalVideo(h.localTarget),h.beacon=new k["default"](h),h.parser=new o["default"]({vpaidLog:h.vpaidLog,width:h.config.width,height:h.config.height,bitrate:h.config.bitrate,internalPixel:h.tag.pixel,tag:h.tag,vpaidWrapper:h},h.store),h.parser.onFail=h._onParserError.bind(h),h.parser.onNetworkFail=h._onNetworkError.bind(h),h.parser.onVpaidJs=h._onVpaidJs.bind(h),h.parser.onMp4Video=h._onMp4Video.bind(h),h.parser.onMp4VideoMobile=h._onMp4VideoMobile.bind(h),h.parser.onVpaidJsMobile=h._onVpaidJsMobile.bind(h),h.parser.onSpotxAdOs=h._onSpotxAdOs.bind(h),h.adFoundDispatched=!1,h.vpaidHandler=!1,h.stopped=!1,h._startParser(),r={lastDelayBetweenWfs:h.store.get("dynamicWf.lastDelayBetweenWfs"),currentDelayBetweenWfs:h.store.get("dynamicWf.currentDelayBetweenWfs")},q.logToBI(h.vpaidLog,"dynamicWf",r),h.isVForceActive=h.store.get("vForce")||!1,q.logToBI(h.vpaidLog,"vForce",{vForceIsActive:h.isVForceActive}),h._initTimers(),h.store.get("useVideoControls")&&h.store.getByLineItem("ad_controls",h.tag)!==!1&&(h.VideoControls=new R["default"](h.localVideo,h.store,h.localTarget,"ad",h),h.VideoControls.setVpaidHandler(h),h.VideoControls.setOnSoundChangeCallback(h._onSoundChange.bind(h))),h.handelsEarlyAI=h.store.get("erlyai"),h._handleDataSaver(),h.store.get("debug")&&h._addCopyToClipboardBtn(),h.isReplayable=!1,h._onGotAdIconsBinded=h._onGotAdIcons.bind(h),h._appendVpaidCSS(),h}return h(b,a),i(b,[{key:"_addCopyToClipboardBtn",value:function c(){var a=this,b=document.createElement("div");b.className="playerSaveButton",b.style.zIndex=Y+10,b.innerHTML="SAVE",this.localVideo.parentElement.appendChild(b),b.addEventListener("click",function(){(0,P["default"])(a.vpaidLog.toString())})}},{key:"_startParser",value:function d(){this.parser.stopped||(this.tag.vast?this.parser.parseVastFromString(this.tag.vast):this.parser.parseVastFromUrl(this.tag.url))}},{key:"_initTimers",value:function e(){this._waitForEvent(this.vpaidEvents.AdLoaded,this.store.getByLineItem("altmot",this.tag)||this.tag.ADTO,this._onAdLoadedEvent.bind(this),this._onAdLoadedTimeout.bind(this)),this._setTimers()}},{key:"_setTimers",value:function j(){var a=this._initTimersStart?Date.now()-this._initTimersStart:0;this._initTimersStart=Date.now(),this._initTillAdstartTimeout(a),this._initAutoKillTimeOut(a)}},{key:"_initTillAdstartTimeout",value:function l(a){var b,c=this;this.tillAdstartTimeout&&clearTimeout(this.tillAdstartTimeout),b=this.type&&this.store.getByTech("adto",this.type)||this.store.getByLineItem("adto",this.tag)||this.tag.ADTO,b-=a,b>0&&(this.tillAdstartTimeout=setTimeout(function(){q.logToBI(c.vpaidLog,"AdStopADTO",{timeout:b}),c.error="adto",c.stop(c.error,c.oppsID.adtoTimeout)},b))}},{key:"_initAutoKillTimeOut",value:function n(a){var b,c=this;this.autoKill&&clearTimeout(this.autoKill),b=this.type&&this.store.getByTech("vakll",this.type)||this.store.getByLineItem("vakll",this.tag)||9e4,b-=a,b>0&&(this.autoKill=setTimeout(function(){q.logToBI(c.vpaidLog,"AutoKill",{timeout:b}),c.error="autoKill",c.beacon.dispatchEvent(c.vpaidEvents.AdVideoComplete,c),c.stop(c.error,c.oppsID.globalTimeout)},b))}},{key:"_killTimers",value:function p(){if(clearTimeout(this.autoKill),clearTimeout(this.tillAdstartTimeout),clearTimeout(this.adloadedTimeout),this.pendingEvents)for(var a in this.pendingEvents)this.pendingEvents[a].timeoutId!=-1&&clearTimeout(this.pendingEvents[a].timeoutId);this.pendingEvents={}}},{key:"_createClickableTarget",value:function r(a){var b,c,d;if(!this.stopped)return b=document.createElement("div"),c=this.store.get("width"),d=this.store.get("height"),b.className="cm-ad-click-target",b.style.cssText="width: "+c+"px; height: "+d+"px; cursor: pointer; position: absolute; top: 0px; left: 0px;",
b.style.display="",b.setAttribute("width",c),b.setAttribute("height",d),a.appendChild(b),b}},{key:"_createLocalVideo",value:function t(a){var b,c,d,e=this;if(!this.stopped)return b=document.createElement("video"),c=this.store.get("width"),d=this.store.get("height"),b.className="cm-ad-player",b.style.cssText="width: "+c+"px; height: "+d+"px;",b.style.display="",b.volume=0,this.shouldMuteVid&&(b.muted=!0),b.setAttribute("width",c),b.setAttribute("height",d),this.isMobile&&(b.muted=!0,b.setAttribute("muted","")),b.addEventListener("timeupdate",function(a){e._onTimeupdate(b)}),this.config.videoSlotControls&&b.removeAttribute("controls"),this.store.get("addprld")&&(b.setAttribute("preload","auto"),q.logToBI(this.vpaidLog,"preload",{preload:!0})),a.appendChild(b),b}},{key:"_createLocalTarget",value:function v(a){if(!this.stopped){var b=document.createElement("div");return this.store.get("noplrcntr")&&(b.id="_cm-css-reset"),b=this._styleElement(b,a),this.useIframeOnVpaidWrapper?b:(this._createAdTargetElement(b),a.appendChild(this.adTarget?this.adTarget:b),b)}}},{key:"_createLocalIframe",value:function x(a){var b,c=this;if(!this.stopped&&this.useIframeOnVpaidWrapper)return b=document.createElement("iframe"),b.onload=function(){var a,d,e;b.onload=null,a=c.store.get("resourceLoader"),a.loadCSSResources(b.contentWindow.document),d=b.contentWindow.document.createElement("div"),d.id="_cm-css-reset",d.appendChild(c.localTarget),b.contentWindow.document.body.style.margin="0",b.contentWindow.document.body.appendChild(d),b.contentWindow.addEventListener("message",function(a){window.postMessage(a.data,a.origin)}),q.logToBI(c.vpaidLog,"localIframeOrigin",{origin:b.contentWindow.location.origin}),c.iframeWrapperLoaded=!0,e=c.store.get("vpaidWrapper"+c.index+"Handler"),e&&c._createHandler(e.filesArray,e.AdParamString,e.handlerType,e.options,e.trackingPixels)},this.iframeWrapperLoaded=!1,b=this._styleElement(b,a),b.classList.add("_cm-video-ad-iframe"),this._createAdTargetElement(b),a.appendChild(this.adTarget?this.adTarget:b),b}},{key:"_styleElement",value:function z(a,b){return this.store.get("noplrcntr")||(a.style.cssText=b.style.cssText),a.style.position="absolute",a.style.overflow="hidden",a.style.top="0",a.style.height="0",a.style.left="0",a.style.zIndex="1",a.style.background="transparent",this.store.get("noplrcntr")?a.className=this.vpaidWrapperIndex:a.className=(b.className?b.className:"")+" "+this.vpaidWrapperIndex,this.isMultiAdsActive&&a.className.indexOf("_cm-video-ad")<0&&(a.className="_cm-video-ad "+a.className),a}},{key:"_createAdTargetElement",value:function B(a){(this.isMultiVpaidUnit||this.isMultiAdsActive)&&(q.removeClass(a,"multi-vpaids"),this.adTarget=document.createElement("div"),this.adTarget.className="_cm-ad",this.adTarget.id="_cm-css-reset",this.adTarget.appendChild(a))}},{key:"_onHandlerError",value:function D(a,b){q.logToBI(this.vpaidLog,"earlyError",{errMsg:a}),this.loadedEvent||(this.status="error",this.stopped||(this.beacon.dispatchEvent(this.vpaidEvents.AdError,a),"adUnitLoadFailed"===b&&(q.logToBI(this.vpaidLog,"adUnitLoadFailed",{errMsg:a}),this.stop("adUnitLoadFailed",K["default"].adUnitLoadFailed)),q.logToBI(this.vpaidLog,"handlerError",{errMsg:a})))}},{key:"_onHandlerCreated",value:function F(){this.stopped||(q.logToBI(this.vpaidLog,"createdVpaidHandler",{}),this._connectToVpaidHandler(),this.vpaidHandler.handshakeVersion("2.0"),q.logToBI(this.vpaidLog,"initAd",{adInited:!0}),this.VideoControls&&this.vpaidHandler.canvas&&this.VideoControls.setCanvas(this.vpaidHandler.canvas),this.vpaidHandler.initAd(this.config.width,this.config.height,this.config.viewMode,this.config.bitrate,{AdParameters:this.creatives.AdParameters},{slot:this.localTarget,videoSlot:this.localVideo,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay}))}},{key:"_connectToVpaidHandler",value:function H(){if(!this.stopped)for(var a in this.vpaidEvents)this.vpaidHandler.subscribe(this._handleVpaidEvents.bind(this,this.vpaidEvents[a]),this.vpaidEvents[a])}},{key:"_adLoadedHandler",value:function J(a){var b,c=this;this.stopped||(this.adLoadedFired=!0,this.loadedEvent=this.loadedEvent+" "+a,this.readyInMS=Date.now()-this.created,this.debugTracker.info("Ad loaded now => pause it srcEvent",a),this._sendOpp(K["default"].adLoaded),this.isMobile&&this.vpaidHandler.canvas&&(this.muted=!0),this.status="ready",this.isUnPaused=!0,this.store.emit("vpaidReady",this),this.asyncAdimpression=this.store.getByLineItem("asyncAdimpression",this.tag),this.asyncAdimpression&&(b=this.store.getByLineItem("aaViewability",this.tag)?"unit::viewability":"unit::conversion",q.logToBI(this.vpaidLog,"asyncAdimpression",{event:b}),this.on(b,function(){q.logToBI(c.vpaidLog,"asyncAdimpressionEvent",{event:b}),c.onAsyncAdmpression()})),this.setAdVolume(this.adVolume),this.adFoundDispatched=!0,this.vpaidHandler.checkUnfriendlyIframe&&(this.isUnfriendlyIframe=this.vpaidHandler.checkUnfriendlyIframe()),this.type&&"javascript"==this.type&&this.logVpaidFamily(),this.setVpaidAnalyticsIsVideoUrlPublic&&this.setVpaidAnalyticsIsVideoUrlPublic(""!==this.getVideoUrl()),this.tag.requiredViewability&&this.store.emit("emitQueueStatus"))}},{key:"startAd",value:function L(a){var b=this;this.adStarted=!0,this.setAdVolume(this.adVolume),this._startForceAdVolumeInterval(),this.options=Object.assign(a||{},this.store.get("getAdData")),this.isStarted=!0,this.store.incr("ads_started"),this._sendOpp(this.oppsID.startAd),q.logToBI(this.vpaidLog,"adOptions",this.options),q.logToBI(this.vpaidLog,"startAd",{adStarted:!0}),this.earlyAdImpression||this._waitForEvent(this.vpaidEvents.AdImpression,this.store.get("adimptmot"),this._onAdImpressionEvent.bind(this),this._onAdImpressionTimeout.bind(this)),this.isUnPaused?this.vpaidHandler.startAd():this.vpaidHandler.resumeAd(),clearTimeout(this.tillAdstartTimeout),this.working=!0,this.bringToFront(),this.earlyAdImpression&&setTimeout(function(){b._onAdImpression()},500)}},{key:"_startForceAdVolumeInterval",value:function M(){var a,b,c=this;this.isMobile||(a=this.store.get("frcadvlmtrvl"),!this.setAdVolumeInterval&&a>0&&(b=this.store.get("stpfrcvlevnt")||this.vpaidEvents.AdVideoFirstQuartile,this.vpaidHandler.subscribe(function(){c._stopForceAdVolumeInterval()},b),this.setAdVolumeInterval=setInterval(function(){c.vpaidHandler&&!c.vpaidHandler.stopped?c.setAdVolume(c.adVolume):clearInterval(c.setAdVolumeInterval)},a)))}},{key:"_stopForceAdVolumeInterval",value:function O(){this.isMobile||(clearInterval(this.setAdVolumeInterval),this.setAdVolumeInterval=0)}},{key:"restartAd",value:function Q(){var a=this;this.isReplayable&&(this.opportunityManager.unpause(),this._sendOpp(this.oppsID.replayAd),this.opportunityManager.pause(),this.pixelManager.pause(),this.working=this.isStarted=this.adStarted=!0,this.store.incr("ads_started"),this.clickThruUrl=this.clickThruUrl||this.pixelManager.getClickThruUrl(),this.vpaidHandler.restartAd(this.videoUrl,this.clickThruUrl),setTimeout(function(){a.bringToFront()}))}},{key:"isReplayableVpaid",value:function S(){return this.isVForceActive&&this.store.getByLineItem("rplvpdactv",this.tag)&&this.vpaidHandler&&this.vpaidHandler.isReplayable()}},{key:"dontDie",value:function U(){this.stayAlive=!0,this.vpaidHandler&&this.vpaidHandler.dontDie&&this.vpaidHandler.dontDie(),this._killTimers()}},{key:"_handleStopped",value:function Z(a){this.moveToBack(),this.stop(a.type,a.oppType),this.working=!1}},{key:"pauseAd",value:function $(){this.stopped||(q.logToBI(this.vpaidLog,"pauseAd",{api:!0}),this.waitForAdPausedBeforeResumeAd&&(this.isUnPaused&&(this.adPausedFired=!1),this.resumeOnAdPaused&&(this.resumeOnAdPaused=!1)),this.pauseAdStartTime=Date.now(),this.working=!1,this.vpaidHandler.pauseAd(),this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout())}},{key:"resumeAd",value:function _(){if(!this.stopped&&(this.isMultiAdsActive||!this.store.get("forcePause"))){if(this.waitForAdPausedBeforeResumeAd&&!this.adPausedFired)return this.resumeOnAdPaused=!0,void q.logToBI(this.vpaidLog,"resumeAdDelay",{delay:!0});this.resumeOnAdPaused=!1,q.logToBI(this.vpaidLog,"resumeAd",{api:!0}),this.working=!0,this.vpaidHandler.resumeAd(),this.isMultiVpaidUnit&&this.resizeAd(this.store.get("width"),this.store.get("height")),this.VideoControls&&!this.workingVpaid&&(this.VideoControls.resetAdControls(),this.isMobile&&this.store.emit("playerStatusChanged","ad")),this.store.set("ad_controls",this.store.getByLineItem("ad_controls",this.tag)!==!1),this.workingVpaid=!0,this.isVForceActive&&(this._setTimeoutToAdCompletion(),this._bringLocalIframeToFront(),this._setGlobalAdTimeout())}}},{key:"_bringLocalIframeToFront",value:function aa(){this.localIframe&&(this.localIframe.style.zIndex=this.localTarget.style.zIndex)}},{key:"_setGlobalAdTimeout",value:function ba(){var a=this;this.globalAdTimeoutLength&&this.globalAdTimeoutLength>0&&!this.globalAdTimeout&&(this.globalAdTimeoutStartTime=Date.now(),this.globalAdTimeout=setTimeout(function(){a.stopped||(q.logToBI(a.vpaidLog,"globalAdTimeout",{}),a.stop("global_ad_timeout"))},this.globalAdTimeoutLength))}},{key:"_pauseGlobalAdTimeout",value:function ca(){this.globalAdTimeout&&(this.globalAdTimeout=clearTimeout(this.globalAdTimeout),this.globalAdTimeoutLength-=Date.now()-this.globalAdTimeoutStartTime)}},{key:"_setTimeoutToAdCompletion",value:function da(){var a=this;!this.timeoutToAdCompletion&&this.timeoutLengthToAdCompletion>0&&!this.newCompletionEventFired&&(this.timeoutToAdCompletionStartTime=Date.now(),this.timeoutToAdCompletion=setTimeout(function(){a.stopped||a._newCompletionHandler("timerEnded")},this.timeoutLengthToAdCompletion))}},{key:"_pauseAdTimeoutToCompletion",value:function ea(){this.timeoutToAdCompletion&&(this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this.timeoutLengthToAdCompletion-=Date.now()-this.timeoutToAdCompletionStartTime)}},{key:"_fireNewCompletionEvent",value:function fa(a){if(!this.newCompletionEventFired){var b=this.localVideo.currentTime;q.logToBI(this.vpaidLog,"newCompletionEvent",{newCompletion:!0,reason:a,currentTime:b}),this._sendOpp(this.oppsID.newCompletion),this.newCompletionEventFired=!0,this.fireCompletionPixelOnNewCompletionEvent&&this._firePixel(this.vpaidEvents.AdVideoComplete,{newCompletion:!0})}}},{key:"getVideoUrl",value:function ga(){return this.videoUrl||(this.videoUrl=this.vpaidHandler.getVideoUrl?this.vpaidHandler.getVideoUrl():"",this._setVideoDataToPlayerDAST()),this.videoUrl}},{key:"_setVideoDataToPlayerDAST",value:function ha(){var a={vu:this.videoUrl},b=this.localVideo;this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement&&(b=this.vpaidHandler.getVPAIDVideoElement()||b),b&&(a.edr=b.duration,a.ewd=parseInt(b.videoWidth),a.eht=parseInt(b.videoHeight)),this.playerDAST.set(a)}},{key:"_setVideoThrottle",value:function ia(){this.videoThrottleLength=this.store.getByLineItem("vtrtl",this.tag),this.videoThrottleLength&&(this.videoThrottleLength=q.normalizeMilliseconds(this.videoThrottleLength),this.videoUrl=this.getVideoUrl(),this.videoUrl?q.logToBI(this.vpaidLog,"videoThrottle",{videoUrl:this.videoUrl,delay:this.videoThrottleLength}):(this.videoThrottleLength=0,q.logToBI(this.vpaidLog,"videoThrottle",{videoUrlEmpty:!0})))}},{key:"_throttleVideo",value:function ja(){var a,b;this._isVideoThrottled()||(a=this.store.get("videosToThrottleList")||{},b={videoUrl:this.videoUrl,delay:this.videoThrottleLength},this.emit("throttleVideo",b),a[this.videoUrl]=b,this.store.set("videosToThrottleList",a),q.logToBI(this.vpaidLog,"videoThrottleDelayStart",b))}},{key:"_isVideoThrottled",value:function ka(){var a=this.store.get("videosToThrottleList")||{};return a.hasOwnProperty(this.videoUrl)}},{key:"_delayAdLoadUntilVideoThrottleEnd",value:function la(){q.logToBI(this.vpaidLog,"adLoadedEventThrotlled",{videoUrl:this.videoUrl,delayStarted:!0}),this._sendOpp(this.oppsID.videoThrottle),this.onThrottleEndEventName="onThrottleEnd_"+this.videoUrl,this.onRemovedFromThrottleListenersEventName="onRemovedFromThrottleListeners_"+this.videoUrl,this._bindedOnAdLoadVideoThrottleDelayEnd=this._onAdLoadVideoThrottleDelayEnd.bind(this),this._bindedOnRemovedFromVideoThrottleListeners=this._onRemovedFromVideoThrottleListeners.bind(this),this.store.removeAllListeners(this.onThrottleEndEventName),this.store.emit(this.onRemovedFromThrottleListenersEventName),this.store.on(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this.store.on(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners)}},{key:"_onAdLoadVideoThrottleDelayEnd",value:function ma(){if(!this.stopped){q.logToBI(this.vpaidLog,"adLoadedEventThrotlled",{videoUrl:this.videoUrl,delayEnded:!0},!0);var a=this.store.get("videosToThrottleList")||{};delete a[this.videoUrl],this.store.set("videosToThrottleList",a),this.store.removeListener(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this.store.removeListener(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners),this._adLoadedHandler(event)}}},{key:"_onRemovedFromVideoThrottleListeners",value:function na(){this.stop("removedFromVideoThrottleListeners",null,{eventData:{videoUrl:this.videoUrl}})}},{key:"_shouldBufferAdvertiser",value:function oa(){if(this.isBufferModeOn){var a=this.store.get("bufferModeList")||[];return this.bufferModeDelay&&a.indexOf(this.tag.advId)<0}return!1}},{key:"_setBufferModeForAdvertiser",value:function pa(){var a=this.store.get("bufferModeList")||[],b={advId:this.tag.advId,delay:this.bufferModeDelay};this.emit("setBufferModeForAdvertiser",b),q.logToBI(this.vpaidLog,"bufferMode",b),a.push(b.advId),this.store.set("bufferModeList",a)}},{key:"_logVideoUrlCounter",value:function qa(){var a,b,c=this.getVideoUrl();c||(c="na"),a=this.store.get("videoUrlsCounter")||{},a[c]=a.hasOwnProperty(c)?++a[c]:1,q.logToBI(this.vpaidLog,"videoUrlCounter",{videoUrl:c,counter:a[c]}),b=Object.keys(a),q.logToBI(this.vpaidLog,"sessionUniqueVideoUrls",{counter:b.length,urls:b},!0),this.store.set("videoUrlsCounter",a)}},{key:"_handleVpaidEvents",value:function ra(a,b){var c,d,e,f,g,h,i=this;if(this.vpaidEvents){if("vpaid"===this.vpaidHandler.type&&(this.store.getByLineItem("cmpltonstpd",this.tag)||this.vpaidHandler.completeOnAdStop)){if(a===this.vpaidEvents.AdVideoComplete)return void(this.vpaidHandler&&this.vpaidHandler.setCompletionOnAdStoppedTimeout&&this.vpaidHandler.setCompletionOnAdStoppedTimeout());a===this.vpaidEvents.AdStopped&&(a=this.vpaidEvents.AdVideoComplete,q.logToBI(this.vpaidLog,"completeOnAdStop",{value:!0,domain:q.stripDomain(this.vpaidHandler.mediaUrl)}))}if(!this.isFirstVpaidEvent&&this.vpaidHandler._getMediaUrl()&&(this.isFirstVpaidEvent=!0,q.logToBI(this.vpaidLog,"mediaUrl",{url:this.vpaidHandler._getMediaUrl()}),this._checkIfGoogle()),c=!0,!this.stopped){switch(d=this._firePixel(a,b),this.debugTracker.info("VpaidHandler-event",a),this.moatTracker&&this.moatTracker.dispatch({type:a,adVolume:this.adVolume}),this._onEvent(a),a){case this.vpaidEvents.AdLoaded:this.isVideoThrottleOn&&void 0===this.videoThrottleLength&&this._setVideoThrottle(),this.videoThrottleLength&&this._isVideoThrottled()?this._delayAdLoadUntilVideoThrottleEnd():this._adLoadedHandler(a),this.vpaidLog.getVpaidAnalyticsReport&&(e=this.vpaidLog.getVpaidAnalyticsReport(),q.logToBI(this.vpaidLog,"vpaidAnalyticsUntilAdloaded",e)),this.vpaidHandler.getAdIcons&&this.vpaidHandler.getAdIcons(this._onGotAdIconsBinded);break;case this.vpaidEvents.AdImpression:if(c=this._onAdImpression(a),this._pushConversionDataToWaterfallLog(),this._logVideoUrlCounter(),this.videoThrottleLength&&this._throttleVideo(),this._shouldBufferAdvertiser()&&this._setBufferModeForAdvertiser(),this.earlyAdImpression)return;this.isVForceActive||(this._setTimeoutToAdCompletion(),this._bringLocalIframeToFront(),this._setGlobalAdTimeout()),this._setVideoDataToPlayerDAST();break;case this.vpaidEvents.AdVideoStart:this.setAdVolume(this.adVolume),this.adFoundDispatched||(this.adFoundDispatched=!0,this.beacon.dispatchEvent(this.vpaidEvents.AdFound)),this.beacon.dispatchEvent(this.vpaidEvents.AdVideoStart);break;case this.vpaidEvents.AdSkipped:this.adStoppedHandler(a),this._handleStopped({type:a,oppType:this.oppsID.adSkiped});break;case this.vpaidEvents.AdStopped:this.adStoppedHandler(a),this._handleStopped({type:a});break;case this.vpaidEvents.AdLog:this.debugTracker.info("VpaidHandler-Log",arguments);break;case this.vpaidEvents.AdError:f=this.oppsID.adError,this.isAdErrorBeforeAdLoadedActive&&!this.adLoadedFired&&(f=this.oppsID.adErrorBeforeLoad),"mp4"===this.type?(q.logToBI(this.vpaidLog,"Mp4AdError",{}),this.stop("Mp4AdError",f)):this.stop("AdError",f,b);break;case this.vpaidEvents.SoundViolation:this.store.get("sndvltopp")&&!this.alreadySentSoundViolation&&(this.alreadySentSoundViolation=!0,this._sendOpp(this.oppsID.soundViolation));break;case this.vpaidEvents.AdPaused:q.logToBI(this.vpaidLog,"pauseAdLength",{fromPauseAd:this.pauseAdStartTime?Math.round(Date.now()-this.pauseAdStartTime):void 0}),this.pauseAdStartTime=void 0,this.adPausedFired=!0,this.waitForAdPausedBeforeResumeAd&&this.resumeOnAdPaused&&this.resumeAd();case this.vpaidEvents.AdClickThru:b=this._adClickThruHandler(b),this.isUnPaused=!1,this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout();break;case this.vpaidEvents.AdPlaying:q.logToBI(this.vpaidLog,"resumeAdDelay",{adPlaying:!0}),this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout();case this.vpaidEvents.AdStarted:case this.vpaidEvents.AdVideoStart:this.isUnPaused=!0;break;case this.vpaidEvents.AdVideoFirstQuartile:this.beacon.dispatchEvent(a),this.isUnPaused||q.logToBI(this.vpaidLog,"firstQuartileOnPause",{isPaused:!0}),this.store.getByLineItem("lgvpdtxtelmnts")&&this.vpaidHandler&&this.vpaidHandler.logVpaidElements&&this.vpaidHandler.logVpaidElements();break;case this.vpaidEvents.AdVolumeChange:this.isMobile&&b&&b.eventData&&b.eventData.volume&&(this.adVolume=q.normalizeVolume(b.eventData.volume));break;default:this.beacon.dispatchEvent(a)}if(this.emit(a,{type:a,data:b}),g=!document.hidden,h=this.localVideo.currentTime,q.logToBI(this.vpaidLog,"event_"+a,{qsize:this.manager.queueSize,vpaidReadyInQue:this.manager.getVpaidReadyCount(),adsPlaying:this.store.get("ads_playing"),tabVis:!document.hidden,isViewable:g,vidCurrentime:h,lastKpi:this.store.get("last_kpi"),kpiDelta:this.store.get("last_kpi")-this.store.get("first_kpi"),lastWF:this.store.get("last_wf_duration"),eventDataStr:b?q.stringify(b.eventData):null}),d&&this.vpaidEventToPixelId.hasOwnProperty(a)&&this.hadImpression&&this._sendOpp(this.vpaidEventToPixelId[a]),this.vpaidEvents)if(a===this.vpaidEvents.AdClickThru)this.clickThruUrl=b&&b.eventData?b.eventData.url:"",this._newCompletionHandler(this.vpaidEvents.AdClickThru);else if(a==this.vpaidEvents.AdVideoComplete){if(this._newCompletionHandler(this.vpaidEvents.AdVideoComplete,d),this.stayAlive)return this.globalAdTimeout&&(this.globalAdTimeout=clearTimeout(this.globalAdTimeout)),void this.emit("end");this.vpaidHandler.stopAd(),setTimeout(function(){i.working=!1,i.workingVpaid=!1,i.stop("AdVideoComplete"),i.status="stopped"},2)}this.manager&&c&&this.manager.trigger(a,this,b?b.eventData:null)}}}},{key:"_onGotAdIcons",value:function sa(a,b){q.logToBI(this.vpaidLog,"ad_choices",{vpaid:{error:a,result:b}})}},{key:"_newCompletionHandler",value:function ta(a,b){if(!this.newCompletionEventFired&&(this.timeoutToAdCompletion||this.fireNewCompletionPixel)){if(this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this._validateNewCompletionFiring(a,b))return void this._fireNewCompletionEvent(a);q.logToBI(this.vpaidLog,"fireNewCompletionPrevented",{reason:a,isCmpFireValid:b})}}},{key:"_validateNewCompletionFiring",value:function ua(a,b){return a===this.vpaidEvents.AdClickThru||(a===this.vpaidEvents.AdVideoComplete?b&&this.opportunityManager.alreadySent(this.tag,this.oppsID.videoComplete):"timerEnded"===a&&this.opportunityManager.alreadySent(this.tag,this.oppsID.videoFirstQuartile))}},{key:"_adClickThruHandler",value:function va(a){var b,c;return a&&a.eventData&&a.eventData.url?a:(b=this.pixelManager.getClickThruUrl(),b&&(c={url:b},a?a.eventData=Object.assign(a.eventData||{},c):a={eventData:c}),a)}},{key:"_checkIfGoogle",value:function wa(){var a,b=this.localTarget.querySelector("iframe");if(b){for(a=q.domIframeIterator(b,this.store.get("debug")),this.isGoogleIframe=!1;!this.isGoogleIframe&&a.hasNext();)this._isGoogleIframe(a.current)&&(this.isGoogleIframe=!0);this.isGoogleIframe&&q.logToBI(this.vpaidLog,"googleDemand",{value:!0})}}},{key:"_isGoogleIframe",value:function xa(a){return a&&a.src.indexOf("imasdk.googleapis.com")>-1&&a.src.indexOf("bridge")>-1}},{key:"_onAdImpression",value:function ya(){var a=!0,b=this.store.get("rstmrai");return this.fireViewTracking&&this.fireViewTracking(),b&&this._killTimers(),!this.adStarted&&this.handelsEarlyAI?(this.earlyAdImpression=!0,this.pauseAd(),this.isUnPaused=!1,q.logToBI(this.vpaidLog,"earlyAdImpression",{early:!0}),clearTimeout(this.tillAdstartTimeout),this._fireAdImpression(),!1):(this.hadImpression?(q.logToBI(this.vpaidLog,"doubleImpression",{value:!0}),a=!1):(this.store.set("conversionsCount",this.store.get("conversionsCount")+1),this.setAdVolume(this.adVolume),this.beacon.dispatchEvent(this.vpaidEvents.AdImpression),this._fireAdImpression(),this.adImpInMS=Date.now()-this.created,this.hadImpression=!0,this._wfStats.increaseSuccess(),this.vpaidHandler&&this.vpaidHandler.logVideoUrl&&this.vpaidHandler.logVideoUrl(),this.isReplayable=this.isReplayableVpaid(),q.logToBI(this.vpaidLog,"restartAd",{isReplayable:this.isReplayable})),this.earlyAdImpression&&this.manager&&this.manager.trigger("AdImpression",this,null),a)}},{key:"_firePixel",value:function za(a,b){if("AdVideoComplete"!==a||this.hadImpression){if(!(a===this.vpaidEvents.AdImpression&&this.hadImpression||this.asyncAdimpression))return this.pixelManager.firePixel(a,this.vpaidLog,b)}else q.logToBI(this.vpaidLog,"pixelViolation",{event:a});return!0}},{key:"_fireAdImpression",value:function Aa(a){this.adimpFired||this.asyncAdimpression&&!a||(q.logToBI(this.vpaidLog,"fireAsyncAdimpression",{end:!0}),this._sendOpp(this.oppsID.tagImpression),this.pixelManager.firePixel(this.vpaidEvents.AdImpression,this.vpaidLog),this.adimpFired=!0)}},{key:"onAsyncAdmpression",value:function Ba(){q.logToBI(this.vpaidLog,"fireAsyncAdimpression",{start:!0}),this._fireAdImpression(!0)}},{key:"adStoppedHandler",value:function Ca(a){var b=this;this.stop(),setTimeout(function(){b._cleanVpaid()},1e4)}},{key:"_setAdVolume",value:function Da(a,b){var c=this;this.stopped||(a=q.normalizeVolume(a),this.adVolume=a,this.shouldMuteVid&&(this.localVideo.muted=0===a),this.adVolume>0&&this.setAdVolumeInterval&&this._stopForceAdVolumeInterval(),this.store.get("frcmtfrms")&&this._setVolumeInIframes(this.localTarget.getElementsByTagName("iframe"),a),this.vpaidHandler&&(this.vpaidHandler.setAdVolume(a,b),this.vpaidHandler.callIMAApi&&this.vpaidHandler.callIMAApi("volume",a),this.vpaidHandler.getAdVolume(function(a,b){b!=c.adVolume&&q.logToBI(c.vpaidLog,"inconsistencyAdVolume",{set:c.adVolume,get:b})})))}},{key:"_setVolumeInIframes",value:function Ea(a,b){var c=this;q.DOMIterator(a[0],"iframe",function(a){a.forEach(function(a){c._overideVolumeInIframe(a),a.setAttribute("tbvol",b),a.volume=b,c.shouldMuteVid&&(a.muted=0===b)})},"video",this.store.get("debug"))}},{key:"_overideVolumeInIframe",value:function Fa(a){if(!a||!a.sv){var b=this;a.sv=!0,a.addEventListener("volumechange",function(){a.volume!==parseFloat(this.getAttribute("tbvol"))?(a.volume=0,b.beacon.dispatchEvent(b.vpaidEvents.SoundViolation,{})):a.volume=b.adVolume})}}},{key:"_onParserError",value:function Ga(a,b){this.stopped||(this.status="error",this.error=a||"",this.isPlaying=!1,q.logToBI(this.vpaidLog,"AdError",{readyInMS:this.readyInMS,errType:a,isPraserError:!0}),this.stop(this.error,b))}},{key:"_onNetworkError",value:function Ha(a){this.stopped||(this.status="error",this.error=a?"xhrStatuses_"+a:"",this.isPlaying=!1,q.logToBI(this.vpaidLog,"networkError",{readyInMS:this.readyInMS,errType:"networkError",isNetworkError:!0}),this.stop(this.error,K["default"].networkError))}},{key:"_updateAdVideoDurationOnVideoControls",value:function Ia(a){this.VideoControls&&this.VideoControls.setState({vidDuration:a,vidCurrentTime:0})}},{key:"_registerAnalytics",value:function Ja(a,b,c){var d,e=this,f=this.store.get("analyticsFuncString");if(f)try{return d=this.store.get("anltcsOptions"),this.maxNetworkCalls&&(d.maxNetworkCalls=this.maxNetworkCalls),this.iframesWeights&&(d.iframesWeights=this.iframesWeights),a.contentWindow.eval(f),d.deepIframes&&(a.contentWindow.AnalyticsReporter.prototype.vpaidAnalyticsFunc=f),new a.contentWindow.AnalyticsReporter(b||this.vpaidHandler,c||function(){},d),a.contentWindow.setIsVideoUrlPublic&&(this.setVpaidAnalyticsIsVideoUrlPublic=a.contentWindow.setIsVideoUrlPublic),this.vpaidLog.getVpaidAnalyticsReport=a.contentWindow.getVpaidAnalyticsReport,a.contentWindow.onNetworkCallsLimitExceeded=function(){e.stopped||(q.logToBI(e.vpaidLog,"vpaidAnalyticsCallLimit",{adImpression:e.adimpFired,limitExceeded:!0,maxNetworkCalls:e.maxNetworkCalls}),e.adimpFired||e.stop("networkCallsLimitExceeded",K["default"].maxNetworkCalls))},q.logToBI(this.vpaidLog,"vpaidAnalyticsEval",{success:!0,maxNetworkCalls:this.maxNetworkCalls,vaVersion:this.latestVpaidAnalytics}),!0}catch(g){q.logToBI(this.vpaidLog,"vpaidAnalyticsEval",{success:!1,ex:g})}return!1}},{key:"_onVpaidJs",value:function Ka(a,b,c,d,e){this.tag.vpaidWrapperData.mediatype=2,this.debugTracker.info("ParserResponded[JavaScript]",d),this.pixelManager.loadPixelData(c),this.type="javascript";var f=null;this.store.get("vjshndlrlgcy")?(f=y["default"],this.vpaidHandlerType="JsVpaidLegacey"):(f=w["default"],this.vpaidHandlerType="JsVpaid"),this._createHandler(a,b,f,{registerAnalyticsToVpaidLog:this.registerAnalytics}),this._updateAdVideoDurationOnVideoControls(e)}},{key:"_onMp4Video",value:function La(a,b,c,d,e){this.tag.vpaidWrapperData.mediatype=1,this.debugTracker.info("ParserResponded[Video]",d),this.type="mp4",this.vpaidHandlerType="VideoVpaid",this.pixelManager.loadPixelData(c),this._createHandler(a,b,u["default"],{},c),this._updateAdVideoDurationOnVideoControls(e)}},{key:"_onVpaidJsMobile",value:function Ma(a,b,c,d,e){this.clickableTarget&&this.localTarget.removeChild(this.clickableTarget),this.tag.vpaidWrapperData.mediatype=2,this.debugTracker.info("ParserResponded[JsMobile]",d),this.type="javascript",this.vpaidHandlerType="JsVpaidMobile",this.pixelManager.loadPixelData(c),this._createHandler(a,b,A["default"],{registerAnalyticsToVpaidLog:this.registerAnalytics}),this._updateAdVideoDurationOnVideoControls(e)}},{key:"_onMp4VideoMobile",value:function Na(a,b,c,d,e){this.tag.vpaidWrapperData.mediatype=1,this.debugTracker.info("ParserResponded[VideoMobile]",d),this.type="mp4",this.vpaidHandlerType="VideoVpaidMobile",this.pixelManager.loadPixelData(c),this._createHandler(a,b,C["default"],{duration:e},c),this._updateAdVideoDurationOnVideoControls(e)}},{key:"_onSpotxAdOs",value:function Oa(a,b){this.clickableTarget&&this.localTarget.removeChild(this.clickableTarget),this.tag.vpaidWrapperData.mediaType=4,this.debugTracker.info("ParserResponded[SpotxAdOs]",a),this.type="spotxAdOs",this.vpaidHandlerType="SpotxAdOs",this.pixelManager.loadPixelData(b),this._createHandler([],"",s["default"],{vastParser:this.parser,adOptions:a,registerAnalyticsToVpaidLog:this.registerAnalytics})}},{key:"_createHandler",value:function Pa(a,b,c,d,e){if(!this.stopped){if(this.useIframeOnVpaidWrapper&&!this.iframeWrapperLoaded)return void this.store.set("vpaidWrapper"+this.index+"Handler",{filesArray:a,AdParamString:b,handlerType:c,options:d,trackingPixels:e});if(this.vpaidLog.setVastWrapperCount(this.parser.wrappersCount),q.logToBI(this.vpaidLog,"creatingVpaidHandler",{type:this.vpaidHandlerType}),this._setTimers(),this.creatives.AdParameters=b,this.vpaidHandler=new c({applyBypass:!!this.creatives.AFBP,slot:this.localTarget,videoSlot:this.localVideo,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay,protection:this.config.vpaid_protect_path,adParams:b,vpaidFiles:a,tag:this.tag,onReady:this._onHandlerCreated.bind(this),onError:this._onHandlerError.bind(this),extra:d||{},trackingPixels:e,clickableTarget:this.clickableTarget||null,playerDAST:this.playerDAST},this.vpaidLog,this.store),this.vpaidHandler._onHijackAttempt=this.hijackAttempt.bind(this),this.store.getByLineItem("moat",this.tag))if(this.moatTracker)q.logToBI(this.vpaidLog,"doubleMoat",{text:"tried to initiate moat more than once"});else{if(!this.store.get("moat")){var f=this.store.getByLineItem("mtfctr",this.tag);if(q.getRandomInt(0,100)>f)return}this.moatTracker=new N["default"]({container:this.vpaidHandler.getDOMContainer(),tag:this.tag,moatPartnerCode:this.store.getByLineItem("moatPartnerCode",this.tag),duration:this.vpaidHandler.getAdDuration(),url:this.vpaidHandler.mediaFiles[0].url,store:this.store,vpaidLog:this.vpaidLog})}}}},{key:"_cleanVpaid",value:function Qa(){var a,b;this.clean||this.stayAlive&&this.isReplayable||(this.clean=!0,this.vpaidLog&&(this.vpaidLog.saveToDb(),this.vpaidLog.getVpaidAnalyticsReport=void 0),this.wflog&&(this.wflog.complete(),this.wflog=void 0),this.pixelManager&&this.pixelManager.destroy(),this.beacon&&(a=this.beacon.listEvents(),this.beacon.destroy()),this.localTarget&&(this.localVideo.parentElement&&this.localTarget.removeChild(this.localVideo),b=this.localTarget.querySelectorAll("iframe"),this._clearIframe(b&&b.length?b[0]:null),this.localTarget.parentNode.removeChild(this.localTarget)),this.localIframe&&this.localIframe.parentElement&&this.localIframe.parentElement.removeChild(this.localIframe),this.adTarget&&this.adTarget.parentNode.removeChild(this.adTarget),this.timeoutToAdCompletion=clearTimeout(this.timeoutToAdCompletion),this.globalAdTimeout=clearTimeout(this.globalAdTimeout),this._killTimers(),this.parser.destroy(),this.vpaidHandler&&(this.vpaidHandler._onHijackAttempt=null),this.moatTracker&&this.moatTracker.dispose(),this.status="stopped",this.working=!1,this.VideoControls&&this.VideoControls.destroy(),this.playerDAST&&this.playerDAST.destroy(),this.store&&(this._bindedOnAdLoadVideoThrottleDelayEnd&&(this.store.removeListener(this.onThrottleEndEventName,this._bindedOnAdLoadVideoThrottleDelayEnd),this._bindedOnAdLoadVideoThrottleDelayEnd=void 0),this._bindedOnRemovedFromVideoThrottleListeners&&(this.store.removeListener(this.onRemovedFromThrottleListenersEventName,this._bindedOnRemovedFromVideoThrottleListeners),this._bindedOnRemovedFromVideoThrottleListeners=void 0)),this.creatives=this.vpaidLog=this.parser=this.debugTracker=this.manager=this.tag=this.vast=this.beacon=this.pixelManager=this.config=this.vpaidEvents=this.localTarget=this.localIframe=this.vpaidHandler=this.store=this._wfStats=this.localVideo=this.VideoControls=void 0,this.isPlaying=!1,window.setTimeout(this.onAfterStop,0),this.emit("vpaidCleaned"))}},{key:"_clearIframe",value:function Ra(a){a&&(q.DOMIterator(a,"iframe",function(a){var b=cmTag.$;a.forEach(function(a){b(a).remove()})},"*",this.store.get("debug")),a&&a.parentNode.removeChild(a))}},{key:"bringToFront",value:function Sa(){var a,b;this.localTarget&&!this.blockBringToFront&&(a=this.store.get("height"),this.localTarget.style.display="block",this.localTarget.style.height=a+"px",b=Y++ +99,this.localTarget.style.zIndex=b,this.localIframe&&(this.localIframe.style.display="block",this.localIframe.style.height=a+"px"),this.clickableTarget&&(this.clickableTarget.style.zIndex=b),this.vpaidHandler&&(this.vpaidHandler.zIndex=b),this.VideoControls&&this.VideoControls.setState({isVisible:!0}),this.toggleIframeContentDisplay("hide"))}},{key:"moveToBack",value:function Ta(){this.localTarget&&(this.localTarget.style.zIndex=0,this.localIframe&&(this.localIframe.style.zIndex=0),this.clickableTarget&&(this.clickableTarget.style.zIndex=0));
}},{key:"subscribe",value:function Ua(a,b){this.stopped||this.vpaidEvents[b]&&this.beacon.addEventListener(b,a)}},{key:"unsubscribe",value:function Va(a,b){this.vpaidEvents&&this.vpaidEvents[b]&&this.beacon.removeEventListener(b,a)}},{key:"stop",value:function Wa(a,b,c){var d=this;"global_ad_timeout"!==a&&this.stayAlive&&this.isReplayable||this.stopped||(a&&"hijackAttempt"!==a&&(c&&c.eventData?q.logToBI(this.vpaidLog,a,{eventDataStr:q.stringify(c.eventData),status:this.status}):q.logToBI(this.vpaidLog,a,{status:this.status})),this._stopForceAdVolumeInterval(),this._wfStats&&(this.hadImpression||this._wfStats.increaseFailure(),q.logToBI(this.vpaidLog,"wfStats",{data:this._wfStats.getData()})),this.isStarted&&this.store.decr("ads_started"),this.stopReason=a,this.oldStatus+=this.status,this.isPlaying=!1,void 0!==b&&this._sendOpp(b),this.stopped=!0,this.vpaidHandler&&(this.vpaidHandler.onAfterStop=this._cleanVpaid.bind(this),this.vpaidHandler.stopAd()),this.emit("end"),this.store.emit("vpaidEnded",this),setTimeout(function(){d._cleanVpaid()},2),"global_ad_timeout"===a&&(this.isReplayable=!1,this.isVForceActive||this.store.emit("stop")))}},{key:"callVpaidMethod",value:function Xa(a,b,c){if(!this.stopped){if(this.vpaidHandler&&this.vpaidHandler.callIMAApi&&("pauseAd"!=a&&"resumeAd"!=a||this.vpaidHandler.callIMAApi(a)),q.logToBI(this.vpaidLog,"vpaidApi_"+a,{}),"setAdVolume"==a&&(this.adVolume=q.normalizeVolume(b[0])),"pauseAd"==a&&(this.isUnPaused=!1),"resizeAd"==a&&this._resizeContainers(b[0],b[1],b[2]),!this.vpaidHandler||!this.vpaidHandler[a])return c;try{return this.vpaidHandler[a].apply(this.vpaidHandler,b)}catch(d){return c}}}},{key:"_resizeContainers",value:function Ya(a,b,c){this.localVideo.style.width=a+"px",this.localVideo.style.height=b+"px",this.localVideo.setAttribute("width",a),this.localVideo.setAttribute("height",b),this.localTarget.style.width=a+"px",this.localTarget.style.height=b+"px",this.localTarget.setAttribute("width",a),this.localTarget.setAttribute("height",b),this.localIframe&&(this.localIframe.style.width=a+"px",this.localIframe.style.height=b+"px",this.localIframe.setAttribute("width",a),this.localIframe.setAttribute("height",b))}},{key:"onAfterStop",value:function Za(){}},{key:"hijackAttempt",value:function $a(a,b){if(!this.hijackFired){this.hijackFired=!0,(new Image).src="//convusmp.basebanner.com/st?cijs=0&ttype=5&pix=31542217&dast="+this.tag.dast+"&"+(new Date).getTime(),q.logToBI(this.vpaidLog,"hijackAttempt",{badUrl:a,earlyHijack:!!b&&b});var c=this.store.get("hjkstp")!==!1;c&&this.stop("hijackAttempt",K["default"].hijackAttempt)}}},{key:"fire99",value:function _a(){this._sendOpp(this.oppsID.firstImpression)}},{key:"_onEvent",value:function ab(a,b){if(this.pendingEvents&&this.pendingEvents.hasOwnProperty(a)){var c=this.pendingEvents[a];c.timeoutId!=-1&&clearTimeout(c.timeoutId),c.cb&&"function"==typeof c.cb&&c.cb(b),delete this.pendingEvents[a]}}},{key:"_waitForEvent",value:function bb(a,b,c,d){var e=function h(){},f=-1,g=this;b>0&&d&&"function"==typeof d&&(f=setTimeout(function(){q.logToBI(this.vpaidLog,"vpaidTimeout_"+a,{}),d(),delete g.pendingEvents[a],f=null,c=e,d=e}.bind(this),b)),this.pendingEvents||(this.pendingEvents={}),this.pendingEvents[a]={cb:c,timeoutId:f}}},{key:"_onAdLoadedTimeout",value:function cb(){this.error="adloadedTimeout",this.stop(this.error,this.oppsID.adloadedTimeout)}},{key:"_onAdLoadedEvent",value:function db(){}},{key:"_onAdImpressionTimeout",value:function eb(){this.error="adImpressionTimeout",this.stop(this.error)}},{key:"_onAdImpressionEvent",value:function fb(){}},{key:"setVastPrice",value:function gb(a){this.tag.vpaidWrapperData.vastPrice=a,a>0&&q.logToBI(this.vpaidLog,"vastPrice",{value:a})}},{key:"setVastType",value:function hb(a){this.tag.vpaidWrapperData.vastType=a}},{key:"setVastIcons",value:function ib(a){var b=this.store.getByLineItem("fkadchcs",this.tag);b?(this.hasAdChoices=!0,q.logToBI(this.vpaidLog,"ad_choices",{fakeAdChoices:!0})):(this.tag.vpaidWrapperData.icons=a,this.hasAdChoices=a.length,this.hasAdChoices&&(this._addAdChoiceDiv(a),q.logToBI(this.vpaidLog,"ad_choices",{vast:a})))}},{key:"_addAdChoiceDiv",value:function jb(a){var b,c,d,e,f,g,h,i=!0,j=!1,k=void 0;try{for(b=a[Symbol.iterator]();!(i=(c=b.next()).done);i=!0)d=c.value,d.attributes.program&&this.iconsPrograms.indexOf(d.attributes.program)===-1&&(this.iconsPrograms.push(d.attributes.program),e=document.createElement("div"),e.className="_cm-ad-choices-player",e.style.zIndex=""+(Y+10),d.attributes.xPosition&&(e.style.left="initial",e.style[d.attributes.xPosition]="13px"),d.attributes.yPosition&&(e.style.top="initial",e.style[d.attributes.yPosition]="16px"),f=document.createElement("a"),d.clickThroughUrl&&(f.href=d.clickThroughUrl),f.onclick=this._appendOnClick(d),f.target="_blank",f.className="_cm-ad-choices-player-anchor",f.style.width=d.attributes.width||"19px",f.style.height=d.attributes.height||"15px",d.staticresource?f.style.background="#fff url("+d.staticresource+") no-repeat center center":d.htmlresource&&(g=document.createElement("template"),g.innerHTML=d.htmlresource,f.appendChild(g.content.childNodes[0])),d.iconViewTracking.length&&(h=d.iconViewTracking,this.fireViewTracking=function(){setTimeout(function(a){var b,c,d,e=!0,f=!1,g=void 0;try{for(b=a[Symbol.iterator]();!(e=(c=b.next()).done);e=!0)d=c.value,(new Image).src=d}catch(h){f=!0,g=h}finally{try{!e&&b["return"]&&b["return"]()}finally{if(f)throw g}}},5e3,h)}),e.appendChild(f),this.localVideo.parentElement.appendChild(e))}catch(l){j=!0,k=l}finally{try{!i&&b["return"]&&b["return"]()}finally{if(j)throw k}}}},{key:"_appendOnClick",value:function kb(a){return function(){var b,c,d,e=!0,f=!1,g=void 0;try{for(b=a.clickTracking[Symbol.iterator]();!(e=(c=b.next()).done);e=!0)d=c.value,(new Image).src=d}catch(h){f=!0,g=h}finally{try{!e&&b["return"]&&b["return"]()}finally{if(f)throw g}}}}},{key:"_copyFromStoreToBi",value:function lb(a){this.store.get(a)&&q.logToBI(this.vpaidLog,a,this.store.get(a))}},{key:"_handleDataSaver",value:function mb(){this.isMobile&&!this.vpaidHandler.canvas&&this.store.get("dataSaverDetected")&&(this.isUnPaused=!1,q.logToBI(this.vpaidLog,"dataSaverDetected",{value:!0}))}},{key:"mute",value:function nb(){this.adVolume=0,this.VideoControls&&this.VideoControls.setState({isMuted:!0})}},{key:"unmute",value:function ob(){if(this.adVolume=q.normalizeVolume(this.store.get("dfltvlm")),this.VideoControls){if(this.store.get("forceMute"))return void(this.adVolume=0);this.VideoControls.setState({isMuted:!1}),this.adVolume=q.normalizeVolume(this.VideoControls.getValueFromControlsState("volume"))}}},{key:"updateStatusesOnGetAd",value:function pb(a){q.logToBI(this.vpaidLog,"statusesOnGetAd",{status:this.status,hadImpression:!!this.hadImpression,isStarted:!!this.isStarted,requiredViewability:a.requiredViewability})}},{key:"logVpaidFamily",value:function qb(){var a,b,c,d,e=[],f=[];if(this.vpaidHandler.adUnit._iframe&&this.vpaidHandler.adUnit._iframe.contentWindow)for(a=this.vpaidHandler.adUnit._iframe.contentWindow.document.scripts,b=0;b<a.length;b++)a[b].src.indexOf("z.moatads.com")>-1&&a[b].src.split("/").length>4&&e.push(a[b].src.split("/")[3]),a[b].src.indexOf("sc.iasds01.com")>-1&&(c=a[b].src.match(/EntityId=([^&]*)/),2===c.length&&f.push("ias-"+c[1]));d=""+this.tag.dp+(e.length>0?e.join("_"):"")+(f.length>0?f.join("_"):"")+(this.isGoogleIframe?"_ggl":"")+(this.isUnfriendlyIframe?"_ui":""),d!==this.tag.dp&&q.logToBI(this.vpaidLog,"vpaidFamily",{family:d})}},{key:"resizeAd",value:function rb(a,b,c){var d,e,f,g,h;if(!this.stopped)try{if((void 0==a||isNaN(parseInt(a)))&&(a=!1),(void 0==b||isNaN(parseInt(b)))&&(b=!1),d=0,e=0,!a&&!b)return void this.debugTracker.error("resize","No `height` or `width` specified!");b&&a?(e=this._convertSizeFromNumberToPixels(b),d=this._convertSizeFromNumberToPixels(a)):(c=c&&c.split(":").length>1?c:this.store.get("playerAspectRatio"),c=c.split(":"),a?(f=parseInt(fullAspectRatio[1])/parseInt(fullAspectRatio[0]),d=this._convertSizeFromNumberToPixels(a),e=this._convertSizeFromNumberToPixels(Math.floor(parseFloat(d)*f))):(f=parseInt(fullAspectRatio[0])/parseInt(fullAspectRatio[1]),e=this._convertSizeFromNumberToPixels(b),d=this._convertSizeFromNumberToPixels(Math.floor(parseFloat(e)*f)))),d&&e&&(g=parseFloat(d),h=parseFloat(e),this.localTarget.style.width=d,this.localTarget.style.height=e,this.localTarget.setAttribute("width",g),this.localTarget.setAttribute("height",h),this.localIframe&&(this.localIframe.style.width=d,this.localIframe.style.height=e,this.localIframe.setAttribute("width",g),this.localIframe.setAttribute("height",h)),this.localVideo.style.width=d,this.localVideo.style.height=e,this.localVideo.setAttribute("width",g),this.localVideo.setAttribute("height",h),this.isMultiAdsActive&&(this.store.set("width",g.toString()),this.store.set("height",h.toString()),this.store.emit("resizeVpaidWrapper",{width:g,height:h}),this.vpaidHandler.resizeAd(g,h,this.config.viewMode||"normal"))),this.blockBringToFront&&(this.blockBringToFront=!1,this.bringToFront())}catch(i){this.debugTracker.error("resize","Resizing component failed!")}}},{key:"_convertSizeFromNumberToPixels",value:function sb(a){var b=a+"";return b.search(/px$/g)<0&&(b+="px"),b}},{key:"getCurrentVolume",value:function tb(){return this.VideoControls?this.VideoControls.getValueFromControlsState("volume"):this.adVolume}},{key:"_onSoundChange",value:function ub(a){this.vpaidHandler&&this.vpaidHandler.onMuteChanged&&this.vpaidHandler.onMuteChanged(a)}},{key:"_pushConversionDataToWaterfallLog",value:function vb(){var a,b;this.wflog&&(a=this.getVideoUrl(),a&&(b=this.store.get("wfLogUniqueVideoUrls_"+this.wflog.index)||[],b.indexOf(a)<0&&(b.push(a),this.wflog.push("uniqueVideoUrlsCounter",b.length),this.store.set("wfLogUniqueVideoUrls_"+this.wflog.index,b))),this.wflog.push("wfConversionsCounter",this.wflog.get("wfConversionsCounter",0)+1),this.wflog.sendDataOnConversion())}},{key:"_pushUniqueAdvIdsToWaterfallLog",value:function wb(){if(this.wflog){var a=this.store.get("wfLogUniqueAdvIds_"+this.wflog.index)||[];a.indexOf(this.tag.advId)<0&&(a.push(this.tag.advId),this.wflog.push("uniqueAdvIdsCounter",a.length),this.store.set("wfLogUniqueAdvIds_"+this.wflog.index,a))}}},{key:"_appendVpaidCSS",value:function xb(){var a,b,c,d=this.store.getByLineItem("vpdcss",this.tag),e=[];if(void 0!==d){for(a in d)if(b=null,b=this.localTarget.className.indexOf(a)>-1?this.localTarget:this.localTarget.querySelectorAll(a)[0])for(c in d[a])b.style[c]=d[a][c];else e.push("No element matching "+a);q.logToBI(this.vpaidLog,"appendVpaidCSS",{success:0===e.length,style:q.stringify(d),errors:e.join(",")})}}},{key:"toggleIframeContentDisplay",value:function yb(a){this.isMultiVpaidUnit&&this.toggleIframeContentDisplayActive&&this.vpaidHandler.toggleIframeContentDisplay&&this.vpaidHandler.toggleIframeContentDisplay(a)}},{key:"_sendOpp",value:function zb(a){!this.stopped&&this.opportunityManager&&this.opportunityManager.send(this.tag,a,this.playerDAST.get(),this.localVideo?this.localVideo.currentTime:void 0)}},{key:"getAdDuration",value:function Ab(){var a=this;isNaN(this.localVideo.duration)?this.vpaidHandler&&this.vpaidHandler.getAdDuration(function(b,c){a._setVideoControlsDuration(c)}):this._setVideoControlsDuration(this.localVideo.duration)}},{key:"_setVideoControlsDuration",value:function Bb(a){this.VideoControls&&this.VideoControls.setState({vidDuration:a})}},{key:"registerToVPAIDVideoTimeupdateEvent",value:function Cb(){var a,b=this;this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement&&(a=this.vpaidHandler.getVPAIDVideoElement(),null!==a&&a.addEventListener("timeupdate",function(c){b._onTimeupdate(a)}))}},{key:"_onTimeupdate",value:function Db(a){this.workingVpaid&&a.currentTime>0&&this.VideoControls&&this.VideoControls.setState({preventAdTicker:!0,vidDuration:a.duration,vidCurrentTime:a.currentTime})}}]),b}(L.EventEmitter),c["default"]=Z,b.exports=c["default"]},{"../player/Tracker":27,"../player/VideoControls":28,"../player/utils":38,"./Beacon":39,"./CostModels":41,"./JsVpaid":46,"./JsVpaid-legacey":45,"./JsVpaidMobile":47,"./MoatTracker":49,"./OpportunityManager":52,"./OpportunityType":53,"./PixelManager":54,"./PlayerDAST":55,"./SpotxAdOs":57,"./VastParser":58,"./VideoVpaid":59,"./VideoVpaidMobile":60,"./VpaidLog":61,"copy-to-clipboard":2,events:3,"lodash.debounce":4}],63:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a){return a&&a.__esModule?a:{"default":a}}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;Object.defineProperty(c,"__esModule",{value:!0}),g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/Tracker"),i=e(h),j=a("../player/Post"),k=e(j),l=a("../player/utils"),m=d(l),n=a("./VpaidLog"),o=e(n),p=a("./WfLog"),q=e(p),r=a("./WaterfallStats"),s=e(r),t=a("../player/dastDecoder"),u=e(t),v=-1,w=1,x=function(){function a(b){var c,d=this;f(this,a),this.store=b,this.store.set("waterfallFailsInARow",0),this.store.set("waterfallSuccessesInARow",0),this.store.set("waterfallIndex",w),this.encryptWaterfallResponse=this.store.get("encwfrs"),this.wfv=this.store.get("wfv"),this.isBufferModeOn=this.store.get("bfrmd"),this.requiredViewabilityFactor=this.store.get("rvfctr"),this.dynamicNoaopMaxValue=this.store.get("dnapmxvl"),this.mimeEnum=[{id:5,mime:"application/javascript",video:!1},{id:8,mime:"video/x-ms-wmv",video:!0},{id:10,mime:"video/mp4",video:!0},{id:11,mime:"video/ogg",video:!0},{id:12,mime:"video/webm",video:!0}],this.creatives={},this.inHttpsProtocol="https:"===window.location.protocol,this.debugTracker=new i["default"]("WaterfallManager"),this.cachedTags=!1,this.cacheAge=0,this.staticWf=this.store.get("static_schedule"),this.shouldRun=function(){return!0},this._runBindedWaterfallTicker=this._runWaterfallTicker.bind(this),this._roundTripAverageDuration=0,this._roundTripsCount=0,this._initDynamicWfsValues(),this.store.get("wf_manual")||this.startNextWfTimeout(),this.store.on("stop",this._stop.bind(this)),this.store.on("pausePlayer",this._stop.bind(this)),c=this.store.get("wf_dynmc_ps"),c&&(this.store.on("contentPaused",this._stop.bind(this)),this.store.on("contentResumed",this.startNextWfTimeout.bind(this))),this.isFirstRun=!0,this.igonreWfWhenHidden=this.store.get("ignrwfhdn"),this.lineitemMaxFails=this.store.get("mxlifls"),this._registerQueueEvent(),this.maxAllowedEmptyWaterfalls=this.store.get("mxemptwf"),this.store.set("emptyWaterfallsInARow",0),this.store.on("startWf",function(){d.store.set("dlywf",!1),d.runWaterfall("startWf")})}return g(a,[{key:"_shouldDelayWaterfall",value:function b(){return this.store.get("dlywf")}},{key:"startNextWfTimeout",value:function c(){var a=this;this.wfInterval&&clearTimeout(this.wfInterval),this._calcDynamicWfsValues(),this._delayBetweenWfs>0?this.wfInterval=setTimeout(function(){a._runBindedWaterfallTicker()},this._delayBetweenWfs):this.store.emit("closePlayer")}},{key:"_initDynamicWfsValues",value:function d(){this.maxTimeBetweenWaterfalls=this.store.get("mxtmbtwfs"),this.minTimeBetweenWaterfalls=this.store.get("mntmbtwfs"),this.defaultTimeBetweenWaterfalls=this.store.get("time_between_waterfall"),this.timeBetweenWfFunc=this.store.get("tmbtwfs"),"function"!=typeof this.timeBetweenWfFunc&&(this.timeBetweenWfFunc=void 0),this.minTimeBetweenWfFunc=this.store.get("mntmbtwfsf"),"function"!=typeof this.minTimeBetweenWfFunc&&(this.minTimeBetweenWfFunc=void 0),this.defaultMinTimeBetweenWf=this.store.get("mintimwf")||5e3,this.store.set("dynamicWf.lastDelayBetweenWfs",-1),this.store.set("dynamicWf.currentDelayBetweenWfs",-1),this._calcDynamicWfsValues()}},{key:"_calcDynamicWfsValues",value:function e(){this._delayBetweenWfs=1e3*this._calcDelayBetweenWf(),this._delayBetweenWfs>0&&(this._minTimeBetweenWf=this._calcMinDelayBetweenWfs()),this._saveDynamicWfsValues()}},{key:"_calcDelayBetweenWf",value:function h(){var a=v;if(this.timeBetweenWfFunc)try{a=this.timeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(b){a=this.defaultTimeBetweenWaterfalls}return a>this.maxTimeBetweenWaterfalls?a=v:a<this.minTimeBetweenWaterfalls&&(a=this.minTimeBetweenWaterfalls),a}},{key:"_calcMinDelayBetweenWfs",value:function j(){var a=this.defaultMinTimeBetweenWf;if(this.minTimeBetweenWfFunc)try{a=this.minTimeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(b){a=this.defaultMinTimeBetweenWf}return a}},{key:"_saveDynamicWfsValues",value:function l(){this.store.set("dynamicWf.lastDelayBetweenWfs",this.store.get("dynamicWf.currentDelayBetweenWfs")),this.store.set("dynamicWf.currentDelayBetweenWfs",this._delayBetweenWfs)}},{key:"_registerQueueEvent",value:function n(){var a=this.store.get("run_wf_when_empty");a&&this.store.on("playFromEmptyQueue",this.runWaterfall.bind(this,"queueEmpty"))}},{key:"_isInIdleMode",value:function o(){return this.store.get("isIdleMode")}},{key:"_runWaterfallTicker",value:function p(){this.startNextWfTimeout(),this.runWaterfall("interval")}},{key:"init",value:function r(a,b){this.creatives=a,this.store.set("creatives",a),this.adParams=b,this._shouldRunWaterfallOnInit()&&this.runWaterfall("run_wf_on_init")}},{key:"_shouldRunWaterfallOnInit",value:function t(){return this.store.get("run_wf_on_init")}},{key:"_serveStaticWf",value:function x(a){var b,c;this._getRollType(),b=0,"mid-roll"==this.currentRollType?b=1:"post-roll"==this.currentRollType&&(b=2),c=new Function("try { return "+this.staticWf[b].ad_parameters+";} catch(e){}")(),this._handleWaterfallSuccess(m.stringify(c.waterfall),a)}},{key:"runWaterfall",value:function y(a){var b,c,d,e,f,g,h,i,j,l,n,o,p,r,s=this;if(!this.passedMaxEmptyWaterfalls()&&!this.store.get("first_look")&&("function"!=typeof this.shouldRun||this.shouldRun())&&!this._shouldDelayWaterfall()&&!(this._isInIdleMode()||(b=this,c=(new Date).getTime(),d=this.lastRun?c-this.lastRun:this._minTimeBetweenWf,d<this._minTimeBetweenWf))){if(this.lastRun=c,e=new q["default"](this.store),this.staticWf)return void setTimeout(function(){s._serveStaticWf(e)},20);1===w&&m.reportDebug("player_waterfall","firstwf",{type:"debug",message:"firstwf",fullPageUrl:this.store.get("fullPageUrl"),player_id:this.store.get("player_id")},this.store),f=this.store.get("pstflrs")===!0,g=this.store.get("psthdrs")||"application/json",this.lastRun=c,e.requestTime=Date.now(),e.ignoredLineitems=[],e.push("reason",a),e.push("waterfallIndex",w),e.push("sinceLastWf",d),e.push("queueLength",this.store.get("queueLength")),e.push("vpaidReadyCount",this.store.get("vpaidReadyCount")),e.push("vpaidPendingCount",this.store.get("queueLength")-this.store.get("vpaidReadyCount")),e.push("failsInARow",this.store.get("waterfallFailsInARow")),e.push("successesInARow",this.store.get("waterfallSuccessesInARow")),e.push("lastDelayBetweenWfs",this.store.get("dynamicWf.lastDelayBetweenWfs")),e.push("currentDelayBetweenWfs",this.store.get("dynamicWf.currentDelayBetweenWfs")),e.push("emptyWaterfallsInARow",this.store.get("emptyWaterfallsInARow")),e.push("maxAllowedEmptyWaterfalls",this.maxAllowedEmptyWaterfalls),e.push("encryptedResponse",this.encryptWaterfallResponse),e.push("waterfallVersion",this.wfv),e.push("navigatorConnection",this.store.get("navigatorConnection")),this.isBufferModeOn&&e.push("bufferMode",this.store.get("bufferModeList")||[]),h=function u(a){b._handleWaterfallError(a,e)},i=function v(a){b._handleWaterfallSuccess(a,e)},j=this._generateWaterfallUrl(this.creatives,this._runMimeTypeCheck()),e.push("url",j);try{for(l=j.split("?")[1].split("&"),n={},p=0;p<l.length;p++)o=l[p],n[o.split("=")[0]]=o.split("=")[1];e.push("urlParams",n)}catch(t){}if(e.push("noaop",this.isFirstRun?this.store.get("firstWaterfallNoaop"):this.creatives.NOAOP),j){if(this.adParams&&this.adParams.waterfall)window.setTimeout(this._handleWaterfallSuccess.bind(this,m.stringify(this.adParams.waterfall)),0);else{if(!f)return(0,k["default"])(j,"",i,h,!0,!0),w++,this.store.set("waterfallIndex",w),void(this.isFirstRun&&(this.isFirstRun=!1));r=this._buildPostData(),e.push("postData",r),(0,k["default"])(j,r,i,h,!0,!0,5e3,g),this.isFirstRun&&(this.isFirstRun=!1)}w++,this.store.set("waterfallIndex",w)}}}},{key:"_buildPostData",value:function z(){var a,b,c,d,e,f,g,h={fv:[]},i=this.store.get("sessionData");return i&&(h.sd=i),this.encryptWaterfallResponse&&(h.en=1),h.wfv=this.wfv,this.isBufferModeOn&&(a=this.store.get("bufferModeList")||[],a.length>0&&(h.bm=a)),b=this.store.get("lineItems")||[],b.length>0&&(c=this,d=null,b.map(function(a){var b=c.store.get(a);h.fv.push({li:a,f:b.fails,fr:b.failsRow,c:b.conversions,t:b.tries})})),e=this.store.getWfData(),h.adv=e,!this.sentCookiesData&&this.store.get("EP_PLAYER")&&(h.ls=this.store.get("EP_PLAYER"),this.sentCookiesData=!0),f=this.store.get("navigatorConnection")||{},h.cdl=f.downlink||0,h.cet=f.effectiveTypeId||0,h.ct=f.typeId||0,h.crt=f.rtt||0,h.csd=f.saveData===!0?1:0,g=m.stringify(h)}},{key:"_runMimeTypeCheck",value:function A(){var a,b,c=document.createElement("video"),d=[];for(d.push(5),a=0;a<this.mimeEnum.length;a++)b=this.mimeEnum[a],b.video&&c.canPlayType(b.mime)&&d.push(b.id);return c=void 0,d}},{key:"passedMaxEmptyWaterfalls",value:function B(){return!!this.maxAllowedEmptyWaterfalls&&this.store.get("emptyWaterfallsInARow")>this.maxAllowedEmptyWaterfalls}},{key:"_handleWaterfallSuccess",value:function C(a,b){var c,d,e,f,g,h;if(this.store.incr("emptyWaterfallsInARow"),!this.igonreWfWhenHidden){if(this._addRoundTripDuration(),!a)return this.debugTracker.info("runWaterfall","Empty Waterfall!"),this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),void this._handleWaterfallError("empty-response",b);if(this.encryptWaterfallResponse&&(a=this._decodeText(a)),c=new Function("try { return "+a+";} catch(e){}")(),!(c&&c.tags&&c.tags.length))return d=c&&c.tags?"Failed to decode empty server response":"Failed to decode server response!",this.debugTracker.warn("runWaterfall",d),this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),void this._handleWaterfallError("no-tags",b);this.store.set("emptyWaterfallsInARow",0),this.debugTracker.info("Waterfall number "+(b.index+1)+" received",c.tags,{color:"#D15EFF"}),this.store.set("sessionData",c.sd),c&&c.pixel_piggies&&this._firePiggies(c.pixel_piggies),e=[];for(f in c.tags)g=c.tags[f],(g.url||g.vast)&&(g.score=-1,g.waterfallTagId=f,g.created=(new Date).getTime(),g.dp=(g.lp&&g.lp.length>0&&g.lp[0]?g.lp[0]:"").replace(/http:\/\/|.com|https:\/\/|.com/g,"")||"na",g.dpFull=g.lp&&g.lp.length>0?g.lp[0]:"na",g.conversionPixels=g.conversionPixels||[],g.ts=Date.now(),g.wfIndex=b?b.get("waterfallIndex",-1):w,g.url=g.url?m.replaceMacros(g.url,this.store):"",g.vast=g.vast?m.replaceMacros(g.vast,this.store):"",g.pixel=g.pixel?this._getPixel(g.pixel):"",g.brand=g.brand||"",g.rollType=this.currentRollType,g.pubId=this.pubid,g.tagId=this.tagid,g.isRon=this.isRon,g.cstmdl=g.cstmdl||-1,h=g.pixel.match("cirid=([^&]*)"),h&&h.length&&(g.cirid=h[1]),g.dast=g.pixel?this._getDastFromPixel(g.pixel):"",g.vidDast=g.pixel?this._getVidDastFromPixel(g.pixel):"",g.campaignId=this._getCampaignId(g.vidDast),g.lineItem=g.lineItemId||this._getDastVal(g.dast,"cicmp"),g.lineItem=g.lineItem.toString(),g.url&&0===g.url.indexOf("http:")&&(this.store.get("usscrtgurl")||this.inHttpsProtocol&&this.store.get("httpsOverride"))&&(g.url=g.url.replace("http:","https:")),this._overrideParamsByDemand(g),this._decodeItemParams(g),this.requiredViewabilityFactor>0&&!g.requiredViewability&&(g.requiredViewability=this._drawRequiredViewabilityByFactor(g)),this._ignoreLineitem(g.lineItem)?(b.ignoredLineitems.push(g.lineItem),b.push("ignoreLineitems",b.ignoredLineitems),this.store.get(g.lineItem+".failsRow")?this.store.incr(g.lineItem+".failsRow"):this.store.set(g.lineItem+".failsRow",1)):e.push(g),this.store.get(g.lineItem)||this.store.set(g.lineItem,{failsRow:0,tries:0,conversions:0,fails:0}),g.lineItemStats=m.deepClone(this.store.get(g.lineItem)));e.length>0?(this._pushTagsResponseToWaterfallLog(b,e),c.tags=e,c.data=new s["default"](this.store,w),this.onWaterfallSuccess(c,b),b&&(b.push("duration",Date.now()-b.requestTime),b.push("response",a),b.push("tagsCount",e.length),b.push("success",!0),this._sendWfLog(b)),this.store.emit("waterfallData",c)):(this.debugTracker.error("runWaterfall","Failed to get any tags!"),this._handleWaterfallError("no-clean-tags",b))}}},{key:"_drawRequiredViewabilityByFactor",value:function D(a){var b=!!(m.getRandomInt(0,100)<=this.requiredViewabilityFactor&&a&&a.brand);return b&&(a.requiredViewabilityDrawn=!0),b}},{key:"_pushTagsResponseToWaterfallLog",value:function E(a,b){a&&b.map(function(b,c){var d=Object.assign({},b);a.push("tagResponse_"+c,m.flattenObject(d))})}},{key:"_overrideParamsByDemand",value:function F(a){this.store.get("ovrtgbydc")&&(a=Object.assign(a,this.store.getByAdvId("ovrdtag",a.advId)))}},{key:"_sendWfLog",value:function G(a){var b={wfRoundTripAverageDuration:this.store.get("performance.wfRoundTripAverageDuration"),performanceMeasurment:this.store.get("performance.performanceMeasurment")};a.push("performance",b),a.push("conversionsCount",this.store.get("conversionsCount")),a.push("unit",{width:this.store.get("width"),height:this.store.get("height")}),this.store.get("vForce")&&a.push("getAdData",this.store.get("getAdData"))}},{key:"_addRoundTripDuration",value:function H(){var a=Date.now()-this.lastRun;this._roundTripAverageDuration=parseInt((this._roundTripAverageDuration*this._roundTripsCount+a)/(this._roundTripsCount+1)),this.store.set("waterfall_data.last_duration",a),this.store.set("waterfall_data.average_duration",this._roundTripAverageDuration),this._roundTripsCount++}},{key:"_ignoreLineitem",value:function I(a){var b,c;return this.lineitemMaxFails>0&&(b=this.store.get(a),c=b?b.failsRow:-1,c>this.lineitemMaxFails)}},{key:"_getVidDastFromPixel",value:function J(a){var b=a.match('vid-dast=([^&|"]*)');return b&&b.length?b[1]:""}},{key:"_decodeItemParams",value:function K(a){a.rpox=this._decodeValue(a.rpox),a.alfrox=this._decodeValue(a.alfrox),a.frox=this._decodeValue(a.frox),a.ex&&(a.crId=a.ex.ecrid,a.stId=a.ex.s,a.cmpgnId=a.ex.ecid,a.ex.b&&(a.brand=this.encryptWaterfallResponse?a.ex.b:this._decodeText(a.ex.b))),a.itemType=a.t}},{key:"_decodeValue",value:function L(a){return this.encryptWaterfallResponse?a:(2530^a)/1e3}},{key:"_decodeText",value:function M(a){var b,c,d,e,f;try{b=atob(a)}catch(g){return!1}for(c="",e="PlAyER",f=0;f<b.length;f++)d=f%e.length,c+=String.fromCharCode(b[f].charCodeAt(0).toString(10)^e[d].charCodeAt(0).toString(10));return c}},{key:"_firePiggies",value:function N(a){var b,c,d,e=this.store.get("fire_piggies");if(e&&!(w>=5))for(b=0;b<a.length;b++)if(c=a[b],c.url){d=m.setUrlPrefix(c.url);try{(new Image).src=d}catch(f){this.debugTracker.error("_fireIframePig - Malformed url!",f)}}}},{key:"_fireIframePig",value:function O(a){var b,c=document.createElement("iframe");c.src=a,c.style.display="none",b=document.getElementsByTagName("body")[0],b||(b=document.getElementsByTagName("html")[0]),b||(b=document.getElementsByTagName("div")[0]),b?b.appendChild(c):this.debugTracker.warn("_fireIframePig","Failed to fire piggies.")}},{key:"_handleWaterfallError",value:function P(a,b){this.store.incr("emptyWaterfallsInARow"),this._addRoundTripDuration(),b&&(b.push("duration",Date.now()-b.requestTime),b.push("error",a),b.push("success",!1),this._sendWfLog(b)),this.onWaterfallError(a)}},{key:"_decideNoap",value:function Q(a){var b,c,d;return this.isFirstRun?b=this.store.get("firstWaterfallNoaop"):this.dynamicNoaopMaxValue>0?(c=this.store.get("max_ready_vpaid")||0,d=this.store.get("vpaidReadyCount")||0,b=Math.min(this.dynamicNoaopMaxValue,c-d)):b=a,b||a}},{key:"_generateWaterfallUrl",value:function R(a,b){var c,d,e,f,g,h,i,j,k,l,n,o=this.store.get("wf_base_path")||a.CM_DOMAIN;return o+=/.*\/$/g.test(o)?"":"/",o=m.setUrlPrefix(o),c=[],d=!document.hidden,(e=this._getRollType())?(f=(new Date).getTimezoneOffset(),f*=-1,g=a.SORTORDERTYPE,h=this.store.get("ab_test"),i=this.store.get("mprdct"),c.push("oid="+a.OID),c.push("width="+(a.PLAYER_WIDTH||a["PLAYER-WIDTH"])),c.push("height="+(a.PLAYER_HEIGHT||a["PLAYER-HEIGHT"])),c.push("pubid="+(this.pubid||a.PUBID)),c.push("tagid="+(this.tagid||a.TAGID)),c.push("crid="+(this.store.get("creativeId")||"")),c.push("noaop="+this._decideNoap(a.NOAOP)),c.push("sortOrderType="+g),c.push("cb="+(new Date).getTime()),c.push("mimes="+b.join(",")),c.push("isvideo="+a.ISVIDEO),c.push("plmd="+a.PLMD),c.push("mindur="+a.MINDUR),c.push("maxdur="+a.MAXDUR),c.push("minbr="+a.MINBR),c.push("maxbr="+a.MAXBR),c.push("st="+m.getStreamType(e.roll_type)),c.push("seq="+w),c.push("pv="+(this.store.get("player_version")||999)),c.push("pt="+m.crc32(h||999)),c.push("tz="+f),c.push("viewable="+d),c.push("ddast="+this.store.get("auc_dast")),c.push("proto=2,3,5,6"),this.store.get("dtagid")&&c.push("dtagid="+this.store.get("dtagid")),this.store.get("dpubid")&&c.push("dpubid="+this.store.get("dpubid")),h&&c.push("abtst="+h),"undefined"!=typeof i&&c.push("mPre="+i),c.push("encoded=1"),j=this.store.get("pstn")||1,c.push("pstn="+j),a.CIRF&&c.push("cirf="+encodeURIComponent(decodeURIComponent(a.CIRF))),c.push("callback="),k=this.store.get("wf_xrta"),k&&c.push(k),this.encryptWaterfallResponse&&c.push("en=1"),c.push("wfv="+this.wfv),this.isBufferModeOn&&(l=this.store.get("bufferModeList")||[],l.length>0&&c.push("bm="+l.join(","))),c.push("cdb="+(this.store.get("cdb")||"")),c.push("gdprApplies="+(this.store.get("gdprApplies")||!1)),n=this.store.get("wf_path")||a.SERVICE,window.lastWfUrl=o+n+"?"+c.join("&"),o+n+"?"+c.join("&")):""}},{key:"_getPixel",value:function S(a){var b=a.split(/<script.*?src="(.*?)"/g);if(1==b.length){if(b=a.split(/<script.*?src='(.*?)'/g),b[1])return b[1].replace(/^http(s:|:)/g,"")}else if(b[1])return b[1].replace(/^http(s:|:)/g,"");return a.replace(/^http(s:|:)/g,"")}},{key:"_getDastFromPixel",value:function T(a){var b,c,d,e=a.replace(/\?\?+/g,"?").replace(/&&+/g,"&").split(/\?(.+)?/gi,2);if(2!=e.length)return"";b=e[1].split(/\?|&/gi);for(c in b)if(b[c]&&(d=b[c].split(/=(.+)?/gi,2),2==d.length&&"dast"==d[0]))return d[1];return""}},{key:"onWaterfallError",value:function U(){}},{key:"onWaterfallSuccess",value:function V(){}},{key:"SetWaterfallError",value:function W(a){this.onWaterfallError=a}},{key:"SetWaterfallSuccess",value:function X(a){this.onWaterfallSuccess=a}},{key:"SetShouldRun",value:function Y(a){this.shouldRun=a||function(){}}},{key:"GetCounter",value:function Z(){return w}},{key:"_getRollType",value:function $(){var a,b=this.store.get("contentSchedule")||{},c=null,d=Object.keys(b)||[];return 1===w?(a=d[0],c=b[a]):d.length>0&&(a=d[1],c=b[a]),this.currentRollType=c?c.roll_type:"",this.pubid=c?c.pubid:0,this.tagid=c?c.tagid:0,c}},{key:"_getDastVal",value:function _(a,b){var c,d="";try{d=atob(a)}catch(e){return}return c=d.match(b+"=([^&]*)"),c&&c.length>1?c[1]:""}},{key:"_stop",value:function aa(){clearTimeout(this.wfInterval)}},{key:"start",value:function ba(){this.startNextWfTimeout()}},{key:"stop",value:function ca(){this._stop()}},{key:"_getCampaignId",value:function da(a){var b,c;try{return b=new u["default"](a,this.store),c=b.fetchResults(),c&&c.cipid?c.cipid:-1}catch(d){return-1}}}]),a}(),c["default"]=x,b.exports=c["default"]},{"../player/Post":22,"../player/Tracker":27,"../player/dastDecoder":34,"../player/utils":38,"./VpaidLog":61,"./WaterfallStats":64,"./WfLog":65}],64:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);
return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i;Object.defineProperty(c,"__esModule",{value:!0}),f=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=a("../player/utils"),h=d(g),i=function(){function a(b,c){e(this,a),this.id=Date.now()+"_"+h.generateGuid(20),this.index=c,this.store=b,this.vpaidsCount=0,this.reportedVpaidsCount=0,this.success=0,this.fails=0,this.isSuccessed=!1}return f(a,[{key:"increaseVpaidsCount",value:function b(){this.vpaidsCount++}},{key:"increaseSuccess",value:function c(){this.success++,this._update()}},{key:"increaseFailure",value:function d(){this.fails++,this._update()}},{key:"_update",value:function g(){this.reportedVpaidsCount++,this.isSuccessed||(1===this.success?(this.store.incr("waterfallSuccessesInARow"),this.store.set("waterfallFailsInARow",0),this.isSuccessed=!0):this.reportedVpaidsCount===this.vpaidsCount&&(this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0)))}},{key:"getData",value:function i(){return{id:this.id,index:this.index,allVpaidsReported:this.vpaidsCount===this.reportedVpaidsCount,wf_sr:this.store.get("waterfallSuccessesInARow"),wf_fr:this.store.get("waterfallFailsInARow")}}}]),a}(),c["default"]=i,b.exports=c["default"]},{"../player/utils":38}],65:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f,g,h,i,j,k,l;Object.defineProperty(c,"__esModule",{value:!0}),f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("../player/utils"),i=d(h),j=0,k=1e4,l=function(){function a(b){var c=this;e(this,a),this.index=j++,this.numberOfConnectedVpaids=0,this.dataChanged=!0,this.store=b,this.created=Date.now(),this.data={_id:i.generateGuid(10),player_id:this.store.get("player_id"),isMobile:this.store.get("isMobile"),created:(new Date).toISOString(),unitType:this.store.get("unit_type"),fullPageUrl:this.store.get("fullPageUrl"),updatesCount:0,taboolaVpaid:this.store.get("istblvpd")},this.sendDataInterval=setInterval(function(){c.dataChanged&&c._sendData()},k)}return g(a,[{key:"push",value:function b(a,c){this.data.hasOwnProperty(a)&&!this._hasValueChanged(this.data,a,c)||(this.dataChanged=!0),this.data[a]=c}},{key:"_hasValueChanged",value:function c(a,b,d){var e,g;if("object"!==("undefined"==typeof d?"undefined":f(d)))return a[b]!==d;if(Array.isArray(d)){for(e=0;e<d.length;e++)if(a[b].indexOf(d[e])<0)return!0;return!1}for(g in d)if(this._hasValueChanged(this.data[b],g,d[g]))return!0;return!1}},{key:"get",value:function d(a,b){return this.data.hasOwnProperty(a)?this.data[a]:b}},{key:"_sendData",value:function h(){this.data&&(this.data.updatesCount++,i.reportDebug("player_waterfall","WfLog",this.data,this.store),this.dataChanged=!1)}},{key:"sendDataOnConversion",value:function l(){var a=this;setTimeout(function(){a._sendData()},2e3)}},{key:"increaseNumberOfConnectedVpaids",value:function m(){this.numberOfConnectedVpaids++}},{key:"complete",value:function n(){0==--this.numberOfConnectedVpaids&&(this._sendData(),this.data=this.store=void 0,this.sendDataInterval=clearInterval(this.sendDataInterval))}}]),a}(),c["default"]=l,b.exports=c["default"]},{"../player/utils":38}],66:[function(a,b,c){"use strict";function d(a){var b,c;if(a&&a.__esModule)return a;if(b={},null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b,c){k.indexOf(a)>-1||k.push(a)}function f(a,b,c){k.indexOf(a)>-1||k.push(a)}function g(a){var b=j.crc32(a);k.indexOf(b)>-1||l.push(a)}function h(a,b,c,d){var e=j.crc32(a),f=e+":"+b;return m.indexOf(f)>-1?void j.reportDebug("player_waterfall","doubleOppsPerVidDast",{crcVidDast:e,oppsID:b,tagItem:j.stringify(c)},d):void m.push(f)}var i,j,k,l,m;Object.defineProperty(c,"__esModule",{value:!0}),c.reportOppsPerVidDastDuplications=c.reportCleanPixel=c.reportVast=c.reportPixel=void 0,i=a("../player/utils"),j=d(i),k=[],l=[],m=[],c.reportPixel=e,c.reportVast=g,c.reportCleanPixel=f,c.reportOppsPerVidDastDuplications=h},{"../player/utils":38}],67:[function(a,b,c){"use strict";function d(a,b){return new f.Player(a,b)}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f={Player:null,VideoElement:null,BitBuffer:null,Source:{},Demuxer:{},Decoder:{},Renderer:{},AudioOutput:{},Now:function g(){return window.performance?window.performance.now()/1e3:Date.now()/1e3},CreateVideoElements:function h(){var a,b=document.querySelectorAll(".jsmpeg");for(a=0;a<b.length;a++)new f.VideoElement(b[a])},Fill:function i(a,b){if(a.fill)a.fill(b);else for(var c=0;c<a.length;c++)a[c]=b}};"complete"===document.readyState?f.CreateVideoElements():document.addEventListener("DOMContentLoaded",f.CreateVideoElements),f.VideoElement=function(){var a=function b(a){var c,d,e,g,h=a.dataset.url;if(!h)throw"VideoElement has no `data-url` attribute";c=function j(a,b){for(var c in b)a.style[c]=b[c]},this.container=a,c(this.container,{display:"inline-block",position:"relative",minWidth:"80px",minHeight:"80px"}),this.canvas=document.createElement("canvas"),this.canvas.width=960,this.canvas.height=540,c(this.canvas,{display:"block",width:"100%"}),this.container.appendChild(this.canvas),this.playButton=document.createElement("div"),this.playButton.innerHTML=b.PLAY_BUTTON,c(this.playButton,{zIndex:2,position:"absolute",top:"0",bottom:"0",left:"0",right:"0",maxWidth:"75px",maxHeight:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.playButton),d={canvas:this.canvas};for(e in a.dataset)try{d[e]=JSON.parse(a.dataset[e])}catch(i){d[e]=a.dataset[e]}this.player=new f.Player(h,d),!d.poster||d.autoplay||this.player.options.streaming||(d.decodeFirstFrame=!1,this.poster=new Image,this.poster.src=d.poster,this.poster.addEventListener("load",this.posterLoaded),c(this.poster,{display:"block",zIndex:1,position:"absolute",top:0,left:0,bottom:0,right:0}),this.container.appendChild(this.poster)),this.player.options.streaming||this.container.addEventListener("click",this.onClick.bind(this)),(d.autoplay||this.player.options.streaming)&&(this.playButton.style.display="none"),this.player.audioOut&&!this.player.audioOut.unlocked&&(g=this.container,(d.autoplay||this.player.options.streaming)&&(this.unmuteButton=document.createElement("div"),this.unmuteButton.innerHTML=b.UNMUTE_BUTTON,c(this.unmuteButton,{zIndex:2,position:"absolute",bottom:"10px",right:"20px",width:"75px",height:"75px",margin:"auto",opacity:"0.7",cursor:"pointer"}),this.container.appendChild(this.unmuteButton),g=this.unmuteButton),this.unlockAudioBound=this.onUnlockAudio.bind(this,g),g.addEventListener("touchstart",this.unlockAudioBound,!1),g.addEventListener("click",this.unlockAudioBound,!0))};return a.prototype.onUnlockAudio=function(a,b){this.unmuteButton&&(b.preventDefault(),b.stopPropagation()),this.player.audioOut.unlock(function(){this.unmuteButton&&(this.unmuteButton.style.display="none"),a.removeEventListener("touchstart",this.unlockAudioBound),a.removeEventListener("click",this.unlockAudioBound)}.bind(this))},a.prototype.onClick=function(a){this.player.isPlaying?(this.player.pause(),this.playButton.style.display="block"):(this.player.play(),this.playButton.style.display="none",this.poster&&(this.poster.style.display="none"))},a.PLAY_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 200 200" alt="Play video"><circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"/><polygon points="70, 55 70, 145 145, 100" fill="#fff"/></svg>',a.UNMUTE_BUTTON='<svg style="max-width: 75px; max-height: 75px;" viewBox="0 0 75 75"><polygon class="audio-speaker" stroke="none" fill="#fff" points="39,13 22,28 6,28 6,47 21,47 39,62 39,13"/><g stroke="#fff" stroke-width="5"><path d="M 49,50 69,26"/><path d="M 69,50 49,26"/></g></svg>',a}(),f.Player=function(){var a=function b(a,c){this.options=c||{},a.match(/^wss?:\/\//)?(this.source=new f.Source.WebSocket(a,c),c.streaming=!0):c.progressive!==!1?(this.source=new f.Source.AjaxProgressive(a,c),c.streaming=!1):(this.source=new f.Source.Ajax(a,c),c.streaming=!1),this.maxAudioLag=c.maxAudioLag||.25,this.loop=c.loop!==!1,this.autoplay=!!c.autoplay||c.streaming,this.onFinished=c.onfinished,this.demuxer=new f.Demuxer.TS(c),this.source.connect(this.demuxer),c.video!==!1&&(this.video=new f.Decoder.MPEG1Video(c),this.renderer=!c.disableGl&&f.Renderer.WebGL.IsSupported()?new f.Renderer.WebGL(c):new f.Renderer.Canvas2D(c),this.demuxer.connect(f.Demuxer.TS.STREAM.VIDEO_1,this.video),this.video.connect(this.renderer)),c.audio!==!1&&f.AudioOutput.WebAudio.IsSupported()&&(this.audio=new f.Decoder.MP2Audio(c),this.audioOut=new f.AudioOutput.WebAudio(c),this.demuxer.connect(f.Demuxer.TS.STREAM.AUDIO_1,this.audio),this.audio.connect(this.audioOut)),Object.defineProperty(this,"currentTime",{get:this.getCurrentTime,set:this.setCurrentTime}),Object.defineProperty(this,"volume",{get:this.getVolume,set:this.setVolume}),this.unpauseOnShow=!1,c.pauseWhenHidden!==!1&&document.addEventListener("visibilitychange",this.showHide.bind(this)),this.source.start(),this.autoplay&&this.play()};return a.prototype.showHide=function(a){"hidden"===document.visibilityState?(this.unpauseOnShow=this.wantsToPlay,this.pause()):this.unpauseOnShow&&this.play()},a.prototype.play=function(a){this.animationId=requestAnimationFrame(this.update.bind(this)),this.wantsToPlay=!0},a.prototype.pause=function(a){cancelAnimationFrame(this.animationId),this.wantsToPlay=!1,this.isPlaying=!1,this.audio&&this.audio.canPlay&&(this.audioOut.stop(),this.seek(this.currentTime))},a.prototype.getVolume=function(){return this.audioOut?this.audioOut.volume:0},a.prototype.setVolume=function(a){this.audioOut&&(this.audioOut.volume=a)},a.prototype.stop=function(a){this.pause(),this.seek(0),this.video&&this.options.decodeFirstFrame!==!1&&this.video.decode()},a.prototype.seek=function(a){var b=this.audio&&this.audio.canPlay?this.audio.startTime:this.video.startTime;this.video&&this.video.seek(a+b),this.audio&&this.audio.seek(a+b),this.startTime=f.Now()-a},a.prototype.getCurrentTime=function(){return this.audio&&this.audio.canPlay?this.audio.currentTime-this.audio.startTime:this.video.currentTime-this.video.startTime},a.prototype.setCurrentTime=function(a){this.seek(a)},a.prototype.update=function(){return this.animationId=requestAnimationFrame(this.update.bind(this)),this.source.established?(this.isPlaying||(this.isPlaying=!0,this.startTime=f.Now()-this.currentTime),void(this.options.streaming?this.updateForStreaming():this.updateForStaticFile())):void(this.renderer&&this.renderer.renderProgress(this.source.progress))},a.prototype.updateForStreaming=function(){if(this.video&&this.video.decode(),this.audio){var a=!1;do this.audioOut.enqueuedTime>this.maxAudioLag&&(this.audioOut.resetEnqueuedTime(),this.audioOut.enabled=!1),a=this.audio.decode();while(a);this.audioOut.enabled=!0}},a.prototype.updateForStaticFile=function(){var a,b,c,d=this,e=!1,g=0;if(this.audio&&this.audio.canPlay){for(;!e&&this.audio.decodedTime-this.audio.currentTime<.25;)e=!this.audio.decode();this.video&&this.video.currentTime<this.audio.currentTime&&(e=!this.video.decode()),g=this.demuxer.currentTime-this.audio.currentTime}else this.video&&(a=f.Now()-this.startTime+this.video.startTime,b=a-this.video.currentTime,c=1/this.video.frameRate,this.video&&b>0&&(b>2*c&&(this.startTime+=b),e=!this.video.decode()),g=this.demuxer.currentTime-a);this.source.resume(g),e&&this.source.completed&&(this.loop?this.seek(0):(this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(function(){d.onFinished()},500),this.pause()))},a}(),f.BitBuffer=function(){var a=function b(a,c){"object"===("undefined"==typeof a?"undefined":e(a))?(this.bytes=a instanceof Uint8Array?a:new Uint8Array(a),this.byteLength=this.bytes.length):(this.bytes=new Uint8Array(a||1048576),this.byteLength=0),this.mode=c||b.MODE.EXPAND,this.index=0};return a.prototype.resize=function(a){var b=new Uint8Array(a);0!==this.byteLength&&(this.byteLength=Math.min(this.byteLength,a),b.set(this.bytes,0,this.byteLength)),this.bytes=b,this.index=Math.min(this.index,this.byteLength<<3)},a.prototype.evict=function(a){var b=this.index>>3,c=this.bytes.length-this.byteLength;return this.index===this.byteLength<<3||a>c+b?(this.byteLength=0,void(this.index=0)):void(0!==b&&(this.bytes.copyWithin?this.bytes.copyWithin(0,b,this.byteLength):this.bytes.set(this.bytes.subarray(b,this.byteLength)),this.byteLength=this.byteLength-b,this.index-=b<<3))},a.prototype.write=function(b){var c,d,f="object"===e(b[0]),g=0,h=this.bytes.length-this.byteLength;if(f)for(g=0,c=0;c<b.length;c++)g+=b[c].byteLength;else g=b.byteLength;if(g>h&&(this.mode===a.MODE.EXPAND?(d=Math.max(2*this.bytes.length,g-h),this.resize(d)):this.evict(g)),f)for(c=0;c<b.length;c++)this.appendSingleBuffer(b[c]);else this.appendSingleBuffer(b)},a.prototype.appendSingleBuffer=function(a){a=a instanceof Uint8Array?a:new Uint8Array(a),this.bytes.set(a,this.byteLength),this.byteLength+=a.length},a.prototype.findNextStartCode=function(){for(var a=this.index+7>>3;a<this.byteLength;a++)if(0==this.bytes[a]&&0==this.bytes[a+1]&&1==this.bytes[a+2])return this.index=a+4<<3,this.bytes[a+3];return this.index=this.byteLength<<3,-1},a.prototype.findStartCode=function(a){for(var b=0;;)if(b=this.findNextStartCode(),b===a||b===-1)return b;return-1},a.prototype.nextBytesAreStartCode=function(){var a=this.index+7>>3;return a>=this.byteLength||0==this.bytes[a]&&0==this.bytes[a+1]&&1==this.bytes[a+2]},a.prototype.peek=function(a){for(var b,c,d,e,f,g=this.index,h=0;a;)b=this.bytes[g>>3],c=8-(7&g),d=c<a?c:a,e=c-d,f=255>>8-d,h=h<<d|(b&f<<e)>>e,g+=d,a-=d;return h},a.prototype.read=function(a){var b=this.peek(a);return this.index+=a,b},a.prototype.skip=function(a){return this.index+=a},a.prototype.rewind=function(a){this.index=Math.max(this.index-a,0)},a.prototype.has=function(a){return(this.byteLength<<3)-this.index>=a},a.MODE={EVICT:1,EXPAND:2},a}(),f.Source.Ajax=function(){var a=function b(a,c){this.url=a,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.onReadyCblk=c.onload};return a.prototype.connect=function(a){this.destination=a},a.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&200===this.request.status&&(this.onLoad(this.request.response),this.onReadyCblk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("GET",this.url),this.request.responseType="arraybuffer",this.request.send()},a.prototype.resume=function(a){},a.prototype.abort=function(){this.request.abort()},a.prototype.onProgress=function(a){this.progress=a.loaded/a.total},a.prototype.onLoad=function(a){this.established=!0,this.completed=!0,this.progress=1,this.destination&&this.destination.write(a)},a}(),f.Source.AjaxProgressive=function(){var a=function b(a,c){this.url=a,this.destination=null,this.request=null,this.completed=!1,this.established=!1,this.progress=0,this.fileSize=0,this.loadedSize=0,this.chunkSize=c.chunkSize||1048576,this.isLoading=!1,this.loadStartTime=0,this.throttled=c.throttled!==!1};return a.prototype.connect=function(a){this.destination=a},a.prototype.start=function(){this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&(this.fileSize=parseInt(this.request.getResponseHeader("Content-Length")),this.loadNextChunk())}.bind(this),this.request.onprogress=this.onProgress.bind(this),this.request.open("HEAD",this.url),this.request.send()},a.prototype.resume=function(a){if(!this.isLoading&&this.throttled){var b=8*this.loadTime+2;b>a&&this.loadNextChunk()}},a.prototype.abort=function(){this.request.abort()},a.prototype.loadNextChunk=function(){var a=this.loadedSize,b=Math.min(this.loadedSize+this.chunkSize-1,this.fileSize-1);return a>=this.fileSize?void(this.completed=!0):(this.isLoading=!0,this.loadStartTime=f.Now(),this.request=new XMLHttpRequest,this.request.onreadystatechange=function(){this.request.readyState===this.request.DONE&&this.request.status>=200&&this.request.status<300?this.onChunkLoad(this.request.response):this.request.readyState===this.request.DONE&&this.loadFails++<3&&this.loadNextChunk()}.bind(this),0===a&&(this.request.onprogress=this.onProgress.bind(this)),this.request.open("GET",this.url+"?"+a+"-"+b),this.request.setRequestHeader("Range","bytes="+a+"-"+b),this.request.responseType="arraybuffer",void this.request.send())},a.prototype.onProgress=function(a){this.progress=a.loaded/a.total},a.prototype.onChunkLoad=function(a){this.established=!0,this.progress=1,this.loadedSize+=a.byteLength,this.loadFails=0,this.isLoading=!1,this.destination&&this.destination.write(a),this.loadTime=f.Now()-this.loadStartTime,this.throttled||this.loadNextChunk()},a}(),f.Source.WebSocket=function(){var a=function b(a,c){this.url=a,this.socket=null,this.callbacks={connect:[],data:[]},this.destination=null,this.reconnectInterval=c.reconnectInterval||5,this.shouldAttemptReconnect=!!this.reconnectInterval,this.completed=!1,this.established=!1,this.progress=0};return a.prototype.connect=function(a){this.destination=a},a.prototype.abort=function(){this.shouldAttemptReconnect=!1,this.socket.close()},a.prototype.start=function(){this.shouldAttemptReconnect=!!this.reconnectInterval,this.progress=0,this.established=!1,this.socket=new WebSocket(this.url),this.socket.binaryType="arraybuffer",this.socket.onmessage=this.onMessage.bind(this),this.socket.onopen=this.onOpen.bind(this),this.socket.onerror=this.onClose.bind(this),this.socket.onclose=this.onClose.bind(this)},a.prototype.resume=function(a){},a.prototype.onOpen=function(){this.progress=1,this.established=!0},a.prototype.onClose=function(){this.shouldAttemptReconnect&&setTimeout(function(){this.start()}.bind(this),1e3*this.reconnectInterval)},a.prototype.onMessage=function(a){this.destination&&this.destination.write(a.data)},a}(),f.Demuxer.TS=function(){var a=function b(a){this.bits=null,this.leftoverBytes=null,this.guessVideoFrameEnd=!0,this.pidsToStreamIds={},this.pesPacketInfo={},this.startTime=0,this.currentTime=0};return a.prototype.connect=function(a,b){this.pesPacketInfo[a]={destination:b,currentLength:0,totalLength:0,pts:0,buffers:[]}},a.prototype.write=function(a){var b,c;for(this.leftoverBytes?(b=a.byteLength+this.leftoverBytes.byteLength,this.bits=new f.BitBuffer(b),this.bits.write([this.leftoverBytes,a])):this.bits=new f.BitBuffer(a);this.bits.has(1504);)this.parsePacket();c=this.bits.byteLength-(this.bits.index>>3),this.leftoverBytes=c>0?this.bits.bytes.subarray(this.bits.index>>3):null},a.prototype.parsePacket=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=(this.bits.index>>3)+188;if(71!==this.bits.read(8))throw"Sync Token not found";a=this.bits.read(1),b=this.bits.read(1),c=this.bits.read(1),d=this.bits.read(13),e=this.bits.read(2),f=this.bits.read(2),g=this.bits.read(4),h=this.pidsToStreamIds[d],b&&h&&(i=this.pesPacketInfo[h],i&&i.currentLength&&this.packetComplete(i)),1&f&&(2&f&&(j=this.bits.read(8),this.bits.skip(j<<3)),b&&this.bits.nextBytesAreStartCode()&&(this.bits.skip(24),h=this.bits.read(8),this.pidsToStreamIds[d]=h,k=this.bits.read(16),this.bits.skip(8),l=this.bits.read(2),this.bits.skip(6),m=this.bits.read(8),n=this.bits.index+(m<<3),i=this.pesPacketInfo[h],i&&(o=0,2&l&&(this.bits.skip(4),p=this.bits.read(3),this.bits.skip(1),q=this.bits.read(15),this.bits.skip(1),r=this.bits.read(15),this.bits.skip(1),o=(1073741824*p+32768*q+r)/9e4,this.currentTime=o,this.startTime===-1&&(this.startTime=o)),s=k?k-m-3:0,this.packetStart(i,o,s)),this.bits.index=n),h&&(i=this.pesPacketInfo[h],i&&(t=this.bits.index>>3,u=this.packetAddData(i,t,w),v=!b&&2&f,(u||this.guessVideoFrameEnd&&v)&&this.packetComplete(i)))),this.bits.index=w<<3},a.prototype.packetStart=function(a,b,c){a.totalLength=c,a.currentLength=0,a.pts=b},a.prototype.packetAddData=function(a,b,c){a.buffers.push(this.bits.bytes.subarray(b,c)),a.currentLength+=c-b;var d=0!==a.totalLength&&a.currentLength>=a.totalLength;return d},a.prototype.packetComplete=function(a){a.destination.write(a.pts,a.buffers),a.totalLength=0,a.currentLength=0,a.buffers=[]},a.STREAM={PACK_HEADER:186,SYSTEM_HEADER:187,PROGRAM_MAP:188,PRIVATE_1:189,PADDING:190,PRIVATE_2:191,AUDIO_1:192,VIDEO_1:224,DIRECTORY:255},a}(),f.Decoder.Base=function(){var a=function b(a){this.destination=null,this.canPlay=!1,this.collectTimestamps=!a.streaming,this.timestamps=[],this.timestampIndex=0,this.startTime=0,this.decodedTime=0,Object.defineProperty(this,"currentTime",{get:this.getCurrentTime})};return a.prototype.connect=function(a){this.destination=a},a.prototype.write=function(a,b){this.collectTimestamps&&(0===this.timestamps.length&&(this.startTime=a,this.decodedTime=a),this.timestamps.push({index:this.bits.byteLength<<3,time:a})),this.bits.write(b),this.canPlay=!0},a.prototype.seek=function(a){var b,c;if(this.collectTimestamps){for(this.timestampIndex=0,b=0;b<this.timestamps.length&&!(this.timestamps[b].time>a);b++)this.timestampIndex=b;c=this.timestamps[this.timestampIndex],c?(this.bits.index=c.index,this.decodedTime=c.time):(this.bits.index=0,this.decodedTime=this.startTime)}},a.prototype.decode=function(){this.advanceDecodedTime(0)},a.prototype.advanceDecodedTime=function(a){var b,c;if(this.collectTimestamps){for(b=-1,c=this.timestampIndex;c<this.timestamps.length&&!(this.timestamps[c].index>this.bits.index);c++)b=c;if(b!==-1&&b!==this.timestampIndex)return this.timestampIndex=b,void(this.decodedTime=this.timestamps[this.timestampIndex].time)}this.decodedTime+=a},a.prototype.getCurrentTime=function(){return this.decodedTime},a}(),f.Decoder.MPEG1Video=function(){var a=function b(a){var b,c;f.Decoder.Base.call(this,a),b=a.videoBufferSize||524288,c=a.streaming?f.BitBuffer.MODE.EVICT:f.BitBuffer.MODE.EXPAND,this.bits=new f.BitBuffer(b,c),this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.currentFrame=0,this.decodeFirstFrame=a.decodeFirstFrame!==!1};return a.prototype=Object.create(f.Decoder.Base.prototype),a.prototype.constructor=a,a.prototype.write=function(b,c){if(f.Decoder.Base.prototype.write.call(this,b,c),!this.hasSequenceHeader){if(this.bits.findStartCode(a.START.SEQUENCE)===-1)return!1;this.decodeSequenceHeader(),this.decodeFirstFrame&&this.decode()}},a.prototype.decode=function(){if(!this.hasSequenceHeader)return!1;if(this.bits.findStartCode(a.START.PICTURE)===-1){var b=this.bits.byteLength-(this.bits.index>>3);return!1}return this.decodePicture(),this.advanceDecodedTime(1/this.frameRate),!0},a.prototype.readHuffman=function(a){var b=0;do b=a[b+this.bits.read(1)];while(b>=0&&0!==a[b]);return a[b+2]},a.prototype.frameRate=30,a.prototype.decodeSequenceHeader=function(){var b,c,d=this.bits.read(12),e=this.bits.read(12);if(this.bits.skip(4),this.frameRate=a.PICTURE_RATE[this.bits.read(4)],this.bits.skip(30),d===this.width&&e===this.height||(this.width=d,this.height=e,this.initBuffers(),this.destination&&this.destination.resize(d,e)),this.bits.read(1)){for(b=0;b<64;b++)this.customIntraQuantMatrix[a.ZIG_ZAG[b]]=this.bits.read(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.bits.read(1)){for(b=0;b<64;b++)c=a.ZIG_ZAG[b],this.customNonIntraQuantMatrix[c]=this.bits.read(8);this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}this.hasSequenceHeader=!0},a.prototype.initBuffers=function(){this.intraQuantMatrix=a.DEFAULT_INTRA_QUANT_MATRIX,this.nonIntraQuantMatrix=a.DEFAULT_NON_INTRA_QUANT_MATRIX,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.currentY=new Uint8ClampedArray(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new Uint8ClampedArray(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new Uint8ClampedArray(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new Uint8ClampedArray(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new Uint8ClampedArray(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new Uint8ClampedArray(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer)},a.prototype.currentY=null,a.prototype.currentCr=null,a.prototype.currentCb=null,a.prototype.pictureType=0,a.prototype.forwardY=null,a.prototype.forwardCr=null,a.prototype.forwardCb=null,a.prototype.fullPelForward=!1,a.prototype.forwardFCode=0,a.prototype.forwardRSize=0,a.prototype.forwardF=0,a.prototype.decodePicture=function(b){var c,d,e,f,g,h,i;if(this.currentFrame++,this.bits.skip(10),this.pictureType=this.bits.read(3),this.bits.skip(16),!(this.pictureType<=0||this.pictureType>=a.PICTURE_TYPE.B)){if(this.pictureType===a.PICTURE_TYPE.PREDICTIVE){if(this.fullPelForward=this.bits.read(1),this.forwardFCode=this.bits.read(3),0===this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}c=0;do c=this.bits.findNextStartCode();while(c===a.START.EXTENSION||c===a.START.USER_DATA);for(;c>=a.START.SLICE_FIRST&&c<=a.START.SLICE_LAST;)this.decodeSlice(255&c),c=this.bits.findNextStartCode();c!==-1&&this.bits.rewind(32),this.destination&&this.destination.render(this.currentY,this.currentCr,this.currentCb),this.pictureType!==a.PICTURE_TYPE.INTRA&&this.pictureType!==a.PICTURE_TYPE.PREDICTIVE||(d=this.forwardY,e=this.forwardY32,f=this.forwardCr,g=this.forwardCr32,h=this.forwardCb,i=this.forwardCb32,this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=d,this.currentY32=e,this.currentCr=f,this.currentCr32=g,this.currentCb=h,this.currentCb32=i)}},a.prototype.quantizerScale=0,a.prototype.sliceBegin=!1,a.prototype.decodeSlice=function(a){for(this.sliceBegin=!0,this.macroblockAddress=(a-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.bits.read(5);this.bits.read(1);)this.bits.skip(8);do this.decodeMacroblock();while(!this.bits.nextBytesAreStartCode())},a.prototype.macroblockAddress=0,a.prototype.mbRow=0,a.prototype.mbCol=0,a.prototype.macroblockType=0,a.prototype.macroblockIntra=!1,a.prototype.macroblockMotFw=!1,a.prototype.motionFwH=0,a.prototype.motionFwV=0,a.prototype.motionFwHPrev=0,a.prototype.motionFwVPrev=0,a.prototype.decodeMacroblock=function(){for(var b,c,d,e,f=0,g=this.readHuffman(a.MACROBLOCK_ADDRESS_INCREMENT);34===g;)g=this.readHuffman(a.MACROBLOCK_ADDRESS_INCREMENT);for(;35===g;)f+=33,g=this.readHuffman(a.MACROBLOCK_ADDRESS_INCREMENT);if(f+=g,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=f;else{if(this.macroblockAddress+f>=this.mbSize)return;for(f>1&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureType===a.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));f>1;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),f--;this.macroblockAddress++}for(this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,b=a.MACROBLOCK_TYPE[this.pictureType],this.macroblockType=this.readHuffman(b),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!==(16&this.macroblockType)&&(this.quantizerScale=this.bits.read(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb)),c=0!==(2&this.macroblockType)?this.readHuffman(a.CODE_BLOCK_PATTERN):this.macroblockIntra?63:0,d=0,e=32;d<6;d++)0!==(c&e)&&this.decodeBlock(d),e>>=1},a.prototype.decodeMotionVectors=function(){var b,c,d=0;this.macroblockMotFw?(b=this.readHuffman(a.MOTION),0!==b&&1!==this.forwardF?(d=this.bits.read(this.forwardRSize),c=(Math.abs(b)-1<<this.forwardRSize)+d+1,b<0&&(c=-c)):c=b,this.motionFwHPrev+=c,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),b=this.readHuffman(a.MOTION),0!==b&&1!==this.forwardF?(d=this.bits.read(this.forwardRSize),c=(Math.abs(b)-1<<this.forwardRSize)+d+1,b<0&&(c=-c)):c=b,this.motionFwVPrev+=c,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureType===a.PICTURE_TYPE.PREDICTIVE&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},a.prototype.copyMacroblock=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this.currentY32,q=this.currentCb32,r=this.currentCr32,s=this.codedWidth,t=s-16,u=a>>1,v=b>>1,w=1===(1&a),x=1===(1&b),y=((this.mbRow<<4)+v)*s+(this.mbCol<<4)+u,z=this.mbRow*s+this.mbCol<<2,A=z+(s<<2);if(w)if(x)for(;z<A;){for(g=c[y]+c[y+s],y++,f=0;f<4;f++)h=c[y]+c[y+s],y++,i=g+h+2>>2&255,g=c[y]+c[y+s],y++,i|=g+h+2<<6&65280,h=c[y]+c[y+s],y++,i|=g+h+2<<14&16711680,g=c[y]+c[y+s],y++,i|=g+h+2<<22&4278190080,p[z++]=i;z+=t>>2,y+=t-1}else for(;z<A;){for(g=c[y++],f=0;f<4;f++)h=c[y++],i=g+h+1>>1&255,g=c[y++],i|=g+h+1<<7&65280,h=c[y++],i|=g+h+1<<15&16711680,g=c[y++],i|=g+h+1<<23&4278190080,p[z++]=i;z+=t>>2,y+=t-1}else if(x)for(;z<A;){for(f=0;f<4;f++)i=c[y]+c[y+s]+1>>1&255,y++,i|=c[y]+c[y+s]+1<<7&65280,y++,i|=c[y]+c[y+s]+1<<15&16711680,y++,i|=c[y]+c[y+s]+1<<23&4278190080,y++,p[z++]=i;z+=t>>2,y+=t}else for(;z<A;){for(f=0;f<4;f++)i=c[y],y++,i|=c[y]<<8,y++,i|=c[y]<<16,y++,i|=c[y]<<24,y++,p[z++]=i;z+=t>>2,y+=t}if(s=this.halfWidth,t=s-8,u=a/2>>1,v=b/2>>1,w=1===(a/2&1),x=1===(b/2&1),y=((this.mbRow<<3)+v)*s+(this.mbCol<<3)+u,z=this.mbRow*s+this.mbCol<<1,A=z+(s<<1),w)if(x)for(;z<A;){for(j=d[y]+d[y+s],m=e[y]+e[y+s],y++,f=0;f<2;f++)k=d[y]+d[y+s],n=e[y]+e[y+s],y++,l=j+k+2>>2&255,o=m+n+2>>2&255,j=d[y]+d[y+s],m=e[y]+e[y+s],y++,l|=j+k+2<<6&65280,o|=m+n+2<<6&65280,k=d[y]+d[y+s],n=e[y]+e[y+s],y++,l|=j+k+2<<14&16711680,o|=m+n+2<<14&16711680,j=d[y]+d[y+s],m=e[y]+e[y+s],y++,l|=j+k+2<<22&4278190080,o|=m+n+2<<22&4278190080,r[z]=l,q[z]=o,z++;z+=t>>2,y+=t-1}else for(;z<A;){for(j=d[y],m=e[y],y++,f=0;f<2;f++)k=d[y],n=e[y++],l=j+k+1>>1&255,o=m+n+1>>1&255,j=d[y],m=e[y++],l|=j+k+1<<7&65280,o|=m+n+1<<7&65280,k=d[y],n=e[y++],l|=j+k+1<<15&16711680,o|=m+n+1<<15&16711680,j=d[y],m=e[y++],
l|=j+k+1<<23&4278190080,o|=m+n+1<<23&4278190080,r[z]=l,q[z]=o,z++;z+=t>>2,y+=t-1}else if(x)for(;z<A;){for(f=0;f<2;f++)l=d[y]+d[y+s]+1>>1&255,o=e[y]+e[y+s]+1>>1&255,y++,l|=d[y]+d[y+s]+1<<7&65280,o|=e[y]+e[y+s]+1<<7&65280,y++,l|=d[y]+d[y+s]+1<<15&16711680,o|=e[y]+e[y+s]+1<<15&16711680,y++,l|=d[y]+d[y+s]+1<<23&4278190080,o|=e[y]+e[y+s]+1<<23&4278190080,y++,r[z]=l,q[z]=o,z++;z+=t>>2,y+=t}else for(;z<A;){for(f=0;f<2;f++)l=d[y],o=e[y],y++,l|=d[y]<<8,o|=e[y]<<8,y++,l|=d[y]<<16,o|=e[y]<<16,y++,l|=d[y]<<24,o|=e[y]<<24,y++,r[z]=l,q[z]=o,z++;z+=t>>2,y+=t}},a.prototype.dcPredictorY=0,a.prototype.dcPredictorCr=0,a.prototype.dcPredictorCb=0,a.prototype.blockData=null,a.prototype.decodeBlock=function(b){var c,d,e,g,h,i,j,k,l,m,n,o=0;for(this.macroblockIntra?(b<4?(d=this.dcPredictorY,e=this.readHuffman(a.DCT_DC_SIZE_LUMINANCE)):(d=4===b?this.dcPredictorCr:this.dcPredictorCb,e=this.readHuffman(a.DCT_DC_SIZE_CHROMINANCE)),e>0?(g=this.bits.read(e),0!==(g&1<<e-1)?this.blockData[0]=d+g:this.blockData[0]=d+(-1<<e|g+1)):this.blockData[0]=d,b<4?this.dcPredictorY=this.blockData[0]:4===b?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,c=this.intraQuantMatrix,o=1):c=this.nonIntraQuantMatrix,h=0;;){if(i=0,j=this.readHuffman(a.DCT_COEFF),1===j&&o>0&&0===this.bits.read(1))break;65535===j?(i=this.bits.read(6),h=this.bits.read(8),0===h?h=this.bits.read(8):128===h?h=this.bits.read(8)-256:h>128&&(h-=256)):(i=j>>8,h=255&j,this.bits.read(1)&&(h=-h)),o+=i,k=a.ZIG_ZAG[o],o++,h<<=1,this.macroblockIntra||(h+=h<0?-1:1),h=h*this.quantizerScale*c[k]>>4,0===(1&h)&&(h-=h>0?1:-1),h>2047?h=2047:h<-2048&&(h=-2048),this.blockData[k]=h*a.PREMULTIPLIER_MATRIX[k]}b<4?(l=this.currentY,n=this.codedWidth-8,m=this.mbRow*this.codedWidth+this.mbCol<<4,0!==(1&b)&&(m+=8),0!==(2&b)&&(m+=this.codedWidth<<3)):(l=4===b?this.currentCb:this.currentCr,n=(this.codedWidth>>1)-8,m=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1===o?(a.CopyValueToDestination(this.blockData[0]+128>>8,l,m,n),this.blockData[0]=0):(a.IDCT(this.blockData),a.CopyBlockToDestination(this.blockData,l,m,n),f.Fill(this.blockData,0)):1===o?(a.AddValueToDestination(this.blockData[0]+128>>8,l,m,n),this.blockData[0]=0):(a.IDCT(this.blockData),a.AddBlockToDestination(this.blockData,l,m,n),f.Fill(this.blockData,0)),o=0},a.CopyBlockToDestination=function(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]=a[e+0],b[c+1]=a[e+1],b[c+2]=a[e+2],b[c+3]=a[e+3],b[c+4]=a[e+4],b[c+5]=a[e+5],b[c+6]=a[e+6],b[c+7]=a[e+7]},a.AddBlockToDestination=function(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]+=a[e+0],b[c+1]+=a[e+1],b[c+2]+=a[e+2],b[c+3]+=a[e+3],b[c+4]+=a[e+4],b[c+5]+=a[e+5],b[c+6]+=a[e+6],b[c+7]+=a[e+7]},a.CopyValueToDestination=function(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]=a,b[c+1]=a,b[c+2]=a,b[c+3]=a,b[c+4]=a,b[c+5]=a,b[c+6]=a,b[c+7]=a},a.AddValueToDestination=function(a,b,c,d){for(var e=0;e<64;e+=8,c+=d+8)b[c+0]+=a,b[c+1]+=a,b[c+2]+=a,b[c+3]+=a,b[c+4]+=a,b[c+5]+=a,b[c+6]+=a,b[c+7]+=a},a.IDCT=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(t=0;t<8;++t)b=a[32+t],c=a[16+t]+a[48+t],d=a[40+t]-a[24+t],g=a[8+t]+a[56+t],h=a[24+t]+a[40+t],e=a[8+t]-a[56+t],f=g+h,i=a[0+t],n=(473*e-196*d+128>>8)-f,j=n-(362*(g-h)+128>>8),k=i-b,l=(362*(a[16+t]-a[48+t])+128>>8)-c,m=i+b,o=k+l,p=m+c,q=k-l,r=m-c,s=-j-(473*d+196*e+128>>8),a[0+t]=f+p,a[8+t]=n+o,a[16+t]=q-j,a[24+t]=r-s,a[32+t]=r+s,a[40+t]=j+q,a[48+t]=o-n,a[56+t]=p-f;for(t=0;t<64;t+=8)b=a[4+t],c=a[2+t]+a[6+t],d=a[5+t]-a[3+t],g=a[1+t]+a[7+t],h=a[3+t]+a[5+t],e=a[1+t]-a[7+t],f=g+h,i=a[0+t],n=(473*e-196*d+128>>8)-f,j=n-(362*(g-h)+128>>8),k=i-b,l=(362*(a[2+t]-a[6+t])+128>>8)-c,m=i+b,o=k+l,p=m+c,q=k-l,r=m-c,s=-j-(473*d+196*e+128>>8),a[0+t]=f+p+128>>8,a[1+t]=n+o+128>>8,a[2+t]=q-j+128>>8,a[3+t]=r-s+128>>8,a[4+t]=r+s+128>>8,a[5+t]=j+q+128>>8,a[6+t]=o-n+128>>8,a[7+t]=p-f+128>>8},a.PICTURE_RATE=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],a.ZIG_ZAG=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),a.DEFAULT_INTRA_QUANT_MATRIX=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),a.DEFAULT_NON_INTRA_QUANT_MATRIX=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),a.PREMULTIPLIER_MATRIX=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),a.MACROBLOCK_ADDRESS_INCREMENT=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),a.MACROBLOCK_TYPE_INTRA=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),a.MACROBLOCK_TYPE_PREDICTIVE=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),a.MACROBLOCK_TYPE_B=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),a.MACROBLOCK_TYPE=[null,a.MACROBLOCK_TYPE_INTRA,a.MACROBLOCK_TYPE_PREDICTIVE,a.MACROBLOCK_TYPE_B],a.CODE_BLOCK_PATTERN=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),a.MOTION=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),a.DCT_DC_SIZE_LUMINANCE=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),a.DCT_DC_SIZE_CHROMINANCE=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),a.DCT_COEFF=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),a.PICTURE_TYPE={INTRA:1,PREDICTIVE:2,B:3},a.START={SEQUENCE:179,SLICE_FIRST:1,SLICE_LAST:175,PICTURE:0,EXTENSION:181,USER_DATA:178},a}(),f.Decoder.MP2Audio=function(){var a=function b(a){var c,d,e,g;for(f.Decoder.Base.call(this,a),c=a.audioBufferSize||131072,d=a.streaming?f.BitBuffer.MODE.EVICT:f.BitBuffer.MODE.EXPAND,this.bits=new f.BitBuffer(c,d),this.left=new Float32Array(1152),this.right=new Float32Array(1152),this.sampleRate=44100,this.D=new Float32Array(1024),this.D.set(b.SYNTHESIS_WINDOW,0),this.D.set(b.SYNTHESIS_WINDOW,512),this.V=new Float32Array(1024),this.U=new Int32Array(32),this.VPos=0,this.allocation=[new Array(32),new Array(32)],this.scaleFactorInfo=[new Uint8Array(32),new Uint8Array(32)],this.scaleFactor=[new Array(32),new Array(32)],this.sample=[new Array(32),new Array(32)],e=0;e<2;e++)for(g=0;g<32;g++)this.scaleFactor[e][g]=[0,0,0],this.sample[e][g]=[0,0,0]};return a.prototype=Object.create(f.Decoder.Base.prototype),a.prototype.constructor=a,a.prototype.decode=function(){var a,b=this.bits.index>>3;return!(b>=this.bits.byteLength)&&(a=this.decodeFrame(this.left,this.right),this.bits.index=b+a<<3,!!a&&(this.destination&&this.destination.play(this.sampleRate,this.left,this.right),this.advanceDecodedTime(this.left.length/this.sampleRate),!0))},a.prototype.getCurrentTime=function(){var a=this.destination?this.destination.enqueuedTime:0;return this.decodedTime-a},a.prototype.decodeFrame=function(b,c){var d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this.bits.read(11),F=this.bits.read(2),G=this.bits.read(2),H=!this.bits.read(1);if(E!==a.FRAME_SYNC||F!==a.VERSION.MPEG_1||G!==a.LAYER.II)return 0;if(d=this.bits.read(4)-1,d>13)return 0;if(e=this.bits.read(2),g=a.SAMPLE_RATE[e],3===e)return 0;for(F===a.VERSION.MPEG_2&&(e+=4,d+=14),h=this.bits.read(1),i=this.bits.read(1),j=this.bits.read(2),k=0,j===a.MODE.JOINT_STEREO?k=this.bits.read(2)+1<<2:(this.bits.skip(2),k=j===a.MODE.MONO?0:32),this.bits.skip(4),H&&this.bits.skip(16),l=a.BIT_RATE[d],g=a.SAMPLE_RATE[e],m=144e3*l/g+h|0,n=0,o=0,F===a.VERSION.MPEG_2?(n=2,o=30):(p=j===a.MODE.MONO?0:1,q=a.QUANT_LUT_STEP_1[p][d],n=a.QUANT_LUT_STEP_2[q][e],o=63&n,n>>=6),k>o&&(k=o),r=0;r<k;r++)this.allocation[0][r]=this.readAllocation(r,n),this.allocation[1][r]=this.readAllocation(r,n);for(r=k;r<o;r++)this.allocation[0][r]=this.allocation[1][r]=this.readAllocation(r,n);for(s=j===a.MODE.MONO?1:2,r=0;r<o;r++){for(t=0;t<s;t++)this.allocation[t][r]&&(this.scaleFactorInfo[t][r]=this.bits.read(2));j===a.MODE.MONO&&(this.scaleFactorInfo[1][r]=this.scaleFactorInfo[0][r])}for(r=0;r<o;r++){for(t=0;t<s;t++)if(this.allocation[t][r])switch(u=this.scaleFactor[t][r],this.scaleFactorInfo[t][r]){case 0:u[0]=this.bits.read(6),u[1]=this.bits.read(6),u[2]=this.bits.read(6);break;case 1:u[0]=u[1]=this.bits.read(6),u[2]=this.bits.read(6);break;case 2:u[0]=u[1]=u[2]=this.bits.read(6);break;case 3:u[0]=this.bits.read(6),u[1]=u[2]=this.bits.read(6)}j===a.MODE.MONO&&(this.scaleFactor[1][r][0]=this.scaleFactor[0][r][0],this.scaleFactor[1][r][1]=this.scaleFactor[0][r][1],this.scaleFactor[1][r][2]=this.scaleFactor[0][r][2])}for(v=0,w=0;w<3;w++)for(x=0;x<4;x++){for(r=0;r<k;r++)this.readSamples(0,r,w),this.readSamples(1,r,w);for(r=k;r<o;r++)this.readSamples(0,r,w),this.sample[1][r][0]=this.sample[0][r][0],this.sample[1][r][1]=this.sample[0][r][1],this.sample[1][r][2]=this.sample[0][r][2];for(r=o;r<32;r++)this.sample[0][r][0]=0,this.sample[0][r][1]=0,this.sample[0][r][2]=0,this.sample[1][r][0]=0,this.sample[1][r][1]=0,this.sample[1][r][2]=0;for(y=0;y<3;y++){for(this.VPos=this.VPos-64&1023,t=0;t<2;t++){for(a.MatrixTransform(this.sample[t],y,this.V,this.VPos),f.Fill(this.U,0),z=512-(this.VPos>>1),A=this.VPos%128>>1;A<1024;){for(B=0;B<32;++B)this.U[B]+=this.D[z++]*this.V[A++];A+=96,z+=32}for(A=1120-A,z-=480;A<1024;){for(B=0;B<32;++B)this.U[B]+=this.D[z++]*this.V[A++];A+=96,z+=32}for(C=0===t?b:c,D=0;D<32;D++)C[v+D]=this.U[D]/2147418112}v+=32}}return this.sampleRate=g,m},a.prototype.readAllocation=function(b,c){var d=a.QUANT_LUT_STEP_3[c][b],e=a.QUANT_LUT_STEP4[15&d][this.bits.read(d>>4)];return e?a.QUANT_TAB[e-1]:0},a.prototype.readSamples=function(b,c,d){var e,f,g,h=this.allocation[b][c],i=this.scaleFactor[b][c][d],j=this.sample[b][c],k=0;return h?(63===i?i=0:(e=i/3|0,i=a.SCALEFACTOR_BASE[i%3]+(1<<e>>1)>>e),f=h.levels,h.group?(k=this.bits.read(h.bits),j[0]=k%f,k=k/f|0,j[1]=k%f,j[2]=k/f|0):(j[0]=this.bits.read(h.bits),j[1]=this.bits.read(h.bits),j[2]=this.bits.read(h.bits)),g=65536/(f+1)|0,f=(f+1>>1)-1,k=(f-j[0])*g,j[0]=k*(i>>12)+(k*(4095&i)+2048>>12)>>12,k=(f-j[1])*g,j[1]=k*(i>>12)+(k*(4095&i)+2048>>12)>>12,k=(f-j[2])*g,void(j[2]=k*(i>>12)+(k*(4095&i)+2048>>12)>>12)):void(j[0]=j[1]=j[2]=0)},a.MatrixTransform=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;e=a[0][b]+a[31][b],f=.500602998235*(a[0][b]-a[31][b]),g=a[1][b]+a[30][b],h=.505470959898*(a[1][b]-a[30][b]),i=a[2][b]+a[29][b],j=.515447309923*(a[2][b]-a[29][b]),k=a[3][b]+a[28][b],l=.53104259109*(a[3][b]-a[28][b]),m=a[4][b]+a[27][b],n=.553103896034*(a[4][b]-a[27][b]),o=a[5][b]+a[26][b],p=.582934968206*(a[5][b]-a[26][b]),q=a[6][b]+a[25][b],r=.622504123036*(a[6][b]-a[25][b]),s=a[7][b]+a[24][b],t=.674808341455*(a[7][b]-a[24][b]),u=a[8][b]+a[23][b],v=.744536271002*(a[8][b]-a[23][b]),w=a[9][b]+a[22][b],x=.839349645416*(a[9][b]-a[22][b]),y=a[10][b]+a[21][b],z=.972568237862*(a[10][b]-a[21][b]),A=a[11][b]+a[20][b],B=1.16943993343*(a[11][b]-a[20][b]),C=a[12][b]+a[19][b],D=1.48416461631*(a[12][b]-a[19][b]),E=a[13][b]+a[18][b],F=2.05778100995*(a[13][b]-a[18][b]),G=a[14][b]+a[17][b],H=3.40760841847*(a[14][b]-a[17][b]),I=a[15][b]+a[16][b],J=10.1900081235*(a[15][b]-a[16][b]),K=e+I,I=.502419286188*(e-I),e=g+G,G=.52249861494*(g-G),g=i+E,E=.566944034816*(i-E),i=k+C,C=.64682178336*(k-C),k=m+A,A=.788154623451*(m-A),m=o+y,y=1.06067768599*(o-y),o=q+w,w=1.72244709824*(q-w),q=s+u,u=5.10114861869*(s-u),s=K+q,q=.509795579104*(K-q),K=e+o,e=.601344886935*(e-o),o=g+m,m=.899976223136*(g-m),g=i+k,k=2.56291544774*(i-k),i=s+g,s=.541196100146*(s-g),g=K+o,o=1.30656296488*(K-o),K=i+g,i=.707106781187*(i-g),g=s+o,s=.707106781187*(s-o),g+=s,o=q+k,q=.541196100146*(q-k),k=e+m,m=1.30656296488*(e-m),e=o+k,k=.707106781187*(o-k),o=q+m,q=.707106781187*(q-m),o+=q,e+=o,o+=k,k+=q,m=I+u,I=.509795579104*(I-u),u=G+w,G=.601344886935*(G-w),w=E+y,y=.899976223136*(E-y),E=C+A,A=2.56291544774*(C-A),C=m+E,m=.541196100146*(m-E),E=u+w,w=1.30656296488*(u-w),u=C+E,E=.707106781187*(C-E),C=m+w,w=.707106781187*(m-w),C+=w,m=I+A,I=.541196100146*(I-A),A=G+y,y=1.30656296488*(G-y),G=m+A,A=.707106781187*(m-A),m=I+y,I=.707106781187*(I-y),m+=I,G+=m,m+=A,A+=I,u+=G,G+=C,C+=m,m+=E,E+=A,A+=w,w+=I,y=f+J,f=.502419286188*(f-J),J=h+H,h=.52249861494*(h-H),H=j+F,F=.566944034816*(j-F),j=l+D,l=.64682178336*(l-D),D=n+B,n=.788154623451*(n-B),B=p+z,z=1.06067768599*(p-z),p=r+x,x=1.72244709824*(r-x),r=t+v,t=5.10114861869*(t-v),v=y+r,r=.509795579104*(y-r),y=J+p,J=.601344886935*(J-p),p=H+B,B=.899976223136*(H-B),H=j+D,D=2.56291544774*(j-D),j=v+H,v=.541196100146*(v-H),H=y+p,p=1.30656296488*(y-p),y=j+H,H=.707106781187*(j-H),j=v+p,p=.707106781187*(v-p),j+=p,v=r+D,D=.541196100146*(r-D),r=J+B,B=1.30656296488*(J-B),J=v+r,r=.707106781187*(v-r),v=D+B,B=.707106781187*(D-B),v+=B,J+=v,v+=r,D=r+B,r=f+t,f=.509795579104*(f-t),t=h+x,h=.601344886935*(h-x),x=F+z,z=.899976223136*(F-z),F=l+n,n=2.56291544774*(l-n),l=r+F,r=.541196100146*(r-F),F=t+x,x=1.30656296488*(t-x),t=l+F,F=.707106781187*(l-F),l=r+x,x=.707106781187*(r-x),l+=x,r=f+n,f=.541196100146*(f-n),n=h+z,z=1.30656296488*(h-z),h=r+n,n=.707106781187*(r-n),r=f+z,f=.707106781187*(f-z),r+=f,h+=r,r+=n,n+=f,t+=h,h+=l,l+=r,r+=F,F+=n,n+=x,x+=f,y+=t,t+=J,J+=h,h+=j,j+=l,l+=v,v+=r,r+=H,H+=F,F+=D,D+=n,n+=p,p+=x,x+=B,B+=f,c[d+48]=-K,c[d+49]=c[d+47]=-y,c[d+50]=c[d+46]=-u,c[d+51]=c[d+45]=-t,c[d+52]=c[d+44]=-e,c[d+53]=c[d+43]=-J,c[d+54]=c[d+42]=-G,c[d+55]=c[d+41]=-h,c[d+56]=c[d+40]=-g,c[d+57]=c[d+39]=-j,c[d+58]=c[d+38]=-C,c[d+59]=c[d+37]=-l,c[d+60]=c[d+36]=-o,c[d+61]=c[d+35]=-v,c[d+62]=c[d+34]=-m,c[d+63]=c[d+33]=-r,c[d+32]=-i,c[d+0]=i,c[d+31]=-H,c[d+1]=H,c[d+30]=-E,c[d+2]=E,c[d+29]=-F,c[d+3]=F,c[d+28]=-k,c[d+4]=k,c[d+27]=-D,c[d+5]=D,c[d+26]=-A,c[d+6]=A,c[d+25]=-n,c[d+7]=n,c[d+24]=-s,c[d+8]=s,c[d+23]=-p,c[d+9]=p,c[d+22]=-w,c[d+10]=w,c[d+21]=-x,c[d+11]=x,c[d+20]=-q,c[d+12]=q,c[d+19]=-B,c[d+13]=B,c[d+18]=-I,c[d+14]=I,c[d+17]=-f,c[d+15]=f,c[d+16]=0},a.FRAME_SYNC=2047,a.VERSION={MPEG_2_5:0,MPEG_2:2,MPEG_1:3},a.LAYER={III:1,II:2,I:3},a.MODE={STEREO:0,JOINT_STEREO:1,DUAL_CHANNEL:2,MONO:3},a.SAMPLE_RATE=new Uint16Array([44100,48e3,32e3,0,22050,24e3,16e3,0]),a.BIT_RATE=new Uint16Array([32,48,56,64,80,96,112,128,160,192,224,256,320,384,8,16,24,32,40,48,56,64,80,96,112,128,144,160]),a.SCALEFACTOR_BASE=new Uint32Array([33554432,26632170,21137968]),a.SYNTHESIS_WINDOW=new Float32Array([0,-.5,-.5,-.5,-.5,-.5,-.5,-1,-1,-1,-1,-1.5,-1.5,-2,-2,-2.5,-2.5,-3,-3.5,-3.5,-4,-4.5,-5,-5.5,-6.5,-7,-8,-8.5,-9.5,-10.5,-12,-13,-14.5,-15.5,-17.5,-19,-20.5,-22.5,-24.5,-26.5,-29,-31.5,-34,-36.5,-39.5,-42.5,-45.5,-48.5,-52,-55.5,-58.5,-62.5,-66,-69.5,-73.5,-77,-80.5,-84.5,-88,-91.5,-95,-98,-101,-104,106.5,109,111,112.5,113.5,114,114,113.5,112,110.5,107.5,104,100,94.5,88.5,81.5,73,63.5,53,41.5,28.5,14.5,-1,-18,-36,-55.5,-76.5,-98.5,-122,-147,-173.5,-200.5,-229.5,-259.5,-290.5,-322.5,-355.5,-389.5,-424,-459.5,-495.5,-532,-568.5,-605,-641.5,-678,-714,-749,-783.5,-817,-849,-879.5,-908.5,-935,-959.5,-981,-1000.5,-1016,-1028.5,-1037.5,-1042.5,-1043.5,-1040,-1031.5,1018.5,1e3,976,946.5,911,869.5,822,767.5,707,640,565.5,485,397,302.5,201,92.5,-22.5,-144,-272.5,-407,-547.5,-694,-846,-1003,-1165,-1331.5,-1502,-1675.5,-1852.5,-2031.5,-2212.5,-2394,-2576.5,-2758.5,-2939.5,-3118.5,-3294.5,-3467.5,-3635.5,-3798.5,-3955,-4104.5,-4245.5,-4377.5,-4499,-4609.5,-4708,-4792.5,-4863.5,-4919,-4958,-4979.5,-4983,-4967.5,-4931.5,-4875,-4796,-4694.5,-4569.5,-4420,-4246,-4046,-3820,-3567,3287,2979.5,2644,2280.5,1888,1467.5,1018.5,541,35,-499,-1061,-1650,-2266.5,-2909,-3577,-4270,-4987.5,-5727.5,-6490,-7274,-8077.5,-8899.5,-9739,-10594.5,-11464.5,-12347,-13241,-14144.5,-15056,-15973.5,-16895.5,-17820,-18744.5,-19668,-20588,-21503,-22410.5,-23308.5,-24195,-25068.5,-25926.5,-26767,-27589,-28389,-29166.5,-29919,-30644.5,-31342,-32009.5,-32645,-33247,-33814.5,-34346,-34839.5,-35295,-35710,-36084.5,-36417.5,-36707.5,-36954,-37156.5,-37315,-37428,-37496,37519,37496,37428,37315,37156.5,36954,36707.5,36417.5,36084.5,35710,35295,34839.5,34346,33814.5,33247,32645,32009.5,31342,30644.5,29919,29166.5,28389,27589,26767,25926.5,25068.5,24195,23308.5,22410.5,21503,20588,19668,18744.5,17820,16895.5,15973.5,15056,14144.5,13241,12347,11464.5,10594.5,9739,8899.5,8077.5,7274,6490,5727.5,4987.5,4270,3577,2909,2266.5,1650,1061,499,-35,-541,-1018.5,-1467.5,-1888,-2280.5,-2644,-2979.5,3287,3567,3820,4046,4246,4420,4569.5,4694.5,4796,4875,4931.5,4967.5,4983,4979.5,4958,4919,4863.5,4792.5,4708,4609.5,4499,4377.5,4245.5,4104.5,3955,3798.5,3635.5,3467.5,3294.5,3118.5,2939.5,2758.5,2576.5,2394,2212.5,2031.5,1852.5,1675.5,1502,1331.5,1165,1003,846,694,547.5,407,272.5,144,22.5,-92.5,-201,-302.5,-397,-485,-565.5,-640,-707,-767.5,-822,-869.5,-911,-946.5,-976,-1e3,1018.5,1031.5,1040,1043.5,1042.5,1037.5,1028.5,1016,1000.5,981,959.5,935,908.5,879.5,849,817,783.5,749,714,678,641.5,605,568.5,532,495.5,459.5,424,389.5,355.5,322.5,290.5,259.5,229.5,200.5,173.5,147,122,98.5,76.5,55.5,36,18,1,-14.5,-28.5,-41.5,-53,-63.5,-73,-81.5,-88.5,-94.5,-100,-104,-107.5,-110.5,-112,-113.5,-114,-114,-113.5,-112.5,-111,-109,106.5,104,101,98,95,91.5,88,84.5,80.5,77,73.5,69.5,66,62.5,58.5,55.5,52,48.5,45.5,42.5,39.5,36.5,34,31.5,29,26.5,24.5,22.5,20.5,19,17.5,15.5,14.5,13,12,10.5,9.5,8.5,8,7,6.5,5.5,5,4.5,4,3.5,3.5,3,2.5,2.5,2,2,1.5,1.5,1,1,1,1,.5,.5,.5,.5,.5,.5]),a.QUANT_LUT_STEP_1=[[0,0,1,1,1,2,2,2,2,2,2,2,2,2],[0,0,0,0,0,0,1,1,1,2,2,2,2,2]],a.QUANT_TAB={A:91,B:94,C:8,D:12},a.QUANT_LUT_STEP_2=[[a.QUANT_TAB.C,a.QUANT_TAB.C,a.QUANT_TAB.D],[a.QUANT_TAB.A,a.QUANT_TAB.A,a.QUANT_TAB.A],[a.QUANT_TAB.B,a.QUANT_TAB.A,a.QUANT_TAB.B]],a.QUANT_LUT_STEP_3=[[68,68,52,52,52,52,52,52,52,52,52,52],[67,67,67,66,66,66,66,66,66,66,66,49,49,49,49,49,49,49,49,49,49,49,49,32,32,32,32,32,32,32],[69,69,69,69,52,52,52,52,52,52,52,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36]],a.QUANT_LUT_STEP4=[[0,1,2,17],[0,1,2,3,4,5,6,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,17],[0,1,3,5,6,7,8,9,10,11,12,13,14,15,16,17],[0,1,2,4,5,6,7,8,9,10,11,12,13,14,15,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],a.QUANT_TAB=[{levels:3,group:1,bits:5},{levels:5,group:1,bits:7},{levels:7,group:0,bits:3},{levels:9,group:1,bits:10},{levels:15,group:0,bits:4},{levels:31,group:0,bits:5},{levels:63,group:0,bits:6},{levels:127,group:0,bits:7},{levels:255,group:0,bits:8},{levels:511,group:0,bits:9},{levels:1023,group:0,bits:10},{levels:2047,group:0,bits:11},{levels:4095,group:0,bits:12},{levels:8191,group:0,bits:13},{levels:16383,group:0,bits:14},{levels:32767,group:0,bits:15},{levels:65535,group:0,bits:16}],a}(),f.Renderer.WebGL=function(){var a=function b(a){var c,d,e,f,g;if(this.canvas=a.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0,c={preserveDrawingBuffer:!!a.preserveDrawingBuffer,alpha:!1,depth:!1,stencil:!1,antialias:!1},this.gl=this.canvas.getContext("webgl",c)||this.canvas.getContext("experimental-webgl",c),!this.gl)throw new Error("Failed to get WebGL Context");d=this.gl,e=null,f=d.createBuffer(),g=new Float32Array([0,0,0,1,1,0,1,1]),d.bindBuffer(d.ARRAY_BUFFER,f),d.bufferData(d.ARRAY_BUFFER,g,d.STATIC_DRAW),this.program=this.createProgram(b.SHADER.VERTEX_IDENTITY,b.SHADER.FRAGMENT_YCRCB_TO_RGBA),e=d.getAttribLocation(this.program,"vertex"),d.enableVertexAttribArray(e),d.vertexAttribPointer(e,2,d.FLOAT,!1,0,0),this.textureY=this.createTexture(0,"textureY"),this.textureCb=this.createTexture(1,"textureCb"),this.textureCr=this.createTexture(2,"textureCr"),this.loadingProgram=this.createProgram(b.SHADER.VERTEX_IDENTITY,b.SHADER.FRAGMENT_LOADING),e=d.getAttribLocation(this.loadingProgram,"vertex"),d.enableVertexAttribArray(e),d.vertexAttribPointer(e,2,d.FLOAT,!1,0,0),this.shouldCreateUnclampedViews=!this.allowsClampedTextureData()};return a.prototype.resize=function(a,b){this.width=0|a,this.height=0|b,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)},a.prototype.createTexture=function(a,b){var c=this.gl,d=c.createTexture();return c.bindTexture(c.TEXTURE_2D,d),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.uniform1i(c.getUniformLocation(this.program,b),a),d},a.prototype.createProgram=function(a,b){var c=this.gl,d=c.createProgram();return c.attachShader(d,this.compileShader(c.VERTEX_SHADER,a)),c.attachShader(d,this.compileShader(c.FRAGMENT_SHADER,b)),c.linkProgram(d),c.useProgram(d),d},a.prototype.compileShader=function(a,b){var c=this.gl,d=c.createShader(a);if(c.shaderSource(d,b),c.compileShader(d),!c.getShaderParameter(d,c.COMPILE_STATUS))throw new Error(c.getShaderInfoLog(d));return d},a.prototype.allowsClampedTextureData=function(){var a=this.gl,b=a.createTexture();return a.bindTexture(a.TEXTURE_2D,b),a.texImage2D(a.TEXTURE_2D,0,a.LUMINANCE,1,1,0,a.LUMINANCE,a.UNSIGNED_BYTE,new Uint8ClampedArray([0])),0===a.getError()},a.prototype.renderProgress=function(a){var b=this.gl,c=b.getUniformLocation(this.loadingProgram,"progress");b.uniform1f(c,a),b.drawArrays(b.TRIANGLE_STRIP,0,4)},a.prototype.render=function(a,b,c){var d,e,f,g,h;this.enabled&&(d=this.gl,e=this.width+15>>4<<4,f=this.height,g=e>>1,h=f>>1,this.shouldCreateUnclampedViews&&(a=new Uint8Array(a.buffer),b=new Uint8Array(b.buffer),c=new Uint8Array(c.buffer)),this.updateTexture(d.TEXTURE0,this.textureY,e,f,a),this.updateTexture(d.TEXTURE1,this.textureCb,g,h,b),this.updateTexture(d.TEXTURE2,this.textureCr,g,h,c),d.drawArrays(d.TRIANGLE_STRIP,0,4))},a.prototype.updateTexture=function(a,b,c,d,e){var f=this.gl;f.activeTexture(a),f.bindTexture(f.TEXTURE_2D,b),f.texImage2D(f.TEXTURE_2D,0,f.LUMINANCE,c,d,0,f.LUMINANCE,f.UNSIGNED_BYTE,e)},a.IsSupported=function(){try{if(!window.WebGLRenderingContext)return!1;var a=document.createElement("canvas");return!(!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(b){return!1}},a.SHADER={FRAGMENT_YCRCB_TO_RGBA:["precision mediump float;","uniform sampler2D textureY;","uniform sampler2D textureCb;","uniform sampler2D textureCr;","varying vec2 texCoord;","mat4 rec601 = mat4(","1.16438,  0.00000,  1.59603, -0.87079,","1.16438, -0.39176, -0.81297,  0.52959,","1.16438,  2.01723,  0.00000, -1.08139,","0, 0, 0, 1",");","void main() {","float y = texture2D(textureY, texCoord).r;","float cb = texture2D(textureCb, texCoord).r;","float cr = texture2D(textureCr, texCoord).r;","gl_FragColor = vec4(y, cr, cb, 1.0) * rec601;","}"].join("\n"),FRAGMENT_LOADING:["precision mediump float;","uniform float progress;","varying vec2 texCoord;","void main() {","float c = ceil(progress-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),VERTEX_IDENTITY:["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n")},a}(),f.Renderer.Canvas2D=function(){var a=function b(a){this.canvas=a.canvas||document.createElement("canvas"),this.width=this.canvas.width,this.height=this.canvas.height,this.enabled=!0,this.context=this.canvas.getContext("2d")};return a.prototype.resize=function(a,b){this.width=0|a,this.height=0|b,this.canvas.width=this.width,this.canvas.height=this.height,this.imageData=this.context.getImageData(0,0,this.width,this.height),f.Fill(this.imageData.data,255)},a.prototype.renderProgress=function(a){var b=this.canvas.width,c=this.canvas.height,d=this.context;d.fillStyle="#222",d.fillRect(0,0,b,c),d.fillStyle="#fff",d.fillRect(0,c-c*a,b,c*a)},a.prototype.render=function(a,b,c){this.YCbCrToRGBA(a,b,c,this.imageData.data),this.context.putImageData(this.imageData,0,0)},a.prototype.YCbCrToRGBA=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(this.enabled)for(e=this.width+15>>4<<4,f=e>>1,g=0,h=e,i=e+(e-this.width),j=0,k=f-(this.width>>1),l=0,m=4*this.width,n=4*this.width,o=this.width>>1,p=this.height>>1,v=0;v<p;v++){for(w=0;w<o;w++)q=b[j],r=c[j],j++,s=q+(103*q>>8)-179,t=(88*r>>8)-44+(183*q>>8)-91,u=r+(198*r>>8)-227,x=a[g++],y=a[g++],d[l]=x+s,d[l+1]=x-t,d[l+2]=x+u,d[l+4]=y+s,d[l+5]=y-t,d[l+6]=y+u,l+=8,z=a[h++],A=a[h++],d[m]=z+s,d[m+1]=z-t,d[m+2]=z+u,d[m+4]=A+s,d[m+5]=A-t,d[m+6]=A+u,m+=8;g+=i,h+=i,l+=n,m+=n,j+=k}},a}(),f.AudioOutput.WebAudio=function(){var a=function b(a){this.context=b.CachedContext=b.CachedContext||new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.destination=this.gain,this.startTime=0,this.buffer=null,this.wallclockStartTime=0,this.volume=1,this.enabled=!0,this.unlocked=!b.NeedsUnlocking(),Object.defineProperty(this,"enqueuedTime",{get:this.getEnqueuedTime})};return a.prototype.play=function(a,b,c){var d,e,g,h,i;if(this.enabled){if(!this.unlocked)return d=f.Now(),this.wallclockStartTime<d&&(this.wallclockStartTime=d),void(this.wallclockStartTime+=b.length/a);this.gain.gain.value=this.volume,e=this.context.createBuffer(2,b.length,a),e.getChannelData(0).set(b),e.getChannelData(1).set(c),g=this.context.createBufferSource(),g.buffer=e,g.connect(this.destination),h=this.context.currentTime,i=e.duration,this.startTime<h&&(this.startTime=h,this.wallclockStartTime=f.Now()),g.start(this.startTime),this.startTime+=i,this.wallclockStartTime+=i}},a.prototype.stop=function(){this.gain.gain.value=0},a.prototype.getEnqueuedTime=function(){return Math.max(this.wallclockStartTime-f.Now(),0)},a.prototype.resetEnqueuedTime=function(){this.startTime=this.context.currentTime,this.wallclockStartTime=f.Now()},a.prototype.unlock=function(a){var b,c;return this.unlocked?void(a&&a()):(this.unlockCallback=a,b=this.context.createBuffer(1,1,22050),c=this.context.createBufferSource(),c.buffer=b,c.connect(this.destination),c.start(0),void setTimeout(this.checkIfUnlocked.bind(this,c,0),0))},a.prototype.checkIfUnlocked=function(a,b){a.playbackState===a.PLAYING_STATE||a.playbackState===a.FINISHED_STATE?(this.unlocked=!0,this.unlockCallback&&(this.unlockCallback(),this.unlockCallback=null)):b<10&&setTimeout(this.checkIfUnlocked.bind(this,a,b+1),100)},a.NeedsUnlocking=function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},a.IsSupported=function(){return window.AudioContext||window.webkitAudioContext},a.CachedContext=null,a}(),b.exports=d},{}],68:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=function(a,b){var c=b.get("dsm")||{},e=c.bl||[],f=d.concat(e),g=!1;return f.map(function(b){b.indexOf(a)!==-1&&(g=!0)}),g};var d=[".rtbauction.com","video.leadzu.com"];b.exports=c["default"]},{}],69:[function(a,b,c){"use strict";function d(a,b){function c(a,c){var d=e(a,b),f=e(c,b);return d>f?1:-1}var d=a.sort(c);return d}function e(a,b){var c,d=0,e=g(a.wfIndex),h=g(a.waterfallTagId),i=g(a.cpmFloor),j=g(a.fillrate),k=b.getByAdvId("scoreBoost",a.advId)||0,l=f(a.type)||1,m={wg:e,wi:h,fr:j,cf:i,mt:l,advb:k};if(a.scoreSummary=m,d=1,c=b.get("qsrtscr"),c&&"function"==typeof c)try{d=c(m,a,b)}catch(n){d=999999}return a.score=d,d}function f(a){return"flash"===a?1:"javascript"===a?2:"spotxAdOs"===a?4:3}function g(a){return a=a||0,parseInt(a)}b.exports={sort:d}},{}],70:[function(a,b,c){"use strict";b.exports=function(){return{adimpression:[],impression:[],aderror:[],error:[],adclickthru:[],clickthru:[],adclickthrough:[],clickthrough:[],adclicktracking:[],clicktracking:[],adoloaded:[],loaded:[],adstarted:[],started:[],adstopped:[],stopped:[],adskipped:[],skipped:[],adskippablestatechange:[],skippablestatechange:[],adsizechange:[],sizechange:[],adlinearchange:[],linearchange:[],addurationchange:[],
durationchange:[],adexpandedchange:[],expandedchange:[],advolumechange:[],volumechange:[],advideostart:[],start:[],advideofirstquartile:[],firstquartile:[],advideomidpoint:[],midpoint:[],advideothirdquartile:[],thirdquartile:[],advideocomplete:[],complete:[],adinteraction:[],interaction:[],aduseracceptinvitation:[],acceptinvitation:[],aduserminimize:[],minimize:[],aduserclose:[],close:[],adpaused:[],paused:[],pause:[],adplaying:[],playing:[],resume:[],adlog:[],log:[],adfound:[],admute:[],mute:[],adunmute:[],unmute:[],adfullscreen:[],fullscreen:[],creativeview:[],progress:[]}}},{}],71:[function(a,b,c){"use strict";b.exports={AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt",Progress:"Progress"}},{}]},{},[20]);